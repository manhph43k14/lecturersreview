/*!
   * OmiseJs v2.5.1
   * Copyright: Omise
   *
   * Date: 2019/11/06 10:02
   */
!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=7)}([function(e,t,n){var r={test:{vaultUrl:"http://vault.lvh.me:4500",cardHost:"http://localhost:5002",interfaceUrl:"http://api.lvh.me:3000"},development:{vaultUrl:"https://vault-staging.omise.co",cardHost:"http://localhost:5002",interfaceUrl:"https://api-staging.omise.co"},staging:{vaultUrl:"https://vault-staging.omise.co",cardHost:"https://cdn.dev-omise.co",interfaceUrl:"https://api-staging.omise.co"},production:{vaultUrl:"https://vault.omise.co",cardHost:"https://cdn.omise.co",interfaceUrl:"https://api.omise.co"}};e.exports=r.production},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function r(e,t){return Object.assign({},e,t)}function o(e){try{return JSON.parse(e)}catch(t){return e}}function i(e){return e.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})}function a(e){for(var t={},n=e.attributes.length,r=0;r<n;r++){var o=e.attributes[r];if(/^data/.test(o.name)){t[i(o.name.replace("data-",""))]=o.value}}return t}t.b=r,t.c=o,t.a=a},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e){var t={error:!1,message:""};return e.vaultUrl&&n.i(s.isUri)(e.vaultUrl)?e.cardHost&&n.i(s.isUri)(e.cardHost)?e.interfaceUrl&&n.i(s.isUri)(e.interfaceUrl)||(t.message="Missing interfaceUrl"):t.message="Missing cardHost":t.message="Missing valutUrl",t.error=""!==t.message,t}n.d(t,"a",function(){return u});var s=n(9),c=(n.n(s),n(11)),u=(n.n(c),function(){function e(t){r(this,e);var n=a(t);if(n.error)throw new Error(n.message);this.config=t,this.publicKey=null,this._rpc=null}return i(e,[{key:"_createRpc",value:function(e){var t=this;if(this._rpc)return this._rpc;var n=this.config.vaultUrl,r=setTimeout(function(){t._rpc.destroy(),t._rpc=null,e&&e()},3e4);return this._rpc=new easyXDM.Rpc({remote:"".concat(n,"/provider"),onReady:function(){clearTimeout(r)}},{remote:{createToken:{}}}),this._rpc}},{key:"setPublicKey",value:function(e){return this.publicKey=e,this.publicKey}},{key:"createSource",value:function(e,t,n){var r=btoa(this.publicKey);t.type=e;var o="".concat(this.config.interfaceUrl,"/sources/");fetch(o,{method:"post",headers:{Authorization:"Basic ".concat(r),"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){return e.json().then(function(t){return n(e.status,t)})}).catch(function(e){n(0,{code:"create_source_error",error:e.message})})}},{key:"createToken",value:function(e,t,n){var r={};r[e]=t,this._createRpc(function(){n(0,{code:"rpc_error",message:"unable to connect to provider after timeout"})}).createToken(this.publicKey,r,function(e){n(e.status,e.data)},function(e){n(e.data.status,e.data.data)})}}]),e}())},function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(n,!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function u(e){var t={},n={publicKey:"key",logo:"image",locationField:"location"};for(var r in e){var o=n[r];o?t[o]=e[r]:t[r]=e[r]}return t}n.d(t,"a",function(){return m});var l=n(8),f=n(2),p={key:"",amount:0,currency:"THB",image:"https://cdn.omise.co/assets/frontend-images/store-logo.svg",frameLabel:"Omise",defaultPaymentMethod:"credit_card",otherPaymentMethods:[],frameDescription:"Secured by Omise",submitLabel:"Pay",buttonLabel:"Pay with Omise",location:"no",submitAuto:"yes",submitFormTarget:"",cardBrands:"visa mastercard",locale:"en",autoCardNumberFormat:"yes",expiryDateStyle:"",hideAmount:"false"},d=["display: none","visibility: visible","position: fixed","left: 0px","top: 0px","width: 100%","height: 100%","z-index: 2147483647","padding: 0","margin: 0","border: 0 none transparent","background-color: rgba(0, 0, 0, 0)","overflow-x: hidden","overflow-y: auto","-webkit-tap-highlight-color: transparent","transition: background-color .2s"],h=function(){},m=function(){function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];a(this,e),this.setup(t),n&&this.init()}return c(e,[{key:"setup",value:function(e){return this.app={settings:o({},e),iframe:null,iframeLoaded:!1,omiseScriptTag:null,omiseGenerateCheckoutButton:null,iframeAppId:"omise-checkout-iframe-app",defaultConfig:o({},p),configForIframeOnLoad:o({},p),currentOpenConfig:{},formElement:null,allConfigureButtons:[]},this.app}},{key:"init",value:function(){for(var e=null!=this.app.iframe,t=document.getElementsByTagName("script"),r=t.length,o=0;o<r;o++){var i=t[o];if(i.hasAttribute("data-key")&&i.hasAttribute("data-amount")){this.app.omiseScriptTag=i;break}}e||this.isInsideIframeApp()||!this.app.omiseScriptTag||(this.createIframe(),this.app.omiseGenerateCheckoutButton=this.createOmiseCheckoutButton(),n.i(l.a)(this))}},{key:"getDefaultConfig",value:function(){return this.app.defaultConfig}},{key:"getAllConfigureButtons",value:function(){return this.app.allConfigureButtons}},{key:"setTokenAtOmiseTokenField",value:function(e){var t=o({},this.app.defaultConfig,{},this.app.currentOpenConfig),n=t.submitAuto,r=t.onCreateTokenSuccess;this.app.formElement&&(this.isOmiseSource(e)?this.app.formElement.omiseSource.value=e:this.app.formElement.omiseToken.value=e),"yes"===n&&this.app.formElement&&this.app.formElement.submit(),(r||h)(e),this.app.currentOpenConfig={}}},{key:"isOmiseSource",value:function(e){return/^src_/.test(e)}},{key:"getFormByTarget",value:function(e){for(var t=e;t&&"FORM"!==t.tagName;)t=t.parentNode;return t}},{key:"createIframe",value:function(){var e=this,t=document.createElement("iframe");return t.id=this.app.iframeAppId,t.src="".concat(this.app.settings.cardHost,"/pay.html"),t.setAttribute("style",d.join("; ")),document.body.appendChild(t),t.onload=function(){"block"===e.app.iframe.style.display&&n.i(l.b)(t.contentWindow,{config:e.app.configForIframeOnLoad}),e.app.iframeLoaded=!0},this.app.iframe=t,this.app.iframe}},{key:"createHiddenInputForOmiseToken",value:function(e){var t=null;if(e&&"FORM"===e.tagName&&(t=e),!t)throw new Error(["Missing form element. Generate button or custom button must contain in form element.","https://github.com/omise/examples/blob/master/omise.js/example-4-custom-integration-multiple-buttons.html","Or setting submit form target","https://github.com/omise/examples/blob/master/omise.js/example-5-custom-integration-specify-checkout-form.html"].join("\n"));var n=t.querySelector('input[name="omiseToken"]');null==n&&(n=document.createElement("input"),n.setAttribute("type","hidden"),n.setAttribute("name","omiseToken"),t.appendChild(n));var r=t.querySelector('input[name="omiseSource"]');return null==r&&(r=document.createElement("input"),r.setAttribute("type","hidden"),r.setAttribute("name","omiseSource"),t.appendChild(r)),n}},{key:"createOmiseCheckoutButton",value:function(){var e=this,t=this.prepareConfig(n.i(f.a)(this.app.omiseScriptTag)),r=document.createElement("button");r.className="omise-checkout-button",r.innerHTML=t.buttonLabel;var i=this.app.omiseScriptTag;if(i){var a=this.getFormByTarget(i);this.app.formElement=a,this.createHiddenInputForOmiseToken(a)}else console.warn("Missing Omise script tag");return r.addEventListener("click",function(t){if(t.preventDefault(),i){var r=n.i(f.a)(i),a=e.prepareConfig(r);e.app.configForIframeOnLoad=o({},a),e.open(a)}else console.warn("Missing Omise script tag")},!1),i.parentNode.insertBefore(r,i.nextSibling),r}},{key:"isInsideIframeApp",value:function(){return null!=document.getElementById(this.app.iframeAppId)}},{key:"prepareConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.otherPaymentMethods;return t&&"string"==typeof t&&(e.otherPaymentMethods=this.stringToArray(t)),n.i(f.b)(this.app.defaultConfig,u(e))}},{key:"stringToArray",value:function(e){return e.split(",").map(function(e){return e.trim()})}},{key:"configure",value:function(e){return this.app.defaultConfig=this.prepareConfig(e),this.isInsideIframeApp()||this.app.iframe||(this.createIframe(),n.i(l.a)(this)),this.app.defaultConfig}},{key:"open",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h;if(!this.app.iframe)return!1;var i=function(){var i=e.prepareConfig(t);e.app.currentOpenConfig=o({},i),e.app.iframe.style.backgroundColor="rgba(0, 0, 0, .4)",e.app.iframe.style.display="block",setTimeout(function(){n.i(l.b)(e.app.iframe.contentWindow,{config:i}),r(e.app.iframe)})};if(this.app.iframeLoaded)i();else var a=0,s=setInterval(function(){((a+=100)>=3e3||e.app.iframeLoaded)&&(e.app.iframeLoaded&&i(),clearInterval(s))},100);return!0}},{key:"close",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return!!this.app.iframe&&(this.app.iframe.style.backgroundColor="rgba(0, 0, 0, 0)",setTimeout(function(){e.app.iframe.style.display="none",t(e.app.iframe),(e.app.currentOpenConfig.onFormClosed||h)(e.app.iframe)},250),!0)}},{key:"destroy",value:function(){var e=document.getElementById(this.app.iframeAppId);if(this.app.iframe&&e){var t=document.getElementById(this.app.iframeAppId);document.body.removeChild(t),this.setup()}}},{key:"createParentFrameHandler",value:function(){return{closeIframe:function(){n.i(l.c)()},closeAndSendToken:function(e){n.i(l.d)(e)}}}},{key:"configureButton",value:function(e,t){var n=this.prepareConfig(t),r={buttonId:e,configuration:n};return this.app.allConfigureButtons.push(r),r}},{key:"attach",value:function(){var e=this,t=[];return this.app.allConfigureButtons.forEach(function(n){var r=n.configuration,o=document.querySelector(n.buttonId),i=e.app.defaultConfig.buttonLabel,a=i;r.buttonLabel&&a!==r.buttonLabel?a=r.buttonLabel:o.innerHTML&&(a=o.innerHTML),o.innerHTML=a;var s=e.app.defaultConfig.submitFormTarget,c=s?document.querySelector(s):e.getFormByTarget(o);e.createHiddenInputForOmiseToken(c),o.addEventListener("click",function(t){t.preventDefault();t.target;e.app.configForIframeOnLoad=r,e.app.formElement=c,e.open(r)},!1),t.push(o)}),this.isInsideIframeApp()||this.app.iframe||(this.createIframe(),n.i(l.a)(this)),t}}]),e}()},function(e,t){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),r=1;r<arguments.length;r++){var o=arguments[r];if(null!=o)for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])}return n},writable:!0,configurable:!0})},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t,r,o,i,a){function s(e,t){var r=n(e[t]);return"function"==r||!("object"!=r||!e[t])||"unknown"==r}function c(e,t){return!("object"!=n(e[t])||!e[t])}function u(e){return"[object Array]"===Object.prototype.toString.call(e)}function l(){var e="Shockwave Flash",t="application/x-shockwave-flash";if(!w(navigator.plugins)&&"object"==n(navigator.plugins[e])){var r=navigator.plugins[e].description;r&&!w(navigator.mimeTypes)&&navigator.mimeTypes[t]&&navigator.mimeTypes[t].enabledPlugin&&(P=r.match(/\d+/g))}if(!P){var o;try{o=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),P=Array.prototype.slice.call(o.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1),o=null}catch(e){}}if(!P)return!1;var i=parseInt(P[0],10),a=parseInt(P[1],10);return A=i>9&&a>0,!0}function f(){if(!W){W=!0;for(var e=0;e<K.length;e++)K[e]();K.length=0}}function p(e,t){if(W)return void e.call(t);K.push(function(){e.call(t)})}function d(){var e=parent;if(""!==N)for(var t=0,n=N.split(".");t<n.length;t++)e=e[n[t]];return e.easyXDM}function h(t){return e.easyXDM=U,N=t,N&&(J="easyXDM_"+N.replace(".","_")+"_"),H}function m(e){return e.match(R)[3]}function y(e){return e.match(R)[4]||""}function g(e){var t=e.toLowerCase().match(R),n=t[2],r=t[3],o=t[4]||"";return("http:"==n&&":80"==o||"https:"==n&&":443"==o)&&(o=""),n+"//"+r+o}function v(e){if(e=e.replace(D,"$1/"),!e.match(/^(http||https):\/\//)){var t="/"===e.substring(0,1)?"":r.pathname;"/"!==t.substring(t.length-1)&&(t=t.substring(0,t.lastIndexOf("/")+1)),e=r.protocol+"//"+r.host+t+e}for(;L.test(e);)e=e.replace(L,"");return e}function b(e,t){var n="",r=e.indexOf("#");-1!==r&&(n=e.substring(r),e=e.substring(0,r));var o=[];for(var i in t)t.hasOwnProperty(i)&&o.push(i+"="+a(t[i]));return e+(q?"#":-1==e.indexOf("?")?"?":"&")+o.join("&")+n}function w(e){return void 0===e}function _(e,t,r){var o;for(var i in t)t.hasOwnProperty(i)&&(i in e?(o=t[i],"object"===n(o)?_(e[i],o,r):r||(e[i]=t[i])):e[i]=t[i]);return e}function O(){var e=t.body.appendChild(t.createElement("form")),n=e.appendChild(t.createElement("input"));n.name=J+"TEST"+I,C=n!==e.elements[n.name],t.body.removeChild(e)}function k(e){w(C)&&O();var r;C?r=t.createElement('<iframe name="'+e.props.name+'"/>'):(r=t.createElement("IFRAME"),r.name=e.props.name),r.id=r.name=e.props.name,delete e.props.name,"string"==typeof e.container&&(e.container=t.getElementById(e.container)),e.container||(_(r.style,{position:"absolute",top:"-2000px",left:"0px"}),e.container=t.body);var o=e.props.src;if(e.props.src="javascript:false",_(r,e.props),r.border=r.frameBorder=0,r.allowTransparency=!0,e.container.appendChild(r),e.onLoad&&F(r,"load",e.onLoad),e.usePost){var i,a=e.container.appendChild(t.createElement("form"));if(a.target=r.name,a.action=o,a.method="POST","object"===n(e.usePost))for(var s in e.usePost)e.usePost.hasOwnProperty(s)&&(C?i=t.createElement('<input name="'+s+'"/>'):(i=t.createElement("INPUT"),i.name=s),i.value=e.usePost[s],a.appendChild(i));a.submit(),a.parentNode.removeChild(a)}else r.src=o;return e.props.src=o,r}function x(e,t){"string"==typeof e&&(e=[e]);for(var n,r=e.length;r--;)if(n=e[r],n=new RegExp("^"==n.substr(0,1)?n:"^"+n.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),n.test(t))return!0;return!1}function T(n){var o,i=n.protocol;if(n.isHost=n.isHost||w(X.xdm_p),q=n.hash||!1,n.props||(n.props={}),n.isHost)n.remote=v(n.remote),n.channel=n.channel||"default"+I++,n.secret=Math.random().toString(16).substring(2),w(i)&&(i=g(r.href)==g(n.remote)?"4":s(e,"postMessage")||s(t,"postMessage")?"1":n.swf&&s(e,"ActiveXObject")&&l()?"6":"Gecko"===navigator.product&&"frameElement"in e&&-1==navigator.userAgent.indexOf("WebKit")?"5":n.remoteHelper?"2":"0");else if(n.channel=X.xdm_c.replace(/["'<>\\]/g,""),n.secret=X.xdm_s,n.remote=X.xdm_e.replace(/["'<>\\]/g,""),i=X.xdm_p,n.acl&&!x(n.acl,n.remote))throw new Error("Access denied for "+n.remote);switch(n.protocol=i,i){case"0":if(_(n,{interval:100,delay:2e3,useResize:!0,useParent:!1,usePolling:!1},!0),n.isHost){if(!n.local){for(var a,c=r.protocol+"//"+r.host,u=t.body.getElementsByTagName("img"),f=u.length;f--;)if(a=u[f],a.src.substring(0,c.length)===c){n.local=a.src;break}n.local||(n.local=e)}var p={xdm_c:n.channel,xdm_p:0};n.local===e?(n.usePolling=!0,n.useParent=!0,n.local=r.protocol+"//"+r.host+r.pathname+r.search,p.xdm_e=n.local,p.xdm_pa=1):p.xdm_e=v(n.local),n.container&&(n.useResize=!1,p.xdm_po=1),n.remote=b(n.remote,p)}else _(n,{channel:X.xdm_c,remote:X.xdm_e,useParent:!w(X.xdm_pa),usePolling:!w(X.xdm_po),useResize:!n.useParent&&n.useResize});o=[new H.stack.HashTransport(n),new H.stack.ReliableBehavior({}),new H.stack.QueueBehavior({encode:!0,maxLength:4e3-n.remote.length}),new H.stack.VerifyBehavior({initiate:n.isHost})];break;case"1":o=[new H.stack.PostMessageTransport(n)];break;case"2":n.isHost&&(n.remoteHelper=v(n.remoteHelper)),o=[new H.stack.NameTransport(n),new H.stack.QueueBehavior,new H.stack.VerifyBehavior({initiate:n.isHost})];break;case"3":o=[new H.stack.NixTransport(n)];break;case"4":o=[new H.stack.SameOriginTransport(n)];break;case"5":o=[new H.stack.FrameElementTransport(n)];break;case"6":P||l(),o=[new H.stack.FlashTransport(n)]}return o.push(new H.stack.QueueBehavior({lazy:n.lazy,remove:!0})),o}function E(e){for(var t,n={incoming:function(e,t){this.up.incoming(e,t)},outgoing:function(e,t){this.down.outgoing(e,t)},callback:function(e){this.up.callback(e)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}},r=0,o=e.length;r<o;r++)t=e[r],_(t,n,!0),0!==r&&(t.down=e[r-1]),r!==o-1&&(t.up=e[r+1]);return t}function S(e){e.up.down=e.down,e.down.up=e.up,e.up=e.down=null}var C,P,A,F,B,M=this,I=Math.floor(1e4*Math.random()),j=Function.prototype,R=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,L=/[\-\w]+\/\.\.\//,D=/([^:])\/\//g,N="",H={},U=e.easyXDM,J="easyXDM_",q=!1;if(s(e,"addEventListener"))F=function(e,t,n){e.addEventListener(t,n,!1)},B=function(e,t,n){e.removeEventListener(t,n,!1)};else{if(!s(e,"attachEvent"))throw new Error("Browser not supported");F=function(e,t,n){e.attachEvent("on"+t,n)},B=function(e,t,n){e.detachEvent("on"+t,n)}}var z,W=!1,K=[];if("readyState"in t?(z=t.readyState,W="complete"==z||~navigator.userAgent.indexOf("AppleWebKit/")&&("loaded"==z||"interactive"==z)):W=!!t.body,!W){if(s(e,"addEventListener"))F(t,"DOMContentLoaded",f);else if(F(t,"readystatechange",function(){"complete"==t.readyState&&f()}),t.documentElement.doScroll&&e===top){!function e(){if(!W){try{t.documentElement.doScroll("left")}catch(t){return void o(e,1)}f()}}()}F(e,"load",f)}var X=function(e){e=e.substring(1).split("&");for(var t,n={},r=e.length;r--;)t=e[r].split("="),n[t[0]]=i(t[1]);return n}(/xdm_e=/.test(r.search)?r.search:r.hash),$=function(){var e={},t={a:[1,2,3]},n='{"a":[1,2,3]}';return"undefined"!=typeof JSON&&"function"==typeof JSON.stringify&&JSON.stringify(t).replace(/\s/g,"")===n?JSON:(Object.toJSON&&Object.toJSON(t).replace(/\s/g,"")===n&&(e.stringify=Object.toJSON),"function"==typeof String.prototype.evalJSON&&(t=n.evalJSON(),t.a&&3===t.a.length&&3===t.a[2]&&(e.parse=function(e){return e.evalJSON()})),e.stringify&&e.parse?($=function(){return e},e):null)};_(H,{version:"2.4.19.3",query:X,stack:{},apply:_,getJSONObject:$,whenReady:p,noConflict:h}),H.DomHelper={on:F,un:B,requiresJSON:function(n){c(e,"JSON")||t.write('<script type="text/javascript" src="'+n+'"><\/script>')}},function(){var e={};H.Fn={set:function(t,n){e[t]=n},get:function(t,n){if(e.hasOwnProperty(t)){var r=e[t];return n&&delete e[t],r}}}}(),H.Socket=function(e){var t=E(T(e).concat([{incoming:function(t,n){e.onMessage(t,n)},callback:function(t){e.onReady&&e.onReady(t)}}])),n=g(e.remote);this.origin=g(e.remote),this.destroy=function(){t.destroy()},this.postMessage=function(e){t.outgoing(e,n)},t.init()},H.Rpc=function(e,t){if(t.local)for(var n in t.local)if(t.local.hasOwnProperty(n)){var r=t.local[n];"function"==typeof r&&(t.local[n]={method:r})}var o=E(T(e).concat([new H.stack.RpcBehavior(this,t),{callback:function(t){e.onReady&&e.onReady(t)}}]));this.origin=g(e.remote),this.destroy=function(){o.destroy()},o.init()},H.stack.SameOriginTransport=function(e){var t,n,i,a;return t={outgoing:function(e,t,n){i(e),n&&n()},destroy:function(){n&&(n.parentNode.removeChild(n),n=null)},onDOMReady:function(){a=g(e.remote),e.isHost?(_(e.props,{src:b(e.remote,{xdm_e:r.protocol+"//"+r.host+r.pathname,xdm_c:e.channel,xdm_p:4}),name:J+e.channel+"_provider"}),n=k(e),H.Fn.set(e.channel,function(e){return i=e,o(function(){t.up.callback(!0)},0),function(e){t.up.incoming(e,a)}})):(i=d().Fn.get(e.channel,!0)(function(e){t.up.incoming(e,a)}),o(function(){t.up.callback(!0)},0))},init:function(){p(t.onDOMReady,t)}}},H.stack.FlashTransport=function(e){function n(e,t){o(function(){s.up.incoming(e,u)},0)}function i(n){var r=e.swf+"?host="+e.isHost,o="easyXDM_swf_"+Math.floor(1e4*Math.random());H.Fn.set("flash_loaded"+n.replace(/[\-.]/g,"_"),function(){H.stack.FlashTransport[n].swf=l=f.firstChild;for(var e=H.stack.FlashTransport[n].queue,t=0;t<e.length;t++)e[t]();e.length=0}),e.swfContainer?f="string"==typeof e.swfContainer?t.getElementById(e.swfContainer):e.swfContainer:(f=t.createElement("div"),_(f.style,A&&e.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0}),t.body.appendChild(f));var i="callback=flash_loaded"+a(n.replace(/[\-.]/g,"_"))+"&proto="+M.location.protocol+"&domain="+a(m(M.location.href))+"&port="+a(y(M.location.href))+"&ns="+a(N);f.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+o+"' data='"+r+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+r+"'></param><param name='flashvars' value='"+i+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+i+"' allowScriptAccess='always' wmode='transparent' src='"+r+"' height='1' width='1'></embed></object>"}var s,c,u,l,f;return s={outgoing:function(t,n,r){l.postMessage(e.channel,t.toString()),r&&r()},destroy:function(){try{l.destroyChannel(e.channel)}catch(e){}l=null,c&&(c.parentNode.removeChild(c),c=null)},onDOMReady:function(){u=e.remote,H.Fn.set("flash_"+e.channel+"_init",function(){o(function(){s.up.callback(!0)})}),H.Fn.set("flash_"+e.channel+"_onMessage",n),e.swf=v(e.swf);var t=m(e.swf),a=function(){H.stack.FlashTransport[t].init=!0,l=H.stack.FlashTransport[t].swf,l.createChannel(e.channel,e.secret,g(e.remote),e.isHost),e.isHost&&(A&&e.swfNoThrottle&&_(e.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"}),_(e.props,{src:b(e.remote,{xdm_e:g(r.href),xdm_c:e.channel,xdm_p:6,xdm_s:e.secret}),name:J+e.channel+"_provider"}),c=k(e))};H.stack.FlashTransport[t]&&H.stack.FlashTransport[t].init?a():H.stack.FlashTransport[t]?H.stack.FlashTransport[t].queue.push(a):(H.stack.FlashTransport[t]={queue:[a]},i(t))},init:function(){p(s.onDOMReady,s)}}},H.stack.PostMessageTransport=function(t){function n(e){if(e.origin)return g(e.origin);if(e.uri)return g(e.uri);if(e.domain)return r.protocol+"//"+e.domain;throw"Unable to retrieve the origin of the event"}function i(e){var r=n(e);r==u&&e.data.substring(0,t.channel.length+1)==t.channel+" "&&a.up.incoming(e.data.substring(t.channel.length+1),r)}var a,s,c,u;return a={outgoing:function(e,n,r){c.postMessage(t.channel+" "+e,n||u),r&&r()},destroy:function(){B(e,"message",i),s&&(c=null,s.parentNode.removeChild(s),s=null)},onDOMReady:function(){if(u=g(t.remote),t.isHost){F(e,"message",function n(r){r.data==t.channel+"-ready"&&(c="postMessage"in s.contentWindow?s.contentWindow:s.contentWindow.document,B(e,"message",n),F(e,"message",i),o(function(){a.up.callback(!0)},0))}),_(t.props,{src:b(t.remote,{xdm_e:g(r.href),xdm_c:t.channel,xdm_p:1}),name:J+t.channel+"_provider"}),s=k(t)}else F(e,"message",i),c="postMessage"in e.parent?e.parent:e.parent.document,c.postMessage(t.channel+"-ready",u),o(function(){a.up.callback(!0)},0)},init:function(){p(a.onDOMReady,a)}}},H.stack.FrameElementTransport=function(n){var i,a,s,c;return i={outgoing:function(e,t,n){s.call(this,e),n&&n()},destroy:function(){a&&(a.parentNode.removeChild(a),a=null)},onDOMReady:function(){c=g(n.remote),n.isHost?(_(n.props,{src:b(n.remote,{xdm_e:g(r.href),xdm_c:n.channel,xdm_p:5}),name:J+n.channel+"_provider"}),a=k(n),a.fn=function(e){return delete a.fn,s=e,o(function(){i.up.callback(!0)},0),function(e){i.up.incoming(e,c)}}):(t.referrer&&g(t.referrer)!=X.xdm_e&&(e.top.location=X.xdm_e),s=e.frameElement.fn(function(e){i.up.incoming(e,c)}),i.up.callback(!0))},init:function(){p(i.onDOMReady,i)}}},H.stack.NameTransport=function(e){function t(t){var n=e.remoteHelper+(s?"#_3":"#_2")+e.channel;c.contentWindow.sendMessage(t,n)}function n(){s?2!=++l&&s||a.up.callback(!0):(t("ready"),a.up.callback(!0))}function r(e){a.up.incoming(e,d)}function i(){f&&o(function(){f(!0)},0)}var a,s,c,u,l,f,d,h;return a={outgoing:function(e,n,r){f=r,t(e)},destroy:function(){c.parentNode.removeChild(c),c=null,s&&(u.parentNode.removeChild(u),u=null)},onDOMReady:function(){s=e.isHost,l=0,d=g(e.remote),e.local=v(e.local),s?(H.Fn.set(e.channel,function(t){s&&"ready"===t&&(H.Fn.set(e.channel,r),n())}),h=b(e.remote,{xdm_e:e.local,xdm_c:e.channel,xdm_p:2}),_(e.props,{src:h+"#"+e.channel,name:J+e.channel+"_provider"}),u=k(e)):(e.remoteHelper=e.remote,H.Fn.set(e.channel,r));var t=function t(){var r=c||this;B(r,"load",t),H.Fn.set(e.channel+"_load",i),function e(){"function"==typeof r.contentWindow.sendMessage?n():o(e,50)}()};c=k({props:{src:e.local+"#_4"+e.channel},onLoad:t})},init:function(){p(a.onDOMReady,a)}}},H.stack.HashTransport=function(t){function n(e){if(m){var n=t.remote+"#"+d+++"_"+e;(c||!y?m.contentWindow:m).location=n}}function r(e){f=e,s.up.incoming(f.substring(f.indexOf("_")+1),v)}function i(){if(h){var e=h.location.href,t="",n=e.indexOf("#");-1!=n&&(t=e.substring(n)),t&&t!=f&&r(t)}}function a(){u=setInterval(i,l)}var s,c,u,l,f,d,h,m,y,v;return s={outgoing:function(e,t){n(e)},destroy:function(){e.clearInterval(u),!c&&y||m.parentNode.removeChild(m),m=null},onDOMReady:function(){if(c=t.isHost,l=t.interval,f="#"+t.channel,d=0,y=t.useParent,v=g(t.remote),c){if(_(t.props,{src:t.remote,name:J+t.channel+"_provider"}),y)t.onLoad=function(){h=e,a(),s.up.callback(!0)};else{var n=0,r=t.delay/50;!function e(){if(++n>r)throw new Error("Unable to reference listenerwindow");try{h=m.contentWindow.frames[J+t.channel+"_consumer"]}catch(e){}h?(a(),s.up.callback(!0)):o(e,50)}()}m=k(t)}else h=e,a(),y?(m=parent,s.up.callback(!0)):(_(t,{props:{src:t.remote+"#"+t.channel+new Date,name:J+t.channel+"_consumer"},onLoad:function(){s.up.callback(!0)}}),m=k(t))},init:function(){p(s.onDOMReady,s)}}},H.stack.ReliableBehavior=function(e){var t,n,r=0,o=0,i="";return t={incoming:function(e,a){var s=e.indexOf("_"),c=e.substring(0,s).split(",");e=e.substring(s+1),c[0]==r&&(i="",n&&n(!0)),e.length>0&&(t.down.outgoing(c[1]+","+r+"_"+i,a),o!=c[1]&&(o=c[1],t.up.incoming(e,a)))},outgoing:function(e,a,s){i=e,n=s,t.down.outgoing(o+","+ ++r+"_"+e,a)}}},H.stack.QueueBehavior=function(e){function t(){if(e.remove&&0===s.length)return void S(n);if(!c&&0!==s.length&&!r){c=!0;var i=s.shift();n.down.outgoing(i.data,i.origin,function(e){c=!1,i.callback&&o(function(){i.callback(e)},0),t()})}}var n,r,s=[],c=!0,u="",l=0,f=!1,p=!1;return n={init:function(){w(e)&&(e={}),e.maxLength&&(l=e.maxLength,p=!0),e.lazy?f=!0:n.down.init()},callback:function(e){c=!1;var r=n.up;t(),r.callback(e)},incoming:function(t,r){if(p){var o=t.indexOf("_"),a=parseInt(t.substring(0,o),10);u+=t.substring(o+1),0===a&&(e.encode&&(u=i(u)),n.up.incoming(u,r),u="")}else n.up.incoming(t,r)},outgoing:function(r,o,i){e.encode&&(r=a(r));var c,u=[];if(p){for(;0!==r.length;)c=r.substring(0,l),r=r.substring(c.length),u.push(c);for(;c=u.shift();)s.push({data:u.length+"_"+c,origin:o,callback:0===u.length?i:null})}else s.push({data:r,origin:o,callback:i});f?n.down.init():t()},destroy:function(){r=!0,n.down.destroy()}}},H.stack.VerifyBehavior=function(e){function t(){r=Math.random().toString(16).substring(2),n.down.outgoing(r)}var n,r,o;return n={incoming:function(i,a){var s=i.indexOf("_");-1===s?i===r?n.up.callback(!0):o||(o=i,e.initiate||t(),n.down.outgoing(i)):i.substring(0,s)===o&&n.up.incoming(i.substring(s+1),a)},outgoing:function(e,t,o){n.down.outgoing(r+"_"+e,t,o)},callback:function(n){e.initiate&&t()}}},H.stack.RpcBehavior=function(e,t){function n(e){e.jsonrpc="2.0",i.down.outgoing(a.stringify(e))}function r(e,t){var r=Array.prototype.slice;return function(){var o,i=arguments.length,a={method:t};i>0&&"function"==typeof arguments[i-1]?(i>1&&"function"==typeof arguments[i-2]?(o={success:arguments[i-2],error:arguments[i-1]},a.params=r.call(arguments,0,i-2)):(o={success:arguments[i-1]},a.params=r.call(arguments,0,i-1)),c[""+ ++s]=o,a.id=s):a.params=r.call(arguments,0),e.namedParams&&1===a.params.length&&(a.params=a.params[0]),n(a)}}function o(e,t,r,o){if(!r)return void(t&&n({id:t,error:{code:-32601,message:"Procedure not found."}}));var i,a;t?(i=function(e){i=j,n({id:t,result:e})},a=function(e,r){a=j;var o={id:t,error:{code:-32099,message:e}};r&&(o.error.data=r),n(o)}):i=a=j,u(o)||(o=[o]);try{var s=r.method.apply(r.scope,o.concat([i,a]));w(s)||i(s)}catch(e){a(e.message)}}var i,a=t.serializer||$(),s=0,c={};return i={incoming:function(e,r){var i=a.parse(e);if(i.method)t.handle?t.handle(i,n):o(i.method,i.id,t.local[i.method],i.params);else{var s=c[i.id];i.error?s.error&&s.error(i.error):s.success&&s.success(i.result),delete c[i.id]}},init:function(){if(t.remote)for(var n in t.remote)t.remote.hasOwnProperty(n)&&(e[n]=r(t.remote[n],n));i.down.init()},destroy:function(){for(var n in t.remote)t.remote.hasOwnProperty(n)&&e.hasOwnProperty(n)&&delete e[n];i.down.destroy()}}},e.easyXDM=H}(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){var r=n(5),o=(n.n(r),n(6)),i=(n.n(o),n(0)),a=n.n(i),s=n(3),c=n(4);t.default=s.a,e.Omise=new s.a(a.a),e.OmiseCard=new c.a(a.a)}.call(t,n(1))},function(e,t,n){"use strict";(function(e){function r(t){e.addEventListener("message",function(e){var r=n.i(f.c)(e.data),o=r.type,i=r.data;s(t,o,i)},!1)}function o(e,t){c(e,p.SHOW_IFRAME_APP_FORM,t,l.a.cardHost)}function i(){c(parent.window,p.CLOSE_IFRAME,null,"*")}function a(e){c(parent.window,p.CLOSE_AND_SEND_TOKEN,e,"*")}function s(e,t,n){switch(t){case p.CLOSE_IFRAME:e.close();break;case p.CLOSE_AND_SEND_TOKEN:e.close(),e.setTokenAtOmiseTokenField(n)}}function c(e,t,n,r){var o=JSON.stringify({type:t,data:n});e.postMessage(o,r)}t.a=r,t.b=o,t.c=i,t.d=a;var u=n(0),l=n.n(u),f=n(2),p={CLOSE_IFRAME:"CLOSE_IFRAME",SHOW_IFRAME_APP_FORM:"SHOW_IFRAME_APP_FORM",CLOSE_AND_SEND_TOKEN:"CLOSE_AND_SEND_TOKEN"}}).call(t,n(1))},function(e,t,n){(function(e){!function(e){"use strict";function t(e){if(e&&!/[^a-z0-9\:\/\?\#\[\]\@\!\$\&\'\(\)\*\+\,\;\=\.\-\_\~\%]/i.test(e)&&!/%[^0-9a-f]/i.test(e)&&!/%[0-9a-f](:?[^0-9a-f]|$)/i.test(e)){var t=[],n="",r="",o="",a="",s="",c="";if(t=i(e),n=t[1],r=t[2],o=t[3],a=t[4],s=t[5],n&&n.length&&o.length>=0){if(r&&r.length){if(0!==o.length&&!/^\//.test(o))return}else if(/^\/\//.test(o))return;if(/^[a-z][a-z0-9\+\-\.]*$/.test(n.toLowerCase()))return c+=n+":",r&&r.length&&(c+="//"+r),c+=o,a&&a.length&&(c+="?"+a),s&&s.length&&(c+="#"+s),c}}}function n(e,n){if(t(e)){var r=[],o="",a="",s="",c="",u="",l="",f="";if(r=i(e),o=r[1],a=r[2],s=r[3],u=r[4],l=r[5],o){if(n){if("https"!=o.toLowerCase())return}else if("http"!=o.toLowerCase())return;if(a)return/:(\d+)$/.test(a)&&(c=a.match(/:(\d+)$/)[0],a=a.replace(/:\d+$/,"")),f+=o+":",f+="//"+a,c&&(f+=c),f+=s,u&&u.length&&(f+="?"+u),l&&l.length&&(f+="#"+l),f}}}function r(e){return n(e,!0)}function o(e){return n(e)||r(e)}e.exports.is_uri=t,e.exports.is_http_uri=n,e.exports.is_https_uri=r,e.exports.is_web_uri=o,e.exports.isUri=t,e.exports.isHttpUri=n,e.exports.isHttpsUri=r,e.exports.isWebUri=o;var i=function(e){return e.match(/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/)}}(e)}).call(t,n(10)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){!function(e){"use strict";function t(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function n(e){return"string"!=typeof e&&(e=String(e)),e}function r(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return g.iterable&&(t[Symbol.iterator]=function(){return t}),t}function o(e){this.map={},e instanceof o?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function i(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function a(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function s(e){var t=new FileReader,n=a(t);return t.readAsArrayBuffer(e),n}function c(e){var t=new FileReader,n=a(t);return t.readAsText(e),n}function u(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}function l(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function f(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(g.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(g.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(g.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(g.arrayBuffer&&g.blob&&b(e))this._bodyArrayBuffer=l(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!g.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!w(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=l(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):g.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},g.blob&&(this.blob=function(){var e=i(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?i(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(s)}),this.text=function(){var e=i(this);if(e)return e;if(this._bodyBlob)return c(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(u(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g.formData&&(this.formData=function(){return this.text().then(h)}),this.json=function(){return this.text().then(JSON.parse)},this}function p(e){var t=e.toUpperCase();return _.indexOf(t)>-1?t:e}function d(e,t){t=t||{};var n=t.body;if(e instanceof d){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new o(e.headers)),this.method=e.method,this.mode=e.mode,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new o(t.headers)),this.method=p(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function h(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(o))}}),t}function m(e){var t=new o;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();t.append(r,o)}}),t}function y(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new o(t.headers),this.url=t.url||"",this._initBody(e)}if(!e.fetch){var g={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(g.arrayBuffer)var v=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],b=function(e){return e&&DataView.prototype.isPrototypeOf(e)},w=ArrayBuffer.isView||function(e){return e&&v.indexOf(Object.prototype.toString.call(e))>-1};o.prototype.append=function(e,r){e=t(e),r=n(r);var o=this.map[e];this.map[e]=o?o+","+r:r},o.prototype.delete=function(e){delete this.map[t(e)]},o.prototype.get=function(e){return e=t(e),this.has(e)?this.map[e]:null},o.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},o.prototype.set=function(e,r){this.map[t(e)]=n(r)},o.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},o.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),r(e)},o.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),r(e)},o.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),r(e)},g.iterable&&(o.prototype[Symbol.iterator]=o.prototype.entries);var _=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];d.prototype.clone=function(){return new d(this,{body:this._bodyInit})},f.call(d.prototype),f.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new o(this.headers),url:this.url})},y.error=function(){var e=new y(null,{status:0,statusText:""});return e.type="error",e};var O=[301,302,303,307,308];y.redirect=function(e,t){if(-1===O.indexOf(t))throw new RangeError("Invalid status code");return new y(null,{status:t,headers:{location:e}})},e.Headers=o,e.Request=d,e.Response=y,e.fetch=function(e,t){return new Promise(function(n,r){var o=new d(e,t),i=new XMLHttpRequest;i.onload=function(){var e={status:i.status,statusText:i.statusText,headers:m(i.getAllResponseHeaders()||"")};e.url="responseURL"in i?i.responseURL:e.headers.get("X-Request-URL");var t="response"in i?i.response:i.responseText;n(new y(t,e))},i.onerror=function(){r(new TypeError("Network request failed"))},i.ontimeout=function(){r(new TypeError("Network request failed"))},i.open(o.method,o.url,!0),"include"===o.credentials?i.withCredentials=!0:"omit"===o.credentials&&(i.withCredentials=!1),"responseType"in i&&g.blob&&(i.responseType="blob"),o.headers.forEach(function(e,t){i.setRequestHeader(t,e)}),i.send(void 0===o._bodyInit?null:o._bodyInit)})},e.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vb21pc2UuanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIDBjZWI0YmU2NGFmNzAwNTYyMWM1Iiwid2VicGFjazovLy8uL3NyYy9jb25maWcuanMiLCJ3ZWJwYWNrOi8vLyh3ZWJwYWNrKS9idWlsZGluL2dsb2JhbC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaGVscGVycy91dGlscy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvT21pc2UuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL09taXNlQ2FyZC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaGVscGVycy9wb2x5ZmlsbC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdmVuZG9ycy9lYXN5WERNLmpzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvbWVzc2FnZS5qcyIsIndlYnBhY2s6Ly8vLi9+L3ZhbGlkLXVybC9pbmRleC5qcyIsIndlYnBhY2s6Ly8vKHdlYnBhY2spL2J1aWxkaW4vbW9kdWxlLmpzIiwid2VicGFjazovLy8uL34vd2hhdHdnLWZldGNoL2ZldGNoLmpzIl0sIm5hbWVzIjpbIm1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpbnN0YWxsZWRNb2R1bGVzIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwiY2FsbCIsIm0iLCJjIiwidmFsdWUiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJnZXQiLCJuIiwiX19lc01vZHVsZSIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImNvbmZpZyIsInRlc3QiLCJ2YXVsdFVybCIsInByb2Nlc3MiLCJjYXJkSG9zdCIsImludGVyZmFjZVVybCIsImRldmVsb3BtZW50Iiwic3RhZ2luZyIsInByb2R1Y3Rpb24iLCJnIiwidGhpcyIsIkZ1bmN0aW9uIiwiZXZhbCIsImUiLCJ3aW5kb3ciLCJfX3dlYnBhY2tfZXhwb3J0c19fIiwibWVyZ2UiLCJkZXN0Iiwic291cmNlIiwiYXNzaWduIiwic2FmZUpzb25QYXJzZSIsInN0ciIsIkpTT04iLCJwYXJzZSIsImRhc2hUb0NhbWVsQ2FzZSIsInJlcGxhY2UiLCJ0b1VwcGVyQ2FzZSIsImV4dHJhY3REYXRhRnJvbUVsZW1lbnQiLCJlbGVtZW50IiwiZXh0cmFjdERhdGEiLCJ0b3RhbEF0dHJzIiwiYXR0cmlidXRlcyIsImxlbmd0aCIsImF0dHIiLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX2RlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImRlc2NyaXB0b3IiLCJ3cml0YWJsZSIsImtleSIsIl9jcmVhdGVDbGFzcyIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInZlcmlmeUNvbmZpZ1N0cnVjdHVyZSIsInJlc3VsdCIsImVycm9yIiwibWVzc2FnZSIsImlzVXJpIiwiT21pc2UiLCJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfdmFsaWRfdXJsX18iLCJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfd2hhdHdnX2ZldGNoX18iLCJFcnJvciIsInB1YmxpY0tleSIsIl9ycGMiLCJjYWxsYmFjayIsInRtIiwic2V0VGltZW91dCIsImRlc3Ryb3kiLCJlYXN5WERNIiwiUnBjIiwicmVtb3RlIiwib25SZWFkeSIsImNsZWFyVGltZW91dCIsImNyZWF0ZVRva2VuIiwidHlwZSIsIm9wdGlvbnMiLCJhdXRoIiwiYnRvYSIsInVybCIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJib2R5Iiwic3RyaW5naWZ5IiwidGhlbiIsInJlc3BvbnNlIiwianNvbiIsImRhdGEiLCJzdGF0dXMiLCJjb2RlIiwiYXMiLCJoYW5kbGVyIiwiX2NyZWF0ZVJwYyIsIm93bktleXMiLCJlbnVtZXJhYmxlT25seSIsImtleXMiLCJnZXRPd25Qcm9wZXJ0eVN5bWJvbHMiLCJzeW1ib2xzIiwiZmlsdGVyIiwic3ltIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwicHVzaCIsImFwcGx5IiwiX29iamVjdFNwcmVhZCIsImFyZ3VtZW50cyIsImZvckVhY2giLCJfZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzIiwiZGVmaW5lUHJvcGVydGllcyIsIm9iaiIsImZpeENvbmZpZ05hbWUiLCJmaXhDb25maWciLCJuZWVkVG9GaXhLZXlzIiwibG9nbyIsImxvY2F0aW9uRmllbGQiLCJjb3JyZWN0S2V5TmFtZSIsIk9taXNlQ2FyZCIsIl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fbWVzc2FnZV9fIiwiX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX2hlbHBlcnNfdXRpbHNfXyIsImRlZmF1bHRJZnJhbWVBcHBDb25maWciLCJhbW91bnQiLCJjdXJyZW5jeSIsImltYWdlIiwiZnJhbWVMYWJlbCIsImRlZmF1bHRQYXltZW50TWV0aG9kIiwib3RoZXJQYXltZW50TWV0aG9kcyIsImZyYW1lRGVzY3JpcHRpb24iLCJzdWJtaXRMYWJlbCIsImJ1dHRvbkxhYmVsIiwibG9jYXRpb24iLCJzdWJtaXRBdXRvIiwic3VibWl0Rm9ybVRhcmdldCIsImNhcmRCcmFuZHMiLCJsb2NhbGUiLCJhdXRvQ2FyZE51bWJlckZvcm1hdCIsImV4cGlyeURhdGVTdHlsZSIsImhpZGVBbW91bnQiLCJpZnJhbWVEZWZhdWx0U3R5bGUiLCJub29wIiwic2V0dGluZ3MiLCJpbml0V2hlblN0YXJ0Iiwic2V0dXAiLCJpbml0IiwiYXBwIiwiaWZyYW1lIiwiaWZyYW1lTG9hZGVkIiwib21pc2VTY3JpcHRUYWciLCJvbWlzZUdlbmVyYXRlQ2hlY2tvdXRCdXR0b24iLCJpZnJhbWVBcHBJZCIsImRlZmF1bHRDb25maWciLCJjb25maWdGb3JJZnJhbWVPbkxvYWQiLCJjdXJyZW50T3BlbkNvbmZpZyIsImZvcm1FbGVtZW50IiwiYWxsQ29uZmlndXJlQnV0dG9ucyIsImZvdW5kSWZyYW1lIiwic2NyaXB0cyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJzY3JpcHRzTGVuIiwic2NyaXB0IiwiaGFzQXR0cmlidXRlIiwiaXNJbnNpZGVJZnJhbWVBcHAiLCJjcmVhdGVJZnJhbWUiLCJjcmVhdGVPbWlzZUNoZWNrb3V0QnV0dG9uIiwibGlzdGVuTWVzc2FnZSIsInRva2VuIiwibWVyZ2VkQ29uZmlnIiwib25DcmVhdGVUb2tlblN1Y2Nlc3MiLCJpc09taXNlU291cmNlIiwib21pc2VTb3VyY2UiLCJvbWlzZVRva2VuIiwic3VibWl0Iiwic3RyaW5nIiwiY3VycmVudE5vZGUiLCJ0YWdOYW1lIiwicGFyZW50Tm9kZSIsImNyZWF0ZUVsZW1lbnQiLCJpZCIsInNyYyIsInNldEF0dHJpYnV0ZSIsImpvaW4iLCJhcHBlbmRDaGlsZCIsIm9ubG9hZCIsInN0eWxlIiwiZGlzcGxheSIsIm1lc3NhZ2VTaG93SWZyYW1lQXBwRm9ybSIsImNvbnRlbnRXaW5kb3ciLCJpbnB1dE9taXNlVG9rZW4iLCJxdWVyeVNlbGVjdG9yIiwiaW5wdXRPbWlzZVNvdXJjZSIsInByZXBhcmVDb25maWciLCJjaGVja291dEJ1dHRvbiIsImNsYXNzTmFtZSIsImlubmVySFRNTCIsImdldEZvcm1CeVRhcmdldCIsImNyZWF0ZUhpZGRlbklucHV0Rm9yT21pc2VUb2tlbiIsImNvbnNvbGUiLCJ3YXJuIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJjb25maWdGcm9tU2NyaXB0VGFnIiwib3BlbiIsImluc2VydEJlZm9yZSIsIm5leHRTaWJsaW5nIiwiZ2V0RWxlbWVudEJ5SWQiLCJuZXdDb25maWciLCJzdHJpbmdUb0FycmF5Iiwic3BsaXQiLCJtYXAiLCJ0cmltIiwib3BlbklmcmFtZVdpdGhOZXdDb25maWciLCJiYWNrZ3JvdW5kQ29sb3IiLCJvYnNlcnZlQ291bnQiLCJvYnNlcnZlVGltZXIiLCJzZXRJbnRlcnZhbCIsImNsZWFySW50ZXJ2YWwiLCJvbkZvcm1DbG9zZWQiLCJyZW1vdmVDaGlsZCIsImNsb3NlSWZyYW1lIiwibWVzc2FnZUNsb3NlSWZyYW1lIiwiY2xvc2VBbmRTZW5kVG9rZW4iLCJtZXNzYWdlQ2xvc2VBbmRTZW5kVG9rZW4iLCJidXR0b25JZCIsImNvbmZpZ0ZvckJ1dHRvbiIsIm5ld0J1dHRvbkNvbmZpZyIsImNvbmZpZ3VyYXRpb24iLCJhdHRhY2hlZEJ1dHRvbnMiLCJpdGVtIiwiYnV0dG9uIiwiZGVmYXVsdEJ1dHRvblRleHQiLCJidXR0b25UZXh0IiwidmFyQXJncyIsInRvIiwiaW5kZXgiLCJuZXh0U291cmNlIiwibmV4dEtleSIsIl90eXBlb2YiLCJTeW1ib2wiLCJpdGVyYXRvciIsImNvbnN0cnVjdG9yIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiaXNIb3N0TWV0aG9kIiwidCIsImlzSG9zdE9iamVjdCIsImlzQXJyYXkiLCJ0b1N0cmluZyIsImhhc0ZsYXNoIiwibWltZVR5cGUiLCJ1bmRlZiIsIm5hdmlnYXRvciIsInBsdWdpbnMiLCJkZXNjcmlwdGlvbiIsIm1pbWVUeXBlcyIsImVuYWJsZWRQbHVnaW4iLCJmbGFzaFZlcnNpb24iLCJtYXRjaCIsImZsYXNoIiwiQWN0aXZlWE9iamVjdCIsIkFycmF5Iiwic2xpY2UiLCJHZXRWYXJpYWJsZSIsIm5vdFN1cHBvcnRlZEV4Y2VwdGlvbiIsIm1ham9yIiwicGFyc2VJbnQiLCJtaW5vciIsIkhBU19GTEFTSF9USFJPVFRMRURfQlVHIiwiZG9tX29uUmVhZHkiLCJkb21Jc1JlYWR5IiwiZG9tUmVhZHlRdWV1ZSIsIndoZW5SZWFkeSIsImZuIiwic2NvcGUiLCJnZXRQYXJlbnRPYmplY3QiLCJwYXJlbnQiLCJuYW1lc3BhY2UiLCJpaSIsIm5vQ29uZmxpY3QiLCJucyIsIl9lYXN5WERNIiwiSUZSQU1FX1BSRUZJWCIsImdldERvbWFpbk5hbWUiLCJyZVVSSSIsImdldFBvcnQiLCJnZXRMb2NhdGlvbiIsInRvTG93ZXJDYXNlIiwicHJvdG8iLCJkb21haW4iLCJwb3J0IiwicmVzb2x2ZVVybCIsInJlRG91YmxlU2xhc2giLCJwYXRoIiwic3Vic3RyaW5nIiwicGF0aG5hbWUiLCJsYXN0SW5kZXhPZiIsInByb3RvY29sIiwiaG9zdCIsInJlUGFyZW50IiwiYXBwZW5kUXVlcnlQYXJhbWV0ZXJzIiwicGFyYW1ldGVycyIsImhhc2giLCJpbmRleE9mIiwicSIsInVzZUhhc2giLCJ2IiwiZGVzdGluYXRpb24iLCJub092ZXJ3cml0ZSIsIm1lbWJlciIsInByb3AiLCJ0ZXN0Rm9yTmFtZVByb3BlcnR5QnVnIiwiZm9ybSIsImlucHV0IiwiY2hhbm5lbElkIiwiSEFTX05BTUVfUFJPUEVSVFlfQlVHIiwiZWxlbWVudHMiLCJjcmVhdGVGcmFtZSIsImZyYW1lIiwiY29udGFpbmVyIiwicG9zaXRpb24iLCJ0b3AiLCJsZWZ0IiwiYm9yZGVyIiwiZnJhbWVCb3JkZXIiLCJhbGxvd1RyYW5zcGFyZW5jeSIsIm9uTG9hZCIsIm9uIiwidXNlUG9zdCIsImFjdGlvbiIsImNoZWNrQWNsIiwiYWNsIiwicmUiLCJSZWdFeHAiLCJzdWJzdHIiLCJwcmVwYXJlVHJhbnNwb3J0U3RhY2siLCJzdGFja0VscyIsImlzSG9zdCIsInF1ZXJ5IiwieGRtX3AiLCJjaGFubmVsIiwic2VjcmV0IiwiTWF0aCIsInJhbmRvbSIsImhyZWYiLCJzd2YiLCJwcm9kdWN0IiwidXNlckFnZW50IiwicmVtb3RlSGVscGVyIiwieGRtX2MiLCJ4ZG1fcyIsInhkbV9lIiwiaW50ZXJ2YWwiLCJkZWxheSIsInVzZVJlc2l6ZSIsInVzZVBhcmVudCIsInVzZVBvbGxpbmciLCJsb2NhbCIsImltYWdlcyIsInNlYXJjaCIsInhkbV9wYSIsInhkbV9wbyIsInN0YWNrIiwiSGFzaFRyYW5zcG9ydCIsIlJlbGlhYmxlQmVoYXZpb3IiLCJRdWV1ZUJlaGF2aW9yIiwiZW5jb2RlIiwibWF4TGVuZ3RoIiwiVmVyaWZ5QmVoYXZpb3IiLCJpbml0aWF0ZSIsIlBvc3RNZXNzYWdlVHJhbnNwb3J0IiwiTmFtZVRyYW5zcG9ydCIsIk5peFRyYW5zcG9ydCIsIlNhbWVPcmlnaW5UcmFuc3BvcnQiLCJGcmFtZUVsZW1lbnRUcmFuc3BvcnQiLCJGbGFzaFRyYW5zcG9ydCIsImxhenkiLCJyZW1vdmUiLCJjaGFpblN0YWNrIiwic3RhY2tFbGVtZW50cyIsInN0YWNrRWwiLCJkZWZhdWx0cyIsImluY29taW5nIiwib3JpZ2luIiwidXAiLCJvdXRnb2luZyIsInJlY2lwaWVudCIsImRvd24iLCJzdWNjZXNzIiwibGVuIiwicmVtb3ZlRnJvbVN0YWNrIiwidW4iLCJnbG9iYWwiLCJmbG9vciIsImVtcHR5Rm4iLCJsaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzRXZlbnQiLCJmcE5vdGlmeSIsImF0dGFjaEV2ZW50IiwiZGV0YWNoRXZlbnQiLCJyZWFkeVN0YXRlIiwiZG9jdW1lbnRFbGVtZW50IiwiZG9TY3JvbGwiLCJkb1Njcm9sbENoZWNrIiwicGFpciIsImdldEpTT04iLCJjYWNoZWQiLCJhIiwidG9KU09OIiwiU3RyaW5nIiwiZXZhbEpTT04iLCJ2ZXJzaW9uIiwiZ2V0SlNPTk9iamVjdCIsIkRvbUhlbHBlciIsInJlcXVpcmVzSlNPTiIsIndyaXRlIiwiX21hcCIsIkZuIiwic2V0IiwiZGVsIiwiU29ja2V0IiwiY29uY2F0Iiwib25NZXNzYWdlIiwicG9zdE1lc3NhZ2UiLCJqc29uUnBjQ29uZmlnIiwiUnBjQmVoYXZpb3IiLCJwdWIiLCJzZW5kIiwidGFyZ2V0T3JpZ2luIiwib25ET01SZWFkeSIsInNlbmRGbiIsIm1zZyIsImFkZFN3ZiIsInN3ZkNvbnRhaW5lciIsImZpcnN0Q2hpbGQiLCJxdWV1ZSIsInN3Zk5vVGhyb3R0bGUiLCJoZWlnaHQiLCJ3aWR0aCIsInJpZ2h0Iiwib3ZlcmZsb3ciLCJmbGFzaFZhcnMiLCJkZXN0cm95Q2hhbm5lbCIsInN3ZmRvbWFpbiIsImNyZWF0ZUNoYW5uZWwiLCJfZ2V0T3JpZ2luIiwidXJpIiwiX3dpbmRvd19vbk1lc3NhZ2UiLCJjYWxsZXJXaW5kb3ciLCJ3YWl0Rm9yUmVhZHkiLCJyZWZlcnJlciIsImZyYW1lRWxlbWVudCIsIl9zZW5kTWVzc2FnZSIsInNlbmRNZXNzYWdlIiwiX29uUmVhZHkiLCJyZWFkeUNvdW50IiwiX29uTWVzc2FnZSIsInJlbW90ZU9yaWdpbiIsIl9vbkxvYWQiLCJyZW1vdGVXaW5kb3ciLCJyZW1vdGVVcmwiLCJ3IiwiX2NhbGxlcldpbmRvdyIsIl9tc2dOciIsIl9oYW5kbGVIYXNoIiwiX2xhc3RNc2ciLCJfcmVtb3RlT3JpZ2luIiwiX3BvbGxIYXNoIiwiX2xpc3RlbmVyV2luZG93IiwiX2F0dGFjaExpc3RlbmVycyIsIl90aW1lciIsInBvbGxJbnRlcnZhbCIsInRyaWVzIiwibWF4IiwiZ2V0UmVmIiwiZnJhbWVzIiwiZXgiLCJEYXRlIiwiaWRPdXQiLCJpZEluIiwiY3VycmVudE1lc3NhZ2UiLCJhY2siLCJkaXNwYXRjaCIsIndhaXRpbmciLCJkZXN0cm95aW5nIiwic2hpZnQiLCJkb0ZyYWdtZW50Iiwic2VxIiwiZnJhZ21lbnQiLCJmcmFnbWVudHMiLCJzdGFydFZlcmlmaWNhdGlvbiIsIm15U2VjcmV0IiwidGhlaXJTZWNyZXQiLCJwcm94eSIsIl9zZW5kIiwianNvbnJwYyIsInNlcmlhbGl6ZXIiLCJfY3JlYXRlTWV0aG9kIiwiZGVmaW5pdGlvbiIsInBhcmFtcyIsIl9jYWxsYmFja3MiLCJfY2FsbGJhY2tDb3VudGVyIiwibmFtZWRQYXJhbXMiLCJfZXhlY3V0ZU1ldGhvZCIsImV4MSIsImhhbmRsZSIsIk9taXNlQ2FyZEluc3RhbmNlIiwicmVjZWl2ZU1lc3NhZ2UiLCJtZXNzYWdlRGF0YSIsIm1lc3NhZ2VUeXBlSGFuZGxlciIsIm1lc3NhZ2VUeXBlIiwiU0hPV19JRlJBTUVfQVBQX0ZPUk0iLCJDTE9TRV9JRlJBTUUiLCJDTE9TRV9BTkRfU0VORF9UT0tFTiIsImNsb3NlIiwic2V0VG9rZW5BdE9taXNlVG9rZW5GaWVsZCIsImlzX2lyaSIsInNwbGl0dGVkIiwic2NoZW1lIiwiYXV0aG9yaXR5Iiwib3V0Iiwic3BsaXRVcmkiLCJpc19odHRwX2lyaSIsImFsbG93SHR0cHMiLCJpc19odHRwc19pcmkiLCJpc193ZWJfaXJpIiwiaXNfdXJpIiwiaXNfaHR0cF91cmkiLCJpc19odHRwc191cmkiLCJpc193ZWJfdXJpIiwiaXNIdHRwVXJpIiwiaXNIdHRwc1VyaSIsImlzV2ViVXJpIiwid2VicGFja1BvbHlmaWxsIiwiZGVwcmVjYXRlIiwicGF0aHMiLCJjaGlsZHJlbiIsInNlbGYiLCJub3JtYWxpemVOYW1lIiwibm9ybWFsaXplVmFsdWUiLCJpdGVyYXRvckZvciIsIml0ZW1zIiwibmV4dCIsImRvbmUiLCJ1bmRlZmluZWQiLCJzdXBwb3J0IiwiaXRlcmFibGUiLCJIZWFkZXJzIiwiYXBwZW5kIiwiaGVhZGVyIiwiZ2V0T3duUHJvcGVydHlOYW1lcyIsImNvbnN1bWVkIiwiYm9keVVzZWQiLCJQcm9taXNlIiwicmVqZWN0IiwiZmlsZVJlYWRlclJlYWR5IiwicmVhZGVyIiwicmVzb2x2ZSIsIm9uZXJyb3IiLCJyZWFkQmxvYkFzQXJyYXlCdWZmZXIiLCJibG9iIiwiRmlsZVJlYWRlciIsInByb21pc2UiLCJyZWFkQXNBcnJheUJ1ZmZlciIsInJlYWRCbG9iQXNUZXh0IiwicmVhZEFzVGV4dCIsInJlYWRBcnJheUJ1ZmZlckFzVGV4dCIsImJ1ZiIsInZpZXciLCJVaW50OEFycmF5IiwiY2hhcnMiLCJmcm9tQ2hhckNvZGUiLCJidWZmZXJDbG9uZSIsImJ5dGVMZW5ndGgiLCJidWZmZXIiLCJCb2R5IiwiX2luaXRCb2R5IiwiX2JvZHlJbml0IiwiX2JvZHlUZXh0IiwiQmxvYiIsImlzUHJvdG90eXBlT2YiLCJfYm9keUJsb2IiLCJmb3JtRGF0YSIsIkZvcm1EYXRhIiwiX2JvZHlGb3JtRGF0YSIsInNlYXJjaFBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsImFycmF5QnVmZmVyIiwiaXNEYXRhVmlldyIsIl9ib2R5QXJyYXlCdWZmZXIiLCJBcnJheUJ1ZmZlciIsImlzQXJyYXlCdWZmZXJWaWV3IiwicmVqZWN0ZWQiLCJ0ZXh0IiwiZGVjb2RlIiwibm9ybWFsaXplTWV0aG9kIiwidXBjYXNlZCIsIm1ldGhvZHMiLCJSZXF1ZXN0IiwiY3JlZGVudGlhbHMiLCJtb2RlIiwiYnl0ZXMiLCJwYXJzZUhlYWRlcnMiLCJyYXdIZWFkZXJzIiwibGluZSIsInBhcnRzIiwiUmVzcG9uc2UiLCJib2R5SW5pdCIsIm9rIiwic3RhdHVzVGV4dCIsInZpZXdDbGFzc2VzIiwiRGF0YVZpZXciLCJpc1ZpZXciLCJvbGRWYWx1ZSIsImhhcyIsInRoaXNBcmciLCJ2YWx1ZXMiLCJlbnRyaWVzIiwiY2xvbmUiLCJyZWRpcmVjdFN0YXR1c2VzIiwicmVkaXJlY3QiLCJSYW5nZUVycm9yIiwicmVxdWVzdCIsInhociIsIlhNTEh0dHBSZXF1ZXN0IiwiZ2V0QWxsUmVzcG9uc2VIZWFkZXJzIiwicmVzcG9uc2VVUkwiLCJyZXNwb25zZVRleHQiLCJvbnRpbWVvdXQiLCJ3aXRoQ3JlZGVudGlhbHMiLCJyZXNwb25zZVR5cGUiLCJzZXRSZXF1ZXN0SGVhZGVyIiwicG9seWZpbGwiXSwibWFwcGluZ3MiOiI7Ozs7OztDQU1TLFNBQVVBLEdDRmpCLFFBQVNDLEdBQW9CQyxHQUc1QixHQUFHQyxFQUFpQkQsR0FDbkIsTUFBT0MsR0FBaUJELEdBQVVFLE9BR25DLElBQUlDLEdBQVNGLEVBQWlCRCxJQUM3QkksRUFBR0osRUFDSEssR0FBRyxFQUNISCxXQVVELE9BTkFKLEdBQVFFLEdBQVVNLEtBQUtILEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNILEdBRy9ESSxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBdkJmLEdBQUlELEtBNEJKRixHQUFvQlEsRUFBSVQsRUFHeEJDLEVBQW9CUyxFQUFJUCxFQUd4QkYsRUFBb0JLLEVBQUksU0FBU0ssR0FBUyxNQUFPQSxJQUdqRFYsRUFBb0JXLEVBQUksU0FBU1IsRUFBU1MsRUFBTUMsR0FDM0NiLEVBQW9CYyxFQUFFWCxFQUFTUyxJQUNsQ0cs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YzZoQixHQUFNQSxFQUFJMWhCLFNBQVcwaEIsRUFBSUksWUFDbER0RSxHQUFRLEdBQUlpRCxHQUFTNWdCLEVBQU1SLEtBRzdCcWlCLEVBQUlqRSxRQUFVLFdBQ1pKLEVBQU8sR0FBSWhnQixXQUFVLDRCQUd2QnFrQixFQUFJSyxVQUFZLFdBQ2QxRSxFQUFPLEdBQUloZ0IsV0FBVSw0QkFHdkJxa0IsRUFBSXJhLEtBQUtvYSxFQUFRL2hCLE9BQVEraEIsRUFBUWppQixLQUFLLEdBRVYsWUFBeEJpaUIsRUFBUXZCLFlBQ1Z3QixFQUFJTSxpQkFBa0IsRUFDVyxTQUF4QlAsRUFBUXZCLGNBQ2pCd0IsRUFBSU0saUJBQWtCLEdBR3BCLGdCQUFrQk4sSUFBTzlFLEVBQVFlLE9BQ25DK0QsRUFBSU8sYUFBZSxRQUdyQlIsRUFBUTloQixRQUFReUIsUUFBUSxTQUFTdEgsRUFBT0UsR0FDdEMwbkIsRUFBSVEsaUJBQWlCbG9CLEVBQU1GLEtBRzdCNG5CLEVBQUlwTSxTQUFrQyxLQUF0Qm1NLEVBQVE3QyxVQUE0QixLQUFPNkMsRUFBUTdDLGNBR3ZFeEMsRUFBSzNjLE1BQU0waUIsVUFBVyxJQUNMLG1CQUFUL0YsTUFBdUJBLEtBQU8xZ0IiLCJmaWxlIjoib21pc2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAgICogT21pc2VKcyB2Mi41LjFcbiAgICogQ29weXJpZ2h0OiBPbWlzZVxuICAgKlxuICAgKiBEYXRlOiAyMDE5LzExLzA2IDEwOjAyXG4gICAqL1xuLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRpOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGw6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge31cbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGlkZW50aXR5IGZ1bmN0aW9uIGZvciBjYWxsaW5nIGhhcm1vbnkgaW1wb3J0cyB3aXRoIHRoZSBjb3JyZWN0IGNvbnRleHRcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5pID0gZnVuY3Rpb24odmFsdWUpIHsgcmV0dXJuIHZhbHVlOyB9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuLyoqKioqKi8gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbi8qKioqKiovIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4vKioqKioqLyBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4vKioqKioqLyBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4vKioqKioqLyBcdFx0XHRcdGdldDogZ2V0dGVyXG4vKioqKioqLyBcdFx0XHR9KTtcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbi8qKioqKiovIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuLyoqKioqKi8gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbi8qKioqKiovIFx0XHRyZXR1cm4gZ2V0dGVyO1xuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiL1wiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDcpO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG52YXIgZW52ID0gXCJwcm9kdWN0aW9uXCIgfHwgJ2RldmVsb3BtZW50JztcbnZhciBjb25maWcgPSB7XG4gIHRlc3Q6IHtcbiAgICB2YXVsdFVybDogXCJodHRwOi8vdmF1bHQubHZoLm1lOjQ1MDBcIixcbiAgICBjYXJkSG9zdDogXCJodHRwOi8vbG9jYWxob3N0OjUwMDJcIixcbiAgICBpbnRlcmZhY2VVcmw6IFwiaHR0cDovL2FwaS5sdmgubWU6MzAwMFwiXG4gIH0sXG4gIGRldmVsb3BtZW50OiB7XG4gICAgdmF1bHRVcmw6IFwiaHR0cHM6Ly92YXVsdC1zdGFnaW5nLm9taXNlLmNvXCIsXG4gICAgY2FyZEhvc3Q6IFwiaHR0cDovL2xvY2FsaG9zdDo1MDAyXCIsXG4gICAgaW50ZXJmYWNlVXJsOiBcImh0dHBzOi8vYXBpLXN0YWdpbmcub21pc2UuY29cIlxuICB9LFxuICBzdGFnaW5nOiB7XG4gICAgdmF1bHRVcmw6IFwiaHR0cHM6Ly92YXVsdC1zdGFnaW5nLm9taXNlLmNvXCIsXG4gICAgY2FyZEhvc3Q6IFwiaHR0cHM6Ly9jZG4uZGV2LW9taXNlLmNvXCIsXG4gICAgaW50ZXJmYWNlVXJsOiBcImh0dHBzOi8vYXBpLXN0YWdpbmcub21pc2UuY29cIlxuICB9LFxuICBwcm9kdWN0aW9uOiB7XG4gICAgdmF1bHRVcmw6IFwiaHR0cHM6Ly92YXVsdC5vbWlzZS5jb1wiLFxuICAgIGNhcmRIb3N0OiBcImh0dHBzOi8vY2RuLm9taXNlLmNvXCIsXG4gICAgaW50ZXJmYWNlVXJsOiBcImh0dHBzOi8vYXBpLm9taXNlLmNvXCJcbiAgfVxufTtcbm1vZHVsZS5leHBvcnRzID0gY29uZmlnW2Vudl07XG5cbi8qKiovIH0pLFxuLyogMSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG52YXIgZztcclxuXHJcbi8vIFRoaXMgd29ya3MgaW4gbm9uLXN0cmljdCBtb2RlXHJcbmcgPSAoZnVuY3Rpb24oKSB7XHJcblx0cmV0dXJuIHRoaXM7XHJcbn0pKCk7XHJcblxyXG50cnkge1xyXG5cdC8vIFRoaXMgd29ya3MgaWYgZXZhbCBpcyBhbGxvd2VkIChzZWUgQ1NQKVxyXG5cdGcgPSBnIHx8IEZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKSB8fCAoMSxldmFsKShcInRoaXNcIik7XHJcbn0gY2F0Y2goZSkge1xyXG5cdC8vIFRoaXMgd29ya3MgaWYgdGhlIHdpbmRvdyByZWZlcmVuY2UgaXMgYXZhaWxhYmxlXHJcblx0aWYodHlwZW9mIHdpbmRvdyA9PT0gXCJvYmplY3RcIilcclxuXHRcdGcgPSB3aW5kb3c7XHJcbn1cclxuXHJcbi8vIGcgY2FuIHN0aWxsIGJlIHVuZGVmaW5lZCwgYnV0IG5vdGhpbmcgdG8gZG8gYWJvdXQgaXQuLi5cclxuLy8gV2UgcmV0dXJuIHVuZGVmaW5lZCwgaW5zdGVhZCBvZiBub3RoaW5nIGhlcmUsIHNvIGl0J3NcclxuLy8gZWFzaWVyIHRvIGhhbmRsZSB0aGlzIGNhc2UuIGlmKCFnbG9iYWwpIHsgLi4ufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBnO1xyXG5cblxuLyoqKi8gfSksXG4vKiAyICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBfX3dlYnBhY2tfZXhwb3J0c19fLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuLyogaGFybW9ueSBleHBvcnQgKGltbXV0YWJsZSkgKi8gX193ZWJwYWNrX2V4cG9ydHNfX1tcImJcIl0gPSBtZXJnZTtcbi8qIHVudXNlZCBoYXJtb255IGV4cG9ydCBjbG9uZSAqL1xuLyogaGFybW9ueSBleHBvcnQgKGltbXV0YWJsZSkgKi8gX193ZWJwYWNrX2V4cG9ydHNfX1tcImNcIl0gPSBzYWZlSnNvblBhcnNlO1xuLyogdW51c2VkIGhhcm1vbnkgZXhwb3J0IGlzRW1wdHkgKi9cbi8qIHVudXNlZCBoYXJtb255IGV4cG9ydCBjYW1lbENhc2VUb0Rhc2ggKi9cbi8qIHVudXNlZCBoYXJtb255IGV4cG9ydCBkYXNoVG9DYW1lbENhc2UgKi9cbi8qIGhhcm1vbnkgZXhwb3J0IChpbW11dGFibGUpICovIF9fd2VicGFja19leHBvcnRzX19bXCJhXCJdID0gZXh0cmFjdERhdGFGcm9tRWxlbWVudDtcbi8qKlxuICogLT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT1cbiAqIEhlbHBlcnMgLSB1dGlsc1xuICogLT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT1cbiAqL1xuZnVuY3Rpb24gbWVyZ2UoZGVzdCwgc291cmNlKSB7XG4gIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBkZXN0LCBzb3VyY2UpO1xufVxuZnVuY3Rpb24gY2xvbmUoc291cmNlKSB7XG4gIHJldHVybiBzYWZlSnNvblBhcnNlKEpTT04uc3RyaW5naWZ5KHNvdXJjZSkpO1xufVxuZnVuY3Rpb24gc2FmZUpzb25QYXJzZShzdHIpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gSlNPTi5wYXJzZShzdHIpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIHN0cjtcbiAgfVxufVxuZnVuY3Rpb24gaXNFbXB0eSh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgPT0gbnVsbCB8fCB2YWx1ZSA9PT0gJycgPyB0cnVlIDogZmFsc2U7XG59XG4vKipcbiAqIEhlbHBlciBmb3IgdHJhbnNmcm9tIHN0cmluZyBgY2FtZWxDYXNlYCB0byBgZGFzaGAuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHN0ciAtIHN0cmluZyBmb3IgdHJhbnNmb3JtLlxuICogQHJldHVybiB7c3RyaW5nfSBzdHJpbmcgYWZ0ZXIgdHJhbnNmb3JtLlxuICovXG5cbmZ1bmN0aW9uIGNhbWVsQ2FzZVRvRGFzaChzdHIpIHtcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKC8oW2Etel0pKFtBLVpdKS9nLCAnJDEtJDInKTtcbn0gLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy82NjYwOTc3L2NvbnZlcnQtaHlwaGVucy10by1jYW1lbC1jYXNlLWNhbWVsY2FzZVxuXG5mdW5jdGlvbiBkYXNoVG9DYW1lbENhc2Uoc3RyKSB7XG4gIHJldHVybiBzdHIucmVwbGFjZSgvLShbYS16XSkvZywgZnVuY3Rpb24gKGcpIHtcbiAgICByZXR1cm4gZ1sxXS50b1VwcGVyQ2FzZSgpO1xuICB9KTtcbn1cbi8qKlxuICogSGVscGVyIGZ1bmN0aW9uIHRvIGV4dHJhY2sgYWxsIGRhdGEgZnJvbSBlbGVtZW50LlxuICpcbiAqIEBwYXJhbSB7ZWxlbWVudH0gZWxlbWVudCAtIGVsZW1lbnQgZm9yIGV4dHJhY3QgZGF0YS5cbiAqIEByZXR1cm4ge29iamVjdH0gYWxsIGRhdGEgYW5kIHZhbHVlLlxuICovXG5cbmZ1bmN0aW9uIGV4dHJhY3REYXRhRnJvbUVsZW1lbnQoZWxlbWVudCkge1xuICB2YXIgZXh0cmFjdERhdGEgPSB7fTtcbiAgdmFyIHRvdGFsQXR0cnMgPSBlbGVtZW50LmF0dHJpYnV0ZXMubGVuZ3RoO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgdG90YWxBdHRyczsgaSsrKSB7XG4gICAgdmFyIGF0dHIgPSBlbGVtZW50LmF0dHJpYnV0ZXNbaV07IC8vIEV4dGVhY3QgYWxsIG9ubHkgZGF0YSBmcm9tIGVsZW1lbnRcblxuICAgIGlmICgvXmRhdGEvLnRlc3QoYXR0ci5uYW1lKSkge1xuICAgICAgdmFyIG5hbWUgPSBkYXNoVG9DYW1lbENhc2UoYXR0ci5uYW1lLnJlcGxhY2UoJ2RhdGEtJywgJycpKTtcbiAgICAgIGV4dHJhY3REYXRhW25hbWVdID0gYXR0ci52YWx1ZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZXh0cmFjdERhdGE7XG59XG5cbi8qKiovIH0pLFxuLyogMyAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgX193ZWJwYWNrX2V4cG9ydHNfXywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcbi8qIGhhcm1vbnkgZXhwb3J0IChiaW5kaW5nKSAqLyBfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJhXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gT21pc2U7IH0pO1xuLyogdW51c2VkIGhhcm1vbnkgZXhwb3J0IHZlcmlmeUNvbmZpZ1N0cnVjdHVyZSAqL1xuLyogaGFybW9ueSBpbXBvcnQgKi8gdmFyIF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF92YWxpZF91cmxfXyA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7XG4vKiBoYXJtb255IGltcG9ydCAqLyB2YXIgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX3ZhbGlkX3VybF9fX2RlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLm4oX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX3ZhbGlkX3VybF9fKTtcbi8qIGhhcm1vbnkgaW1wb3J0ICovIHZhciBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfd2hhdHdnX2ZldGNoX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKTtcbi8qIGhhcm1vbnkgaW1wb3J0ICovIHZhciBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfd2hhdHdnX2ZldGNoX19fZGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18ubihfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfd2hhdHdnX2ZldGNoX18pO1xuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfVxuXG5mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfVxuXG4vKipcbiAqIC09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09XG4gKiBPbWlzZS5qcyBDb3JlXG4gKiAtPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPVxuICovXG5cblxuXG52YXIgT21pc2UgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBPbWlzZShjb25maWcpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgT21pc2UpO1xuXG4gICAgdmFyIHJlc3VsdCA9IHZlcmlmeUNvbmZpZ1N0cnVjdHVyZShjb25maWcpO1xuXG4gICAgaWYgKHJlc3VsdC5lcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKHJlc3VsdC5tZXNzYWdlKTtcbiAgICB9XG5cbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgICB0aGlzLnB1YmxpY0tleSA9IG51bGw7XG4gICAgdGhpcy5fcnBjID0gbnVsbDtcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhPbWlzZSwgW3tcbiAgICBrZXk6IFwiX2NyZWF0ZVJwY1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfY3JlYXRlUnBjKGNhbGxiYWNrKSB7XG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICBpZiAodGhpcy5fcnBjKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ycGM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgdmF1bHRVcmwgPSB0aGlzLmNvbmZpZy52YXVsdFVybDtcbiAgICAgICAgdmFyIHRtID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgX3RoaXMuX3JwYy5kZXN0cm95KCk7XG5cbiAgICAgICAgICBfdGhpcy5fcnBjID0gbnVsbDtcblxuICAgICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIDMwMDAwKTtcbiAgICAgICAgdGhpcy5fcnBjID0gbmV3IGVhc3lYRE0uUnBjKHtcbiAgICAgICAgICByZW1vdGU6IFwiXCIuY29uY2F0KHZhdWx0VXJsLCBcIi9wcm92aWRlclwiKSxcbiAgICAgICAgICBvblJlYWR5OiBmdW5jdGlvbiBvblJlYWR5KCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRtKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICByZW1vdGU6IHtcbiAgICAgICAgICAgIGNyZWF0ZVRva2VuOiB7fVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9ycGM7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInNldFB1YmxpY0tleVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRQdWJsaWNLZXkocHVibGljS2V5KSB7XG4gICAgICB0aGlzLnB1YmxpY0tleSA9IHB1YmxpY0tleTtcbiAgICAgIHJldHVybiB0aGlzLnB1YmxpY0tleTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY3JlYXRlU291cmNlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZVNvdXJjZSh0eXBlLCBvcHRpb25zLCBjYWxsYmFjaykge1xuICAgICAgdmFyIGF1dGggPSBidG9hKHRoaXMucHVibGljS2V5KTtcbiAgICAgIG9wdGlvbnMudHlwZSA9IHR5cGU7XG4gICAgICB2YXIgdXJsID0gXCJcIi5jb25jYXQodGhpcy5jb25maWcuaW50ZXJmYWNlVXJsLCBcIi9zb3VyY2VzL1wiKTtcbiAgICAgIGZldGNoKHVybCwge1xuICAgICAgICBtZXRob2Q6ICdwb3N0JyxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIEF1dGhvcml6YXRpb246IFwiQmFzaWMgXCIuY29uY2F0KGF1dGgpLFxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkob3B0aW9ucylcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgIHJldHVybiBjYWxsYmFjayhyZXNwb25zZS5zdGF0dXMsIGRhdGEpO1xuICAgICAgICB9KTtcbiAgICAgIH0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGNhbGxiYWNrKDAsIHtcbiAgICAgICAgICBjb2RlOiAnY3JlYXRlX3NvdXJjZV9lcnJvcicsXG4gICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2VcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY3JlYXRlVG9rZW5cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlVG9rZW4oYXMsIGF0dHJpYnV0ZXMsIGhhbmRsZXIpIHtcbiAgICAgIHZhciBkYXRhID0ge307XG4gICAgICBkYXRhW2FzXSA9IGF0dHJpYnV0ZXM7XG5cbiAgICAgIHRoaXMuX2NyZWF0ZVJwYyhmdW5jdGlvbiAoKSB7XG4gICAgICAgIGhhbmRsZXIoMCwge1xuICAgICAgICAgIGNvZGU6ICdycGNfZXJyb3InLFxuICAgICAgICAgIG1lc3NhZ2U6ICd1bmFibGUgdG8gY29ubmVjdCB0byBwcm92aWRlciBhZnRlciB0aW1lb3V0J1xuICAgICAgICB9KTtcbiAgICAgIH0pLmNyZWF0ZVRva2VuKHRoaXMucHVibGljS2V5LCBkYXRhLCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaGFuZGxlcihyZXNwb25zZS5zdGF0dXMsIHJlc3BvbnNlLmRhdGEpO1xuICAgICAgfSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaGFuZGxlcihlLmRhdGEuc3RhdHVzLCBlLmRhdGEuZGF0YSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gT21pc2U7XG59KCk7XG4vKipcbiAqIEhlbHBlciB0byB2ZXJpZnkgY29uZmlnIHN0cnVjdHVyZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgLSBjb25maWcgZm9yIG9taXNlLmpzLlxuICovXG5cblxuXG5mdW5jdGlvbiB2ZXJpZnlDb25maWdTdHJ1Y3R1cmUoY29uZmlnKSB7XG4gIHZhciByZXN1bHQgPSB7XG4gICAgZXJyb3I6IGZhbHNlLFxuICAgIG1lc3NhZ2U6ICcnXG4gIH07XG5cbiAgaWYgKCFjb25maWcudmF1bHRVcmwgfHwgIV9fd2VicGFja19yZXF1aXJlX18uaShfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfdmFsaWRfdXJsX19bXCJpc1VyaVwiXSkoY29uZmlnLnZhdWx0VXJsKSkge1xuICAgIHJlc3VsdC5tZXNzYWdlID0gJ01pc3NpbmcgdmFsdXRVcmwnO1xuICB9IGVsc2UgaWYgKCFjb25maWcuY2FyZEhvc3QgfHwgIV9fd2VicGFja19yZXF1aXJlX18uaShfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfdmFsaWRfdXJsX19bXCJpc1VyaVwiXSkoY29uZmlnLmNhcmRIb3N0KSkge1xuICAgIHJlc3VsdC5tZXNzYWdlID0gJ01pc3NpbmcgY2FyZEhvc3QnO1xuICB9IGVsc2UgaWYgKCFjb25maWcuaW50ZXJmYWNlVXJsIHx8ICFfX3dlYnBhY2tfcmVxdWlyZV9fLmkoX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX3ZhbGlkX3VybF9fW1wiaXNVcmlcIl0pKGNvbmZpZy5pbnRlcmZhY2VVcmwpKSB7XG4gICAgcmVzdWx0Lm1lc3NhZ2UgPSAnTWlzc2luZyBpbnRlcmZhY2VVcmwnO1xuICB9XG5cbiAgcmVzdWx0LmVycm9yID0gcmVzdWx0Lm1lc3NhZ2UgIT09ICcnO1xuICByZXR1cm4gcmVzdWx0O1xufVxuXG4vKioqLyB9KSxcbi8qIDQgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIF9fd2VicGFja19leHBvcnRzX18sIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG4vKiB1bnVzZWQgaGFybW9ueSBleHBvcnQgZGVmYXVsdElmcmFtZUFwcENvbmZpZyAqL1xuLyogdW51c2VkIGhhcm1vbnkgZXhwb3J0IGlmcmFtZURlZmF1bHRTdHlsZSAqL1xuLyogaGFybW9ueSBleHBvcnQgKGJpbmRpbmcpICovIF9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcImFcIiwgZnVuY3Rpb24oKSB7IHJldHVybiBPbWlzZUNhcmQ7IH0pO1xuLyogdW51c2VkIGhhcm1vbnkgZXhwb3J0IGZpeENvbmZpZ05hbWUgKi9cbi8qIGhhcm1vbnkgaW1wb3J0ICovIHZhciBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX21lc3NhZ2VfXyA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7XG4vKiBoYXJtb255IGltcG9ydCAqLyB2YXIgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX2hlbHBlcnNfdXRpbHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5mdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsgfSk7IGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfVxuXG5mdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pOyB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7IH0gZWxzZSB7IG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5cbi8qKlxuICogLT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT1cbiAqIE9taXNlQ2FyZFxuICogLT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT1cbiAqL1xuXG5cbnZhciBkZWZhdWx0SWZyYW1lQXBwQ29uZmlnID0ge1xuICBrZXk6ICcnLFxuICBhbW91bnQ6IDAsXG4gIGN1cnJlbmN5OiAnVEhCJyxcbiAgLy8gVEhCLFVTRCxKUFlcbiAgaW1hZ2U6ICdodHRwczovL2Nkbi5vbWlzZS5jby9hc3NldHMvZnJvbnRlbmQtaW1hZ2VzL3N0b3JlLWxvZ28uc3ZnJyxcbiAgZnJhbWVMYWJlbDogJ09taXNlJyxcbiAgZGVmYXVsdFBheW1lbnRNZXRob2Q6ICdjcmVkaXRfY2FyZCcsXG4gIG90aGVyUGF5bWVudE1ldGhvZHM6IFtdLFxuICBmcmFtZURlc2NyaXB0aW9uOiAnU2VjdXJlZCBieSBPbWlzZScsXG4gIHN1Ym1pdExhYmVsOiAnUGF5JyxcbiAgYnV0dG9uTGFiZWw6ICdQYXkgd2l0aCBPbWlzZScsXG4gIGxvY2F0aW9uOiAnbm8nLFxuICBzdWJtaXRBdXRvOiAneWVzJyxcbiAgc3VibWl0Rm9ybVRhcmdldDogJycsXG4gIGNhcmRCcmFuZHM6ICd2aXNhIG1hc3RlcmNhcmQnLFxuICBsb2NhbGU6ICdlbicsXG4gIC8vIGVuLHRoLGphXG4gIGF1dG9DYXJkTnVtYmVyRm9ybWF0OiAneWVzJyxcbiAgLy8geWVzLG5vXG4gIGV4cGlyeURhdGVTdHlsZTogJycsXG4gIC8vIGJhc2ljXG4gIGhpZGVBbW91bnQ6ICdmYWxzZScgLy8gZmFsc2UsIHRydWVcblxufTtcbnZhciBpZnJhbWVEZWZhdWx0U3R5bGUgPSBbJ2Rpc3BsYXk6IG5vbmUnLCAndmlzaWJpbGl0eTogdmlzaWJsZScsICdwb3NpdGlvbjogZml4ZWQnLCAnbGVmdDogMHB4JywgJ3RvcDogMHB4JywgJ3dpZHRoOiAxMDAlJywgJ2hlaWdodDogMTAwJScsICd6LWluZGV4OiAyMTQ3NDgzNjQ3JywgJ3BhZGRpbmc6IDAnLCAnbWFyZ2luOiAwJywgJ2JvcmRlcjogMCBub25lIHRyYW5zcGFyZW50JywgJ2JhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMCknLCAnb3ZlcmZsb3cteDogaGlkZGVuJywgJ292ZXJmbG93LXk6IGF1dG8nLCAnLXdlYmtpdC10YXAtaGlnaGxpZ2h0LWNvbG9yOiB0cmFuc3BhcmVudCcsICd0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIC4ycyddO1xuXG52YXIgbm9vcCA9IGZ1bmN0aW9uIG5vb3AoKSB7fTtcblxudmFyIE9taXNlQ2FyZCA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIE9taXNlQ2FyZChzZXR0aW5ncykge1xuICAgIHZhciBpbml0V2hlblN0YXJ0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB0cnVlO1xuXG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE9taXNlQ2FyZCk7XG5cbiAgICB0aGlzLnNldHVwKHNldHRpbmdzKTtcblxuICAgIGlmIChpbml0V2hlblN0YXJ0KSB7XG4gICAgICB0aGlzLmluaXQoKTtcbiAgICB9XG4gIH1cbiAgLyoqXG4gICAqIFNldHVwIE9taXNlLmpzXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBzZXR0aW5ncyAtIHNldHRpbmcgZm9yIE9taXNlLmpzXG4gICAqL1xuXG5cbiAgX2NyZWF0ZUNsYXNzKE9taXNlQ2FyZCwgW3tcbiAgICBrZXk6IFwic2V0dXBcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0dXAoc2V0dGluZ3MpIHtcbiAgICAgIHRoaXMuYXBwID0ge1xuICAgICAgICBzZXR0aW5nczogX29iamVjdFNwcmVhZCh7fSwgc2V0dGluZ3MpLFxuICAgICAgICBpZnJhbWU6IG51bGwsXG4gICAgICAgIGlmcmFtZUxvYWRlZDogZmFsc2UsXG4gICAgICAgIG9taXNlU2NyaXB0VGFnOiBudWxsLFxuICAgICAgICBvbWlzZUdlbmVyYXRlQ2hlY2tvdXRCdXR0b246IG51bGwsXG4gICAgICAgIGlmcmFtZUFwcElkOiAnb21pc2UtY2hlY2tvdXQtaWZyYW1lLWFwcCcsXG4gICAgICAgIGRlZmF1bHRDb25maWc6IF9vYmplY3RTcHJlYWQoe30sIGRlZmF1bHRJZnJhbWVBcHBDb25maWcpLFxuICAgICAgICBjb25maWdGb3JJZnJhbWVPbkxvYWQ6IF9vYmplY3RTcHJlYWQoe30sIGRlZmF1bHRJZnJhbWVBcHBDb25maWcpLFxuICAgICAgICBjdXJyZW50T3BlbkNvbmZpZzoge30sXG4gICAgICAgIGZvcm1FbGVtZW50OiBudWxsLFxuICAgICAgICBhbGxDb25maWd1cmVCdXR0b25zOiBbXVxuICAgICAgfTtcbiAgICAgIHJldHVybiB0aGlzLmFwcDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUnVuIG9uIHN0YXJ0IHVwXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJpbml0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICB2YXIgZm91bmRJZnJhbWUgPSB0aGlzLmFwcC5pZnJhbWUgIT0gbnVsbDtcbiAgICAgIHZhciBzY3JpcHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpO1xuICAgICAgdmFyIHNjcmlwdHNMZW4gPSBzY3JpcHRzLmxlbmd0aDtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzY3JpcHRzTGVuOyBpKyspIHtcbiAgICAgICAgdmFyIHNjcmlwdCA9IHNjcmlwdHNbaV07XG5cbiAgICAgICAgaWYgKHNjcmlwdC5oYXNBdHRyaWJ1dGUoJ2RhdGEta2V5JykgJiYgc2NyaXB0Lmhhc0F0dHJpYnV0ZSgnZGF0YS1hbW91bnQnKSkge1xuICAgICAgICAgIHRoaXMuYXBwLm9taXNlU2NyaXB0VGFnID0gc2NyaXB0O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICghZm91bmRJZnJhbWUgJiYgIXRoaXMuaXNJbnNpZGVJZnJhbWVBcHAoKSAmJiB0aGlzLmFwcC5vbWlzZVNjcmlwdFRhZykge1xuICAgICAgICB0aGlzLmNyZWF0ZUlmcmFtZSgpO1xuICAgICAgICB0aGlzLmFwcC5vbWlzZUdlbmVyYXRlQ2hlY2tvdXRCdXR0b24gPSB0aGlzLmNyZWF0ZU9taXNlQ2hlY2tvdXRCdXR0b24oKTtcbiAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5pKF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fbWVzc2FnZV9fW1wiYVwiIC8qIGRlZmF1bHQgKi9dKSh0aGlzKTtcbiAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IGRlZmF1bHQgY29uZmlnXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtvYmplY3R9IGN1cnJlbnQgZGVmYXVsdCBjb25maWcuXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJnZXREZWZhdWx0Q29uZmlnXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGdldERlZmF1bHRDb25maWcoKSB7XG4gICAgICByZXR1cm4gdGhpcy5hcHAuZGVmYXVsdENvbmZpZztcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IGFsbCBjb25maWd1cmUgYnV0dG9ucy5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gYWxsIGNvbmZpZ3VyZSBidXR0b25zLlxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiZ2V0QWxsQ29uZmlndXJlQnV0dG9uc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRBbGxDb25maWd1cmVCdXR0b25zKCkge1xuICAgICAgcmV0dXJuIHRoaXMuYXBwLmFsbENvbmZpZ3VyZUJ1dHRvbnM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCB0b2tlbiBhdCBvbWlzZSB0b2tlbiBoaWRkZW4gZmllbGQuXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHRva2VuIC0gb21pc2UgdG9rZW4uXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJzZXRUb2tlbkF0T21pc2VUb2tlbkZpZWxkXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNldFRva2VuQXRPbWlzZVRva2VuRmllbGQodG9rZW4pIHtcbiAgICAgIHZhciBtZXJnZWRDb25maWcgPSBfb2JqZWN0U3ByZWFkKHt9LCB0aGlzLmFwcC5kZWZhdWx0Q29uZmlnLCB7fSwgdGhpcy5hcHAuY3VycmVudE9wZW5Db25maWcpO1xuXG4gICAgICB2YXIgc3VibWl0QXV0byA9IG1lcmdlZENvbmZpZy5zdWJtaXRBdXRvLFxuICAgICAgICAgIG9uQ3JlYXRlVG9rZW5TdWNjZXNzID0gbWVyZ2VkQ29uZmlnLm9uQ3JlYXRlVG9rZW5TdWNjZXNzO1xuXG4gICAgICBpZiAodGhpcy5hcHAuZm9ybUVsZW1lbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNPbWlzZVNvdXJjZSh0b2tlbikpIHtcbiAgICAgICAgICB0aGlzLmFwcC5mb3JtRWxlbWVudC5vbWlzZVNvdXJjZS52YWx1ZSA9IHRva2VuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuYXBwLmZvcm1FbGVtZW50Lm9taXNlVG9rZW4udmFsdWUgPSB0b2tlbjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoc3VibWl0QXV0byA9PT0gJ3llcycgJiYgdGhpcy5hcHAuZm9ybUVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5hcHAuZm9ybUVsZW1lbnQuc3VibWl0KCk7XG4gICAgICB9XG5cbiAgICAgIDtcbiAgICAgIChvbkNyZWF0ZVRva2VuU3VjY2VzcyB8fCBub29wKSh0b2tlbik7IC8vIGNsZWFyIGN1cnJlbnQgb3BlbiBjb25maWcgYWZ0ZXIgc3VibWl0ZWRcblxuICAgICAgdGhpcy5hcHAuY3VycmVudE9wZW5Db25maWcgPSB7fTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiaXNPbWlzZVNvdXJjZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpc09taXNlU291cmNlKHN0cmluZykge1xuICAgICAgcmV0dXJuIC9ec3JjXy8udGVzdChzdHJpbmcpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgZm9ybSBlbGVtZW50IGZyb20gdGFyZ2V0IGJ5IHRyYXZlbCB1cCB0byBET00gdHJlZS5cbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IHRhcmdldCAtIHRhcmdldCBlbGVtZW50IGZvciBmaW5kIGZvcm0gZWxlbWVudC5cbiAgICAgKiBAcmV0dXJuIHtFbGVtZW50fSBmb3JtIGVsZW1lbnQuXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJnZXRGb3JtQnlUYXJnZXRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Rm9ybUJ5VGFyZ2V0KHRhcmdldCkge1xuICAgICAgdmFyIGN1cnJlbnROb2RlID0gdGFyZ2V0OyAvLyB0cmF2ZWwgRE9NIHVudGlsIGZvdW5kIGZvcm0gdGFnXG5cbiAgICAgIHdoaWxlIChjdXJyZW50Tm9kZSAmJiBjdXJyZW50Tm9kZS50YWdOYW1lICE9PSAnRk9STScpIHtcbiAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5wYXJlbnROb2RlO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gY3VycmVudE5vZGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBpZnJhbWUgYXQgbWVyY2hhbnQgcGFnZVxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiY3JlYXRlSWZyYW1lXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZUlmcmFtZSgpIHtcbiAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgIHZhciBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtcbiAgICAgIGlmcmFtZS5pZCA9IHRoaXMuYXBwLmlmcmFtZUFwcElkO1xuICAgICAgaWZyYW1lLnNyYyA9IFwiXCIuY29uY2F0KHRoaXMuYXBwLnNldHRpbmdzLmNhcmRIb3N0LCBcIi9wYXkuaHRtbFwiKTtcbiAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgaWZyYW1lRGVmYXVsdFN0eWxlLmpvaW4oJzsgJykpO1xuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpZnJhbWUpO1xuXG4gICAgICBpZnJhbWUub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoX3RoaXMuYXBwLmlmcmFtZS5zdHlsZS5kaXNwbGF5ID09PSAnYmxvY2snKSB7XG4gICAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5pKF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fbWVzc2FnZV9fW1wiYlwiIC8qIG1lc3NhZ2VTaG93SWZyYW1lQXBwRm9ybSAqL10pKGlmcmFtZS5jb250ZW50V2luZG93LCB7XG4gICAgICAgICAgICBjb25maWc6IF90aGlzLmFwcC5jb25maWdGb3JJZnJhbWVPbkxvYWRcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIF90aGlzLmFwcC5pZnJhbWVMb2FkZWQgPSB0cnVlO1xuICAgICAgfTtcblxuICAgICAgdGhpcy5hcHAuaWZyYW1lID0gaWZyYW1lO1xuICAgICAgcmV0dXJuIHRoaXMuYXBwLmlmcmFtZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGhpZGRlbiBpbnB1dCBmb3Igc3RvcmUgT21pc2UgVG9rZW4uXG4gICAgICogQHBhcmFtICB7RWxlbWVudH0gdGFyZ2V0IC0gdGFyZ2V0IGVsZW1lbnQgZm9yIGluc2VydCBpbnB1dC5cbiAgICAgKiBAcmV0dXJuIHtFbGVtZW50fSBoaWRkZW4gaW5wdXQgZWxlbWVudC5cbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcImNyZWF0ZUhpZGRlbklucHV0Rm9yT21pc2VUb2tlblwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVIaWRkZW5JbnB1dEZvck9taXNlVG9rZW4odGFyZ2V0KSB7XG4gICAgICB2YXIgZm9ybUVsZW1lbnQgPSBudWxsO1xuXG4gICAgICBpZiAodGFyZ2V0ICYmIHRhcmdldC50YWdOYW1lID09PSAnRk9STScpIHtcbiAgICAgICAgZm9ybUVsZW1lbnQgPSB0YXJnZXQ7XG4gICAgICB9XG5cbiAgICAgIGlmICghZm9ybUVsZW1lbnQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFsnTWlzc2luZyBmb3JtIGVsZW1lbnQuIEdlbmVyYXRlIGJ1dHRvbiBvciBjdXN0b20gYnV0dG9uIG11c3QgY29udGFpbiBpbiBmb3JtIGVsZW1lbnQuJywgJ2h0dHBzOi8vZ2l0aHViLmNvbS9vbWlzZS9leGFtcGxlcy9ibG9iL21hc3Rlci9vbWlzZS5qcy9leGFtcGxlLTQtY3VzdG9tLWludGVncmF0aW9uLW11bHRpcGxlLWJ1dHRvbnMuaHRtbCcsICdPciBzZXR0aW5nIHN1Ym1pdCBmb3JtIHRhcmdldCcsICdodHRwczovL2dpdGh1Yi5jb20vb21pc2UvZXhhbXBsZXMvYmxvYi9tYXN0ZXIvb21pc2UuanMvZXhhbXBsZS01LWN1c3RvbS1pbnRlZ3JhdGlvbi1zcGVjaWZ5LWNoZWNrb3V0LWZvcm0uaHRtbCddLmpvaW4oJ1xcbicpKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGlucHV0T21pc2VUb2tlbiA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJvbWlzZVRva2VuXCJdJyk7XG5cbiAgICAgIGlmIChpbnB1dE9taXNlVG9rZW4gPT0gbnVsbCkge1xuICAgICAgICBpbnB1dE9taXNlVG9rZW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgICAgICBpbnB1dE9taXNlVG9rZW4uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2hpZGRlbicpO1xuICAgICAgICBpbnB1dE9taXNlVG9rZW4uc2V0QXR0cmlidXRlKCduYW1lJywgJ29taXNlVG9rZW4nKTtcbiAgICAgICAgZm9ybUVsZW1lbnQuYXBwZW5kQ2hpbGQoaW5wdXRPbWlzZVRva2VuKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGlucHV0T21pc2VTb3VyY2UgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwib21pc2VTb3VyY2VcIl0nKTtcblxuICAgICAgaWYgKGlucHV0T21pc2VTb3VyY2UgPT0gbnVsbCkge1xuICAgICAgICBpbnB1dE9taXNlU291cmNlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgICAgaW5wdXRPbWlzZVNvdXJjZS5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnaGlkZGVuJyk7XG4gICAgICAgIGlucHV0T21pc2VTb3VyY2Uuc2V0QXR0cmlidXRlKCduYW1lJywgJ29taXNlU291cmNlJyk7XG4gICAgICAgIGZvcm1FbGVtZW50LmFwcGVuZENoaWxkKGlucHV0T21pc2VTb3VyY2UpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gaW5wdXRPbWlzZVRva2VuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBdXRvIGNyZWF0ZSBwYXkgd2l0aCBvbWlzZSBidXR0b24gYXQgbmV4dCBvbWlzZSBzY3JpcHQgdGFnc1xuICAgICAqIEByZXR1cm4ge0VsZW1lbnR9IG9taXNlIGdlbmVyYXRlIGNoZWNrb3V0IGJ1dHRvbi5cbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcImNyZWF0ZU9taXNlQ2hlY2tvdXRCdXR0b25cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlT21pc2VDaGVja291dEJ1dHRvbigpIHtcbiAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICB2YXIgY29uZmlnID0gdGhpcy5wcmVwYXJlQ29uZmlnKF9fd2VicGFja19yZXF1aXJlX18uaShfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfaGVscGVyc191dGlsc19fW1wiYVwiIC8qIGV4dHJhY3REYXRhRnJvbUVsZW1lbnQgKi9dKSh0aGlzLmFwcC5vbWlzZVNjcmlwdFRhZykpO1xuICAgICAgdmFyIGNoZWNrb3V0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICBjaGVja291dEJ1dHRvbi5jbGFzc05hbWUgPSAnb21pc2UtY2hlY2tvdXQtYnV0dG9uJztcbiAgICAgIGNoZWNrb3V0QnV0dG9uLmlubmVySFRNTCA9IGNvbmZpZy5idXR0b25MYWJlbDtcbiAgICAgIHZhciBvbWlzZVNjcmlwdFRhZyA9IHRoaXMuYXBwLm9taXNlU2NyaXB0VGFnO1xuXG4gICAgICBpZiAob21pc2VTY3JpcHRUYWcpIHtcbiAgICAgICAgdmFyIGZvcm1FbGVtZW50ID0gdGhpcy5nZXRGb3JtQnlUYXJnZXQob21pc2VTY3JpcHRUYWcpO1xuICAgICAgICB0aGlzLmFwcC5mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgICAgICB0aGlzLmNyZWF0ZUhpZGRlbklucHV0Rm9yT21pc2VUb2tlbihmb3JtRWxlbWVudCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLndhcm4oJ01pc3NpbmcgT21pc2Ugc2NyaXB0IHRhZycpO1xuICAgICAgfSAvLyBiaW5kIGJ1dHRvbiBldmVudC5cblxuXG4gICAgICBjaGVja291dEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIGlmIChvbWlzZVNjcmlwdFRhZykge1xuICAgICAgICAgIHZhciBjb25maWdGcm9tU2NyaXB0VGFnID0gX193ZWJwYWNrX3JlcXVpcmVfXy5pKF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9oZWxwZXJzX3V0aWxzX19bXCJhXCIgLyogZXh0cmFjdERhdGFGcm9tRWxlbWVudCAqL10pKG9taXNlU2NyaXB0VGFnKTtcblxuICAgICAgICAgIHZhciBfY29uZmlnID0gX3RoaXMyLnByZXBhcmVDb25maWcoY29uZmlnRnJvbVNjcmlwdFRhZyk7XG5cbiAgICAgICAgICBfdGhpczIuYXBwLmNvbmZpZ0ZvcklmcmFtZU9uTG9hZCA9IF9vYmplY3RTcHJlYWQoe30sIF9jb25maWcpO1xuXG4gICAgICAgICAgX3RoaXMyLm9wZW4oX2NvbmZpZyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKCdNaXNzaW5nIE9taXNlIHNjcmlwdCB0YWcnKTtcbiAgICAgICAgfVxuICAgICAgfSwgZmFsc2UpOyAvLyBpbmplY3QgYnV0dG9uIG5leHQgc2NyaXB0IHRhZy5cblxuICAgICAgb21pc2VTY3JpcHRUYWcucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoY2hlY2tvdXRCdXR0b24sIG9taXNlU2NyaXB0VGFnLm5leHRTaWJsaW5nKTtcbiAgICAgIHJldHVybiBjaGVja291dEJ1dHRvbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2hlY2tpbmcgb21pc2VDYXJkLmpzIGFyZSBydW5uaW5nIGF0IE9taXNlIGlmcmFtZSBhcHAgb3Igbm90XG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJpc0luc2lkZUlmcmFtZUFwcFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpc0luc2lkZUlmcmFtZUFwcCgpIHtcbiAgICAgIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmFwcC5pZnJhbWVBcHBJZCkgIT0gbnVsbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUHJlcGFyZSBjb25maWd1cmUgYmVmb3JlIHNlbmQgdG8gY2hlY2tvdXQgZm9ybS5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gbmV3Q29uZmlnICAgICAtIG5ldyBjb25maWcgZm9yIG1lcmdlIHdpdGggZGVmYXVsdCBjb25maWcuXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBjb25maWd1cmUgYWZ0ZXIgbWVyZ2VkIGFuZCBmaXguXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJwcmVwYXJlQ29uZmlnXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHByZXBhcmVDb25maWcoKSB7XG4gICAgICB2YXIgbmV3Q29uZmlnID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcbiAgICAgIHZhciBvdGhlclBheW1lbnRNZXRob2RzID0gbmV3Q29uZmlnLm90aGVyUGF5bWVudE1ldGhvZHM7XG5cbiAgICAgIGlmIChvdGhlclBheW1lbnRNZXRob2RzICYmIHR5cGVvZiBvdGhlclBheW1lbnRNZXRob2RzID09ICdzdHJpbmcnKSB7XG4gICAgICAgIG5ld0NvbmZpZy5vdGhlclBheW1lbnRNZXRob2RzID0gdGhpcy5zdHJpbmdUb0FycmF5KG90aGVyUGF5bWVudE1ldGhvZHMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5pKF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9oZWxwZXJzX3V0aWxzX19bXCJiXCIgLyogbWVyZ2UgKi9dKSh0aGlzLmFwcC5kZWZhdWx0Q29uZmlnLCBmaXhDb25maWdOYW1lKG5ld0NvbmZpZykpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzdHJpbmdUb0FycmF5XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHN0cmluZ1RvQXJyYXkoc3RyKSB7XG4gICAgICByZXR1cm4gc3RyLnNwbGl0KCcsJykubWFwKGZ1bmN0aW9uIChzKSB7XG4gICAgICAgIHJldHVybiBzLnRyaW0oKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgZGVmYXVsdCBjb25maWd1cmUuXG4gICAgICogQHBhcmFtICB7b2JqZWN0fSBuZXdDb25maWcgLSBuZXcgY29uZmlnIGZvciBtZXJnZSB3aXRoIGRlZmF1bHQuXG4gICAgICogQHJldHVybiB7b2JqZWN0fSBkZWZhdWx0IGNvbmZpZy5cbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcImNvbmZpZ3VyZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjb25maWd1cmUobmV3Q29uZmlnKSB7XG4gICAgICB0aGlzLmFwcC5kZWZhdWx0Q29uZmlnID0gdGhpcy5wcmVwYXJlQ29uZmlnKG5ld0NvbmZpZyk7XG5cbiAgICAgIGlmICghdGhpcy5pc0luc2lkZUlmcmFtZUFwcCgpKSB7XG4gICAgICAgIGlmICghdGhpcy5hcHAuaWZyYW1lKSB7XG4gICAgICAgICAgdGhpcy5jcmVhdGVJZnJhbWUoKTtcbiAgICAgICAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLmkoX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19tZXNzYWdlX19bXCJhXCIgLyogZGVmYXVsdCAqL10pKHRoaXMpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmFwcC5kZWZhdWx0Q29uZmlnO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBPcGVuIGlmcmFtZSBhcHAuXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSAgIG5ld0NvbmZpZyAtIG5ldyBjb25maWcgZm9yIGlmcmFtZSBhcHAuXG4gICAgICogQHBhcmFtICB7RnVuY3Rpb259IGNhbGxiYWNrICAtIGNhbGxiYWNrIGZpcmUgYWZ0ZXIgaWZyYW1lIGFwcCBvcGVuZWQuXG4gICAgICogQHJldHVybiByZXN1bHQgZm9yIG9wZW4uXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJvcGVuXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW4oKSB7XG4gICAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgICAgdmFyIG5ld0NvbmZpZyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG4gICAgICB2YXIgY2FsbGJhY2sgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IG5vb3A7XG5cbiAgICAgIGlmICghdGhpcy5hcHAuaWZyYW1lKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgdmFyIG9wZW5JZnJhbWVXaXRoTmV3Q29uZmlnID0gZnVuY3Rpb24gb3BlbklmcmFtZVdpdGhOZXdDb25maWcoKSB7XG4gICAgICAgIHZhciBjb25maWcgPSBfdGhpczMucHJlcGFyZUNvbmZpZyhuZXdDb25maWcpO1xuXG4gICAgICAgIF90aGlzMy5hcHAuY3VycmVudE9wZW5Db25maWcgPSBfb2JqZWN0U3ByZWFkKHt9LCBjb25maWcpO1xuICAgICAgICBfdGhpczMuYXBwLmlmcmFtZS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAncmdiYSgwLCAwLCAwLCAuNCknO1xuICAgICAgICBfdGhpczMuYXBwLmlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5pKF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fbWVzc2FnZV9fW1wiYlwiIC8qIG1lc3NhZ2VTaG93SWZyYW1lQXBwRm9ybSAqL10pKF90aGlzMy5hcHAuaWZyYW1lLmNvbnRlbnRXaW5kb3csIHtcbiAgICAgICAgICAgIGNvbmZpZzogY29uZmlnXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY2FsbGJhY2soX3RoaXMzLmFwcC5pZnJhbWUpO1xuICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgICAgIGlmICh0aGlzLmFwcC5pZnJhbWVMb2FkZWQpIHtcbiAgICAgICAgb3BlbklmcmFtZVdpdGhOZXdDb25maWcoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBvYnNlcnZlVGltZW91dCA9IDMwMDA7XG4gICAgICAgIHZhciBvYnNlcnZlRGVsYXkgPSAxMDA7XG4gICAgICAgIHZhciBvYnNlcnZlQ291bnQgPSAwO1xuICAgICAgICB2YXIgb2JzZXJ2ZVRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIG9ic2VydmVDb3VudCArPSBvYnNlcnZlRGVsYXk7XG5cbiAgICAgICAgICBpZiAob2JzZXJ2ZUNvdW50ID49IG9ic2VydmVUaW1lb3V0IHx8IF90aGlzMy5hcHAuaWZyYW1lTG9hZGVkKSB7XG4gICAgICAgICAgICBpZiAoX3RoaXMzLmFwcC5pZnJhbWVMb2FkZWQpIHtcbiAgICAgICAgICAgICAgb3BlbklmcmFtZVdpdGhOZXdDb25maWcoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChvYnNlcnZlVGltZXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgb2JzZXJ2ZURlbGF5KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsb3NlIGlmcmFtZSBhcHBcbiAgICAgKiBAcGFyYW0gIHtGdW5jdGlvbn0gY2FsbGJhY2sgIC0gY2FsbGJhY2sgZmlyZSBhZnRlciBpZnJhbWUgYXBwIGNsb3NlZC5cbiAgICAgKiBAcmV0dXJuIHJlc3VsdCBmb3IgY2xvc2UuXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJjbG9zZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9zZSgpIHtcbiAgICAgIHZhciBfdGhpczQgPSB0aGlzO1xuXG4gICAgICB2YXIgY2FsbGJhY2sgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IG5vb3A7XG5cbiAgICAgIGlmICghdGhpcy5hcHAuaWZyYW1lKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5hcHAuaWZyYW1lLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdyZ2JhKDAsIDAsIDAsIDApJztcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpczQuYXBwLmlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICBjYWxsYmFjayhfdGhpczQuYXBwLmlmcmFtZSk7XG4gICAgICAgIHZhciBvbkZvcm1DbG9zZWQgPSBfdGhpczQuYXBwLmN1cnJlbnRPcGVuQ29uZmlnLm9uRm9ybUNsb3NlZDtcbiAgICAgICAgKG9uRm9ybUNsb3NlZCB8fCBub29wKShfdGhpczQuYXBwLmlmcmFtZSk7XG4gICAgICB9LCAyNTApO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERlc3Ryb3kgaWZyYW1lIGFwcFxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiZGVzdHJveVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgdmFyIGlmcmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuYXBwLmlmcmFtZUFwcElkKTtcblxuICAgICAgaWYgKHRoaXMuYXBwLmlmcmFtZSAmJiBpZnJhbWUpIHtcbiAgICAgICAgdmFyIF9pZnJhbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmFwcC5pZnJhbWVBcHBJZCk7XG5cbiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChfaWZyYW1lKTsgLy8gcmVzZXQgYXBwIG9iamVjdCB0byBkZWZhdWx0XG5cbiAgICAgICAgdGhpcy5zZXR1cCgpO1xuICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgaGFuZGxlciBmb3IgaWZyYW1lIGFwcCBmb3IgY29udHJvbCBPbWlzZUNhcmQuanNcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcImNyZWF0ZVBhcmVudEZyYW1lSGFuZGxlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVQYXJlbnRGcmFtZUhhbmRsZXIoKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjbG9zZUlmcmFtZTogZnVuY3Rpb24gY2xvc2VJZnJhbWUoKSB7XG4gICAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5pKF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fbWVzc2FnZV9fW1wiY1wiIC8qIG1lc3NhZ2VDbG9zZUlmcmFtZSAqL10pKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGNsb3NlQW5kU2VuZFRva2VuOiBmdW5jdGlvbiBjbG9zZUFuZFNlbmRUb2tlbih0b2tlbikge1xuICAgICAgICAgIF9fd2VicGFja19yZXF1aXJlX18uaShfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX21lc3NhZ2VfX1tcImRcIiAvKiBtZXNzYWdlQ2xvc2VBbmRTZW5kVG9rZW4gKi9dKSh0b2tlbik7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE5PVEU6IExFR0FDWVxuICAgICAqIFNldCBjb25maWd1cmUgdG8gcGF5IGJ1dHRvblxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBidXR0b25JZCAtIGJ1dHRvbiB0YXJnZXQgaWQuXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGNvbmZpZyAgIC0gY29uZmlndXJlIGZvciBwYXkgYnV0dG9uLlxuICAgICAqIEByZXR1cm4ge29iamVjdH0gbmV3IGJ1dHRvbiBjb25maWd1cmUuXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJjb25maWd1cmVCdXR0b25cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gY29uZmlndXJlQnV0dG9uKGJ1dHRvbklkLCBjb25maWcpIHtcbiAgICAgIHZhciBjb25maWdGb3JCdXR0b24gPSB0aGlzLnByZXBhcmVDb25maWcoY29uZmlnKTtcbiAgICAgIHZhciBuZXdCdXR0b25Db25maWcgPSB7XG4gICAgICAgIGJ1dHRvbklkOiBidXR0b25JZCxcbiAgICAgICAgY29uZmlndXJhdGlvbjogY29uZmlnRm9yQnV0dG9uXG4gICAgICB9O1xuICAgICAgdGhpcy5hcHAuYWxsQ29uZmlndXJlQnV0dG9ucy5wdXNoKG5ld0J1dHRvbkNvbmZpZyk7XG4gICAgICByZXR1cm4gbmV3QnV0dG9uQ29uZmlnO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBOT1RFOiBMRUdBQ1lcbiAgICAgKiBBY3RpdmF0ZSBhbGwgY29uZmlndXJlIGJ1dHRvbnMuXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJhdHRhY2hcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gYXR0YWNoKCkge1xuICAgICAgdmFyIF90aGlzNSA9IHRoaXM7XG5cbiAgICAgIHZhciBhdHRhY2hlZEJ1dHRvbnMgPSBbXTtcbiAgICAgIHRoaXMuYXBwLmFsbENvbmZpZ3VyZUJ1dHRvbnMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICB2YXIgY29uZmlndXJhdGlvbiA9IGl0ZW0uY29uZmlndXJhdGlvbjtcbiAgICAgICAgdmFyIGJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoaXRlbS5idXR0b25JZCk7XG4gICAgICAgIHZhciBkZWZhdWx0QnV0dG9uVGV4dCA9IF90aGlzNS5hcHAuZGVmYXVsdENvbmZpZy5idXR0b25MYWJlbDtcbiAgICAgICAgdmFyIGJ1dHRvblRleHQgPSBkZWZhdWx0QnV0dG9uVGV4dDtcblxuICAgICAgICBpZiAoY29uZmlndXJhdGlvbi5idXR0b25MYWJlbCAmJiBidXR0b25UZXh0ICE9PSBjb25maWd1cmF0aW9uLmJ1dHRvbkxhYmVsKSB7XG4gICAgICAgICAgYnV0dG9uVGV4dCA9IGNvbmZpZ3VyYXRpb24uYnV0dG9uTGFiZWw7XG4gICAgICAgIH0gZWxzZSBpZiAoYnV0dG9uLmlubmVySFRNTCkge1xuICAgICAgICAgIGJ1dHRvblRleHQgPSBidXR0b24uaW5uZXJIVE1MO1xuICAgICAgICB9XG5cbiAgICAgICAgYnV0dG9uLmlubmVySFRNTCA9IGJ1dHRvblRleHQ7XG4gICAgICAgIHZhciBzdWJtaXRGb3JtVGFyZ2V0ID0gX3RoaXM1LmFwcC5kZWZhdWx0Q29uZmlnLnN1Ym1pdEZvcm1UYXJnZXQ7XG4gICAgICAgIHZhciBmb3JtRWxlbWVudCA9IHN1Ym1pdEZvcm1UYXJnZXQgPyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHN1Ym1pdEZvcm1UYXJnZXQpIDogX3RoaXM1LmdldEZvcm1CeVRhcmdldChidXR0b24pO1xuXG4gICAgICAgIF90aGlzNS5jcmVhdGVIaWRkZW5JbnB1dEZvck9taXNlVG9rZW4oZm9ybUVsZW1lbnQpO1xuXG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldDtcbiAgICAgICAgICBfdGhpczUuYXBwLmNvbmZpZ0ZvcklmcmFtZU9uTG9hZCA9IGNvbmZpZ3VyYXRpb247XG4gICAgICAgICAgX3RoaXM1LmFwcC5mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuXG4gICAgICAgICAgX3RoaXM1Lm9wZW4oY29uZmlndXJhdGlvbik7XG4gICAgICAgIH0sIGZhbHNlKTtcbiAgICAgICAgYXR0YWNoZWRCdXR0b25zLnB1c2goYnV0dG9uKTtcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIXRoaXMuaXNJbnNpZGVJZnJhbWVBcHAoKSkge1xuICAgICAgICBpZiAoIXRoaXMuYXBwLmlmcmFtZSkge1xuICAgICAgICAgIHRoaXMuY3JlYXRlSWZyYW1lKCk7XG4gICAgICAgICAgX193ZWJwYWNrX3JlcXVpcmVfXy5pKF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fbWVzc2FnZV9fW1wiYVwiIC8qIGRlZmF1bHQgKi9dKSh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gYXR0YWNoZWRCdXR0b25zO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBPbWlzZUNhcmQ7XG59KCk7XG4vKipcbiAqIEZpeCBjb25maWcgbmFtZSB0aGF0IGRvZXNuJ3QgbWF0Y2ggd2l0aCBvdGhlci5cbiAqIEBwYXJhbSB7b2JqZWN0fSBjb25maWcgLSBjb25maWcgZm9yIGlmcmFtZSBhcHAuXG4gKiBAcmV0dXJuIHtvYmplY3R9IGZpeCBjb25maWcuXG4gKi9cblxuXG5cbmZ1bmN0aW9uIGZpeENvbmZpZ05hbWUoY29uZmlnKSB7XG4gIHZhciBmaXhDb25maWcgPSB7fTtcbiAgdmFyIG5lZWRUb0ZpeEtleXMgPSB7XG4gICAgcHVibGljS2V5OiAna2V5JyxcbiAgICBsb2dvOiAnaW1hZ2UnLFxuICAgIGxvY2F0aW9uRmllbGQ6ICdsb2NhdGlvbidcbiAgfTsgLy8gYXNzaWduIHZhbHVlIGFuZCBmaXgga2V5XG5cbiAgZm9yICh2YXIga2V5IGluIGNvbmZpZykge1xuICAgIC8vIGZvdW5kIGtleSB0aGF0IG5lZWQgdG8gZml4XG4gICAgdmFyIGNvcnJlY3RLZXlOYW1lID0gbmVlZFRvRml4S2V5c1trZXldO1xuXG4gICAgaWYgKGNvcnJlY3RLZXlOYW1lKSB7XG4gICAgICBmaXhDb25maWdbY29ycmVjdEtleU5hbWVdID0gY29uZmlnW2tleV07XG4gICAgfSBlbHNlIHtcbiAgICAgIGZpeENvbmZpZ1trZXldID0gY29uZmlnW2tleV07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGZpeENvbmZpZztcbn1cblxuLyoqKi8gfSksXG4vKiA1ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cbi8qIGVzbGludC1kaXNhYmxlICovXG5cbi8qKlxuICogLT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT1cbiAqIFBvbHlmaWxsIG1pc3NpbmcganMgZmVhdHVyZXNcbiAqIE5PVEU6IGltcG9ydCB0aGlzIGZpbGUgYXQgZmlyc3QgbGluZSBvZiAuL3NyYy9pbmRleC5qc1xuICogLT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT1cbiAqL1xuXG4vKipcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBQb2x5ZmlsbCAtIE9iamVjdC5hc3NpZ25cbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKi9cbmlmICh0eXBlb2YgT2JqZWN0LmFzc2lnbiAhPSAnZnVuY3Rpb24nKSB7XG4gIC8vIE11c3QgYmUgd3JpdGFibGU6IHRydWUsIGVudW1lcmFibGU6IGZhbHNlLCBjb25maWd1cmFibGU6IHRydWVcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE9iamVjdCwgJ2Fzc2lnbicsIHtcbiAgICB2YWx1ZTogZnVuY3Rpb24gYXNzaWduKHRhcmdldCwgdmFyQXJncykge1xuICAgICAgLy8gLmxlbmd0aCBvZiBmdW5jdGlvbiBpcyAyXG4gICAgICAndXNlIHN0cmljdCc7XG5cbiAgICAgIGlmICh0YXJnZXQgPT0gbnVsbCkge1xuICAgICAgICAvLyBUeXBlRXJyb3IgaWYgdW5kZWZpbmVkIG9yIG51bGxcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNvbnZlcnQgdW5kZWZpbmVkIG9yIG51bGwgdG8gb2JqZWN0Jyk7XG4gICAgICB9XG5cbiAgICAgIHZhciB0byA9IE9iamVjdCh0YXJnZXQpO1xuXG4gICAgICBmb3IgKHZhciBpbmRleCA9IDE7IGluZGV4IDwgYXJndW1lbnRzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICB2YXIgbmV4dFNvdXJjZSA9IGFyZ3VtZW50c1tpbmRleF07XG5cbiAgICAgICAgaWYgKG5leHRTb3VyY2UgIT0gbnVsbCkge1xuICAgICAgICAgIC8vIFNraXAgb3ZlciBpZiB1bmRlZmluZWQgb3IgbnVsbFxuICAgICAgICAgIGZvciAodmFyIG5leHRLZXkgaW4gbmV4dFNvdXJjZSkge1xuICAgICAgICAgICAgLy8gQXZvaWQgYnVncyB3aGVuIGhhc093blByb3BlcnR5IGlzIHNoYWRvd2VkXG4gICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG5leHRTb3VyY2UsIG5leHRLZXkpKSB7XG4gICAgICAgICAgICAgIHRvW25leHRLZXldID0gbmV4dFNvdXJjZVtuZXh0S2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRvO1xuICAgIH0sXG4gICAgd3JpdGFibGU6IHRydWUsXG4gICAgY29uZmlndXJhYmxlOiB0cnVlXG4gIH0pO1xufVxuXG4vKioqLyB9KSxcbi8qIDYgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiKSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH1cblxuLyoqXHJcbiAqIGVhc3lYRE1cclxuICogaHR0cDovL2Vhc3l4ZG0ubmV0L1xyXG4gKiBDb3B5cmlnaHQoYykgMjAwOS0yMDExLCDDmHl2aW5kIFNlYW4gS2luc2V5LCBveXZpbmRAa2luc2V5Lm5vLlxyXG4gKlxyXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XHJcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcclxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xyXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXHJcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xyXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG4gKlxyXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxyXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuICpcclxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxyXG4gKiBUSEUgU09GVFdBUkUuXHJcbiAqL1xuKGZ1bmN0aW9uICh3aW5kb3csIGRvY3VtZW50LCBsb2NhdGlvbiwgc2V0VGltZW91dCwgZGVjb2RlVVJJQ29tcG9uZW50LCBlbmNvZGVVUklDb21wb25lbnQpIHtcbiAgLypqc2xpbnQgZXZpbDogdHJ1ZSwgYnJvd3NlcjogdHJ1ZSwgaW1tZWQ6IHRydWUsIHBhc3NmYWlsOiB0cnVlLCB1bmRlZjogdHJ1ZSwgbmV3Y2FwOiB0cnVlKi9cblxuICAvKmdsb2JhbCBKU09OLCBYTUxIdHRwUmVxdWVzdCwgd2luZG93LCBlc2NhcGUsIHVuZXNjYXBlLCBBY3RpdmVYT2JqZWN0ICovXG4gIC8vXG4gIC8vIGVhc3lYRE1cbiAgLy8gaHR0cDovL2Vhc3l4ZG0ubmV0L1xuICAvLyBDb3B5cmlnaHQoYykgMjAwOS0yMDExLCDDmHl2aW5kIFNlYW4gS2luc2V5LCBveXZpbmRAa2luc2V5Lm5vLlxuICAvL1xuICAvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gIC8vIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAgLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICAvLyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gIC8vIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICAvLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuICAvL1xuICAvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICAvLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAgLy9cbiAgLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICAvLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAgLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gIC8vIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAgLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAgLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICAvLyBUSEUgU09GVFdBUkUuXG4gIC8vXG4gIHZhciBnbG9iYWwgPSB0aGlzO1xuICB2YXIgY2hhbm5lbElkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMDApOyAvLyByYW5kb21pemUgdGhlIGluaXRpYWwgaWQgaW4gY2FzZSBvZiBtdWx0aXBsZSBjbG9zdXJlcyBsb2FkZWRcblxuICB2YXIgZW1wdHlGbiA9IEZ1bmN0aW9uLnByb3RvdHlwZTtcbiAgdmFyIHJlVVJJID0gL14oKGh0dHAuPzopXFwvXFwvKFteOlxcL1xcc10rKSg6XFxkKykqKS87IC8vIHJldHVybnMgZ3JvdXBzIGZvciBwcm90b2NvbCAoMiksIGRvbWFpbiAoMykgYW5kIHBvcnQgKDQpXG5cbiAgdmFyIHJlUGFyZW50ID0gL1tcXC1cXHddK1xcL1xcLlxcLlxcLy87IC8vIG1hdGNoZXMgYSBmb28vLi4vIGV4cHJlc3Npb25cblxuICB2YXIgcmVEb3VibGVTbGFzaCA9IC8oW146XSlcXC9cXC8vZzsgLy8gbWF0Y2hlcyAvLyBhbnl3aGVyZSBidXQgaW4gdGhlIHByb3RvY29sXG5cbiAgdmFyIG5hbWVzcGFjZSA9IFwiXCI7IC8vIHN0b3JlcyBuYW1lc3BhY2UgdW5kZXIgd2hpY2ggZWFzeVhETSBvYmplY3QgaXMgc3RvcmVkIG9uIHRoZSBwYWdlIChlbXB0eSBpZiBvYmplY3QgaXMgZ2xvYmFsKVxuXG4gIHZhciBlYXN5WERNID0ge307XG4gIHZhciBfZWFzeVhETSA9IHdpbmRvdy5lYXN5WERNOyAvLyBtYXAgb3ZlciBnbG9iYWwgZWFzeVhETSBpbiBjYXNlIG9mIG92ZXJ3cml0ZVxuXG4gIHZhciBJRlJBTUVfUFJFRklYID0gXCJlYXN5WERNX1wiO1xuICB2YXIgSEFTX05BTUVfUFJPUEVSVFlfQlVHO1xuICB2YXIgdXNlSGFzaCA9IGZhbHNlOyAvLyB3aGV0aGVyIHRvIHVzZSB0aGUgaGFzaCBvdmVyIHRoZSBxdWVyeVxuXG4gIHZhciBmbGFzaFZlcnNpb247IC8vIHdpbGwgYmUgc2V0IGlmIHVzaW5nIGZsYXNoXG5cbiAgdmFyIEhBU19GTEFTSF9USFJPVFRMRURfQlVHOyAvLyBodHRwOi8vcGV0ZXIubWljaGF1eC5jYS9hcnRpY2xlcy9mZWF0dXJlLWRldGVjdGlvbi1zdGF0ZS1vZi10aGUtYXJ0LWJyb3dzZXItc2NyaXB0aW5nXG5cbiAgZnVuY3Rpb24gaXNIb3N0TWV0aG9kKG9iamVjdCwgcHJvcGVydHkpIHtcbiAgICB2YXIgdCA9IF90eXBlb2Yob2JqZWN0W3Byb3BlcnR5XSk7XG5cbiAgICByZXR1cm4gdCA9PSAnZnVuY3Rpb24nIHx8ICEhKHQgPT0gJ29iamVjdCcgJiYgb2JqZWN0W3Byb3BlcnR5XSkgfHwgdCA9PSAndW5rbm93bic7XG4gIH1cblxuICBmdW5jdGlvbiBpc0hvc3RPYmplY3Qob2JqZWN0LCBwcm9wZXJ0eSkge1xuICAgIHJldHVybiAhIShfdHlwZW9mKG9iamVjdFtwcm9wZXJ0eV0pID09ICdvYmplY3QnICYmIG9iamVjdFtwcm9wZXJ0eV0pO1xuICB9IC8vIGVuZFxuICAvLyBodHRwOi8vcGVyZmVjdGlvbmtpbGxzLmNvbS9pbnN0YW5jZW9mLWNvbnNpZGVyZWQtaGFybWZ1bC1vci1ob3ctdG8td3JpdGUtYS1yb2J1c3QtaXNhcnJheS9cblxuXG4gIGZ1bmN0aW9uIGlzQXJyYXkobykge1xuICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykgPT09ICdbb2JqZWN0IEFycmF5XSc7XG4gIH0gLy8gZW5kXG5cblxuICBmdW5jdGlvbiBoYXNGbGFzaCgpIHtcbiAgICB2YXIgbmFtZSA9IFwiU2hvY2t3YXZlIEZsYXNoXCIsXG4gICAgICAgIG1pbWVUeXBlID0gXCJhcHBsaWNhdGlvbi94LXNob2Nrd2F2ZS1mbGFzaFwiO1xuXG4gICAgaWYgKCF1bmRlZihuYXZpZ2F0b3IucGx1Z2lucykgJiYgX3R5cGVvZihuYXZpZ2F0b3IucGx1Z2luc1tuYW1lXSkgPT0gXCJvYmplY3RcIikge1xuICAgICAgLy8gYWRhcHRlZCBmcm9tIHRoZSBzd2ZvYmplY3QgY29kZVxuICAgICAgdmFyIGRlc2NyaXB0aW9uID0gbmF2aWdhdG9yLnBsdWdpbnNbbmFtZV0uZGVzY3JpcHRpb247XG5cbiAgICAgIGlmIChkZXNjcmlwdGlvbiAmJiAhdW5kZWYobmF2aWdhdG9yLm1pbWVUeXBlcykgJiYgbmF2aWdhdG9yLm1pbWVUeXBlc1ttaW1lVHlwZV0gJiYgbmF2aWdhdG9yLm1pbWVUeXBlc1ttaW1lVHlwZV0uZW5hYmxlZFBsdWdpbikge1xuICAgICAgICBmbGFzaFZlcnNpb24gPSBkZXNjcmlwdGlvbi5tYXRjaCgvXFxkKy9nKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIWZsYXNoVmVyc2lvbikge1xuICAgICAgdmFyIGZsYXNoO1xuXG4gICAgICB0cnkge1xuICAgICAgICBmbGFzaCA9IG5ldyBBY3RpdmVYT2JqZWN0KFwiU2hvY2t3YXZlRmxhc2guU2hvY2t3YXZlRmxhc2hcIik7XG4gICAgICAgIGZsYXNoVmVyc2lvbiA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZsYXNoLkdldFZhcmlhYmxlKFwiJHZlcnNpb25cIikubWF0Y2goLyhcXGQrKSwoXFxkKyksKFxcZCspLChcXGQrKS8pLCAxKTtcbiAgICAgICAgZmxhc2ggPSBudWxsO1xuICAgICAgfSBjYXRjaCAobm90U3VwcG9ydGVkRXhjZXB0aW9uKSB7fVxuICAgIH1cblxuICAgIGlmICghZmxhc2hWZXJzaW9uKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdmFyIG1ham9yID0gcGFyc2VJbnQoZmxhc2hWZXJzaW9uWzBdLCAxMCksXG4gICAgICAgIG1pbm9yID0gcGFyc2VJbnQoZmxhc2hWZXJzaW9uWzFdLCAxMCk7XG4gICAgSEFTX0ZMQVNIX1RIUk9UVExFRF9CVUcgPSBtYWpvciA+IDkgJiYgbWlub3IgPiAwO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIC8qXHJcbiAgICogQ3Jvc3MgQnJvd3NlciBpbXBsZW1lbnRhdGlvbiBmb3IgYWRkaW5nIGFuZCByZW1vdmluZyBldmVudCBsaXN0ZW5lcnMuXHJcbiAgICovXG5cblxuICB2YXIgb24sIHVuO1xuXG4gIGlmIChpc0hvc3RNZXRob2Qod2luZG93LCBcImFkZEV2ZW50TGlzdGVuZXJcIikpIHtcbiAgICBvbiA9IGZ1bmN0aW9uIG9uKHRhcmdldCwgdHlwZSwgbGlzdGVuZXIpIHtcbiAgICAgIHRhcmdldC5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyLCBmYWxzZSk7XG4gICAgfTtcblxuICAgIHVuID0gZnVuY3Rpb24gdW4odGFyZ2V0LCB0eXBlLCBsaXN0ZW5lcikge1xuICAgICAgdGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIsIGZhbHNlKTtcbiAgICB9O1xuICB9IGVsc2UgaWYgKGlzSG9zdE1ldGhvZCh3aW5kb3csIFwiYXR0YWNoRXZlbnRcIikpIHtcbiAgICBvbiA9IGZ1bmN0aW9uIG9uKG9iamVjdCwgc0V2ZW50LCBmcE5vdGlmeSkge1xuICAgICAgb2JqZWN0LmF0dGFjaEV2ZW50KFwib25cIiArIHNFdmVudCwgZnBOb3RpZnkpO1xuICAgIH07XG5cbiAgICB1biA9IGZ1bmN0aW9uIHVuKG9iamVjdCwgc0V2ZW50LCBmcE5vdGlmeSkge1xuICAgICAgb2JqZWN0LmRldGFjaEV2ZW50KFwib25cIiArIHNFdmVudCwgZnBOb3RpZnkpO1xuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQnJvd3NlciBub3Qgc3VwcG9ydGVkXCIpO1xuICB9XG4gIC8qXHJcbiAgICogQ3Jvc3MgQnJvd3NlciBpbXBsZW1lbnRhdGlvbiBvZiBET01Db250ZW50TG9hZGVkLlxyXG4gICAqL1xuXG5cbiAgdmFyIGRvbUlzUmVhZHkgPSBmYWxzZSxcbiAgICAgIGRvbVJlYWR5UXVldWUgPSBbXSxcbiAgICAgIHJlYWR5U3RhdGU7XG5cbiAgaWYgKFwicmVhZHlTdGF0ZVwiIGluIGRvY3VtZW50KSB7XG4gICAgLy8gSWYgYnJvd3NlciBpcyBXZWJLaXQtcG93ZXJlZCwgY2hlY2sgZm9yIGJvdGggJ2xvYWRlZCcgKGxlZ2FjeSBicm93c2VycykgYW5kXG4gICAgLy8gJ2ludGVyYWN0aXZlJyAoSFRNTDUgc3BlY3MsIHJlY2VudCBXZWJLaXQgYnVpbGRzKSBzdGF0ZXMuXG4gICAgLy8gaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTQ1MTE5XG4gICAgcmVhZHlTdGF0ZSA9IGRvY3VtZW50LnJlYWR5U3RhdGU7XG4gICAgZG9tSXNSZWFkeSA9IHJlYWR5U3RhdGUgPT0gXCJjb21wbGV0ZVwiIHx8IH5uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ0FwcGxlV2ViS2l0LycpICYmIChyZWFkeVN0YXRlID09IFwibG9hZGVkXCIgfHwgcmVhZHlTdGF0ZSA9PSBcImludGVyYWN0aXZlXCIpO1xuICB9IGVsc2Uge1xuICAgIC8vIElmIHJlYWR5U3RhdGUgaXMgbm90IHN1cHBvcnRlZCBpbiB0aGUgYnJvd3NlciwgdGhlbiBpbiBvcmRlciB0byBiZSBhYmxlIHRvIGZpcmUgd2hlblJlYWR5IGZ1bmN0aW9ucyBhcHJvcHJpYXRlbHlcbiAgICAvLyB3aGVuIGFkZGVkIGR5bmFtaWNhbGx5IF9hZnRlcl8gRE9NIGxvYWQsIHdlIGhhdmUgdG8gZGVkdWNlIHdldGhlciB0aGUgRE9NIGlzIHJlYWR5IG9yIG5vdC5cbiAgICAvLyBXZSBvbmx5IG5lZWQgYSBib2R5IHRvIGFkZCBlbGVtZW50cyB0bywgc28gdGhlIGV4aXN0ZW5jZSBvZiBkb2N1bWVudC5ib2R5IGlzIGVub3VnaCBmb3IgdXMuXG4gICAgZG9tSXNSZWFkeSA9ICEhZG9jdW1lbnQuYm9keTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGRvbV9vblJlYWR5KCkge1xuICAgIGlmIChkb21Jc1JlYWR5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZG9tSXNSZWFkeSA9IHRydWU7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRvbVJlYWR5UXVldWUubGVuZ3RoOyBpKyspIHtcbiAgICAgIGRvbVJlYWR5UXVldWVbaV0oKTtcbiAgICB9XG5cbiAgICBkb21SZWFkeVF1ZXVlLmxlbmd0aCA9IDA7XG4gIH1cblxuICBpZiAoIWRvbUlzUmVhZHkpIHtcbiAgICBpZiAoaXNIb3N0TWV0aG9kKHdpbmRvdywgXCJhZGRFdmVudExpc3RlbmVyXCIpKSB7XG4gICAgICBvbihkb2N1bWVudCwgXCJET01Db250ZW50TG9hZGVkXCIsIGRvbV9vblJlYWR5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgb24oZG9jdW1lbnQsIFwicmVhZHlzdGF0ZWNoYW5nZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09IFwiY29tcGxldGVcIikge1xuICAgICAgICAgIGRvbV9vblJlYWR5KCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBpZiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmRvU2Nyb2xsICYmIHdpbmRvdyA9PT0gdG9wKSB7XG4gICAgICAgIHZhciBkb1Njcm9sbENoZWNrID0gZnVuY3Rpb24gZG9TY3JvbGxDaGVjaygpIHtcbiAgICAgICAgICBpZiAoZG9tSXNSZWFkeSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH0gLy8gaHR0cDovL2phdmFzY3JpcHQubndib3guY29tL0lFQ29udGVudExvYWRlZC9cblxuXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5kb1Njcm9sbChcImxlZnRcIik7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgc2V0VGltZW91dChkb1Njcm9sbENoZWNrLCAxKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBkb21fb25SZWFkeSgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGRvU2Nyb2xsQ2hlY2soKTtcbiAgICAgIH1cbiAgICB9IC8vIEEgZmFsbGJhY2sgdG8gd2luZG93Lm9ubG9hZCwgdGhhdCB3aWxsIGFsd2F5cyB3b3JrXG5cblxuICAgIG9uKHdpbmRvdywgXCJsb2FkXCIsIGRvbV9vblJlYWR5KTtcbiAgfVxuICAvKipcclxuICAgKiBUaGlzIHdpbGwgYWRkIGEgZnVuY3Rpb24gdG8gdGhlIHF1ZXVlIG9mIGZ1bmN0aW9ucyB0byBiZSBydW4gb25jZSB0aGUgRE9NIHJlYWNoZXMgYSByZWFkeSBzdGF0ZS5cclxuICAgKiBJZiBmdW5jdGlvbnMgYXJlIGFkZGVkIGFmdGVyIHRoaXMgZXZlbnQgdGhlbiB0aGV5IHdpbGwgYmUgZXhlY3V0ZWQgaW1tZWRpYXRlbHkuXHJcbiAgICogQHBhcmFtIHtmdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGFkZFxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBzY29wZSBBbiBvcHRpb25hbCBzY29wZSBmb3IgdGhlIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCB3aXRoLlxyXG4gICAqL1xuXG5cbiAgZnVuY3Rpb24gd2hlblJlYWR5KGZuLCBzY29wZSkge1xuICAgIGlmIChkb21Jc1JlYWR5KSB7XG4gICAgICBmbi5jYWxsKHNjb3BlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBkb21SZWFkeVF1ZXVlLnB1c2goZnVuY3Rpb24gKCkge1xuICAgICAgZm4uY2FsbChzY29wZSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXHJcbiAgICogUmV0dXJucyBhbiBpbnN0YW5jZSBvZiBlYXN5WERNIGZyb20gdGhlIHBhcmVudCB3aW5kb3cgd2l0aFxyXG4gICAqIHJlc3BlY3QgdG8gdGhlIG5hbWVzcGFjZS5cclxuICAgKlxyXG4gICAqIEByZXR1cm4gQW4gaW5zdGFuY2Ugb2YgZWFzeVhETSAoaW4gdGhlIHBhcmVudCB3aW5kb3cpXHJcbiAgICovXG5cblxuICBmdW5jdGlvbiBnZXRQYXJlbnRPYmplY3QoKSB7XG4gICAgdmFyIG9iaiA9IHBhcmVudDtcblxuICAgIGlmIChuYW1lc3BhY2UgIT09IFwiXCIpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IG5hbWVzcGFjZS5zcGxpdChcIi5cIik7IGkgPCBpaS5sZW5ndGg7IGkrKykge1xuICAgICAgICBvYmogPSBvYmpbaWlbaV1dO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBvYmouZWFzeVhETTtcbiAgfVxuICAvKipcclxuICAgKiBSZW1vdmVzIGVhc3lYRE0gdmFyaWFibGUgZnJvbSB0aGUgZ2xvYmFsIHNjb3BlLiBJdCBhbHNvIHJldHVybnMgY29udHJvbFxyXG4gICAqIG9mIHRoZSBlYXN5WERNIHZhcmlhYmxlIHRvIHdoYXRldmVyIGNvZGUgdXNlZCBpdCBiZWZvcmUuXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge1N0cmluZ30gbnMgQSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYW4gb2JqZWN0IHRoYXQgd2lsbCBob2xkXHJcbiAgICogICAgICAgICAgICAgICAgICAgIGFuIGluc3RhbmNlIG9mIGVhc3lYRE0uXHJcbiAgICogQHJldHVybiBBbiBpbnN0YW5jZSBvZiBlYXN5WERNXHJcbiAgICovXG5cblxuICBmdW5jdGlvbiBub0NvbmZsaWN0KG5zKSB7XG4gICAgd2luZG93LmVhc3lYRE0gPSBfZWFzeVhETTtcbiAgICBuYW1lc3BhY2UgPSBucztcblxuICAgIGlmIChuYW1lc3BhY2UpIHtcbiAgICAgIElGUkFNRV9QUkVGSVggPSBcImVhc3lYRE1fXCIgKyBuYW1lc3BhY2UucmVwbGFjZShcIi5cIiwgXCJfXCIpICsgXCJfXCI7XG4gICAgfVxuXG4gICAgcmV0dXJuIGVhc3lYRE07XG4gIH1cbiAgLypcclxuICAgKiBNZXRob2RzIGZvciB3b3JraW5nIHdpdGggVVJMc1xyXG4gICAqL1xuXG4gIC8qKlxyXG4gICAqIEdldCB0aGUgZG9tYWluIG5hbWUgZnJvbSBhIHVybC5cclxuICAgKiBAcGFyYW0ge1N0cmluZ30gdXJsIFRoZSB1cmwgdG8gZXh0cmFjdCB0aGUgZG9tYWluIGZyb20uXHJcbiAgICogQHJldHVybiBUaGUgZG9tYWluIHBhcnQgb2YgdGhlIHVybC5cclxuICAgKiBAdHlwZSB7U3RyaW5nfVxyXG4gICAqL1xuXG5cbiAgZnVuY3Rpb24gZ2V0RG9tYWluTmFtZSh1cmwpIHtcbiAgICByZXR1cm4gdXJsLm1hdGNoKHJlVVJJKVszXTtcbiAgfVxuICAvKipcclxuICAgKiBHZXQgdGhlIHBvcnQgZm9yIGEgZ2l2ZW4gVVJMLCBvciBcIlwiIGlmIG5vbmVcclxuICAgKiBAcGFyYW0ge1N0cmluZ30gdXJsIFRoZSB1cmwgdG8gZXh0cmFjdCB0aGUgcG9ydCBmcm9tLlxyXG4gICAqIEByZXR1cm4gVGhlIHBvcnQgcGFydCBvZiB0aGUgdXJsLlxyXG4gICAqIEB0eXBlIHtTdHJpbmd9XHJcbiAgICovXG5cblxuICBmdW5jdGlvbiBnZXRQb3J0KHVybCkge1xuICAgIHJldHVybiB1cmwubWF0Y2gocmVVUkkpWzRdIHx8IFwiXCI7XG4gIH1cbiAgLyoqXHJcbiAgICogUmV0dXJucyAgYSBzdHJpbmcgY29udGFpbmluZyB0aGUgc2NoZW1hLCBkb21haW4gYW5kIGlmIHByZXNlbnQgdGhlIHBvcnRcclxuICAgKiBAcGFyYW0ge1N0cmluZ30gdXJsIFRoZSB1cmwgdG8gZXh0cmFjdCB0aGUgbG9jYXRpb24gZnJvbVxyXG4gICAqIEByZXR1cm4ge1N0cmluZ30gVGhlIGxvY2F0aW9uIHBhcnQgb2YgdGhlIHVybFxyXG4gICAqL1xuXG5cbiAgZnVuY3Rpb24gZ2V0TG9jYXRpb24odXJsKSB7XG4gICAgdmFyIG0gPSB1cmwudG9Mb3dlckNhc2UoKS5tYXRjaChyZVVSSSk7XG4gICAgdmFyIHByb3RvID0gbVsyXSxcbiAgICAgICAgZG9tYWluID0gbVszXSxcbiAgICAgICAgcG9ydCA9IG1bNF0gfHwgXCJcIjtcblxuICAgIGlmIChwcm90byA9PSBcImh0dHA6XCIgJiYgcG9ydCA9PSBcIjo4MFwiIHx8IHByb3RvID09IFwiaHR0cHM6XCIgJiYgcG9ydCA9PSBcIjo0NDNcIikge1xuICAgICAgcG9ydCA9IFwiXCI7XG4gICAgfVxuXG4gICAgcmV0dXJuIHByb3RvICsgXCIvL1wiICsgZG9tYWluICsgcG9ydDtcbiAgfVxuICAvKipcclxuICAgKiBSZXNvbHZlcyBhIHJlbGF0aXZlIHVybCBpbnRvIGFuIGFic29sdXRlIG9uZS5cclxuICAgKiBAcGFyYW0ge1N0cmluZ30gdXJsIFRoZSBwYXRoIHRvIHJlc29sdmUuXHJcbiAgICogQHJldHVybiB7U3RyaW5nfSBUaGUgcmVzb2x2ZWQgdXJsLlxyXG4gICAqL1xuXG5cbiAgZnVuY3Rpb24gcmVzb2x2ZVVybCh1cmwpIHtcbiAgICAvLyByZXBsYWNlIGFsbCAvLyBleGNlcHQgdGhlIG9uZSBpbiBwcm90byB3aXRoIC9cbiAgICB1cmwgPSB1cmwucmVwbGFjZShyZURvdWJsZVNsYXNoLCBcIiQxL1wiKTsgLy8gSWYgdGhlIHVybCBpcyBhIHZhbGlkIHVybCB3ZSBkbyBub3RoaW5nXG5cbiAgICBpZiAoIXVybC5tYXRjaCgvXihodHRwfHxodHRwcyk6XFwvXFwvLykpIHtcbiAgICAgIC8vIElmIHRoaXMgaXMgYSByZWxhdGl2ZSBwYXRoXG4gICAgICB2YXIgcGF0aCA9IHVybC5zdWJzdHJpbmcoMCwgMSkgPT09IFwiL1wiID8gXCJcIiA6IGxvY2F0aW9uLnBhdGhuYW1lO1xuXG4gICAgICBpZiAocGF0aC5zdWJzdHJpbmcocGF0aC5sZW5ndGggLSAxKSAhPT0gXCIvXCIpIHtcbiAgICAgICAgcGF0aCA9IHBhdGguc3Vic3RyaW5nKDAsIHBhdGgubGFzdEluZGV4T2YoXCIvXCIpICsgMSk7XG4gICAgICB9XG5cbiAgICAgIHVybCA9IGxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgbG9jYXRpb24uaG9zdCArIHBhdGggKyB1cmw7XG4gICAgfSAvLyByZWR1Y2UgYWxsICd4eXovLi4vJyB0byBqdXN0ICcnXG5cblxuICAgIHdoaWxlIChyZVBhcmVudC50ZXN0KHVybCkpIHtcbiAgICAgIHVybCA9IHVybC5yZXBsYWNlKHJlUGFyZW50LCBcIlwiKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdXJsO1xuICB9XG4gIC8qKlxyXG4gICAqIEFwcGVuZHMgdGhlIHBhcmFtZXRlcnMgdG8gdGhlIGdpdmVuIHVybC48YnIvPlxyXG4gICAqIFRoZSBiYXNlIHVybCBjYW4gY29udGFpbiBleGlzdGluZyBxdWVyeSBwYXJhbWV0ZXJzLlxyXG4gICAqIEBwYXJhbSB7U3RyaW5nfSB1cmwgVGhlIGJhc2UgdXJsLlxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbWV0ZXJzIFRoZSBwYXJhbWV0ZXJzIHRvIGFkZC5cclxuICAgKiBAcmV0dXJuIHtTdHJpbmd9IEEgbmV3IHZhbGlkIHVybCB3aXRoIHRoZSBwYXJhbWV0ZXJzIGFwcGVuZGVkLlxyXG4gICAqL1xuXG5cbiAgZnVuY3Rpb24gYXBwZW5kUXVlcnlQYXJhbWV0ZXJzKHVybCwgcGFyYW1ldGVycykge1xuICAgIHZhciBoYXNoID0gXCJcIixcbiAgICAgICAgaW5kZXhPZiA9IHVybC5pbmRleE9mKFwiI1wiKTtcblxuICAgIGlmIChpbmRleE9mICE9PSAtMSkge1xuICAgICAgaGFzaCA9IHVybC5zdWJzdHJpbmcoaW5kZXhPZik7XG4gICAgICB1cmwgPSB1cmwuc3Vic3RyaW5nKDAsIGluZGV4T2YpO1xuICAgIH1cblxuICAgIHZhciBxID0gW107XG5cbiAgICBmb3IgKHZhciBrZXkgaW4gcGFyYW1ldGVycykge1xuICAgICAgaWYgKHBhcmFtZXRlcnMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICBxLnB1c2goa2V5ICsgXCI9XCIgKyBlbmNvZGVVUklDb21wb25lbnQocGFyYW1ldGVyc1trZXldKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHVybCArICh1c2VIYXNoID8gXCIjXCIgOiB1cmwuaW5kZXhPZihcIj9cIikgPT0gLTEgPyBcIj9cIiA6IFwiJlwiKSArIHEuam9pbihcIiZcIikgKyBoYXNoO1xuICB9IC8vIGJ1aWxkIHRoZSBxdWVyeSBvYmplY3QgZWl0aGVyIGZyb20gbG9jYXRpb24ucXVlcnksIGlmIGl0IGNvbnRhaW5zIHRoZSB4ZG1fZSBhcmd1bWVudCwgb3IgZnJvbSBsb2NhdGlvbi5oYXNoXG5cblxuICB2YXIgcXVlcnkgPSBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICBpbnB1dCA9IGlucHV0LnN1YnN0cmluZygxKS5zcGxpdChcIiZcIik7XG4gICAgdmFyIGRhdGEgPSB7fSxcbiAgICAgICAgcGFpcixcbiAgICAgICAgaSA9IGlucHV0Lmxlbmd0aDtcblxuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgIHBhaXIgPSBpbnB1dFtpXS5zcGxpdChcIj1cIik7XG4gICAgICBkYXRhW3BhaXJbMF1dID0gZGVjb2RlVVJJQ29tcG9uZW50KHBhaXJbMV0pO1xuICAgIH1cblxuICAgIHJldHVybiBkYXRhO1xuICB9KC94ZG1fZT0vLnRlc3QobG9jYXRpb24uc2VhcmNoKSA/IGxvY2F0aW9uLnNlYXJjaCA6IGxvY2F0aW9uLmhhc2gpO1xuICAvKlxyXG4gICAqIEhlbHBlciBtZXRob2RzXHJcbiAgICovXG5cbiAgLyoqXHJcbiAgICogSGVscGVyIGZvciBjaGVja2luZyBpZiBhIHZhcmlhYmxlL3Byb3BlcnR5IGlzIHVuZGVmaW5lZFxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSB2IFRoZSB2YXJpYWJsZSB0byB0ZXN0XHJcbiAgICogQHJldHVybiB7Qm9vbGVhbn0gVHJ1ZSBpZiB0aGUgcGFzc2VkIHZhcmlhYmxlIGlzIHVuZGVmaW5lZFxyXG4gICAqL1xuXG5cbiAgZnVuY3Rpb24gdW5kZWYodikge1xuICAgIHJldHVybiB0eXBlb2YgdiA9PT0gXCJ1bmRlZmluZWRcIjtcbiAgfVxuICAvKipcclxuICAgKiBBIHNhZmUgaW1wbGVtZW50YXRpb24gb2YgSFRNTDUgSlNPTi4gRmVhdHVyZSB0ZXN0aW5nIGlzIHVzZWQgdG8gbWFrZSBzdXJlIHRoZSBpbXBsZW1lbnRhdGlvbiB3b3Jrcy5cclxuICAgKiBAcmV0dXJuIHtKU09OfSBBIHZhbGlkIEpTT04gY29uZm9ybWluZyBvYmplY3QsIG9yIG51bGwgaWYgbm90IGZvdW5kLlxyXG4gICAqL1xuXG5cbiAgdmFyIF9nZXRKU09OID0gZnVuY3Rpb24gZ2V0SlNPTigpIHtcbiAgICB2YXIgY2FjaGVkID0ge307XG4gICAgdmFyIG9iaiA9IHtcbiAgICAgIGE6IFsxLCAyLCAzXVxuICAgIH0sXG4gICAgICAgIGpzb24gPSBcIntcXFwiYVxcXCI6WzEsMiwzXX1cIjtcblxuICAgIGlmICh0eXBlb2YgSlNPTiAhPSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBKU09OLnN0cmluZ2lmeSA9PT0gXCJmdW5jdGlvblwiICYmIEpTT04uc3RyaW5naWZ5KG9iaikucmVwbGFjZSgvXFxzL2csIFwiXCIpID09PSBqc29uKSB7XG4gICAgICAvLyB0aGlzIGlzIGEgd29ya2luZyBKU09OIGluc3RhbmNlXG4gICAgICByZXR1cm4gSlNPTjtcbiAgICB9XG5cbiAgICBpZiAoT2JqZWN0LnRvSlNPTikge1xuICAgICAgaWYgKE9iamVjdC50b0pTT04ob2JqKS5yZXBsYWNlKC9cXHMvZywgXCJcIikgPT09IGpzb24pIHtcbiAgICAgICAgLy8gdGhpcyBpcyBhIHdvcmtpbmcgc3RyaW5naWZ5IG1ldGhvZFxuICAgICAgICBjYWNoZWQuc3RyaW5naWZ5ID0gT2JqZWN0LnRvSlNPTjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIFN0cmluZy5wcm90b3R5cGUuZXZhbEpTT04gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgb2JqID0ganNvbi5ldmFsSlNPTigpO1xuXG4gICAgICBpZiAob2JqLmEgJiYgb2JqLmEubGVuZ3RoID09PSAzICYmIG9iai5hWzJdID09PSAzKSB7XG4gICAgICAgIC8vIHRoaXMgaXMgYSB3b3JraW5nIHBhcnNlIG1ldGhvZFxuICAgICAgICBjYWNoZWQucGFyc2UgPSBmdW5jdGlvbiAoc3RyKSB7XG4gICAgICAgICAgcmV0dXJuIHN0ci5ldmFsSlNPTigpO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChjYWNoZWQuc3RyaW5naWZ5ICYmIGNhY2hlZC5wYXJzZSkge1xuICAgICAgLy8gT25seSBtZW1vaXplIHRoZSByZXN1bHQgaWYgd2UgaGF2ZSB2YWxpZCBpbnN0YW5jZVxuICAgICAgX2dldEpTT04gPSBmdW5jdGlvbiBnZXRKU09OKCkge1xuICAgICAgICByZXR1cm4gY2FjaGVkO1xuICAgICAgfTtcblxuICAgICAgcmV0dXJuIGNhY2hlZDtcbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfTtcbiAgLyoqXHJcbiAgICogQXBwbGllcyBwcm9wZXJ0aWVzIGZyb20gdGhlIHNvdXJjZSBvYmplY3QgdG8gdGhlIHRhcmdldCBvYmplY3QuPGJyLz5cclxuICAgKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0IFRoZSB0YXJnZXQgb2YgdGhlIHByb3BlcnRpZXMuXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IHNvdXJjZSBUaGUgc291cmNlIG9mIHRoZSBwcm9wZXJ0aWVzLlxyXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gbm9PdmVyd3JpdGUgU2V0IHRvIFRydWUgdG8gb25seSBzZXQgbm9uLWV4aXN0aW5nIHByb3BlcnRpZXMuXHJcbiAgICovXG5cblxuICBmdW5jdGlvbiBhcHBseShkZXN0aW5hdGlvbiwgc291cmNlLCBub092ZXJ3cml0ZSkge1xuICAgIHZhciBtZW1iZXI7XG5cbiAgICBmb3IgKHZhciBwcm9wIGluIHNvdXJjZSkge1xuICAgICAgaWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShwcm9wKSkge1xuICAgICAgICBpZiAocHJvcCBpbiBkZXN0aW5hdGlvbikge1xuICAgICAgICAgIG1lbWJlciA9IHNvdXJjZVtwcm9wXTtcblxuICAgICAgICAgIGlmIChfdHlwZW9mKG1lbWJlcikgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgIGFwcGx5KGRlc3RpbmF0aW9uW3Byb3BdLCBtZW1iZXIsIG5vT3ZlcndyaXRlKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKCFub092ZXJ3cml0ZSkge1xuICAgICAgICAgICAgZGVzdGluYXRpb25bcHJvcF0gPSBzb3VyY2VbcHJvcF07XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRlc3RpbmF0aW9uW3Byb3BdID0gc291cmNlW3Byb3BdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGRlc3RpbmF0aW9uO1xuICB9IC8vIFRoaXMgdGVzdHMgZm9yIHRoZSBidWcgaW4gSUUgd2hlcmUgc2V0dGluZyB0aGUgW25hbWVdIHByb3BlcnR5IHVzaW5nIGphdmFzY3JpcHQgY2F1c2VzIHRoZSB2YWx1ZSB0byBiZSByZWRpcmVjdGVkIGludG8gW3N1Ym1pdE5hbWVdLlxuXG5cbiAgZnVuY3Rpb24gdGVzdEZvck5hbWVQcm9wZXJ0eUJ1ZygpIHtcbiAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImZvcm1cIikpLFxuICAgICAgICBpbnB1dCA9IGZvcm0uYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpKTtcbiAgICBpbnB1dC5uYW1lID0gSUZSQU1FX1BSRUZJWCArIFwiVEVTVFwiICsgY2hhbm5lbElkOyAvLyBhcHBlbmQgY2hhbm5lbElkIGluIG9yZGVyIHRvIGF2b2lkIGNhY2hpbmcgaXNzdWVzXG5cbiAgICBIQVNfTkFNRV9QUk9QRVJUWV9CVUcgPSBpbnB1dCAhPT0gZm9ybS5lbGVtZW50c1tpbnB1dC5uYW1lXTtcbiAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGZvcm0pO1xuICB9XG4gIC8qKlxyXG4gICAqIENyZWF0ZXMgYSBmcmFtZSBhbmQgYXBwZW5kcyBpdCB0byB0aGUgRE9NLlxyXG4gICAqIEBwYXJhbSBjb25maWcge29iamVjdH0gVGhpcyBvYmplY3QgY2FuIGhhdmUgdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzXHJcbiAgICogPHVsPlxyXG4gICAqIDxsaT4ge29iamVjdH0gcHJvcCBUaGUgcHJvcGVydGllcyB0aGF0IHNob3VsZCBiZSBzZXQgb24gdGhlIGZyYW1lLiBUaGlzIHNob3VsZCBpbmNsdWRlIHRoZSAnc3JjJyBwcm9wZXJ0eS48L2xpPlxyXG4gICAqIDxsaT4ge29iamVjdH0gYXR0ciBUaGUgYXR0cmlidXRlcyB0aGF0IHNob3VsZCBiZSBzZXQgb24gdGhlIGZyYW1lLjwvbGk+XHJcbiAgICogPGxpPiB7RE9NRWxlbWVudH0gY29udGFpbmVyIEl0cyBwYXJlbnQgZWxlbWVudCAoT3B0aW9uYWwpLjwvbGk+XHJcbiAgICogPGxpPiB7ZnVuY3Rpb259IG9uTG9hZCBBIG1ldGhvZCB0aGF0IHNob3VsZCBiZSBjYWxsZWQgd2l0aCB0aGUgZnJhbWVzIGNvbnRlbnRXaW5kb3cgYXMgYXJndW1lbnQgd2hlbiB0aGUgZnJhbWUgaXMgZnVsbHkgbG9hZGVkLiAoT3B0aW9uYWwpPC9saT5cclxuICAgKiA8L3VsPlxyXG4gICAqIEByZXR1cm4gVGhlIGZyYW1lcyBET01FbGVtZW50XHJcbiAgICogQHR5cGUgRE9NRWxlbWVudFxyXG4gICAqL1xuXG5cbiAgZnVuY3Rpb24gY3JlYXRlRnJhbWUoY29uZmlnKSB7XG4gICAgaWYgKHVuZGVmKEhBU19OQU1FX1BST1BFUlRZX0JVRykpIHtcbiAgICAgIHRlc3RGb3JOYW1lUHJvcGVydHlCdWcoKTtcbiAgICB9XG5cbiAgICB2YXIgZnJhbWU7IC8vIFRoaXMgaXMgdG8gd29yayBhcm91bmQgdGhlIHByb2JsZW1zIGluIElFNi83IHdpdGggc2V0dGluZyB0aGUgbmFtZSBwcm9wZXJ0eS5cbiAgICAvLyBJbnRlcm5hbGx5IHRoaXMgaXMgc2V0IGFzICdzdWJtaXROYW1lJyBpbnN0ZWFkIHdoZW4gdXNpbmcgJ2lmcmFtZS5uYW1lID0gLi4uJ1xuICAgIC8vIFRoaXMgaXMgbm90IHJlcXVpcmVkIGJ5IGVhc3lYRE0gaXRzZWxmLCBidXQgaXMgdG8gZmFjaWxpdGF0ZSBvdGhlciB1c2UgY2FzZXNcblxuICAgIGlmIChIQVNfTkFNRV9QUk9QRVJUWV9CVUcpIHtcbiAgICAgIGZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIjxpZnJhbWUgbmFtZT1cXFwiXCIgKyBjb25maWcucHJvcHMubmFtZSArIFwiXFxcIi8+XCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJJRlJBTUVcIik7XG4gICAgICBmcmFtZS5uYW1lID0gY29uZmlnLnByb3BzLm5hbWU7XG4gICAgfVxuXG4gICAgZnJhbWUuaWQgPSBmcmFtZS5uYW1lID0gY29uZmlnLnByb3BzLm5hbWU7XG4gICAgZGVsZXRlIGNvbmZpZy5wcm9wcy5uYW1lO1xuXG4gICAgaWYgKHR5cGVvZiBjb25maWcuY29udGFpbmVyID09IFwic3RyaW5nXCIpIHtcbiAgICAgIGNvbmZpZy5jb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25maWcuY29udGFpbmVyKTtcbiAgICB9XG5cbiAgICBpZiAoIWNvbmZpZy5jb250YWluZXIpIHtcbiAgICAgIC8vIFRoaXMgbmVlZHMgdG8gYmUgaGlkZGVuIGxpa2UgdGhpcywgc2ltcGx5IHNldHRpbmcgZGlzcGxheTpub25lIGFuZCB0aGUgbGlrZSB3aWxsIGNhdXNlIGZhaWx1cmVzIGluIHNvbWUgYnJvd3NlcnMuXG4gICAgICBhcHBseShmcmFtZS5zdHlsZSwge1xuICAgICAgICBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLFxuICAgICAgICB0b3A6IFwiLTIwMDBweFwiLFxuICAgICAgICAvLyBBdm9pZCBwb3RlbnRpYWwgaG9yaXpvbnRhbCBzY3JvbGxiYXJcbiAgICAgICAgbGVmdDogXCIwcHhcIlxuICAgICAgfSk7XG4gICAgICBjb25maWcuY29udGFpbmVyID0gZG9jdW1lbnQuYm9keTtcbiAgICB9IC8vIEhBQ0s6IElFIGNhbm5vdCBoYXZlIHRoZSBzcmMgYXR0cmlidXRlIHNldCB3aGVuIHRoZSBmcmFtZSBpcyBhcHBlbmRlZFxuICAgIC8vICAgICAgIGludG8gdGhlIGNvbnRhaW5lciwgc28gd2Ugc2V0IGl0IHRvIFwiamF2YXNjcmlwdDpmYWxzZVwiIGFzIGFcbiAgICAvLyAgICAgICBwbGFjZWhvbGRlciBmb3Igbm93LiAgSWYgd2UgbGVmdCB0aGUgc3JjIHVuZGVmaW5lZCwgaXQgd291bGRcbiAgICAvLyAgICAgICBpbnN0ZWFkIGRlZmF1bHQgdG8gXCJhYm91dDpibGFua1wiLCB3aGljaCBjYXVzZXMgU1NMIG1peGVkLWNvbnRlbnRcbiAgICAvLyAgICAgICB3YXJuaW5ncyBpbiBJRTYgd2hlbiBvbiBhbiBTU0wgcGFyZW50IHBhZ2UuXG5cblxuICAgIHZhciBzcmMgPSBjb25maWcucHJvcHMuc3JjO1xuICAgIGNvbmZpZy5wcm9wcy5zcmMgPSBcImphdmFzY3JpcHQ6ZmFsc2VcIjsgLy8gdHJhbnNmZXIgcHJvcGVydGllcyB0byB0aGUgZnJhbWVcblxuICAgIGFwcGx5KGZyYW1lLCBjb25maWcucHJvcHMpO1xuICAgIGZyYW1lLmJvcmRlciA9IGZyYW1lLmZyYW1lQm9yZGVyID0gMDtcbiAgICBmcmFtZS5hbGxvd1RyYW5zcGFyZW5jeSA9IHRydWU7XG4gICAgY29uZmlnLmNvbnRhaW5lci5hcHBlbmRDaGlsZChmcmFtZSk7XG5cbiAgICBpZiAoY29uZmlnLm9uTG9hZCkge1xuICAgICAgb24oZnJhbWUsIFwibG9hZFwiLCBjb25maWcub25Mb2FkKTtcbiAgICB9IC8vIHNldCB0aGUgZnJhbWUgVVJMIHRvIHRoZSBwcm9wZXIgdmFsdWUgKHdlIHByZXZpb3VzbHkgc2V0IGl0IHRvXG4gICAgLy8gXCJqYXZhc2NyaXB0OmZhbHNlXCIgdG8gd29yayBhcm91bmQgdGhlIElFIGlzc3VlIG1lbnRpb25lZCBhYm92ZSlcblxuXG4gICAgaWYgKGNvbmZpZy51c2VQb3N0KSB7XG4gICAgICB2YXIgZm9ybSA9IGNvbmZpZy5jb250YWluZXIuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9ybScpKSxcbiAgICAgICAgICBpbnB1dDtcbiAgICAgIGZvcm0udGFyZ2V0ID0gZnJhbWUubmFtZTtcbiAgICAgIGZvcm0uYWN0aW9uID0gc3JjO1xuICAgICAgZm9ybS5tZXRob2QgPSAnUE9TVCc7XG5cbiAgICAgIGlmIChfdHlwZW9mKGNvbmZpZy51c2VQb3N0KSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgZm9yICh2YXIgaSBpbiBjb25maWcudXNlUG9zdCkge1xuICAgICAgICAgIGlmIChjb25maWcudXNlUG9zdC5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICAgICAgaWYgKEhBU19OQU1FX1BST1BFUlRZX0JVRykge1xuICAgICAgICAgICAgICBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJzxpbnB1dCBuYW1lPVwiJyArIGkgKyAnXCIvPicpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiSU5QVVRcIik7XG4gICAgICAgICAgICAgIGlucHV0Lm5hbWUgPSBpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpbnB1dC52YWx1ZSA9IGNvbmZpZy51c2VQb3N0W2ldO1xuICAgICAgICAgICAgZm9ybS5hcHBlbmRDaGlsZChpbnB1dCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZvcm0uc3VibWl0KCk7XG4gICAgICBmb3JtLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZm9ybSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZyYW1lLnNyYyA9IHNyYztcbiAgICB9XG5cbiAgICBjb25maWcucHJvcHMuc3JjID0gc3JjO1xuICAgIHJldHVybiBmcmFtZTtcbiAgfVxuICAvKipcclxuICAgKiBDaGVjayB3aGV0aGVyIGEgZG9tYWluIGlzIGFsbG93ZWQgdXNpbmcgYW4gQWNjZXNzIENvbnRyb2wgTGlzdC5cclxuICAgKiBUaGUgQUNMIGNhbiBjb250YWluICogYW5kID8gYXMgd2lsZGNhcmRzLCBvciBjYW4gYmUgcmVndWxhciBleHByZXNzaW9ucy5cclxuICAgKiBJZiByZWd1bGFyIGV4cHJlc3Npb25zIHRoZXkgbmVlZCB0byBiZWdpbiB3aXRoIF4gYW5kIGVuZCB3aXRoICQuXHJcbiAgICogQHBhcmFtIHtBcnJheS9TdHJpbmd9IGFjbCBUaGUgbGlzdCBvZiBhbGxvd2VkIGRvbWFpbnNcclxuICAgKiBAcGFyYW0ge1N0cmluZ30gZG9tYWluIFRoZSBkb21haW4gdG8gdGVzdC5cclxuICAgKiBAcmV0dXJuIHtCb29sZWFufSBUcnVlIGlmIHRoZSBkb21haW4gaXMgYWxsb3dlZCwgZmFsc2UgaWYgbm90LlxyXG4gICAqL1xuXG5cbiAgZnVuY3Rpb24gY2hlY2tBY2woYWNsLCBkb21haW4pIHtcbiAgICAvLyBub3JtYWxpemUgaW50byBhbiBhcnJheVxuICAgIGlmICh0eXBlb2YgYWNsID09IFwic3RyaW5nXCIpIHtcbiAgICAgIGFjbCA9IFthY2xdO1xuICAgIH1cblxuICAgIHZhciByZSxcbiAgICAgICAgaSA9IGFjbC5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICByZSA9IGFjbFtpXTtcbiAgICAgIHJlID0gbmV3IFJlZ0V4cChyZS5zdWJzdHIoMCwgMSkgPT0gXCJeXCIgPyByZSA6IFwiXlwiICsgcmUucmVwbGFjZSgvKFxcKikvZywgXCIuJDFcIikucmVwbGFjZSgvXFw/L2csIFwiLlwiKSArIFwiJFwiKTtcblxuICAgICAgaWYgKHJlLnRlc3QoZG9tYWluKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgLypcclxuICAgKiBGdW5jdGlvbnMgcmVsYXRlZCB0byBzdGFja3NcclxuICAgKi9cblxuICAvKipcclxuICAgKiBQcmVwYXJlcyBhbiBhcnJheSBvZiBzdGFjay1lbGVtZW50cyBzdWl0YWJsZSBmb3IgdGhlIGN1cnJlbnQgY29uZmlndXJhdGlvblxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgVGhlIFRyYW5zcG9ydHMgY29uZmlndXJhdGlvbi4gU2VlIGVhc3lYRE0uU29ja2V0IGZvciBtb3JlLlxyXG4gICAqIEByZXR1cm4ge0FycmF5fSBBbiBhcnJheSBvZiBzdGFjay1lbGVtZW50cyB3aXRoIHRoZSBUcmFuc3BvcnRFbGVtZW50IGF0IGluZGV4IDAuXHJcbiAgICovXG5cblxuICBmdW5jdGlvbiBwcmVwYXJlVHJhbnNwb3J0U3RhY2soY29uZmlnKSB7XG4gICAgdmFyIHByb3RvY29sID0gY29uZmlnLnByb3RvY29sLFxuICAgICAgICBzdGFja0VscztcbiAgICBjb25maWcuaXNIb3N0ID0gY29uZmlnLmlzSG9zdCB8fCB1bmRlZihxdWVyeS54ZG1fcCk7XG4gICAgdXNlSGFzaCA9IGNvbmZpZy5oYXNoIHx8IGZhbHNlO1xuXG4gICAgaWYgKCFjb25maWcucHJvcHMpIHtcbiAgICAgIGNvbmZpZy5wcm9wcyA9IHt9O1xuICAgIH1cblxuICAgIGlmICghY29uZmlnLmlzSG9zdCkge1xuICAgICAgY29uZmlnLmNoYW5uZWwgPSBxdWVyeS54ZG1fYy5yZXBsYWNlKC9bXCInPD5cXFxcXS9nLCBcIlwiKTtcbiAgICAgIGNvbmZpZy5zZWNyZXQgPSBxdWVyeS54ZG1fcztcbiAgICAgIGNvbmZpZy5yZW1vdGUgPSBxdWVyeS54ZG1fZS5yZXBsYWNlKC9bXCInPD5cXFxcXS9nLCBcIlwiKTtcbiAgICAgIDtcbiAgICAgIHByb3RvY29sID0gcXVlcnkueGRtX3A7XG5cbiAgICAgIGlmIChjb25maWcuYWNsICYmICFjaGVja0FjbChjb25maWcuYWNsLCBjb25maWcucmVtb3RlKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBY2Nlc3MgZGVuaWVkIGZvciBcIiArIGNvbmZpZy5yZW1vdGUpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25maWcucmVtb3RlID0gcmVzb2x2ZVVybChjb25maWcucmVtb3RlKTtcbiAgICAgIGNvbmZpZy5jaGFubmVsID0gY29uZmlnLmNoYW5uZWwgfHwgXCJkZWZhdWx0XCIgKyBjaGFubmVsSWQrKztcbiAgICAgIGNvbmZpZy5zZWNyZXQgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDE2KS5zdWJzdHJpbmcoMik7XG5cbiAgICAgIGlmICh1bmRlZihwcm90b2NvbCkpIHtcbiAgICAgICAgaWYgKGdldExvY2F0aW9uKGxvY2F0aW9uLmhyZWYpID09IGdldExvY2F0aW9uKGNvbmZpZy5yZW1vdGUpKSB7XG4gICAgICAgICAgLypcclxuICAgICAgICAgICAqIEJvdGggZG9jdW1lbnRzIGhhcyB0aGUgc2FtZSBvcmlnaW4sIGxldHMgdXNlIGRpcmVjdCBhY2Nlc3MuXHJcbiAgICAgICAgICAgKi9cbiAgICAgICAgICBwcm90b2NvbCA9IFwiNFwiO1xuICAgICAgICB9IGVsc2UgaWYgKGlzSG9zdE1ldGhvZCh3aW5kb3csIFwicG9zdE1lc3NhZ2VcIikgfHwgaXNIb3N0TWV0aG9kKGRvY3VtZW50LCBcInBvc3RNZXNzYWdlXCIpKSB7XG4gICAgICAgICAgLypcclxuICAgICAgICAgICAqIFRoaXMgaXMgc3VwcG9ydGVkIGluIElFOCssIEZpcmVmb3ggMyssIE9wZXJhIDkrLCBDaHJvbWUgMisgYW5kIFNhZmFyaSA0K1xyXG4gICAgICAgICAgICovXG4gICAgICAgICAgcHJvdG9jb2wgPSBcIjFcIjtcbiAgICAgICAgfSBlbHNlIGlmIChjb25maWcuc3dmICYmIGlzSG9zdE1ldGhvZCh3aW5kb3csIFwiQWN0aXZlWE9iamVjdFwiKSAmJiBoYXNGbGFzaCgpKSB7XG4gICAgICAgICAgLypcclxuICAgICAgICAgICAqIFRoZSBGbGFzaCB0cmFuc3BvcnQgc3VwZXJzZWVkZXMgdGhlIE5peFRyYW5zcG9ydCBhcyB0aGUgTml4VHJhbnNwb3J0IGhhcyBiZWVuIGJsb2NrZWQgYnkgTVNcclxuICAgICAgICAgICAqL1xuICAgICAgICAgIHByb3RvY29sID0gXCI2XCI7XG4gICAgICAgIH0gZWxzZSBpZiAobmF2aWdhdG9yLnByb2R1Y3QgPT09IFwiR2Vja29cIiAmJiBcImZyYW1lRWxlbWVudFwiIGluIHdpbmRvdyAmJiBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ1dlYktpdCcpID09IC0xKSB7XG4gICAgICAgICAgLypcclxuICAgICAgICAgICAqIFRoaXMgaXMgc3VwcG9ydGVkIGluIEdlY2tvIChGaXJlZm94IDErKVxyXG4gICAgICAgICAgICovXG4gICAgICAgICAgcHJvdG9jb2wgPSBcIjVcIjtcbiAgICAgICAgfSBlbHNlIGlmIChjb25maWcucmVtb3RlSGVscGVyKSB7XG4gICAgICAgICAgLypcclxuICAgICAgICAgICAqIFRoaXMgaXMgc3VwcG9ydGVkIGluIGFsbCBicm93c2VycyB0aGF0IHJldGFpbnMgdGhlIHZhbHVlIG9mIHdpbmRvdy5uYW1lIHdoZW5cclxuICAgICAgICAgICAqIG5hdmlnYXRpbmcgZnJvbSBvbmUgZG9tYWluIHRvIGFub3RoZXIsIGFuZCB3aGVyZSBwYXJlbnQuZnJhbWVzW2Zvb10gY2FuIGJlIHVzZWRcclxuICAgICAgICAgICAqIHRvIGdldCBhY2Nlc3MgdG8gYSBmcmFtZSBmcm9tIHRoZSBzYW1lIGRvbWFpblxyXG4gICAgICAgICAgICovXG4gICAgICAgICAgcHJvdG9jb2wgPSBcIjJcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvKlxyXG4gICAgICAgICAgICogVGhpcyBpcyBzdXBwb3J0ZWQgaW4gYWxsIGJyb3dzZXJzIHdoZXJlIFt3aW5kb3ddLmxvY2F0aW9uIGlzIHdyaXRhYmxlIGZvciBhbGxcclxuICAgICAgICAgICAqIFRoZSByZXNpemUgZXZlbnQgd2lsbCBiZSB1c2VkIGlmIHJlc2l6ZSBpcyBzdXBwb3J0ZWQgYW5kIHRoZSBpZnJhbWUgaXMgbm90IHB1dFxyXG4gICAgICAgICAgICogaW50byBhIGNvbnRhaW5lciwgZWxzZSBwb2xsaW5nIHdpbGwgYmUgdXNlZC5cclxuICAgICAgICAgICAqL1xuICAgICAgICAgIHByb3RvY29sID0gXCIwXCI7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25maWcucHJvdG9jb2wgPSBwcm90b2NvbDsgLy8gZm9yIGNvbmRpdGlvbmFsIGJyYW5jaGluZ1xuXG4gICAgc3dpdGNoIChwcm90b2NvbCkge1xuICAgICAgY2FzZSBcIjBcIjpcbiAgICAgICAgLy8gMCA9IEhhc2hUcmFuc3BvcnRcbiAgICAgICAgYXBwbHkoY29uZmlnLCB7XG4gICAgICAgICAgaW50ZXJ2YWw6IDEwMCxcbiAgICAgICAgICBkZWxheTogMjAwMCxcbiAgICAgICAgICB1c2VSZXNpemU6IHRydWUsXG4gICAgICAgICAgdXNlUGFyZW50OiBmYWxzZSxcbiAgICAgICAgICB1c2VQb2xsaW5nOiBmYWxzZVxuICAgICAgICB9LCB0cnVlKTtcblxuICAgICAgICBpZiAoY29uZmlnLmlzSG9zdCkge1xuICAgICAgICAgIGlmICghY29uZmlnLmxvY2FsKSB7XG4gICAgICAgICAgICAvLyBJZiBubyBsb2NhbCBpcyBzZXQgdGhlbiB3ZSBuZWVkIHRvIGZpbmQgYW4gaW1hZ2UgaG9zdGVkIG9uIHRoZSBjdXJyZW50IGRvbWFpblxuICAgICAgICAgICAgdmFyIGRvbWFpbiA9IGxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgbG9jYXRpb24uaG9zdCxcbiAgICAgICAgICAgICAgICBpbWFnZXMgPSBkb2N1bWVudC5ib2R5LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW1nXCIpLFxuICAgICAgICAgICAgICAgIGltYWdlO1xuICAgICAgICAgICAgdmFyIGkgPSBpbWFnZXMubGVuZ3RoO1xuXG4gICAgICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAgIGltYWdlID0gaW1hZ2VzW2ldO1xuXG4gICAgICAgICAgICAgIGlmIChpbWFnZS5zcmMuc3Vic3RyaW5nKDAsIGRvbWFpbi5sZW5ndGgpID09PSBkb21haW4pIHtcbiAgICAgICAgICAgICAgICBjb25maWcubG9jYWwgPSBpbWFnZS5zcmM7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFjb25maWcubG9jYWwpIHtcbiAgICAgICAgICAgICAgLy8gSWYgbm8gbG9jYWwgd2FzIHNldCwgYW5kIHdlIGFyZSB1bmFibGUgdG8gZmluZCBhIHN1aXRhYmxlIGZpbGUsIHRoZW4gd2UgcmVzb3J0IHRvIHVzaW5nIHRoZSBjdXJyZW50IHdpbmRvd1xuICAgICAgICAgICAgICBjb25maWcubG9jYWwgPSB3aW5kb3c7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIHBhcmFtZXRlcnMgPSB7XG4gICAgICAgICAgICB4ZG1fYzogY29uZmlnLmNoYW5uZWwsXG4gICAgICAgICAgICB4ZG1fcDogMFxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBpZiAoY29uZmlnLmxvY2FsID09PSB3aW5kb3cpIHtcbiAgICAgICAgICAgIC8vIFdlIGFyZSB1c2luZyB0aGUgY3VycmVudCB3aW5kb3cgdG8gbGlzdGVuIHRvXG4gICAgICAgICAgICBjb25maWcudXNlUG9sbGluZyA9IHRydWU7XG4gICAgICAgICAgICBjb25maWcudXNlUGFyZW50ID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbmZpZy5sb2NhbCA9IGxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgbG9jYXRpb24uaG9zdCArIGxvY2F0aW9uLnBhdGhuYW1lICsgbG9jYXRpb24uc2VhcmNoO1xuICAgICAgICAgICAgcGFyYW1ldGVycy54ZG1fZSA9IGNvbmZpZy5sb2NhbDtcbiAgICAgICAgICAgIHBhcmFtZXRlcnMueGRtX3BhID0gMTsgLy8gdXNlIHBhcmVudFxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwYXJhbWV0ZXJzLnhkbV9lID0gcmVzb2x2ZVVybChjb25maWcubG9jYWwpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChjb25maWcuY29udGFpbmVyKSB7XG4gICAgICAgICAgICBjb25maWcudXNlUmVzaXplID0gZmFsc2U7XG4gICAgICAgICAgICBwYXJhbWV0ZXJzLnhkbV9wbyA9IDE7IC8vIHVzZSBwb2xsaW5nXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uZmlnLnJlbW90ZSA9IGFwcGVuZFF1ZXJ5UGFyYW1ldGVycyhjb25maWcucmVtb3RlLCBwYXJhbWV0ZXJzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhcHBseShjb25maWcsIHtcbiAgICAgICAgICAgIGNoYW5uZWw6IHF1ZXJ5LnhkbV9jLFxuICAgICAgICAgICAgcmVtb3RlOiBxdWVyeS54ZG1fZSxcbiAgICAgICAgICAgIHVzZVBhcmVudDogIXVuZGVmKHF1ZXJ5LnhkbV9wYSksXG4gICAgICAgICAgICB1c2VQb2xsaW5nOiAhdW5kZWYocXVlcnkueGRtX3BvKSxcbiAgICAgICAgICAgIHVzZVJlc2l6ZTogY29uZmlnLnVzZVBhcmVudCA/IGZhbHNlIDogY29uZmlnLnVzZVJlc2l6ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgc3RhY2tFbHMgPSBbbmV3IGVhc3lYRE0uc3RhY2suSGFzaFRyYW5zcG9ydChjb25maWcpLCBuZXcgZWFzeVhETS5zdGFjay5SZWxpYWJsZUJlaGF2aW9yKHt9KSwgbmV3IGVhc3lYRE0uc3RhY2suUXVldWVCZWhhdmlvcih7XG4gICAgICAgICAgZW5jb2RlOiB0cnVlLFxuICAgICAgICAgIG1heExlbmd0aDogNDAwMCAtIGNvbmZpZy5yZW1vdGUubGVuZ3RoXG4gICAgICAgIH0pLCBuZXcgZWFzeVhETS5zdGFjay5WZXJpZnlCZWhhdmlvcih7XG4gICAgICAgICAgaW5pdGlhdGU6IGNvbmZpZy5pc0hvc3RcbiAgICAgICAgfSldO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBcIjFcIjpcbiAgICAgICAgc3RhY2tFbHMgPSBbbmV3IGVhc3lYRE0uc3RhY2suUG9zdE1lc3NhZ2VUcmFuc3BvcnQoY29uZmlnKV07XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIFwiMlwiOlxuICAgICAgICBpZiAoY29uZmlnLmlzSG9zdCkge1xuICAgICAgICAgIGNvbmZpZy5yZW1vdGVIZWxwZXIgPSByZXNvbHZlVXJsKGNvbmZpZy5yZW1vdGVIZWxwZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3RhY2tFbHMgPSBbbmV3IGVhc3lYRE0uc3RhY2suTmFtZVRyYW5zcG9ydChjb25maWcpLCBuZXcgZWFzeVhETS5zdGFjay5RdWV1ZUJlaGF2aW9yKCksIG5ldyBlYXN5WERNLnN0YWNrLlZlcmlmeUJlaGF2aW9yKHtcbiAgICAgICAgICBpbml0aWF0ZTogY29uZmlnLmlzSG9zdFxuICAgICAgICB9KV07XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIFwiM1wiOlxuICAgICAgICBzdGFja0VscyA9IFtuZXcgZWFzeVhETS5zdGFjay5OaXhUcmFuc3BvcnQoY29uZmlnKV07XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIFwiNFwiOlxuICAgICAgICBzdGFja0VscyA9IFtuZXcgZWFzeVhETS5zdGFjay5TYW1lT3JpZ2luVHJhbnNwb3J0KGNvbmZpZyldO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBcIjVcIjpcbiAgICAgICAgc3RhY2tFbHMgPSBbbmV3IGVhc3lYRE0uc3RhY2suRnJhbWVFbGVtZW50VHJhbnNwb3J0KGNvbmZpZyldO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBcIjZcIjpcbiAgICAgICAgaWYgKCFmbGFzaFZlcnNpb24pIHtcbiAgICAgICAgICBoYXNGbGFzaCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3RhY2tFbHMgPSBbbmV3IGVhc3lYRE0uc3RhY2suRmxhc2hUcmFuc3BvcnQoY29uZmlnKV07XG4gICAgICAgIGJyZWFrO1xuICAgIH0gLy8gdGhpcyBiZWhhdmlvciBpcyByZXNwb25zaWJsZSBmb3IgYnVmZmVyaW5nIG91dGdvaW5nIG1lc3NhZ2VzLCBhbmQgZm9yIHBlcmZvcm1pbmcgbGF6eSBpbml0aWFsaXphdGlvblxuXG5cbiAgICBzdGFja0Vscy5wdXNoKG5ldyBlYXN5WERNLnN0YWNrLlF1ZXVlQmVoYXZpb3Ioe1xuICAgICAgbGF6eTogY29uZmlnLmxhenksXG4gICAgICByZW1vdmU6IHRydWVcbiAgICB9KSk7XG4gICAgcmV0dXJuIHN0YWNrRWxzO1xuICB9XG4gIC8qKlxyXG4gICAqIENoYWlucyBhbGwgdGhlIHNlcGFyYXRlIHN0YWNrIGVsZW1lbnRzIGludG8gYSBzaW5nbGUgdXNhYmxlIHN0YWNrLjxici8+XHJcbiAgICogSWYgYW4gZWxlbWVudCBpcyBtaXNzaW5nIGEgbmVjZXNzYXJ5IG1ldGhvZCB0aGVuIGl0IHdpbGwgaGF2ZSBhIHBhc3MtdGhyb3VnaCBtZXRob2QgYXBwbGllZC5cclxuICAgKiBAcGFyYW0ge0FycmF5fSBzdGFja0VsZW1lbnRzIEFuIGFycmF5IG9mIHN0YWNrIGVsZW1lbnRzIHRvIGJlIGxpbmtlZC5cclxuICAgKiBAcmV0dXJuIHtlYXN5WERNLnN0YWNrLlN0YWNrRWxlbWVudH0gVGhlIGxhc3QgZWxlbWVudCBpbiB0aGUgY2hhaW4uXHJcbiAgICovXG5cblxuICBmdW5jdGlvbiBjaGFpblN0YWNrKHN0YWNrRWxlbWVudHMpIHtcbiAgICB2YXIgc3RhY2tFbCxcbiAgICAgICAgZGVmYXVsdHMgPSB7XG4gICAgICBpbmNvbWluZzogZnVuY3Rpb24gaW5jb21pbmcobWVzc2FnZSwgb3JpZ2luKSB7XG4gICAgICAgIHRoaXMudXAuaW5jb21pbmcobWVzc2FnZSwgb3JpZ2luKTtcbiAgICAgIH0sXG4gICAgICBvdXRnb2luZzogZnVuY3Rpb24gb3V0Z29pbmcobWVzc2FnZSwgcmVjaXBpZW50KSB7XG4gICAgICAgIHRoaXMuZG93bi5vdXRnb2luZyhtZXNzYWdlLCByZWNpcGllbnQpO1xuICAgICAgfSxcbiAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiBjYWxsYmFjayhzdWNjZXNzKSB7XG4gICAgICAgIHRoaXMudXAuY2FsbGJhY2soc3VjY2Vzcyk7XG4gICAgICB9LFxuICAgICAgaW5pdDogZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgdGhpcy5kb3duLmluaXQoKTtcbiAgICAgIH0sXG4gICAgICBkZXN0cm95OiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICB0aGlzLmRvd24uZGVzdHJveSgpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gc3RhY2tFbGVtZW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgc3RhY2tFbCA9IHN0YWNrRWxlbWVudHNbaV07XG4gICAgICBhcHBseShzdGFja0VsLCBkZWZhdWx0cywgdHJ1ZSk7XG5cbiAgICAgIGlmIChpICE9PSAwKSB7XG4gICAgICAgIHN0YWNrRWwuZG93biA9IHN0YWNrRWxlbWVudHNbaSAtIDFdO1xuICAgICAgfVxuXG4gICAgICBpZiAoaSAhPT0gbGVuIC0gMSkge1xuICAgICAgICBzdGFja0VsLnVwID0gc3RhY2tFbGVtZW50c1tpICsgMV07XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHN0YWNrRWw7XG4gIH1cbiAgLyoqXHJcbiAgICogVGhpcyB3aWxsIHJlbW92ZSBhIHN0YWNrZWxlbWVudCBmcm9tIGl0cyBzdGFjayB3aGlsZSBsZWF2aW5nIHRoZSBzdGFjayBmdW5jdGlvbmFsLlxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlbGVtZW50IFRoZSBlbG1lbnQgdG8gcmVtb3ZlIGZyb20gdGhlIHN0YWNrLlxyXG4gICAqL1xuXG5cbiAgZnVuY3Rpb24gcmVtb3ZlRnJvbVN0YWNrKGVsZW1lbnQpIHtcbiAgICBlbGVtZW50LnVwLmRvd24gPSBlbGVtZW50LmRvd247XG4gICAgZWxlbWVudC5kb3duLnVwID0gZWxlbWVudC51cDtcbiAgICBlbGVtZW50LnVwID0gZWxlbWVudC5kb3duID0gbnVsbDtcbiAgfVxuICAvKlxyXG4gICAqIEV4cG9ydCB0aGUgbWFpbiBvYmplY3QgYW5kIGFueSBvdGhlciBtZXRob2RzIGFwcGxpY2FibGVcclxuICAgKi9cblxuICAvKipcclxuICAgKiBAY2xhc3MgZWFzeVhETVxyXG4gICAqIEEgamF2YXNjcmlwdCBsaWJyYXJ5IHByb3ZpZGluZyBjcm9zcy1icm93c2VyLCBjcm9zcy1kb21haW4gbWVzc2FnaW5nL1JQQy5cclxuICAgKiBAdmVyc2lvbiAyLjQuMTkuM1xyXG4gICAqIEBzaW5nbGV0b25cclxuICAgKi9cblxuXG4gIGFwcGx5KGVhc3lYRE0sIHtcbiAgICAvKipcclxuICAgICAqIFRoZSB2ZXJzaW9uIG9mIHRoZSBsaWJyYXJ5XHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICovXG4gICAgdmVyc2lvbjogXCIyLjQuMTkuM1wiLFxuXG4gICAgLyoqXHJcbiAgICAgKiBUaGlzIGlzIGEgbWFwIGNvbnRhaW5pbmcgYWxsIHRoZSBxdWVyeSBwYXJhbWV0ZXJzIHBhc3NlZCB0byB0aGUgZG9jdW1lbnQuXHJcbiAgICAgKiBBbGwgdGhlIHZhbHVlcyBoYXMgYmVlbiBkZWNvZGVkIHVzaW5nIGRlY29kZVVSSUNvbXBvbmVudC5cclxuICAgICAqIEB0eXBlIHtvYmplY3R9XHJcbiAgICAgKi9cbiAgICBxdWVyeTogcXVlcnksXG5cbiAgICAvKipcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cbiAgICBzdGFjazoge30sXG5cbiAgICAvKipcclxuICAgICAqIEFwcGxpZXMgcHJvcGVydGllcyBmcm9tIHRoZSBzb3VyY2Ugb2JqZWN0IHRvIHRoZSB0YXJnZXQgb2JqZWN0Ljxici8+XHJcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gdGFyZ2V0IFRoZSB0YXJnZXQgb2YgdGhlIHByb3BlcnRpZXMuXHJcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gc291cmNlIFRoZSBzb3VyY2Ugb2YgdGhlIHByb3BlcnRpZXMuXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IG5vT3ZlcndyaXRlIFNldCB0byBUcnVlIHRvIG9ubHkgc2V0IG5vbi1leGlzdGluZyBwcm9wZXJ0aWVzLlxyXG4gICAgICovXG4gICAgYXBwbHk6IGFwcGx5LFxuXG4gICAgLyoqXHJcbiAgICAgKiBBIHNhZmUgaW1wbGVtZW50YXRpb24gb2YgSFRNTDUgSlNPTi4gRmVhdHVyZSB0ZXN0aW5nIGlzIHVzZWQgdG8gbWFrZSBzdXJlIHRoZSBpbXBsZW1lbnRhdGlvbiB3b3Jrcy5cclxuICAgICAqIEByZXR1cm4ge0pTT059IEEgdmFsaWQgSlNPTiBjb25mb3JtaW5nIG9iamVjdCwgb3IgbnVsbCBpZiBub3QgZm91bmQuXHJcbiAgICAgKi9cbiAgICBnZXRKU09OT2JqZWN0OiBfZ2V0SlNPTixcblxuICAgIC8qKlxyXG4gICAgICogVGhpcyB3aWxsIGFkZCBhIGZ1bmN0aW9uIHRvIHRoZSBxdWV1ZSBvZiBmdW5jdGlvbnMgdG8gYmUgcnVuIG9uY2UgdGhlIERPTSByZWFjaGVzIGEgcmVhZHkgc3RhdGUuXHJcbiAgICAgKiBJZiBmdW5jdGlvbnMgYXJlIGFkZGVkIGFmdGVyIHRoaXMgZXZlbnQgdGhlbiB0aGV5IHdpbGwgYmUgZXhlY3V0ZWQgaW1tZWRpYXRlbHkuXHJcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gYWRkXHJcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gc2NvcGUgQW4gb3B0aW9uYWwgc2NvcGUgZm9yIHRoZSBmdW5jdGlvbiB0byBiZSBjYWxsZWQgd2l0aC5cclxuICAgICAqL1xuICAgIHdoZW5SZWFkeTogd2hlblJlYWR5LFxuXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmVzIGVhc3lYRE0gdmFyaWFibGUgZnJvbSB0aGUgZ2xvYmFsIHNjb3BlLiBJdCBhbHNvIHJldHVybnMgY29udHJvbFxyXG4gICAgICogb2YgdGhlIGVhc3lYRE0gdmFyaWFibGUgdG8gd2hhdGV2ZXIgY29kZSB1c2VkIGl0IGJlZm9yZS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbnMgQSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYW4gb2JqZWN0IHRoYXQgd2lsbCBob2xkXHJcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgYW4gaW5zdGFuY2Ugb2YgZWFzeVhETS5cclxuICAgICAqIEByZXR1cm4gQW4gaW5zdGFuY2Ugb2YgZWFzeVhETVxyXG4gICAgICovXG4gICAgbm9Db25mbGljdDogbm9Db25mbGljdFxuICB9KTtcbiAgLypqc2xpbnQgZXZpbDogdHJ1ZSwgYnJvd3NlcjogdHJ1ZSwgaW1tZWQ6IHRydWUsIHBhc3NmYWlsOiB0cnVlLCB1bmRlZjogdHJ1ZSwgbmV3Y2FwOiB0cnVlKi9cblxuICAvKmdsb2JhbCBjb25zb2xlLCBfRmlyZWJ1Z0NvbW1hbmRMaW5lLCAgZWFzeVhETSwgd2luZG93LCBlc2NhcGUsIHVuZXNjYXBlLCBpc0hvc3RPYmplY3QsIHVuZGVmLCBfdHJhY2UsIGRvbUlzUmVhZHksIGVtcHR5Rm4sIG5hbWVzcGFjZSAqL1xuICAvL1xuICAvLyBlYXN5WERNXG4gIC8vIGh0dHA6Ly9lYXN5eGRtLm5ldC9cbiAgLy8gQ29weXJpZ2h0KGMpIDIwMDktMjAxMSwgw5h5dmluZCBTZWFuIEtpbnNleSwgb3l2aW5kQGtpbnNleS5uby5cbiAgLy9cbiAgLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICAvLyBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gIC8vIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAgLy8gdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICAvLyBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAgLy8gZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbiAgLy9cbiAgLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAgLy8gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gIC8vXG4gIC8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAgLy8gSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gIC8vIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICAvLyBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gIC8vIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gIC8vIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAgLy8gVEhFIFNPRlRXQVJFLlxuICAvL1xuXG4gIC8qanNsaW50IGV2aWw6IHRydWUsIGJyb3dzZXI6IHRydWUsIGltbWVkOiB0cnVlLCBwYXNzZmFpbDogdHJ1ZSwgdW5kZWY6IHRydWUsIG5ld2NhcDogdHJ1ZSovXG5cbiAgLypnbG9iYWwgZWFzeVhETSwgd2luZG93LCBlc2NhcGUsIHVuZXNjYXBlLCBpc0hvc3RPYmplY3QsIGlzSG9zdE1ldGhvZCwgdW4sIG9uLCBjcmVhdGVGcmFtZSwgZGVidWcgKi9cbiAgLy9cbiAgLy8gZWFzeVhETVxuICAvLyBodHRwOi8vZWFzeXhkbS5uZXQvXG4gIC8vIENvcHlyaWdodChjKSAyMDA5LTIwMTEsIMOYeXZpbmQgU2VhbiBLaW5zZXksIG95dmluZEBraW5zZXkubm8uXG4gIC8vXG4gIC8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAgLy8gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICAvLyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gIC8vIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAgLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gIC8vIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4gIC8vXG4gIC8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gIC8vIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICAvL1xuICAvLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gIC8vIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICAvLyBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAgLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICAvLyBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICAvLyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gIC8vIFRIRSBTT0ZUV0FSRS5cbiAgLy9cblxuICAvKipcclxuICAgKiBAY2xhc3MgZWFzeVhETS5Eb21IZWxwZXJcclxuICAgKiBDb250YWlucyBtZXRob2RzIGZvciBkZWFsaW5nIHdpdGggdGhlIERPTVxyXG4gICAqIEBzaW5nbGV0b25cclxuICAgKi9cblxuICBlYXN5WERNLkRvbUhlbHBlciA9IHtcbiAgICAvKipcclxuICAgICAqIFByb3ZpZGVzIGEgY29uc2lzdGVudCBpbnRlcmZhY2UgZm9yIGFkZGluZyBldmVudGhhbmRsZXJzXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0IFRoZSB0YXJnZXQgdG8gYWRkIHRoZSBldmVudCB0b1xyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHR5cGUgVGhlIG5hbWUgb2YgdGhlIGV2ZW50XHJcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBsaXN0ZW5lciBUaGUgbGlzdGVuZXJcclxuICAgICAqL1xuICAgIG9uOiBvbixcblxuICAgIC8qKlxyXG4gICAgICogUHJvdmlkZXMgYSBjb25zaXN0ZW50IGludGVyZmFjZSBmb3IgcmVtb3ZpbmcgZXZlbnRoYW5kbGVyc1xyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHRhcmdldCBUaGUgdGFyZ2V0IHRvIHJlbW92ZSB0aGUgZXZlbnQgZnJvbVxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHR5cGUgVGhlIG5hbWUgb2YgdGhlIGV2ZW50XHJcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBsaXN0ZW5lciBUaGUgbGlzdGVuZXJcclxuICAgICAqL1xuICAgIHVuOiB1bixcblxuICAgIC8qKlxyXG4gICAgICogQ2hlY2tzIGZvciB0aGUgcHJlc2VuY2Ugb2YgdGhlIEpTT04gb2JqZWN0LlxyXG4gICAgICogSWYgaXQgaXMgbm90IHByZXNlbnQgaXQgd2lsbCB1c2UgdGhlIHN1cHBsaWVkIHBhdGggdG8gbG9hZCB0aGUgSlNPTjIgbGlicmFyeS5cclxuICAgICAqIFRoaXMgc2hvdWxkIGJlIGNhbGxlZCBpbiB0aGUgZG9jdW1lbnRzIGhlYWQgcmlnaHQgYWZ0ZXIgdGhlIGVhc3lYRE0gc2NyaXB0IHRhZy5cclxuICAgICAqIGh0dHA6Ly9qc29uLm9yZy9qc29uMi5qc1xyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHBhdGggQSB2YWxpZCBwYXRoIHRvIGpzb24yLmpzXHJcbiAgICAgKi9cbiAgICByZXF1aXJlc0pTT046IGZ1bmN0aW9uIHJlcXVpcmVzSlNPTihwYXRoKSB7XG4gICAgICBpZiAoIWlzSG9zdE9iamVjdCh3aW5kb3csIFwiSlNPTlwiKSkge1xuICAgICAgICAvLyB3ZSBuZWVkIHRvIGVuY29kZSB0aGUgPCBpbiBvcmRlciB0byBhdm9pZCBhbiBpbGxlZ2FsIHRva2VuIGVycm9yXG4gICAgICAgIC8vIHdoZW4gdGhlIHNjcmlwdCBpcyBpbmxpbmVkIGluIGEgZG9jdW1lbnQuXG4gICAgICAgIGRvY3VtZW50LndyaXRlKCc8JyArICdzY3JpcHQgdHlwZT1cInRleHQvamF2YXNjcmlwdFwiIHNyYz1cIicgKyBwYXRoICsgJ1wiPjwnICsgJy9zY3JpcHQ+Jyk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuICAvKmpzbGludCBldmlsOiB0cnVlLCBicm93c2VyOiB0cnVlLCBpbW1lZDogdHJ1ZSwgcGFzc2ZhaWw6IHRydWUsIHVuZGVmOiB0cnVlLCBuZXdjYXA6IHRydWUqL1xuXG4gIC8qZ2xvYmFsIGVhc3lYRE0sIHdpbmRvdywgZXNjYXBlLCB1bmVzY2FwZSwgZGVidWcgKi9cbiAgLy9cbiAgLy8gZWFzeVhETVxuICAvLyBodHRwOi8vZWFzeXhkbS5uZXQvXG4gIC8vIENvcHlyaWdodChjKSAyMDA5LTIwMTEsIMOYeXZpbmQgU2VhbiBLaW5zZXksIG95dmluZEBraW5zZXkubm8uXG4gIC8vXG4gIC8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAgLy8gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICAvLyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gIC8vIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAgLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gIC8vIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4gIC8vXG4gIC8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gIC8vIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICAvL1xuICAvLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gIC8vIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICAvLyBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAgLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICAvLyBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICAvLyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gIC8vIFRIRSBTT0ZUV0FSRS5cbiAgLy9cblxuICAoZnVuY3Rpb24gKCkge1xuICAgIC8vIFRoZSBtYXAgY29udGFpbmluZyB0aGUgc3RvcmVkIGZ1bmN0aW9uc1xuICAgIHZhciBfbWFwID0ge307XG4gICAgLyoqXHJcbiAgICAgKiBAY2xhc3MgZWFzeVhETS5GblxyXG4gICAgICogVGhpcyBjb250YWlucyBtZXRob2RzIHJlbGF0ZWQgdG8gZnVuY3Rpb24gaGFuZGxpbmcsIHN1Y2ggYXMgc3RvcmluZyBjYWxsYmFja3MuXHJcbiAgICAgKiBAc2luZ2xldG9uXHJcbiAgICAgKiBAbmFtZXNwYWNlIGVhc3lYRE1cclxuICAgICAqL1xuXG4gICAgZWFzeVhETS5GbiA9IHtcbiAgICAgIC8qKlxyXG4gICAgICAgKiBTdG9yZXMgYSBmdW5jdGlvbiB1c2luZyB0aGUgZ2l2ZW4gbmFtZSBmb3IgcmVmZXJlbmNlXHJcbiAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIFRoZSBuYW1lIHRoYXQgdGhlIGZ1bmN0aW9uIHNob3VsZCBiZSByZWZlcnJlZCBieVxyXG4gICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gc3RvcmVcclxuICAgICAgICogQG5hbWVzcGFjZSBlYXN5WERNLmZuXHJcbiAgICAgICAqL1xuICAgICAgc2V0OiBmdW5jdGlvbiBzZXQobmFtZSwgZm4pIHtcbiAgICAgICAgX21hcFtuYW1lXSA9IGZuO1xuICAgICAgfSxcblxuICAgICAgLyoqXHJcbiAgICAgICAqIFJldHJpZXZlcyB0aGUgZnVuY3Rpb24gcmVmZXJyZWQgdG8gYnkgdGhlIGdpdmVuIG5hbWVcclxuICAgICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgVGhlIG5hbWUgb2YgdGhlIGZ1bmN0aW9uIHRvIHJldHJpZXZlXHJcbiAgICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gZGVsIElmIHRoZSBmdW5jdGlvbiBzaG91bGQgYmUgZGVsZXRlZCBhZnRlciByZXRyaWV2YWxcclxuICAgICAgICogQHJldHVybiB7RnVuY3Rpb259IFRoZSBzdG9yZWQgZnVuY3Rpb25cclxuICAgICAgICogQG5hbWVzcGFjZSBlYXN5WERNLmZuXHJcbiAgICAgICAqL1xuICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQobmFtZSwgZGVsKSB7XG4gICAgICAgIGlmICghX21hcC5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBmbiA9IF9tYXBbbmFtZV07XG5cbiAgICAgICAgaWYgKGRlbCkge1xuICAgICAgICAgIGRlbGV0ZSBfbWFwW25hbWVdO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZuO1xuICAgICAgfVxuICAgIH07XG4gIH0pKCk7XG4gIC8qanNsaW50IGV2aWw6IHRydWUsIGJyb3dzZXI6IHRydWUsIGltbWVkOiB0cnVlLCBwYXNzZmFpbDogdHJ1ZSwgdW5kZWY6IHRydWUsIG5ld2NhcDogdHJ1ZSovXG5cbiAgLypnbG9iYWwgZWFzeVhETSwgd2luZG93LCBlc2NhcGUsIHVuZXNjYXBlLCBjaGFpblN0YWNrLCBwcmVwYXJlVHJhbnNwb3J0U3RhY2ssIGdldExvY2F0aW9uLCBkZWJ1ZyAqL1xuICAvL1xuICAvLyBlYXN5WERNXG4gIC8vIGh0dHA6Ly9lYXN5eGRtLm5ldC9cbiAgLy8gQ29weXJpZ2h0KGMpIDIwMDktMjAxMSwgw5h5dmluZCBTZWFuIEtpbnNleSwgb3l2aW5kQGtpbnNleS5uby5cbiAgLy9cbiAgLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICAvLyBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gIC8vIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAgLy8gdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICAvLyBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAgLy8gZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbiAgLy9cbiAgLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAgLy8gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gIC8vXG4gIC8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAgLy8gSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gIC8vIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICAvLyBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gIC8vIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gIC8vIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAgLy8gVEhFIFNPRlRXQVJFLlxuICAvL1xuXG4gIC8qKlxyXG4gICAqIEBjbGFzcyBlYXN5WERNLlNvY2tldFxyXG4gICAqIFRoaXMgY2xhc3MgY3JlYXRlcyBhIHRyYW5zcG9ydCBjaGFubmVsIGJldHdlZW4gdHdvIGRvbWFpbnMgdGhhdCBpcyB1c2FibGUgZm9yIHNlbmRpbmcgYW5kIHJlY2VpdmluZyBzdHJpbmctYmFzZWQgbWVzc2FnZXMuPGJyLz5cclxuICAgKiBUaGUgY2hhbm5lbCBpcyByZWxpYWJsZSwgc3VwcG9ydHMgcXVldWVpbmcsIGFuZCBlbnN1cmVzIHRoYXQgdGhlIG1lc3NhZ2Ugb3JpZ2luYXRlcyBmcm9tIHRoZSBleHBlY3RlZCBkb21haW4uPGJyLz5cclxuICAgKiBJbnRlcm5hbGx5IGRpZmZlcmVudCBzdGFja3Mgd2lsbCBiZSB1c2VkIGRlcGVuZGluZyBvbiB0aGUgYnJvd3NlcnMgZmVhdHVyZXMgYW5kIHRoZSBhdmFpbGFibGUgcGFyYW1ldGVycy5cclxuICAgKiA8aDI+SG93IHRvIHNldCB1cDwvaDI+XHJcbiAgICogU2V0dGluZyB1cCB0aGUgcHJvdmlkZXI6XHJcbiAgICogPHByZT48Y29kZT5cclxuICAgKiB2YXIgc29ja2V0ID0gbmV3IGVhc3lYRE0uU29ja2V0KHtcclxuICAgKiAmbmJzcDsgbG9jYWw6IFwibmFtZS5odG1sXCIsXHJcbiAgICogJm5ic3A7IG9uUmVhZHk6IGZ1bmN0aW9uKCl7XHJcbiAgICogJm5ic3A7ICZuYnNwOyAmIzQ3OyYjNDc7IHlvdSBuZWVkIHRvIHdhaXQgZm9yIHRoZSBvblJlYWR5IGNhbGxiYWNrIGJlZm9yZSB1c2luZyB0aGUgc29ja2V0XHJcbiAgICogJm5ic3A7ICZuYnNwOyBzb2NrZXQucG9zdE1lc3NhZ2UoXCJmb28tbWVzc2FnZVwiKTtcclxuICAgKiAmbmJzcDsgfSxcclxuICAgKiAmbmJzcDsgb25NZXNzYWdlOiBmdW5jdGlvbihtZXNzYWdlLCBvcmlnaW4pIHtcclxuICAgKiAmbmJzcDsmbmJzcDsgYWxlcnQoXCJyZWNlaXZlZCBcIiArIG1lc3NhZ2UgKyBcIiBmcm9tIFwiICsgb3JpZ2luKTtcclxuICAgKiAmbmJzcDsgfVxyXG4gICAqIH0pO1xyXG4gICAqIDwvY29kZT48L3ByZT5cclxuICAgKiBTZXR0aW5nIHVwIHRoZSBjb25zdW1lcjpcclxuICAgKiA8cHJlPjxjb2RlPlxyXG4gICAqIHZhciBzb2NrZXQgPSBuZXcgZWFzeVhETS5Tb2NrZXQoe1xyXG4gICAqICZuYnNwOyByZW1vdGU6IFwiaHR0cDomIzQ3OyYjNDc7cmVtb3RlZG9tYWluL3BhZ2UuaHRtbFwiLFxyXG4gICAqICZuYnNwOyByZW1vdGVIZWxwZXI6IFwiaHR0cDomIzQ3OyYjNDc7cmVtb3RlZG9tYWluL25hbWUuaHRtbFwiLFxyXG4gICAqICZuYnNwOyBvblJlYWR5OiBmdW5jdGlvbigpe1xyXG4gICAqICZuYnNwOyAmbmJzcDsgJiM0NzsmIzQ3OyB5b3UgbmVlZCB0byB3YWl0IGZvciB0aGUgb25SZWFkeSBjYWxsYmFjayBiZWZvcmUgdXNpbmcgdGhlIHNvY2tldFxyXG4gICAqICZuYnNwOyAmbmJzcDsgc29ja2V0LnBvc3RNZXNzYWdlKFwiZm9vLW1lc3NhZ2VcIik7XHJcbiAgICogJm5ic3A7IH0sXHJcbiAgICogJm5ic3A7IG9uTWVzc2FnZTogZnVuY3Rpb24obWVzc2FnZSwgb3JpZ2luKSB7XHJcbiAgICogJm5ic3A7Jm5ic3A7IGFsZXJ0KFwicmVjZWl2ZWQgXCIgKyBtZXNzYWdlICsgXCIgZnJvbSBcIiArIG9yaWdpbik7XHJcbiAgICogJm5ic3A7IH1cclxuICAgKiB9KTtcclxuICAgKiA8L2NvZGU+PC9wcmU+XHJcbiAgICogSWYgeW91IGFyZSB1bmFibGUgdG8gdXBsb2FkIHRoZSA8Y29kZT5uYW1lLmh0bWw8L2NvZGU+IGZpbGUgdG8gdGhlIGNvbnN1bWVycyBkb21haW4gdGhlbiByZW1vdmUgdGhlIDxjb2RlPnJlbW90ZUhlbHBlcjwvY29kZT4gcHJvcGVydHlcclxuICAgKiBhbmQgZWFzeVhETSB3aWxsIGZhbGwgYmFjayB0byB1c2luZyB0aGUgSGFzaFRyYW5zcG9ydCBpbnN0ZWFkIG9mIHRoZSBOYW1lVHJhbnNwb3J0IHdoZW4gbm90IGFibGUgdG8gdXNlIGFueSBvZiB0aGUgcHJpbWFyeSB0cmFuc3BvcnRzLlxyXG4gICAqIEBuYW1lc3BhY2UgZWFzeVhETVxyXG4gICAqIEBjb25zdHJ1Y3RvclxyXG4gICAqIEBjZmcge1N0cmluZy9XaW5kb3d9IGxvY2FsIFRoZSB1cmwgdG8gdGhlIGxvY2FsIG5hbWUuaHRtbCBkb2N1bWVudCwgYSBsb2NhbCBzdGF0aWMgZmlsZSwgb3IgYSByZWZlcmVuY2UgdG8gdGhlIGxvY2FsIHdpbmRvdy5cclxuICAgKiBAY2ZnIHtCb29sZWFufSBsYXp5IChDb25zdW1lciBvbmx5KSBTZXQgdGhpcyB0byB0cnVlIGlmIHlvdSB3YW50IGVhc3lYRE0gdG8gZGVmZXIgY3JlYXRpbmcgdGhlIHRyYW5zcG9ydCB1bnRpbCByZWFsbHkgbmVlZGVkLlxyXG4gICAqIEBjZmcge1N0cmluZ30gcmVtb3RlIChDb25zdW1lciBvbmx5KSBUaGUgdXJsIHRvIHRoZSBwcm92aWRlcnMgZG9jdW1lbnQuXHJcbiAgICogQGNmZyB7U3RyaW5nfSByZW1vdGVIZWxwZXIgKENvbnN1bWVyIG9ubHkpIFRoZSB1cmwgdG8gdGhlIHJlbW90ZSBuYW1lLmh0bWwgZmlsZS4gVGhpcyBpcyB0byBzdXBwb3J0IE5hbWVUcmFuc3BvcnQgYXMgYSBmYWxsYmFjay4gT3B0aW9uYWwuXHJcbiAgICogQGNmZyB7TnVtYmVyfSBkZWxheSBUaGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBlYXN5WERNIHNob3VsZCB0cnkgdG8gZ2V0IGEgcmVmZXJlbmNlIHRvIHRoZSBsb2NhbCB3aW5kb3cuICBPcHRpb25hbCwgZGVmYXVsdHMgdG8gMjAwMC5cclxuICAgKiBAY2ZnIHtOdW1iZXJ9IGludGVydmFsIFRoZSBpbnRlcnZhbCB1c2VkIHdoZW4gcG9sbGluZyBmb3IgbWVzc2FnZXMuIE9wdGlvbmFsLCBkZWZhdWx0cyB0byAzMDAuXHJcbiAgICogQGNmZyB7U3RyaW5nfSBjaGFubmVsIChDb25zdW1lciBvbmx5KSBUaGUgbmFtZSBvZiB0aGUgY2hhbm5lbCB0byB1c2UuIENhbiBiZSB1c2VkIHRvIHNldCBjb25zaXN0ZW50IGlmcmFtZSBuYW1lcy4gTXVzdCBiZSB1bmlxdWUuIE9wdGlvbmFsLlxyXG4gICAqIEBjZmcge0Z1bmN0aW9ufSBvbk1lc3NhZ2UgVGhlIG1ldGhvZCB0aGF0IHNob3VsZCBoYW5kbGUgaW5jb21pbmcgbWVzc2FnZXMuPGJyLz4gVGhpcyBtZXRob2Qgc2hvdWxkIGFjY2VwdCB0d28gYXJndW1lbnRzLCB0aGUgbWVzc2FnZSBhcyBhIHN0cmluZywgYW5kIHRoZSBvcmlnaW4gYXMgYSBzdHJpbmcuIE9wdGlvbmFsLlxyXG4gICAqIEBjZmcge0Z1bmN0aW9ufSBvblJlYWR5IEEgbWV0aG9kIHRoYXQgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIHRoZSB0cmFuc3BvcnQgaXMgcmVhZHkuIE9wdGlvbmFsLlxyXG4gICAqIEBjZmcge0RPTUVsZW1lbnR8U3RyaW5nfSBjb250YWluZXIgKENvbnN1bWVyIG9ubHkpIFRoZSBlbGVtZW50LCBvciB0aGUgaWQgb2YgdGhlIGVsZW1lbnQgdGhhdCB0aGUgcHJpbWFyeSBpZnJhbWUgc2hvdWxkIGJlIGluc2VydGVkIGludG8uIElmIG5vdCBzZXQgdGhlbiB0aGUgaWZyYW1lIHdpbGwgYmUgcG9zaXRpb25lZCBvZmYtc2NyZWVuLiBPcHRpb25hbC5cclxuICAgKiBAY2ZnIHtBcnJheS9TdHJpbmd9IGFjbCAoUHJvdmlkZXIgb25seSkgSGVyZSB5b3UgY2FuIHNwZWNpZnkgd2hpY2ggJ1twcm90b2NvbF06Ly9bZG9tYWluXScgcGF0dGVybnMgdGhhdCBzaG91bGQgYmUgYWxsb3dlZCB0byBhY3QgYXMgdGhlIGNvbnN1bWVyIHRvd2FyZHMgdGhpcyBwcm92aWRlci48YnIvPlxyXG4gICAqIFRoaXMgY2FuIGNvbnRhaW4gdGhlIHdpbGRjYXJkcyA/IGFuZCAqLiAgRXhhbXBsZXMgYXJlICdodHRwOi8vZXhhbXBsZS5jb20nLCAnKi5mb28uY29tJyBhbmQgJypkb20/LmNvbScuIElmIHlvdSB3YW50IHRvIHVzZSByZXF1bGFyIGV4cHJlc3Npb25zIHRoZW4geW91IHBhdHRlcm4gbmVlZHMgdG8gc3RhcnQgd2l0aCBeIGFuZCBlbmQgd2l0aCAkLlxyXG4gICAqIElmIG5vbmUgb2YgdGhlIHBhdHRlcm5zIG1hdGNoIGFuIEVycm9yIHdpbGwgYmUgdGhyb3duLlxyXG4gICAqIEBjZmcge09iamVjdH0gcHJvcHMgKENvbnN1bWVyIG9ubHkpIEFkZGl0aW9uYWwgcHJvcGVydGllcyB0aGF0IHNob3VsZCBiZSBhcHBsaWVkIHRvIHRoZSBpZnJhbWUuIFRoaXMgY2FuIGFsc28gY29udGFpbiBuZXN0ZWQgb2JqZWN0cyBlLmc6IDxjb2RlPntzdHlsZTp7d2lkdGg6XCIxMDBweFwiLCBoZWlnaHQ6XCIxMDBweFwifX08L2NvZGU+LlxyXG4gICAqIFByb3BlcnRpZXMgc3VjaCBhcyAnbmFtZScgYW5kICdzcmMnIHdpbGwgYmUgb3ZlcnJpZGVkLiBPcHRpb25hbC5cclxuICAgKi9cblxuXG4gIGVhc3lYRE0uU29ja2V0ID0gZnVuY3Rpb24gKGNvbmZpZykge1xuICAgIC8vIGNyZWF0ZSB0aGUgc3RhY2tcbiAgICB2YXIgc3RhY2sgPSBjaGFpblN0YWNrKHByZXBhcmVUcmFuc3BvcnRTdGFjayhjb25maWcpLmNvbmNhdChbe1xuICAgICAgaW5jb21pbmc6IGZ1bmN0aW9uIGluY29taW5nKG1lc3NhZ2UsIG9yaWdpbikge1xuICAgICAgICBjb25maWcub25NZXNzYWdlKG1lc3NhZ2UsIG9yaWdpbik7XG4gICAgICB9LFxuICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIGNhbGxiYWNrKHN1Y2Nlc3MpIHtcbiAgICAgICAgaWYgKGNvbmZpZy5vblJlYWR5KSB7XG4gICAgICAgICAgY29uZmlnLm9uUmVhZHkoc3VjY2Vzcyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XSkpLFxuICAgICAgICByZWNpcGllbnQgPSBnZXRMb2NhdGlvbihjb25maWcucmVtb3RlKTsgLy8gc2V0IHRoZSBvcmlnaW5cblxuICAgIHRoaXMub3JpZ2luID0gZ2V0TG9jYXRpb24oY29uZmlnLnJlbW90ZSk7XG4gICAgLyoqXHJcbiAgICAgKiBJbml0aWF0ZXMgdGhlIGRlc3RydWN0aW9uIG9mIHRoZSBzdGFjay5cclxuICAgICAqL1xuXG4gICAgdGhpcy5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgICAgc3RhY2suZGVzdHJveSgpO1xuICAgIH07XG4gICAgLyoqXHJcbiAgICAgKiBQb3N0cyBhIG1lc3NhZ2UgdG8gdGhlIHJlbW90ZSBlbmQgb2YgdGhlIGNoYW5uZWxcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtZXNzYWdlIFRoZSBtZXNzYWdlIHRvIHNlbmRcclxuICAgICAqL1xuXG5cbiAgICB0aGlzLnBvc3RNZXNzYWdlID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgIHN0YWNrLm91dGdvaW5nKG1lc3NhZ2UsIHJlY2lwaWVudCk7XG4gICAgfTtcblxuICAgIHN0YWNrLmluaXQoKTtcbiAgfTtcbiAgLypqc2xpbnQgZXZpbDogdHJ1ZSwgYnJvd3NlcjogdHJ1ZSwgaW1tZWQ6IHRydWUsIHBhc3NmYWlsOiB0cnVlLCB1bmRlZjogdHJ1ZSwgbmV3Y2FwOiB0cnVlKi9cblxuICAvKmdsb2JhbCBlYXN5WERNLCB3aW5kb3csIGVzY2FwZSwgdW5lc2NhcGUsIHVuZGVmLCwgY2hhaW5TdGFjaywgcHJlcGFyZVRyYW5zcG9ydFN0YWNrLCBkZWJ1ZywgZ2V0TG9jYXRpb24gKi9cbiAgLy9cbiAgLy8gZWFzeVhETVxuICAvLyBodHRwOi8vZWFzeXhkbS5uZXQvXG4gIC8vIENvcHlyaWdodChjKSAyMDA5LTIwMTEsIMOYeXZpbmQgU2VhbiBLaW5zZXksIG95dmluZEBraW5zZXkubm8uXG4gIC8vXG4gIC8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAgLy8gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICAvLyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gIC8vIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAgLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gIC8vIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4gIC8vXG4gIC8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gIC8vIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICAvL1xuICAvLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gIC8vIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICAvLyBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAgLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICAvLyBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICAvLyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gIC8vIFRIRSBTT0ZUV0FSRS5cbiAgLy9cblxuICAvKipcclxuICAgKiBAY2xhc3MgZWFzeVhETS5ScGNcclxuICAgKiBDcmVhdGVzIGEgcHJveHkgb2JqZWN0IHRoYXQgY2FuIGJlIHVzZWQgdG8gY2FsbCBtZXRob2RzIGltcGxlbWVudGVkIG9uIHRoZSByZW1vdGUgZW5kIG9mIHRoZSBjaGFubmVsLCBhbmQgYWxzbyB0byBwcm92aWRlIHRoZSBpbXBsZW1lbnRhdGlvblxyXG4gICAqIG9mIG1ldGhvZHMgdG8gYmUgY2FsbGVkIGZyb20gdGhlIHJlbW90ZSBlbmQuPGJyLz5cclxuICAgKiBUaGUgaW5zdGFudGlhdGVkIG9iamVjdCB3aWxsIGhhdmUgbWV0aG9kcyBtYXRjaGluZyB0aG9zZSBzcGVjaWZpZWQgaW4gPGNvZGU+Y29uZmlnLnJlbW90ZTwvY29kZT4uPGJyLz5cclxuICAgKiBUaGlzIHJlcXVpcmVzIHRoZSBKU09OIG9iamVjdCBwcmVzZW50IGluIHRoZSBkb2N1bWVudCwgZWl0aGVyIG5hdGl2ZWx5LCB1c2luZyBqc29uLm9yZydzIGpzb24yIG9yIGFzIGEgd3JhcHBlciBhcm91bmQgbGlicmFyeSBzcGVzaWZpYyBtZXRob2RzLlxyXG4gICAqIDxoMj5Ib3cgdG8gc2V0IHVwPC9oMj5cclxuICAgKiA8cHJlPjxjb2RlPlxyXG4gICAqIHZhciBycGMgPSBuZXcgZWFzeVhETS5ScGMoe1xyXG4gICAqICZuYnNwOyAmIzQ3OyYjNDc7IHRoaXMgY29uZmlndXJhdGlvbiBpcyBlcXVhbCB0byB0aGF0IHVzZWQgYnkgdGhlIFNvY2tldC5cclxuICAgKiAmbmJzcDsgcmVtb3RlOiBcImh0dHA6JiM0NzsmIzQ3O3JlbW90ZWRvbWFpbi8uLi5cIixcclxuICAgKiAmbmJzcDsgb25SZWFkeTogZnVuY3Rpb24oKXtcclxuICAgKiAmbmJzcDsgJm5ic3A7ICYjNDc7JiM0NzsgeW91IG5lZWQgdG8gd2FpdCBmb3IgdGhlIG9uUmVhZHkgY2FsbGJhY2sgYmVmb3JlIHVzaW5nIHRoZSBwcm94eVxyXG4gICAqICZuYnNwOyAmbmJzcDsgcnBjLmZvbyguLi5cclxuICAgKiAmbmJzcDsgfVxyXG4gICAqIH0se1xyXG4gICAqICZuYnNwOyBsb2NhbDogey4ufSxcclxuICAgKiAmbmJzcDsgcmVtb3RlOiB7Li59XHJcbiAgICogfSk7XHJcbiAgICogPC9jb2RlPjwvcHJlPlxyXG4gICAqXHJcbiAgICogPGgyPkV4cG9zaW5nIGZ1bmN0aW9ucyAocHJvY2VkdXJlcyk8L2gyPlxyXG4gICAqIDxwcmU+PGNvZGU+XHJcbiAgICogdmFyIHJwYyA9IG5ldyBlYXN5WERNLlJwYyh7XHJcbiAgICogJm5ic3A7IC4uLlxyXG4gICAqIH0se1xyXG4gICAqICZuYnNwOyBsb2NhbDoge1xyXG4gICAqICZuYnNwOyAmbmJzcDsgbmFtZU9mTWV0aG9kOiB7XHJcbiAgICogJm5ic3A7ICZuYnNwOyAmbmJzcDsgbWV0aG9kOiBmdW5jdGlvbihhcmcxLCBhcmcyLCBzdWNjZXNzLCBlcnJvcil7XHJcbiAgICogJm5ic3A7ICZuYnNwOyAmbmJzcDsgJm5ic3A7IC4uLlxyXG4gICAqICZuYnNwOyAmbmJzcDsgJm5ic3A7IH1cclxuICAgKiAmbmJzcDsgJm5ic3A7IH0sXHJcbiAgICogJm5ic3A7ICZuYnNwOyAmIzQ3OyYjNDc7IHdpdGggc2hvcnRoYW5kIG5vdGF0aW9uXHJcbiAgICogJm5ic3A7ICZuYnNwOyBuYW1lT2ZBbm90aGVyTWV0aG9kOiAgZnVuY3Rpb24oYXJnMSwgYXJnMiwgc3VjY2VzcywgZXJyb3Ipe1xyXG4gICAqICZuYnNwOyAmbmJzcDsgfVxyXG4gICAqICZuYnNwOyB9LFxyXG4gICAqICZuYnNwOyByZW1vdGU6IHsuLi59XHJcbiAgICogfSk7XHJcbiAgICogPC9jb2RlPjwvcHJlPlxyXG4gIFxyXG4gICAqIFRoZSBmdW5jdGlvbiByZWZlcmVuY2VkIGJ5ICBbbWV0aG9kXSB3aWxsIHJlY2VpdmUgdGhlIHBhc3NlZCBhcmd1bWVudHMgZm9sbG93ZWQgYnkgdGhlIGNhbGxiYWNrIGZ1bmN0aW9ucyA8Y29kZT5zdWNjZXNzPC9jb2RlPiBhbmQgPGNvZGU+ZXJyb3I8L2NvZGU+Ljxici8+XHJcbiAgICogVG8gc2VuZCBhIHN1Y2Nlc3NmdWxsIHJlc3VsdCBiYWNrIHlvdSBjYW4gdXNlXHJcbiAgICogICAgIDxwcmU+PGNvZGU+XHJcbiAgICogICAgIHJldHVybiBmb287XHJcbiAgICogICAgIDwvcHJlPjwvY29kZT5cclxuICAgKiBvclxyXG4gICAqICAgICA8cHJlPjxjb2RlPlxyXG4gICAqICAgICBzdWNjZXNzKGZvbyk7XHJcbiAgICogICAgIDwvcHJlPjwvY29kZT5cclxuICAgKiAgVG8gcmV0dXJuIGFuIGVycm9yIHlvdSBjYW4gdXNlXHJcbiAgICogICAgIDxwcmU+PGNvZGU+XHJcbiAgICogICAgIHRocm93IG5ldyBFcnJvcihcImZvbyBlcnJvclwiKTtcclxuICAgKiAgICAgPC9jb2RlPjwvcHJlPlxyXG4gICAqIG9yXHJcbiAgICogICAgIDxwcmU+PGNvZGU+XHJcbiAgICogICAgIGVycm9yKFwiZm9vIGVycm9yXCIpO1xyXG4gICAqICAgICA8L2NvZGU+PC9wcmU+XHJcbiAgICpcclxuICAgKiA8aDI+RGVmaW5pbmcgcmVtb3RlbHkgZXhwb3NlZCBtZXRob2RzIChwcm9jZWR1cmVzL25vdGlmaWNhdGlvbnMpPC9oMj5cclxuICAgKiBUaGUgZGVmaW5pdGlvbiBvZiB0aGUgcmVtb3RlIGVuZCBpcyBxdWl0ZSBzaW1pbGFyOlxyXG4gICAqIDxwcmU+PGNvZGU+XHJcbiAgICogdmFyIHJwYyA9IG5ldyBlYXN5WERNLlJwYyh7XHJcbiAgICogJm5ic3A7IC4uLlxyXG4gICAqIH0se1xyXG4gICAqICZuYnNwOyBsb2NhbDogey4uLn0sXHJcbiAgICogJm5ic3A7IHJlbW90ZToge1xyXG4gICAqICZuYnNwOyAmbmJzcDsgbmFtZU9mTWV0aG9kOiB7fVxyXG4gICAqICZuYnNwOyB9XHJcbiAgICogfSk7XHJcbiAgICogPC9jb2RlPjwvcHJlPlxyXG4gICAqIFRvIGNhbGwgYSByZW1vdGUgbWV0aG9kIHVzZVxyXG4gICAqIDxwcmU+PGNvZGU+XHJcbiAgICogcnBjLm5hbWVPZk1ldGhvZChcImFyZzFcIiwgXCJhcmcyXCIsIGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICogJm5ic3A7IGFsZXJ0KFwic3VjY2VzczogXCIgKyB2YWx1ZSk7XHJcbiAgICogfSwgZnVuY3Rpb24obWVzc2FnZSkge1xyXG4gICAqICZuYnNwOyBhbGVydChcImVycm9yOiBcIiArIG1lc3NhZ2UgKyApO1xyXG4gICAqIH0pO1xyXG4gICAqIDwvY29kZT48L3ByZT5cclxuICAgKiBCb3RoIHRoZSA8Y29kZT5zdWNjZXNzPC9jb2RlPiBhbmQgPGNvZGU+ZXJycm9yPC9jb2RlPiBjYWxsYmFja3MgYXJlIG9wdGlvbmFsLjxici8+XHJcbiAgICogV2hlbiBjYWxsZWQgd2l0aCBubyBjYWxsYmFjayBhIEpTT04tUlBDIDIuMCBub3RpZmljYXRpb24gd2lsbCBiZSBleGVjdXRlZC5cclxuICAgKiBCZSBhd2FyZSB0aGF0IHlvdSB3aWxsIG5vdCBiZSBub3RpZmllZCBvZiBhbnkgZXJyb3JzIHdpdGggdGhpcyBtZXRob2QuXHJcbiAgICogPGJyLz5cclxuICAgKiA8aDI+U3BlY2lmeWluZyBhIGN1c3RvbSBzZXJpYWxpemVyPC9oMj5cclxuICAgKiBJZiB5b3UgZG8gbm90IHdhbnQgdG8gdXNlIHRoZSBKU09OMiBsaWJyYXJ5IGZvciBub24tbmF0aXZlIEpTT04gc3VwcG9ydCwgYnV0IGluc3RlYWQgY2FwYWJpbGl0aWVzIHByb3ZpZGVkIGJ5IHNvbWUgb3RoZXIgbGlicmFyeVxyXG4gICAqIHRoZW4geW91IGNhbiBzcGVjaWZ5IGEgY3VzdG9tIHNlcmlhbGl6ZXIgdXNpbmcgPGNvZGU+c2VyaWFsaXplcjogZm9vPC9jb2RlPlxyXG4gICAqIDxwcmU+PGNvZGU+XHJcbiAgICogdmFyIHJwYyA9IG5ldyBlYXN5WERNLlJwYyh7XHJcbiAgICogJm5ic3A7IC4uLlxyXG4gICAqIH0se1xyXG4gICAqICZuYnNwOyBsb2NhbDogey4uLn0sXHJcbiAgICogJm5ic3A7IHJlbW90ZTogey4uLn0sXHJcbiAgICogJm5ic3A7IHNlcmlhbGl6ZXIgOiB7XHJcbiAgICogJm5ic3A7ICZuYnNwOyBwYXJzZTogZnVuY3Rpb24oc3RyaW5nKXsgLi4uIH0sXHJcbiAgICogJm5ic3A7ICZuYnNwOyBzdHJpbmdpZnk6IGZ1bmN0aW9uKG9iamVjdCkgey4uLn1cclxuICAgKiAmbmJzcDsgfVxyXG4gICAqIH0pO1xyXG4gICAqIDwvY29kZT48L3ByZT5cclxuICAgKiBJZiA8Y29kZT5zZXJpYWxpemVyPC9jb2RlPiBpcyBzZXQgdGhlbiB0aGUgY2xhc3Mgd2lsbCBub3QgYXR0ZW1wdCB0byB1c2UgdGhlIG5hdGl2ZSBpbXBsZW1lbnRhdGlvbi5cclxuICAgKiBAbmFtZXNwYWNlIGVhc3lYRE1cclxuICAgKiBAY29uc3RydWN0b3JcclxuICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIFRoZSB1bmRlcmx5aW5nIHRyYW5zcG9ydHMgY29uZmlndXJhdGlvbi4gU2VlIGVhc3lYRE0uU29ja2V0IGZvciBhdmFpbGFibGUgcGFyYW1ldGVycy5cclxuICAgKiBAcGFyYW0ge09iamVjdH0ganNvblJwY0NvbmZpZyBUaGUgZGVzY3JpcHRpb24gb2YgdGhlIGludGVyZmFjZSB0byBpbXBsZW1lbnQuXHJcbiAgICovXG5cblxuICBlYXN5WERNLlJwYyA9IGZ1bmN0aW9uIChjb25maWcsIGpzb25ScGNDb25maWcpIHtcbiAgICAvLyBleHBhbmQgc2hvcnRoYW5kIG5vdGF0aW9uXG4gICAgaWYgKGpzb25ScGNDb25maWcubG9jYWwpIHtcbiAgICAgIGZvciAodmFyIG1ldGhvZCBpbiBqc29uUnBjQ29uZmlnLmxvY2FsKSB7XG4gICAgICAgIGlmIChqc29uUnBjQ29uZmlnLmxvY2FsLmhhc093blByb3BlcnR5KG1ldGhvZCkpIHtcbiAgICAgICAgICB2YXIgbWVtYmVyID0ganNvblJwY0NvbmZpZy5sb2NhbFttZXRob2RdO1xuXG4gICAgICAgICAgaWYgKHR5cGVvZiBtZW1iZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAganNvblJwY0NvbmZpZy5sb2NhbFttZXRob2RdID0ge1xuICAgICAgICAgICAgICBtZXRob2Q6IG1lbWJlclxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IC8vIGNyZWF0ZSB0aGUgc3RhY2tcblxuXG4gICAgdmFyIHN0YWNrID0gY2hhaW5TdGFjayhwcmVwYXJlVHJhbnNwb3J0U3RhY2soY29uZmlnKS5jb25jYXQoW25ldyBlYXN5WERNLnN0YWNrLlJwY0JlaGF2aW9yKHRoaXMsIGpzb25ScGNDb25maWcpLCB7XG4gICAgICBjYWxsYmFjazogZnVuY3Rpb24gY2FsbGJhY2soc3VjY2Vzcykge1xuICAgICAgICBpZiAoY29uZmlnLm9uUmVhZHkpIHtcbiAgICAgICAgICBjb25maWcub25SZWFkeShzdWNjZXNzKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1dKSk7IC8vIHNldCB0aGUgb3JpZ2luXG5cbiAgICB0aGlzLm9yaWdpbiA9IGdldExvY2F0aW9uKGNvbmZpZy5yZW1vdGUpO1xuICAgIC8qKlxyXG4gICAgICogSW5pdGlhdGVzIHRoZSBkZXN0cnVjdGlvbiBvZiB0aGUgc3RhY2suXHJcbiAgICAgKi9cblxuICAgIHRoaXMuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHN0YWNrLmRlc3Ryb3koKTtcbiAgICB9O1xuXG4gICAgc3RhY2suaW5pdCgpO1xuICB9O1xuICAvKmpzbGludCBldmlsOiB0cnVlLCBicm93c2VyOiB0cnVlLCBpbW1lZDogdHJ1ZSwgcGFzc2ZhaWw6IHRydWUsIHVuZGVmOiB0cnVlLCBuZXdjYXA6IHRydWUqL1xuXG4gIC8qZ2xvYmFsIGVhc3lYRE0sIHdpbmRvdywgZXNjYXBlLCB1bmVzY2FwZSwgZ2V0TG9jYXRpb24sIGFwcGVuZFF1ZXJ5UGFyYW1ldGVycywgY3JlYXRlRnJhbWUsIGRlYnVnLCB1biwgb24sIGFwcGx5LCB3aGVuUmVhZHksIGdldFBhcmVudE9iamVjdCwgSUZSQU1FX1BSRUZJWCovXG4gIC8vXG4gIC8vIGVhc3lYRE1cbiAgLy8gaHR0cDovL2Vhc3l4ZG0ubmV0L1xuICAvLyBDb3B5cmlnaHQoYykgMjAwOS0yMDExLCDDmHl2aW5kIFNlYW4gS2luc2V5LCBveXZpbmRAa2luc2V5Lm5vLlxuICAvL1xuICAvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gIC8vIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAgLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICAvLyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gIC8vIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICAvLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuICAvL1xuICAvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICAvLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAgLy9cbiAgLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICAvLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAgLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gIC8vIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAgLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAgLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICAvLyBUSEUgU09GVFdBUkUuXG4gIC8vXG5cbiAgLyoqXHJcbiAgICogQGNsYXNzIGVhc3lYRE0uc3RhY2suU2FtZU9yaWdpblRyYW5zcG9ydFxyXG4gICAqIFNhbWVPcmlnaW5UcmFuc3BvcnQgaXMgYSB0cmFuc3BvcnQgY2xhc3MgdGhhdCBjYW4gYmUgdXNlZCB3aGVuIGJvdGggZG9tYWlucyBoYXZlIHRoZSBzYW1lIG9yaWdpbi48YnIvPlxyXG4gICAqIFRoaXMgY2FuIGJlIHVzZWZ1bCBmb3IgdGVzdGluZyBhbmQgZm9yIHdoZW4gdGhlIG1haW4gYXBwbGljYXRpb24gc3VwcG9ydHMgYm90aCBpbnRlcm5hbCBhbmQgZXh0ZXJuYWwgc291cmNlcy5cclxuICAgKiBAbmFtZXNwYWNlIGVhc3lYRE0uc3RhY2tcclxuICAgKiBAY29uc3RydWN0b3JcclxuICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIFRoZSB0cmFuc3BvcnRzIGNvbmZpZ3VyYXRpb24uXHJcbiAgICogQGNmZyB7U3RyaW5nfSByZW1vdGUgVGhlIHJlbW90ZSBkb2N1bWVudCB0byBjb21tdW5pY2F0ZSB3aXRoLlxyXG4gICAqL1xuXG5cbiAgZWFzeVhETS5zdGFjay5TYW1lT3JpZ2luVHJhbnNwb3J0ID0gZnVuY3Rpb24gKGNvbmZpZykge1xuICAgIHZhciBwdWIsIGZyYW1lLCBzZW5kLCB0YXJnZXRPcmlnaW47XG4gICAgcmV0dXJuIHB1YiA9IHtcbiAgICAgIG91dGdvaW5nOiBmdW5jdGlvbiBvdXRnb2luZyhtZXNzYWdlLCBkb21haW4sIGZuKSB7XG4gICAgICAgIHNlbmQobWVzc2FnZSk7XG5cbiAgICAgICAgaWYgKGZuKSB7XG4gICAgICAgICAgZm4oKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgIGlmIChmcmFtZSkge1xuICAgICAgICAgIGZyYW1lLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZnJhbWUpO1xuICAgICAgICAgIGZyYW1lID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9uRE9NUmVhZHk6IGZ1bmN0aW9uIG9uRE9NUmVhZHkoKSB7XG4gICAgICAgIHRhcmdldE9yaWdpbiA9IGdldExvY2F0aW9uKGNvbmZpZy5yZW1vdGUpO1xuXG4gICAgICAgIGlmIChjb25maWcuaXNIb3N0KSB7XG4gICAgICAgICAgLy8gc2V0IHVwIHRoZSBpZnJhbWVcbiAgICAgICAgICBhcHBseShjb25maWcucHJvcHMsIHtcbiAgICAgICAgICAgIHNyYzogYXBwZW5kUXVlcnlQYXJhbWV0ZXJzKGNvbmZpZy5yZW1vdGUsIHtcbiAgICAgICAgICAgICAgeGRtX2U6IGxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgbG9jYXRpb24uaG9zdCArIGxvY2F0aW9uLnBhdGhuYW1lLFxuICAgICAgICAgICAgICB4ZG1fYzogY29uZmlnLmNoYW5uZWwsXG4gICAgICAgICAgICAgIHhkbV9wOiA0IC8vIDQgPSBTYW1lT3JpZ2luVHJhbnNwb3J0XG5cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgbmFtZTogSUZSQU1FX1BSRUZJWCArIGNvbmZpZy5jaGFubmVsICsgXCJfcHJvdmlkZXJcIlxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGZyYW1lID0gY3JlYXRlRnJhbWUoY29uZmlnKTtcbiAgICAgICAgICBlYXN5WERNLkZuLnNldChjb25maWcuY2hhbm5lbCwgZnVuY3Rpb24gKHNlbmRGbikge1xuICAgICAgICAgICAgc2VuZCA9IHNlbmRGbjtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBwdWIudXAuY2FsbGJhY2sodHJ1ZSk7XG4gICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAobXNnKSB7XG4gICAgICAgICAgICAgIHB1Yi51cC5pbmNvbWluZyhtc2csIHRhcmdldE9yaWdpbik7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNlbmQgPSBnZXRQYXJlbnRPYmplY3QoKS5Gbi5nZXQoY29uZmlnLmNoYW5uZWwsIHRydWUpKGZ1bmN0aW9uIChtc2cpIHtcbiAgICAgICAgICAgIHB1Yi51cC5pbmNvbWluZyhtc2csIHRhcmdldE9yaWdpbik7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBwdWIudXAuY2FsbGJhY2sodHJ1ZSk7XG4gICAgICAgICAgfSwgMCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBpbml0OiBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICB3aGVuUmVhZHkocHViLm9uRE9NUmVhZHksIHB1Yik7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcbiAgLypqc2xpbnQgZXZpbDogdHJ1ZSwgYnJvd3NlcjogdHJ1ZSwgaW1tZWQ6IHRydWUsIHBhc3NmYWlsOiB0cnVlLCB1bmRlZjogdHJ1ZSwgbmV3Y2FwOiB0cnVlKi9cblxuICAvKmdsb2JhbCBnbG9iYWwsIGVhc3lYRE0sIHdpbmRvdywgZ2V0TG9jYXRpb24sIGFwcGVuZFF1ZXJ5UGFyYW1ldGVycywgY3JlYXRlRnJhbWUsIGRlYnVnLCBhcHBseSwgd2hlblJlYWR5LCBJRlJBTUVfUFJFRklYLCBuYW1lc3BhY2UsIHJlc29sdmVVcmwsIGdldERvbWFpbk5hbWUsIEhBU19GTEFTSF9USFJPVFRMRURfQlVHLCBnZXRQb3J0LCBxdWVyeSovXG4gIC8vXG4gIC8vIGVhc3lYRE1cbiAgLy8gaHR0cDovL2Vhc3l4ZG0ubmV0L1xuICAvLyBDb3B5cmlnaHQoYykgMjAwOS0yMDExLCDDmHl2aW5kIFNlYW4gS2luc2V5LCBveXZpbmRAa2luc2V5Lm5vLlxuICAvL1xuICAvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gIC8vIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAgLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICAvLyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gIC8vIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICAvLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuICAvL1xuICAvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICAvLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAgLy9cbiAgLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICAvLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAgLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gIC8vIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAgLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAgLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICAvLyBUSEUgU09GVFdBUkUuXG4gIC8vXG5cbiAgLyoqXHJcbiAgICogQGNsYXNzIGVhc3lYRE0uc3RhY2suRmxhc2hUcmFuc3BvcnRcclxuICAgKiBGbGFzaFRyYW5zcG9ydCBpcyBhIHRyYW5zcG9ydCBjbGFzcyB0aGF0IHVzZXMgYW4gU1dGIHdpdGggTG9jYWxDb25uZWN0aW9uIHRvIHBhc3MgbWVzc2FnZXMgYmFjayBhbmQgZm9ydGguXHJcbiAgICogQG5hbWVzcGFjZSBlYXN5WERNLnN0YWNrXHJcbiAgICogQGNvbnN0cnVjdG9yXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZyBUaGUgdHJhbnNwb3J0cyBjb25maWd1cmF0aW9uLlxyXG4gICAqIEBjZmcge1N0cmluZ30gcmVtb3RlIFRoZSByZW1vdGUgZG9tYWluIHRvIGNvbW11bmljYXRlIHdpdGguXHJcbiAgICogQGNmZyB7U3RyaW5nfSBzZWNyZXQgdGhlIHByZS1zaGFyZWQgc2VjcmV0IHVzZWQgdG8gc2VjdXJlIHRoZSBjb21tdW5pY2F0aW9uLlxyXG4gICAqIEBjZmcge1N0cmluZ30gc3dmIFRoZSBwYXRoIHRvIHRoZSBzd2YgZmlsZVxyXG4gICAqIEBjZmcge0Jvb2xlYW59IHN3Zk5vVGhyb3R0bGUgU2V0IHRoaXMgdG8gdHJ1ZSBpZiB5b3Ugd2FudCB0byB0YWtlIHN0ZXBzIHRvIGF2b2lkIGJlZWluZyB0aHJvdHRsZWQgd2hlbiBoaWRkZW4uXHJcbiAgICogQGNmZyB7U3RyaW5nIHx8IERPTUVsZW1lbnR9IHN3ZkNvbnRhaW5lciBTZXQgdGhpcyBpZiB5b3Ugd2FudCB0byBjb250cm9sIHdoZXJlIHRoZSBzd2YgaXMgcGxhY2VkXHJcbiAgICovXG5cblxuICBlYXN5WERNLnN0YWNrLkZsYXNoVHJhbnNwb3J0ID0gZnVuY3Rpb24gKGNvbmZpZykge1xuICAgIHZhciBwdWIsIC8vIHRoZSBwdWJsaWMgaW50ZXJmYWNlXG4gICAgZnJhbWUsIHNlbmQsIHRhcmdldE9yaWdpbiwgc3dmLCBzd2ZDb250YWluZXI7XG5cbiAgICBmdW5jdGlvbiBvbk1lc3NhZ2UobWVzc2FnZSwgb3JpZ2luKSB7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcHViLnVwLmluY29taW5nKG1lc3NhZ2UsIHRhcmdldE9yaWdpbik7XG4gICAgICB9LCAwKTtcbiAgICB9XG4gICAgLyoqXHJcbiAgICAgKiBUaGlzIG1ldGhvZCBhZGRzIHRoZSBTV0YgdG8gdGhlIERPTSBhbmQgcHJlcGFyZXMgdGhlIGluaXRpYWxpemF0aW9uIG9mIHRoZSBjaGFubmVsXHJcbiAgICAgKi9cblxuXG4gICAgZnVuY3Rpb24gYWRkU3dmKGRvbWFpbikge1xuICAgICAgLy8gdGhlIGRpZmZlcmVudGlhdGluZyBxdWVyeSBhcmd1bWVudCBpcyBuZWVkZWQgaW4gRmxhc2g5IHRvIGF2b2lkIGEgY2FjaGluZyBpc3N1ZSB3aGVyZSBMb2NhbENvbm5lY3Rpb24gd291bGQgdGhyb3cgYW4gZXJyb3IuXG4gICAgICB2YXIgdXJsID0gY29uZmlnLnN3ZiArIFwiP2hvc3Q9XCIgKyBjb25maWcuaXNIb3N0O1xuICAgICAgdmFyIGlkID0gXCJlYXN5WERNX3N3Zl9cIiArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwKTsgLy8gcHJlcGFyZSB0aGUgaW5pdCBmdW5jdGlvbiB0aGF0IHdpbGwgZmlyZSBvbmNlIHRoZSBzd2YgaXMgcmVhZHlcblxuICAgICAgZWFzeVhETS5Gbi5zZXQoXCJmbGFzaF9sb2FkZWRcIiArIGRvbWFpbi5yZXBsYWNlKC9bXFwtLl0vZywgXCJfXCIpLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGVhc3lYRE0uc3RhY2suRmxhc2hUcmFuc3BvcnRbZG9tYWluXS5zd2YgPSBzd2YgPSBzd2ZDb250YWluZXIuZmlyc3RDaGlsZDtcbiAgICAgICAgdmFyIHF1ZXVlID0gZWFzeVhETS5zdGFjay5GbGFzaFRyYW5zcG9ydFtkb21haW5dLnF1ZXVlO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcXVldWUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBxdWV1ZVtpXSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcXVldWUubGVuZ3RoID0gMDtcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoY29uZmlnLnN3ZkNvbnRhaW5lcikge1xuICAgICAgICBzd2ZDb250YWluZXIgPSB0eXBlb2YgY29uZmlnLnN3ZkNvbnRhaW5lciA9PSBcInN0cmluZ1wiID8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29uZmlnLnN3ZkNvbnRhaW5lcikgOiBjb25maWcuc3dmQ29udGFpbmVyO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gY3JlYXRlIHRoZSBjb250YWluZXIgdGhhdCB3aWxsIGhvbGQgdGhlIHN3ZlxuICAgICAgICBzd2ZDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsgLy8gaHR0cDovL2J1Z3MuYWRvYmUuY29tL2ppcmEvYnJvd3NlL0ZQLTQ3OTZcbiAgICAgICAgLy8gaHR0cDovL3RlY2guZ3JvdXBzLnlhaG9vLmNvbS9ncm91cC9mbGV4Y29kZXJzL21lc3NhZ2UvMTYyMzY1XG4gICAgICAgIC8vIGh0dHBzOi8vZ3JvdXBzLmdvb2dsZS5jb20vZm9ydW0vIyF0b3BpYy9lYXN5eGRtL21KWkpoV2Fnb0xjXG5cbiAgICAgICAgYXBwbHkoc3dmQ29udGFpbmVyLnN0eWxlLCBIQVNfRkxBU0hfVEhST1RUTEVEX0JVRyAmJiBjb25maWcuc3dmTm9UaHJvdHRsZSA/IHtcbiAgICAgICAgICBoZWlnaHQ6IFwiMjBweFwiLFxuICAgICAgICAgIHdpZHRoOiBcIjIwcHhcIixcbiAgICAgICAgICBwb3NpdGlvbjogXCJmaXhlZFwiLFxuICAgICAgICAgIHJpZ2h0OiAwLFxuICAgICAgICAgIHRvcDogMFxuICAgICAgICB9IDoge1xuICAgICAgICAgIGhlaWdodDogXCIxcHhcIixcbiAgICAgICAgICB3aWR0aDogXCIxcHhcIixcbiAgICAgICAgICBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLFxuICAgICAgICAgIG92ZXJmbG93OiBcImhpZGRlblwiLFxuICAgICAgICAgIHJpZ2h0OiAwLFxuICAgICAgICAgIHRvcDogMFxuICAgICAgICB9KTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzd2ZDb250YWluZXIpO1xuICAgICAgfSAvLyBjcmVhdGUgdGhlIG9iamVjdC9lbWJlZFxuXG5cbiAgICAgIHZhciBmbGFzaFZhcnMgPSBcImNhbGxiYWNrPWZsYXNoX2xvYWRlZFwiICsgZW5jb2RlVVJJQ29tcG9uZW50KGRvbWFpbi5yZXBsYWNlKC9bXFwtLl0vZywgXCJfXCIpKSArIFwiJnByb3RvPVwiICsgZ2xvYmFsLmxvY2F0aW9uLnByb3RvY29sICsgXCImZG9tYWluPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KGdldERvbWFpbk5hbWUoZ2xvYmFsLmxvY2F0aW9uLmhyZWYpKSArIFwiJnBvcnQ9XCIgKyBlbmNvZGVVUklDb21wb25lbnQoZ2V0UG9ydChnbG9iYWwubG9jYXRpb24uaHJlZikpICsgXCImbnM9XCIgKyBlbmNvZGVVUklDb21wb25lbnQobmFtZXNwYWNlKTtcbiAgICAgIHN3ZkNvbnRhaW5lci5pbm5lckhUTUwgPSBcIjxvYmplY3QgaGVpZ2h0PScyMCcgd2lkdGg9JzIwJyB0eXBlPSdhcHBsaWNhdGlvbi94LXNob2Nrd2F2ZS1mbGFzaCcgaWQ9J1wiICsgaWQgKyBcIicgZGF0YT0nXCIgKyB1cmwgKyBcIic+XCIgKyBcIjxwYXJhbSBuYW1lPSdhbGxvd1NjcmlwdEFjY2VzcycgdmFsdWU9J2Fsd2F5cyc+PC9wYXJhbT5cIiArIFwiPHBhcmFtIG5hbWU9J3dtb2RlJyB2YWx1ZT0ndHJhbnNwYXJlbnQnPlwiICsgXCI8cGFyYW0gbmFtZT0nbW92aWUnIHZhbHVlPSdcIiArIHVybCArIFwiJz48L3BhcmFtPlwiICsgXCI8cGFyYW0gbmFtZT0nZmxhc2h2YXJzJyB2YWx1ZT0nXCIgKyBmbGFzaFZhcnMgKyBcIic+PC9wYXJhbT5cIiArIFwiPGVtYmVkIHR5cGU9J2FwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoJyBGbGFzaFZhcnM9J1wiICsgZmxhc2hWYXJzICsgXCInIGFsbG93U2NyaXB0QWNjZXNzPSdhbHdheXMnIHdtb2RlPSd0cmFuc3BhcmVudCcgc3JjPSdcIiArIHVybCArIFwiJyBoZWlnaHQ9JzEnIHdpZHRoPScxJz48L2VtYmVkPlwiICsgXCI8L29iamVjdD5cIjtcbiAgICB9XG5cbiAgICByZXR1cm4gcHViID0ge1xuICAgICAgb3V0Z29pbmc6IGZ1bmN0aW9uIG91dGdvaW5nKG1lc3NhZ2UsIGRvbWFpbiwgZm4pIHtcbiAgICAgICAgc3dmLnBvc3RNZXNzYWdlKGNvbmZpZy5jaGFubmVsLCBtZXNzYWdlLnRvU3RyaW5nKCkpO1xuXG4gICAgICAgIGlmIChmbikge1xuICAgICAgICAgIGZuKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBkZXN0cm95OiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHN3Zi5kZXN0cm95Q2hhbm5lbChjb25maWcuY2hhbm5lbCk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHt9XG5cbiAgICAgICAgc3dmID0gbnVsbDtcblxuICAgICAgICBpZiAoZnJhbWUpIHtcbiAgICAgICAgICBmcmFtZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGZyYW1lKTtcbiAgICAgICAgICBmcmFtZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBvbkRPTVJlYWR5OiBmdW5jdGlvbiBvbkRPTVJlYWR5KCkge1xuICAgICAgICB0YXJnZXRPcmlnaW4gPSBjb25maWcucmVtb3RlOyAvLyBQcmVwYXJlIHRoZSBjb2RlIHRoYXQgd2lsbCBiZSBydW4gYWZ0ZXIgdGhlIHN3ZiBoYXMgYmVlbiBpbnRpYWxpemVkXG5cbiAgICAgICAgZWFzeVhETS5Gbi5zZXQoXCJmbGFzaF9cIiArIGNvbmZpZy5jaGFubmVsICsgXCJfaW5pdFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBwdWIudXAuY2FsbGJhY2sodHJ1ZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pOyAvLyBzZXQgdXAgdGhlIG9tTWVzc2FnZSBoYW5kbGVyXG5cbiAgICAgICAgZWFzeVhETS5Gbi5zZXQoXCJmbGFzaF9cIiArIGNvbmZpZy5jaGFubmVsICsgXCJfb25NZXNzYWdlXCIsIG9uTWVzc2FnZSk7XG4gICAgICAgIGNvbmZpZy5zd2YgPSByZXNvbHZlVXJsKGNvbmZpZy5zd2YpOyAvLyByZXBvcnRzIGhhdmUgYmVlbiBtYWRlIG9mIHJlcXVlc3RzIGdvbmUgcm9ndWUgd2hlbiB1c2luZyByZWxhdGl2ZSBwYXRoc1xuXG4gICAgICAgIHZhciBzd2Zkb21haW4gPSBnZXREb21haW5OYW1lKGNvbmZpZy5zd2YpO1xuXG4gICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uIGZuKCkge1xuICAgICAgICAgIC8vIHNldCBpbml0IHRvIHRydWUgaW4gY2FzZSB0aGUgZm4gd2FzIGNhbGxlZCB3YXMgaW52b2tlZCBmcm9tIGEgc2VwYXJhdGUgaW5zdGFuY2VcbiAgICAgICAgICBlYXN5WERNLnN0YWNrLkZsYXNoVHJhbnNwb3J0W3N3ZmRvbWFpbl0uaW5pdCA9IHRydWU7XG4gICAgICAgICAgc3dmID0gZWFzeVhETS5zdGFjay5GbGFzaFRyYW5zcG9ydFtzd2Zkb21haW5dLnN3ZjsgLy8gY3JlYXRlIHRoZSBjaGFubmVsXG5cbiAgICAgICAgICBzd2YuY3JlYXRlQ2hhbm5lbChjb25maWcuY2hhbm5lbCwgY29uZmlnLnNlY3JldCwgZ2V0TG9jYXRpb24oY29uZmlnLnJlbW90ZSksIGNvbmZpZy5pc0hvc3QpO1xuXG4gICAgICAgICAgaWYgKGNvbmZpZy5pc0hvc3QpIHtcbiAgICAgICAgICAgIC8vIGlmIEZsYXNoIGlzIGdvaW5nIHRvIGJlIHRocm90dGxlZCBhbmQgd2Ugd2FudCB0byBhdm9pZCB0aGlzXG4gICAgICAgICAgICBpZiAoSEFTX0ZMQVNIX1RIUk9UVExFRF9CVUcgJiYgY29uZmlnLnN3Zk5vVGhyb3R0bGUpIHtcbiAgICAgICAgICAgICAgYXBwbHkoY29uZmlnLnByb3BzLCB7XG4gICAgICAgICAgICAgICAgcG9zaXRpb246IFwiZml4ZWRcIixcbiAgICAgICAgICAgICAgICByaWdodDogMCxcbiAgICAgICAgICAgICAgICB0b3A6IDAsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBcIjIwcHhcIixcbiAgICAgICAgICAgICAgICB3aWR0aDogXCIyMHB4XCJcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IC8vIHNldCB1cCB0aGUgaWZyYW1lXG5cblxuICAgICAgICAgICAgYXBwbHkoY29uZmlnLnByb3BzLCB7XG4gICAgICAgICAgICAgIHNyYzogYXBwZW5kUXVlcnlQYXJhbWV0ZXJzKGNvbmZpZy5yZW1vdGUsIHtcbiAgICAgICAgICAgICAgICB4ZG1fZTogZ2V0TG9jYXRpb24obG9jYXRpb24uaHJlZiksXG4gICAgICAgICAgICAgICAgeGRtX2M6IGNvbmZpZy5jaGFubmVsLFxuICAgICAgICAgICAgICAgIHhkbV9wOiA2LFxuICAgICAgICAgICAgICAgIC8vIDYgPSBGbGFzaFRyYW5zcG9ydFxuICAgICAgICAgICAgICAgIHhkbV9zOiBjb25maWcuc2VjcmV0XG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICBuYW1lOiBJRlJBTUVfUFJFRklYICsgY29uZmlnLmNoYW5uZWwgKyBcIl9wcm92aWRlclwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGZyYW1lID0gY3JlYXRlRnJhbWUoY29uZmlnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKGVhc3lYRE0uc3RhY2suRmxhc2hUcmFuc3BvcnRbc3dmZG9tYWluXSAmJiBlYXN5WERNLnN0YWNrLkZsYXNoVHJhbnNwb3J0W3N3ZmRvbWFpbl0uaW5pdCkge1xuICAgICAgICAgIC8vIGlmIHRoZSBzd2YgaXMgaW4gcGxhY2UgYW5kIHdlIGFyZSB0aGUgY29uc3VtZXJcbiAgICAgICAgICBmbigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIGlmIHRoZSBzd2YgZG9lcyBub3QgeWV0IGV4aXN0XG4gICAgICAgICAgaWYgKCFlYXN5WERNLnN0YWNrLkZsYXNoVHJhbnNwb3J0W3N3ZmRvbWFpbl0pIHtcbiAgICAgICAgICAgIC8vIGFkZCB0aGUgcXVldWUgdG8gaG9sZCB0aGUgaW5pdCBmbidzXG4gICAgICAgICAgICBlYXN5WERNLnN0YWNrLkZsYXNoVHJhbnNwb3J0W3N3ZmRvbWFpbl0gPSB7XG4gICAgICAgICAgICAgIHF1ZXVlOiBbZm5dXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYWRkU3dmKHN3ZmRvbWFpbik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVhc3lYRE0uc3RhY2suRmxhc2hUcmFuc3BvcnRbc3dmZG9tYWluXS5xdWV1ZS5wdXNoKGZuKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBpbml0OiBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICB3aGVuUmVhZHkocHViLm9uRE9NUmVhZHksIHB1Yik7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcbiAgLypqc2xpbnQgZXZpbDogdHJ1ZSwgYnJvd3NlcjogdHJ1ZSwgaW1tZWQ6IHRydWUsIHBhc3NmYWlsOiB0cnVlLCB1bmRlZjogdHJ1ZSwgbmV3Y2FwOiB0cnVlKi9cblxuICAvKmdsb2JhbCBlYXN5WERNLCB3aW5kb3csIGVzY2FwZSwgdW5lc2NhcGUsIGdldExvY2F0aW9uLCBhcHBlbmRRdWVyeVBhcmFtZXRlcnMsIGNyZWF0ZUZyYW1lLCBkZWJ1ZywgdW4sIG9uLCBhcHBseSwgd2hlblJlYWR5LCBJRlJBTUVfUFJFRklYKi9cbiAgLy9cbiAgLy8gZWFzeVhETVxuICAvLyBodHRwOi8vZWFzeXhkbS5uZXQvXG4gIC8vIENvcHlyaWdodChjKSAyMDA5LTIwMTEsIMOYeXZpbmQgU2VhbiBLaW5zZXksIG95dmluZEBraW5zZXkubm8uXG4gIC8vXG4gIC8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAgLy8gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICAvLyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gIC8vIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAgLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gIC8vIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4gIC8vXG4gIC8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gIC8vIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICAvL1xuICAvLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gIC8vIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICAvLyBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAgLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICAvLyBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICAvLyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gIC8vIFRIRSBTT0ZUV0FSRS5cbiAgLy9cblxuICAvKipcclxuICAgKiBAY2xhc3MgZWFzeVhETS5zdGFjay5Qb3N0TWVzc2FnZVRyYW5zcG9ydFxyXG4gICAqIFBvc3RNZXNzYWdlVHJhbnNwb3J0IGlzIGEgdHJhbnNwb3J0IGNsYXNzIHRoYXQgdXNlcyBIVE1MNSBwb3N0TWVzc2FnZSBmb3IgY29tbXVuaWNhdGlvbi48YnIvPlxyXG4gICAqIDxhIGhyZWY9XCJodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvbXM2NDQ5NDQoVlMuODUpLmFzcHhcIj5odHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvbXM2NDQ5NDQoVlMuODUpLmFzcHg8L2E+PGJyLz5cclxuICAgKiA8YSBocmVmPVwiaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vRE9NL3dpbmRvdy5wb3N0TWVzc2FnZVwiPmh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL0RPTS93aW5kb3cucG9zdE1lc3NhZ2U8L2E+XHJcbiAgICogQG5hbWVzcGFjZSBlYXN5WERNLnN0YWNrXHJcbiAgICogQGNvbnN0cnVjdG9yXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZyBUaGUgdHJhbnNwb3J0cyBjb25maWd1cmF0aW9uLlxyXG4gICAqIEBjZmcge1N0cmluZ30gcmVtb3RlIFRoZSByZW1vdGUgZG9tYWluIHRvIGNvbW11bmljYXRlIHdpdGguXHJcbiAgICovXG5cblxuICBlYXN5WERNLnN0YWNrLlBvc3RNZXNzYWdlVHJhbnNwb3J0ID0gZnVuY3Rpb24gKGNvbmZpZykge1xuICAgIHZhciBwdWIsIC8vIHRoZSBwdWJsaWMgaW50ZXJmYWNlXG4gICAgZnJhbWUsIC8vIHRoZSByZW1vdGUgZnJhbWUsIGlmIGFueVxuICAgIGNhbGxlcldpbmRvdywgLy8gdGhlIHdpbmRvdyB0aGF0IHdlIHdpbGwgY2FsbCB3aXRoXG4gICAgdGFyZ2V0T3JpZ2luOyAvLyB0aGUgZG9tYWluIHRvIGNvbW11bmljYXRlIHdpdGhcblxuICAgIC8qKlxyXG4gICAgICogUmVzb2x2ZXMgdGhlIG9yaWdpbiBmcm9tIHRoZSBldmVudCBvYmplY3RcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZXZlbnQgVGhlIG1lc3NhZ2VldmVudFxyXG4gICAgICogQHJldHVybiB7U3RyaW5nfSBUaGUgc2NoZW1lLCBob3N0IGFuZCBwb3J0IG9mIHRoZSBvcmlnaW5cclxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gX2dldE9yaWdpbihldmVudCkge1xuICAgICAgaWYgKGV2ZW50Lm9yaWdpbikge1xuICAgICAgICAvLyBUaGlzIGlzIHRoZSBIVE1MNSBwcm9wZXJ0eVxuICAgICAgICByZXR1cm4gZ2V0TG9jYXRpb24oZXZlbnQub3JpZ2luKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGV2ZW50LnVyaSkge1xuICAgICAgICAvLyBGcm9tIGVhcmxpZXIgaW1wbGVtZW50YXRpb25zXG4gICAgICAgIHJldHVybiBnZXRMb2NhdGlvbihldmVudC51cmkpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZXZlbnQuZG9tYWluKSB7XG4gICAgICAgIC8vIFRoaXMgaXMgdGhlIGxhc3Qgb3B0aW9uIGFuZCB3aWxsIGZhaWwgaWYgdGhlXG4gICAgICAgIC8vIG9yaWdpbiBpcyBub3QgdXNpbmcgdGhlIHNhbWUgc2NoZW1hIGFzIHdlIGFyZVxuICAgICAgICByZXR1cm4gbG9jYXRpb24ucHJvdG9jb2wgKyBcIi8vXCIgKyBldmVudC5kb21haW47XG4gICAgICB9XG5cbiAgICAgIHRocm93IFwiVW5hYmxlIHRvIHJldHJpZXZlIHRoZSBvcmlnaW4gb2YgdGhlIGV2ZW50XCI7XG4gICAgfVxuICAgIC8qKlxyXG4gICAgICogVGhpcyBpcyB0aGUgbWFpbiBpbXBsZW1lbnRhdGlvbiBmb3IgdGhlIG9uTWVzc2FnZSBldmVudC48YnIvPlxyXG4gICAgICogSXQgY2hlY2tzIHRoZSB2YWxpZGl0eSBvZiB0aGUgb3JpZ2luIGFuZCBwYXNzZXMgdGhlIG1lc3NhZ2Ugb24gaWYgYXBwcm9wcmlhdGUuXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGV2ZW50IFRoZSBtZXNzYWdlZXZlbnRcclxuICAgICAqL1xuXG5cbiAgICBmdW5jdGlvbiBfd2luZG93X29uTWVzc2FnZShldmVudCkge1xuICAgICAgdmFyIG9yaWdpbiA9IF9nZXRPcmlnaW4oZXZlbnQpO1xuXG4gICAgICBpZiAob3JpZ2luID09IHRhcmdldE9yaWdpbiAmJiBldmVudC5kYXRhLnN1YnN0cmluZygwLCBjb25maWcuY2hhbm5lbC5sZW5ndGggKyAxKSA9PSBjb25maWcuY2hhbm5lbCArIFwiIFwiKSB7XG4gICAgICAgIHB1Yi51cC5pbmNvbWluZyhldmVudC5kYXRhLnN1YnN0cmluZyhjb25maWcuY2hhbm5lbC5sZW5ndGggKyAxKSwgb3JpZ2luKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcHViID0ge1xuICAgICAgb3V0Z29pbmc6IGZ1bmN0aW9uIG91dGdvaW5nKG1lc3NhZ2UsIGRvbWFpbiwgZm4pIHtcbiAgICAgICAgY2FsbGVyV2luZG93LnBvc3RNZXNzYWdlKGNvbmZpZy5jaGFubmVsICsgXCIgXCIgKyBtZXNzYWdlLCBkb21haW4gfHwgdGFyZ2V0T3JpZ2luKTtcblxuICAgICAgICBpZiAoZm4pIHtcbiAgICAgICAgICBmbigpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGVzdHJveTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgdW4od2luZG93LCBcIm1lc3NhZ2VcIiwgX3dpbmRvd19vbk1lc3NhZ2UpO1xuXG4gICAgICAgIGlmIChmcmFtZSkge1xuICAgICAgICAgIGNhbGxlcldpbmRvdyA9IG51bGw7XG4gICAgICAgICAgZnJhbWUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChmcmFtZSk7XG4gICAgICAgICAgZnJhbWUgPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgb25ET01SZWFkeTogZnVuY3Rpb24gb25ET01SZWFkeSgpIHtcbiAgICAgICAgdGFyZ2V0T3JpZ2luID0gZ2V0TG9jYXRpb24oY29uZmlnLnJlbW90ZSk7XG5cbiAgICAgICAgaWYgKGNvbmZpZy5pc0hvc3QpIHtcbiAgICAgICAgICAvLyBhZGQgdGhlIGV2ZW50IGhhbmRsZXIgZm9yIGxpc3RlbmluZ1xuICAgICAgICAgIHZhciB3YWl0Rm9yUmVhZHkgPSBmdW5jdGlvbiB3YWl0Rm9yUmVhZHkoZXZlbnQpIHtcbiAgICAgICAgICAgIGlmIChldmVudC5kYXRhID09IGNvbmZpZy5jaGFubmVsICsgXCItcmVhZHlcIikge1xuICAgICAgICAgICAgICAvLyByZXBsYWNlIHRoZSBldmVudGxpc3RlbmVyXG4gICAgICAgICAgICAgIGNhbGxlcldpbmRvdyA9IFwicG9zdE1lc3NhZ2VcIiBpbiBmcmFtZS5jb250ZW50V2luZG93ID8gZnJhbWUuY29udGVudFdpbmRvdyA6IGZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7XG4gICAgICAgICAgICAgIHVuKHdpbmRvdywgXCJtZXNzYWdlXCIsIHdhaXRGb3JSZWFkeSk7XG4gICAgICAgICAgICAgIG9uKHdpbmRvdywgXCJtZXNzYWdlXCIsIF93aW5kb3dfb25NZXNzYWdlKTtcbiAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcHViLnVwLmNhbGxiYWNrKHRydWUpO1xuICAgICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgb24od2luZG93LCBcIm1lc3NhZ2VcIiwgd2FpdEZvclJlYWR5KTsgLy8gc2V0IHVwIHRoZSBpZnJhbWVcblxuICAgICAgICAgIGFwcGx5KGNvbmZpZy5wcm9wcywge1xuICAgICAgICAgICAgc3JjOiBhcHBlbmRRdWVyeVBhcmFtZXRlcnMoY29uZmlnLnJlbW90ZSwge1xuICAgICAgICAgICAgICB4ZG1fZTogZ2V0TG9jYXRpb24obG9jYXRpb24uaHJlZiksXG4gICAgICAgICAgICAgIHhkbV9jOiBjb25maWcuY2hhbm5lbCxcbiAgICAgICAgICAgICAgeGRtX3A6IDEgLy8gMSA9IFBvc3RNZXNzYWdlXG5cbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgbmFtZTogSUZSQU1FX1BSRUZJWCArIGNvbmZpZy5jaGFubmVsICsgXCJfcHJvdmlkZXJcIlxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGZyYW1lID0gY3JlYXRlRnJhbWUoY29uZmlnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBhZGQgdGhlIGV2ZW50IGhhbmRsZXIgZm9yIGxpc3RlbmluZ1xuICAgICAgICAgIG9uKHdpbmRvdywgXCJtZXNzYWdlXCIsIF93aW5kb3dfb25NZXNzYWdlKTtcbiAgICAgICAgICBjYWxsZXJXaW5kb3cgPSBcInBvc3RNZXNzYWdlXCIgaW4gd2luZG93LnBhcmVudCA/IHdpbmRvdy5wYXJlbnQgOiB3aW5kb3cucGFyZW50LmRvY3VtZW50O1xuICAgICAgICAgIGNhbGxlcldpbmRvdy5wb3N0TWVzc2FnZShjb25maWcuY2hhbm5lbCArIFwiLXJlYWR5XCIsIHRhcmdldE9yaWdpbik7XG4gICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBwdWIudXAuY2FsbGJhY2sodHJ1ZSk7XG4gICAgICAgICAgfSwgMCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBpbml0OiBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICB3aGVuUmVhZHkocHViLm9uRE9NUmVhZHksIHB1Yik7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcbiAgLypqc2xpbnQgZXZpbDogdHJ1ZSwgYnJvd3NlcjogdHJ1ZSwgaW1tZWQ6IHRydWUsIHBhc3NmYWlsOiB0cnVlLCB1bmRlZjogdHJ1ZSwgbmV3Y2FwOiB0cnVlKi9cblxuICAvKmdsb2JhbCBlYXN5WERNLCB3aW5kb3csIGVzY2FwZSwgdW5lc2NhcGUsIGdldExvY2F0aW9uLCBhcHBlbmRRdWVyeVBhcmFtZXRlcnMsIGNyZWF0ZUZyYW1lLCBkZWJ1ZywgYXBwbHksIHF1ZXJ5LCB3aGVuUmVhZHksIElGUkFNRV9QUkVGSVgqL1xuICAvL1xuICAvLyBlYXN5WERNXG4gIC8vIGh0dHA6Ly9lYXN5eGRtLm5ldC9cbiAgLy8gQ29weXJpZ2h0KGMpIDIwMDktMjAxMSwgw5h5dmluZCBTZWFuIEtpbnNleSwgb3l2aW5kQGtpbnNleS5uby5cbiAgLy9cbiAgLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICAvLyBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gIC8vIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAgLy8gdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICAvLyBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAgLy8gZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbiAgLy9cbiAgLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAgLy8gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gIC8vXG4gIC8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAgLy8gSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gIC8vIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICAvLyBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gIC8vIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gIC8vIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAgLy8gVEhFIFNPRlRXQVJFLlxuICAvL1xuXG4gIC8qKlxyXG4gICAqIEBjbGFzcyBlYXN5WERNLnN0YWNrLkZyYW1lRWxlbWVudFRyYW5zcG9ydFxyXG4gICAqIEZyYW1lRWxlbWVudFRyYW5zcG9ydCBpcyBhIHRyYW5zcG9ydCBjbGFzcyB0aGF0IGNhbiBiZSB1c2VkIHdpdGggR2Vja28tYnJvd3NlciBhcyB0aGVzZSBhbGxvdyBwYXNzaW5nIHZhcmlhYmxlcyB1c2luZyB0aGUgZnJhbWVFbGVtZW50IHByb3BlcnR5Ljxici8+XHJcbiAgICogU2VjdXJpdHkgaXMgbWFpbnRhaW5lZCBhcyBHZWNobyB1c2VzIExleGljYWwgQXV0aG9yaXphdGlvbiB0byBkZXRlcm1pbmUgdW5kZXIgd2hpY2ggc2NvcGUgYSBmdW5jdGlvbiBpcyBydW5uaW5nLlxyXG4gICAqIEBuYW1lc3BhY2UgZWFzeVhETS5zdGFja1xyXG4gICAqIEBjb25zdHJ1Y3RvclxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgVGhlIHRyYW5zcG9ydHMgY29uZmlndXJhdGlvbi5cclxuICAgKiBAY2ZnIHtTdHJpbmd9IHJlbW90ZSBUaGUgcmVtb3RlIGRvY3VtZW50IHRvIGNvbW11bmljYXRlIHdpdGguXHJcbiAgICovXG5cblxuICBlYXN5WERNLnN0YWNrLkZyYW1lRWxlbWVudFRyYW5zcG9ydCA9IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICB2YXIgcHViLCBmcmFtZSwgc2VuZCwgdGFyZ2V0T3JpZ2luO1xuICAgIHJldHVybiBwdWIgPSB7XG4gICAgICBvdXRnb2luZzogZnVuY3Rpb24gb3V0Z29pbmcobWVzc2FnZSwgZG9tYWluLCBmbikge1xuICAgICAgICBzZW5kLmNhbGwodGhpcywgbWVzc2FnZSk7XG5cbiAgICAgICAgaWYgKGZuKSB7XG4gICAgICAgICAgZm4oKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgIGlmIChmcmFtZSkge1xuICAgICAgICAgIGZyYW1lLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZnJhbWUpO1xuICAgICAgICAgIGZyYW1lID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9uRE9NUmVhZHk6IGZ1bmN0aW9uIG9uRE9NUmVhZHkoKSB7XG4gICAgICAgIHRhcmdldE9yaWdpbiA9IGdldExvY2F0aW9uKGNvbmZpZy5yZW1vdGUpO1xuXG4gICAgICAgIGlmIChjb25maWcuaXNIb3N0KSB7XG4gICAgICAgICAgLy8gc2V0IHVwIHRoZSBpZnJhbWVcbiAgICAgICAgICBhcHBseShjb25maWcucHJvcHMsIHtcbiAgICAgICAgICAgIHNyYzogYXBwZW5kUXVlcnlQYXJhbWV0ZXJzKGNvbmZpZy5yZW1vdGUsIHtcbiAgICAgICAgICAgICAgeGRtX2U6IGdldExvY2F0aW9uKGxvY2F0aW9uLmhyZWYpLFxuICAgICAgICAgICAgICB4ZG1fYzogY29uZmlnLmNoYW5uZWwsXG4gICAgICAgICAgICAgIHhkbV9wOiA1IC8vIDUgPSBGcmFtZUVsZW1lbnRUcmFuc3BvcnRcblxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuYW1lOiBJRlJBTUVfUFJFRklYICsgY29uZmlnLmNoYW5uZWwgKyBcIl9wcm92aWRlclwiXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZnJhbWUgPSBjcmVhdGVGcmFtZShjb25maWcpO1xuXG4gICAgICAgICAgZnJhbWUuZm4gPSBmdW5jdGlvbiAoc2VuZEZuKSB7XG4gICAgICAgICAgICBkZWxldGUgZnJhbWUuZm47XG4gICAgICAgICAgICBzZW5kID0gc2VuZEZuO1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHB1Yi51cC5jYWxsYmFjayh0cnVlKTtcbiAgICAgICAgICAgIH0sIDApOyAvLyByZW1vdmUgdGhlIGZ1bmN0aW9uIHNvIHRoYXQgaXQgY2Fubm90IGJlIHVzZWQgdG8gb3ZlcndyaXRlIHRoZSBzZW5kIGZ1bmN0aW9uIGxhdGVyIG9uXG5cbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAobXNnKSB7XG4gICAgICAgICAgICAgIHB1Yi51cC5pbmNvbWluZyhtc2csIHRhcmdldE9yaWdpbik7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gVGhpcyBpcyB0byBtaXRpZ2F0ZSBvcmlnaW4tc3Bvb2ZpbmdcbiAgICAgICAgICBpZiAoZG9jdW1lbnQucmVmZXJyZXIgJiYgZ2V0TG9jYXRpb24oZG9jdW1lbnQucmVmZXJyZXIpICE9IHF1ZXJ5LnhkbV9lKSB7XG4gICAgICAgICAgICB3aW5kb3cudG9wLmxvY2F0aW9uID0gcXVlcnkueGRtX2U7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgc2VuZCA9IHdpbmRvdy5mcmFtZUVsZW1lbnQuZm4oZnVuY3Rpb24gKG1zZykge1xuICAgICAgICAgICAgcHViLnVwLmluY29taW5nKG1zZywgdGFyZ2V0T3JpZ2luKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBwdWIudXAuY2FsbGJhY2sodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBpbml0OiBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICB3aGVuUmVhZHkocHViLm9uRE9NUmVhZHksIHB1Yik7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcbiAgLypqc2xpbnQgZXZpbDogdHJ1ZSwgYnJvd3NlcjogdHJ1ZSwgaW1tZWQ6IHRydWUsIHBhc3NmYWlsOiB0cnVlLCB1bmRlZjogdHJ1ZSwgbmV3Y2FwOiB0cnVlKi9cblxuICAvKmdsb2JhbCBlYXN5WERNLCB3aW5kb3csIGVzY2FwZSwgdW5lc2NhcGUsIHVuZGVmLCBnZXRMb2NhdGlvbiwgYXBwZW5kUXVlcnlQYXJhbWV0ZXJzLCByZXNvbHZlVXJsLCBjcmVhdGVGcmFtZSwgZGVidWcsIHVuLCBhcHBseSwgd2hlblJlYWR5LCBJRlJBTUVfUFJFRklYKi9cbiAgLy9cbiAgLy8gZWFzeVhETVxuICAvLyBodHRwOi8vZWFzeXhkbS5uZXQvXG4gIC8vIENvcHlyaWdodChjKSAyMDA5LTIwMTEsIMOYeXZpbmQgU2VhbiBLaW5zZXksIG95dmluZEBraW5zZXkubm8uXG4gIC8vXG4gIC8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAgLy8gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICAvLyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gIC8vIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAgLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gIC8vIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4gIC8vXG4gIC8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gIC8vIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICAvL1xuICAvLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gIC8vIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICAvLyBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAgLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICAvLyBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICAvLyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gIC8vIFRIRSBTT0ZUV0FSRS5cbiAgLy9cblxuICAvKipcclxuICAgKiBAY2xhc3MgZWFzeVhETS5zdGFjay5OYW1lVHJhbnNwb3J0XHJcbiAgICogTmFtZVRyYW5zcG9ydCB1c2VzIHRoZSB3aW5kb3cubmFtZSBwcm9wZXJ0eSB0byByZWxheSBkYXRhLlxyXG4gICAqIFRoZSA8Y29kZT5sb2NhbDwvY29kZT4gcGFyYW1ldGVyIG5lZWRzIHRvIGJlIHNldCBvbiBib3RoIHRoZSBjb25zdW1lciBhbmQgcHJvdmlkZXIsPGJyLz5cclxuICAgKiBhbmQgdGhlIDxjb2RlPnJlbW90ZUhlbHBlcjwvY29kZT4gcGFyYW1ldGVyIG5lZWRzIHRvIGJlIHNldCBvbiB0aGUgY29uc3VtZXIuXHJcbiAgICogQGNvbnN0cnVjdG9yXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZyBUaGUgdHJhbnNwb3J0cyBjb25maWd1cmF0aW9uLlxyXG4gICAqIEBjZmcge1N0cmluZ30gcmVtb3RlSGVscGVyIFRoZSB1cmwgdG8gdGhlIHJlbW90ZSBpbnN0YW5jZSBvZiBoYXNoLmh0bWwgLSB0aGlzIGlzIG9ubHkgbmVlZGVkIGZvciB0aGUgaG9zdC5cclxuICAgKiBAbmFtZXNwYWNlIGVhc3lYRE0uc3RhY2tcclxuICAgKi9cblxuXG4gIGVhc3lYRE0uc3RhY2suTmFtZVRyYW5zcG9ydCA9IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICB2YXIgcHViOyAvLyB0aGUgcHVibGljIGludGVyZmFjZVxuXG4gICAgdmFyIGlzSG9zdCwgY2FsbGVyV2luZG93LCByZW1vdGVXaW5kb3csIHJlYWR5Q291bnQsIGNhbGxiYWNrLCByZW1vdGVPcmlnaW4sIHJlbW90ZVVybDtcblxuICAgIGZ1bmN0aW9uIF9zZW5kTWVzc2FnZShtZXNzYWdlKSB7XG4gICAgICB2YXIgdXJsID0gY29uZmlnLnJlbW90ZUhlbHBlciArIChpc0hvc3QgPyBcIiNfM1wiIDogXCIjXzJcIikgKyBjb25maWcuY2hhbm5lbDtcbiAgICAgIGNhbGxlcldpbmRvdy5jb250ZW50V2luZG93LnNlbmRNZXNzYWdlKG1lc3NhZ2UsIHVybCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX29uUmVhZHkoKSB7XG4gICAgICBpZiAoaXNIb3N0KSB7XG4gICAgICAgIGlmICgrK3JlYWR5Q291bnQgPT09IDIgfHwgIWlzSG9zdCkge1xuICAgICAgICAgIHB1Yi51cC5jYWxsYmFjayh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX3NlbmRNZXNzYWdlKFwicmVhZHlcIik7XG5cbiAgICAgICAgcHViLnVwLmNhbGxiYWNrKHRydWUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIF9vbk1lc3NhZ2UobWVzc2FnZSkge1xuICAgICAgcHViLnVwLmluY29taW5nKG1lc3NhZ2UsIHJlbW90ZU9yaWdpbik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX29uTG9hZCgpIHtcbiAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBjYWxsYmFjayh0cnVlKTtcbiAgICAgICAgfSwgMCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHB1YiA9IHtcbiAgICAgIG91dGdvaW5nOiBmdW5jdGlvbiBvdXRnb2luZyhtZXNzYWdlLCBkb21haW4sIGZuKSB7XG4gICAgICAgIGNhbGxiYWNrID0gZm47XG5cbiAgICAgICAgX3NlbmRNZXNzYWdlKG1lc3NhZ2UpO1xuICAgICAgfSxcbiAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgIGNhbGxlcldpbmRvdy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGNhbGxlcldpbmRvdyk7XG4gICAgICAgIGNhbGxlcldpbmRvdyA9IG51bGw7XG5cbiAgICAgICAgaWYgKGlzSG9zdCkge1xuICAgICAgICAgIHJlbW90ZVdpbmRvdy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHJlbW90ZVdpbmRvdyk7XG4gICAgICAgICAgcmVtb3RlV2luZG93ID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9uRE9NUmVhZHk6IGZ1bmN0aW9uIG9uRE9NUmVhZHkoKSB7XG4gICAgICAgIGlzSG9zdCA9IGNvbmZpZy5pc0hvc3Q7XG4gICAgICAgIHJlYWR5Q291bnQgPSAwO1xuICAgICAgICByZW1vdGVPcmlnaW4gPSBnZXRMb2NhdGlvbihjb25maWcucmVtb3RlKTtcbiAgICAgICAgY29uZmlnLmxvY2FsID0gcmVzb2x2ZVVybChjb25maWcubG9jYWwpO1xuXG4gICAgICAgIGlmIChpc0hvc3QpIHtcbiAgICAgICAgICAvLyBSZWdpc3RlciB0aGUgY2FsbGJhY2tcbiAgICAgICAgICBlYXN5WERNLkZuLnNldChjb25maWcuY2hhbm5lbCwgZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgIGlmIChpc0hvc3QgJiYgbWVzc2FnZSA9PT0gXCJyZWFkeVwiKSB7XG4gICAgICAgICAgICAgIC8vIFJlcGxhY2UgdGhlIGhhbmRsZXJcbiAgICAgICAgICAgICAgZWFzeVhETS5Gbi5zZXQoY29uZmlnLmNoYW5uZWwsIF9vbk1lc3NhZ2UpO1xuXG4gICAgICAgICAgICAgIF9vblJlYWR5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7IC8vIFNldCB1cCB0aGUgZnJhbWUgdGhhdCBwb2ludHMgdG8gdGhlIHJlbW90ZSBpbnN0YW5jZVxuXG4gICAgICAgICAgcmVtb3RlVXJsID0gYXBwZW5kUXVlcnlQYXJhbWV0ZXJzKGNvbmZpZy5yZW1vdGUsIHtcbiAgICAgICAgICAgIHhkbV9lOiBjb25maWcubG9jYWwsXG4gICAgICAgICAgICB4ZG1fYzogY29uZmlnLmNoYW5uZWwsXG4gICAgICAgICAgICB4ZG1fcDogMlxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGFwcGx5KGNvbmZpZy5wcm9wcywge1xuICAgICAgICAgICAgc3JjOiByZW1vdGVVcmwgKyAnIycgKyBjb25maWcuY2hhbm5lbCxcbiAgICAgICAgICAgIG5hbWU6IElGUkFNRV9QUkVGSVggKyBjb25maWcuY2hhbm5lbCArIFwiX3Byb3ZpZGVyXCJcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZW1vdGVXaW5kb3cgPSBjcmVhdGVGcmFtZShjb25maWcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbmZpZy5yZW1vdGVIZWxwZXIgPSBjb25maWcucmVtb3RlO1xuICAgICAgICAgIGVhc3lYRE0uRm4uc2V0KGNvbmZpZy5jaGFubmVsLCBfb25NZXNzYWdlKTtcbiAgICAgICAgfSAvLyBTZXQgdXAgdGhlIGlmcmFtZSB0aGF0IHdpbGwgYmUgdXNlZCBmb3IgdGhlIHRyYW5zcG9ydFxuXG5cbiAgICAgICAgdmFyIG9uTG9hZCA9IGZ1bmN0aW9uIG9uTG9hZCgpIHtcbiAgICAgICAgICAvLyBSZW1vdmUgdGhlIGhhbmRsZXJcbiAgICAgICAgICB2YXIgdyA9IGNhbGxlcldpbmRvdyB8fCB0aGlzO1xuICAgICAgICAgIHVuKHcsIFwibG9hZFwiLCBvbkxvYWQpO1xuICAgICAgICAgIGVhc3lYRE0uRm4uc2V0KGNvbmZpZy5jaGFubmVsICsgXCJfbG9hZFwiLCBfb25Mb2FkKTtcblxuICAgICAgICAgIChmdW5jdGlvbiB0ZXN0KCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB3LmNvbnRlbnRXaW5kb3cuc2VuZE1lc3NhZ2UgPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgIF9vblJlYWR5KCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzZXRUaW1lb3V0KHRlc3QsIDUwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KSgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGNhbGxlcldpbmRvdyA9IGNyZWF0ZUZyYW1lKHtcbiAgICAgICAgICBwcm9wczoge1xuICAgICAgICAgICAgc3JjOiBjb25maWcubG9jYWwgKyBcIiNfNFwiICsgY29uZmlnLmNoYW5uZWxcbiAgICAgICAgICB9LFxuICAgICAgICAgIG9uTG9hZDogb25Mb2FkXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIGluaXQ6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgIHdoZW5SZWFkeShwdWIub25ET01SZWFkeSwgcHViKTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xuICAvKmpzbGludCBldmlsOiB0cnVlLCBicm93c2VyOiB0cnVlLCBpbW1lZDogdHJ1ZSwgcGFzc2ZhaWw6IHRydWUsIHVuZGVmOiB0cnVlLCBuZXdjYXA6IHRydWUqL1xuXG4gIC8qZ2xvYmFsIGVhc3lYRE0sIHdpbmRvdywgZXNjYXBlLCB1bmVzY2FwZSwgZ2V0TG9jYXRpb24sIGNyZWF0ZUZyYW1lLCBkZWJ1ZywgdW4sIG9uLCBhcHBseSwgd2hlblJlYWR5LCBJRlJBTUVfUFJFRklYKi9cbiAgLy9cbiAgLy8gZWFzeVhETVxuICAvLyBodHRwOi8vZWFzeXhkbS5uZXQvXG4gIC8vIENvcHlyaWdodChjKSAyMDA5LTIwMTEsIMOYeXZpbmQgU2VhbiBLaW5zZXksIG95dmluZEBraW5zZXkubm8uXG4gIC8vXG4gIC8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAgLy8gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICAvLyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gIC8vIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAgLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gIC8vIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4gIC8vXG4gIC8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gIC8vIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICAvL1xuICAvLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gIC8vIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICAvLyBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAgLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICAvLyBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICAvLyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gIC8vIFRIRSBTT0ZUV0FSRS5cbiAgLy9cblxuICAvKipcclxuICAgKiBAY2xhc3MgZWFzeVhETS5zdGFjay5IYXNoVHJhbnNwb3J0XHJcbiAgICogSGFzaFRyYW5zcG9ydCBpcyBhIHRyYW5zcG9ydCBjbGFzcyB0aGF0IHVzZXMgdGhlIElGcmFtZSBVUkwgVGVjaG5pcXVlIGZvciBjb21tdW5pY2F0aW9uLjxici8+XHJcbiAgICogPGEgaHJlZj1cImh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9iYjczNTMwNS5hc3B4XCI+aHR0cDovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L2JiNzM1MzA1LmFzcHg8L2E+PGJyLz5cclxuICAgKiBAbmFtZXNwYWNlIGVhc3lYRE0uc3RhY2tcclxuICAgKiBAY29uc3RydWN0b3JcclxuICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIFRoZSB0cmFuc3BvcnRzIGNvbmZpZ3VyYXRpb24uXHJcbiAgICogQGNmZyB7U3RyaW5nL1dpbmRvd30gbG9jYWwgVGhlIHVybCB0byB0aGUgbG9jYWwgZmlsZSB1c2VkIGZvciBwcm94eWluZyBtZXNzYWdlcywgb3IgdGhlIGxvY2FsIHdpbmRvdy5cclxuICAgKiBAY2ZnIHtOdW1iZXJ9IGRlbGF5IFRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIGVhc3lYRE0gc2hvdWxkIHRyeSB0byBnZXQgYSByZWZlcmVuY2UgdG8gdGhlIGxvY2FsIHdpbmRvdy5cclxuICAgKiBAY2ZnIHtOdW1iZXJ9IGludGVydmFsIFRoZSBpbnRlcnZhbCB1c2VkIHdoZW4gcG9sbGluZyBmb3IgbWVzc2FnZXMuXHJcbiAgICovXG5cblxuICBlYXN5WERNLnN0YWNrLkhhc2hUcmFuc3BvcnQgPSBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgdmFyIHB1YjtcblxuICAgIHZhciBtZSA9IHRoaXMsXG4gICAgICAgIGlzSG9zdCxcbiAgICAgICAgX3RpbWVyLFxuICAgICAgICBwb2xsSW50ZXJ2YWwsXG4gICAgICAgIF9sYXN0TXNnLFxuICAgICAgICBfbXNnTnIsXG4gICAgICAgIF9saXN0ZW5lcldpbmRvdyxcbiAgICAgICAgX2NhbGxlcldpbmRvdztcblxuICAgIHZhciB1c2VQYXJlbnQsIF9yZW1vdGVPcmlnaW47XG5cbiAgICBmdW5jdGlvbiBfc2VuZE1lc3NhZ2UobWVzc2FnZSkge1xuICAgICAgaWYgKCFfY2FsbGVyV2luZG93KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIHVybCA9IGNvbmZpZy5yZW1vdGUgKyBcIiNcIiArIF9tc2dOcisrICsgXCJfXCIgKyBtZXNzYWdlO1xuICAgICAgKGlzSG9zdCB8fCAhdXNlUGFyZW50ID8gX2NhbGxlcldpbmRvdy5jb250ZW50V2luZG93IDogX2NhbGxlcldpbmRvdykubG9jYXRpb24gPSB1cmw7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX2hhbmRsZUhhc2goaGFzaCkge1xuICAgICAgX2xhc3RNc2cgPSBoYXNoO1xuICAgICAgcHViLnVwLmluY29taW5nKF9sYXN0TXNnLnN1YnN0cmluZyhfbGFzdE1zZy5pbmRleE9mKFwiX1wiKSArIDEpLCBfcmVtb3RlT3JpZ2luKTtcbiAgICB9XG4gICAgLyoqXHJcbiAgICAgKiBDaGVja3MgbG9jYXRpb24uaGFzaCBmb3IgYSBuZXcgbWVzc2FnZSBhbmQgcmVsYXlzIHRoaXMgdG8gdGhlIHJlY2VpdmVyLlxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xuXG5cbiAgICBmdW5jdGlvbiBfcG9sbEhhc2goKSB7XG4gICAgICBpZiAoIV9saXN0ZW5lcldpbmRvdykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBocmVmID0gX2xpc3RlbmVyV2luZG93LmxvY2F0aW9uLmhyZWYsXG4gICAgICAgICAgaGFzaCA9IFwiXCIsXG4gICAgICAgICAgaW5kZXhPZiA9IGhyZWYuaW5kZXhPZihcIiNcIik7XG5cbiAgICAgIGlmIChpbmRleE9mICE9IC0xKSB7XG4gICAgICAgIGhhc2ggPSBocmVmLnN1YnN0cmluZyhpbmRleE9mKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGhhc2ggJiYgaGFzaCAhPSBfbGFzdE1zZykge1xuICAgICAgICBfaGFuZGxlSGFzaChoYXNoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBfYXR0YWNoTGlzdGVuZXJzKCkge1xuICAgICAgX3RpbWVyID0gc2V0SW50ZXJ2YWwoX3BvbGxIYXNoLCBwb2xsSW50ZXJ2YWwpO1xuICAgIH1cblxuICAgIHJldHVybiBwdWIgPSB7XG4gICAgICBvdXRnb2luZzogZnVuY3Rpb24gb3V0Z29pbmcobWVzc2FnZSwgZG9tYWluKSB7XG4gICAgICAgIF9zZW5kTWVzc2FnZShtZXNzYWdlKTtcbiAgICAgIH0sXG4gICAgICBkZXN0cm95OiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbChfdGltZXIpO1xuXG4gICAgICAgIGlmIChpc0hvc3QgfHwgIXVzZVBhcmVudCkge1xuICAgICAgICAgIF9jYWxsZXJXaW5kb3cucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChfY2FsbGVyV2luZG93KTtcbiAgICAgICAgfVxuXG4gICAgICAgIF9jYWxsZXJXaW5kb3cgPSBudWxsO1xuICAgICAgfSxcbiAgICAgIG9uRE9NUmVhZHk6IGZ1bmN0aW9uIG9uRE9NUmVhZHkoKSB7XG4gICAgICAgIGlzSG9zdCA9IGNvbmZpZy5pc0hvc3Q7XG4gICAgICAgIHBvbGxJbnRlcnZhbCA9IGNvbmZpZy5pbnRlcnZhbDtcbiAgICAgICAgX2xhc3RNc2cgPSBcIiNcIiArIGNvbmZpZy5jaGFubmVsO1xuICAgICAgICBfbXNnTnIgPSAwO1xuICAgICAgICB1c2VQYXJlbnQgPSBjb25maWcudXNlUGFyZW50O1xuICAgICAgICBfcmVtb3RlT3JpZ2luID0gZ2V0TG9jYXRpb24oY29uZmlnLnJlbW90ZSk7XG5cbiAgICAgICAgaWYgKGlzSG9zdCkge1xuICAgICAgICAgIGFwcGx5KGNvbmZpZy5wcm9wcywge1xuICAgICAgICAgICAgc3JjOiBjb25maWcucmVtb3RlLFxuICAgICAgICAgICAgbmFtZTogSUZSQU1FX1BSRUZJWCArIGNvbmZpZy5jaGFubmVsICsgXCJfcHJvdmlkZXJcIlxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgaWYgKHVzZVBhcmVudCkge1xuICAgICAgICAgICAgY29uZmlnLm9uTG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgX2xpc3RlbmVyV2luZG93ID0gd2luZG93O1xuXG4gICAgICAgICAgICAgIF9hdHRhY2hMaXN0ZW5lcnMoKTtcblxuICAgICAgICAgICAgICBwdWIudXAuY2FsbGJhY2sodHJ1ZSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgdHJpZXMgPSAwLFxuICAgICAgICAgICAgICAgIG1heCA9IGNvbmZpZy5kZWxheSAvIDUwO1xuXG4gICAgICAgICAgICAoZnVuY3Rpb24gZ2V0UmVmKCkge1xuICAgICAgICAgICAgICBpZiAoKyt0cmllcyA+IG1heCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuYWJsZSB0byByZWZlcmVuY2UgbGlzdGVuZXJ3aW5kb3dcIik7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIF9saXN0ZW5lcldpbmRvdyA9IF9jYWxsZXJXaW5kb3cuY29udGVudFdpbmRvdy5mcmFtZXNbSUZSQU1FX1BSRUZJWCArIGNvbmZpZy5jaGFubmVsICsgXCJfY29uc3VtZXJcIl07XG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGV4KSB7fVxuXG4gICAgICAgICAgICAgIGlmIChfbGlzdGVuZXJXaW5kb3cpIHtcbiAgICAgICAgICAgICAgICBfYXR0YWNoTGlzdGVuZXJzKCk7XG5cbiAgICAgICAgICAgICAgICBwdWIudXAuY2FsbGJhY2sodHJ1ZSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChnZXRSZWYsIDUwKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBfY2FsbGVyV2luZG93ID0gY3JlYXRlRnJhbWUoY29uZmlnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfbGlzdGVuZXJXaW5kb3cgPSB3aW5kb3c7XG5cbiAgICAgICAgICBfYXR0YWNoTGlzdGVuZXJzKCk7XG5cbiAgICAgICAgICBpZiAodXNlUGFyZW50KSB7XG4gICAgICAgICAgICBfY2FsbGVyV2luZG93ID0gcGFyZW50O1xuICAgICAgICAgICAgcHViLnVwLmNhbGxiYWNrKHRydWUpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhcHBseShjb25maWcsIHtcbiAgICAgICAgICAgICAgcHJvcHM6IHtcbiAgICAgICAgICAgICAgICBzcmM6IGNvbmZpZy5yZW1vdGUgKyBcIiNcIiArIGNvbmZpZy5jaGFubmVsICsgbmV3IERhdGUoKSxcbiAgICAgICAgICAgICAgICBuYW1lOiBJRlJBTUVfUFJFRklYICsgY29uZmlnLmNoYW5uZWwgKyBcIl9jb25zdW1lclwiXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIG9uTG9hZDogZnVuY3Rpb24gb25Mb2FkKCkge1xuICAgICAgICAgICAgICAgIHB1Yi51cC5jYWxsYmFjayh0cnVlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBfY2FsbGVyV2luZG93ID0gY3JlYXRlRnJhbWUoY29uZmlnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBpbml0OiBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICB3aGVuUmVhZHkocHViLm9uRE9NUmVhZHksIHB1Yik7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcbiAgLypqc2xpbnQgZXZpbDogdHJ1ZSwgYnJvd3NlcjogdHJ1ZSwgaW1tZWQ6IHRydWUsIHBhc3NmYWlsOiB0cnVlLCB1bmRlZjogdHJ1ZSwgbmV3Y2FwOiB0cnVlKi9cblxuICAvKmdsb2JhbCBlYXN5WERNLCB3aW5kb3csIGVzY2FwZSwgdW5lc2NhcGUsIGRlYnVnICovXG4gIC8vXG4gIC8vIGVhc3lYRE1cbiAgLy8gaHR0cDovL2Vhc3l4ZG0ubmV0L1xuICAvLyBDb3B5cmlnaHQoYykgMjAwOS0yMDExLCDDmHl2aW5kIFNlYW4gS2luc2V5LCBveXZpbmRAa2luc2V5Lm5vLlxuICAvL1xuICAvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gIC8vIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAgLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICAvLyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gIC8vIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICAvLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuICAvL1xuICAvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICAvLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAgLy9cbiAgLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICAvLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAgLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gIC8vIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAgLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAgLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICAvLyBUSEUgU09GVFdBUkUuXG4gIC8vXG5cbiAgLyoqXHJcbiAgICogQGNsYXNzIGVhc3lYRE0uc3RhY2suUmVsaWFibGVCZWhhdmlvclxyXG4gICAqIFRoaXMgaXMgYSBiZWhhdmlvciB0aGF0IHRyaWVzIHRvIG1ha2UgdGhlIHVuZGVybHlpbmcgdHJhbnNwb3J0IHJlbGlhYmxlIGJ5IHVzaW5nIGFja25vd2xlZGdlbWVudHMuXHJcbiAgICogQG5hbWVzcGFjZSBlYXN5WERNLnN0YWNrXHJcbiAgICogQGNvbnN0cnVjdG9yXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZyBUaGUgYmVoYXZpb3JzIGNvbmZpZ3VyYXRpb24uXHJcbiAgICovXG5cblxuICBlYXN5WERNLnN0YWNrLlJlbGlhYmxlQmVoYXZpb3IgPSBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgdmFyIHB1YiwgLy8gdGhlIHB1YmxpYyBpbnRlcmZhY2VcbiAgICBjYWxsYmFjazsgLy8gdGhlIGNhbGxiYWNrIHRvIGV4ZWN1dGUgd2hlbiB3ZSBoYXZlIGEgY29uZmlybWVkIHN1Y2Nlc3MvZmFpbHVyZVxuXG4gICAgdmFyIGlkT3V0ID0gMCxcbiAgICAgICAgaWRJbiA9IDAsXG4gICAgICAgIGN1cnJlbnRNZXNzYWdlID0gXCJcIjtcbiAgICByZXR1cm4gcHViID0ge1xuICAgICAgaW5jb21pbmc6IGZ1bmN0aW9uIGluY29taW5nKG1lc3NhZ2UsIG9yaWdpbikge1xuICAgICAgICB2YXIgaW5kZXhPZiA9IG1lc3NhZ2UuaW5kZXhPZihcIl9cIiksXG4gICAgICAgICAgICBhY2sgPSBtZXNzYWdlLnN1YnN0cmluZygwLCBpbmRleE9mKS5zcGxpdChcIixcIik7XG4gICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlLnN1YnN0cmluZyhpbmRleE9mICsgMSk7XG5cbiAgICAgICAgaWYgKGFja1swXSA9PSBpZE91dCkge1xuICAgICAgICAgIGN1cnJlbnRNZXNzYWdlID0gXCJcIjtcblxuICAgICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgY2FsbGJhY2sodHJ1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1lc3NhZ2UubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHB1Yi5kb3duLm91dGdvaW5nKGFja1sxXSArIFwiLFwiICsgaWRPdXQgKyBcIl9cIiArIGN1cnJlbnRNZXNzYWdlLCBvcmlnaW4pO1xuXG4gICAgICAgICAgaWYgKGlkSW4gIT0gYWNrWzFdKSB7XG4gICAgICAgICAgICBpZEluID0gYWNrWzFdO1xuICAgICAgICAgICAgcHViLnVwLmluY29taW5nKG1lc3NhZ2UsIG9yaWdpbik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgb3V0Z29pbmc6IGZ1bmN0aW9uIG91dGdvaW5nKG1lc3NhZ2UsIG9yaWdpbiwgZm4pIHtcbiAgICAgICAgY3VycmVudE1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgICAgICBjYWxsYmFjayA9IGZuO1xuICAgICAgICBwdWIuZG93bi5vdXRnb2luZyhpZEluICsgXCIsXCIgKyArK2lkT3V0ICsgXCJfXCIgKyBtZXNzYWdlLCBvcmlnaW4pO1xuICAgICAgfVxuICAgIH07XG4gIH07XG4gIC8qanNsaW50IGV2aWw6IHRydWUsIGJyb3dzZXI6IHRydWUsIGltbWVkOiB0cnVlLCBwYXNzZmFpbDogdHJ1ZSwgdW5kZWY6IHRydWUsIG5ld2NhcDogdHJ1ZSovXG5cbiAgLypnbG9iYWwgZWFzeVhETSwgd2luZG93LCBlc2NhcGUsIHVuZXNjYXBlLCBkZWJ1ZywgdW5kZWYsIHJlbW92ZUZyb21TdGFjayovXG4gIC8vXG4gIC8vIGVhc3lYRE1cbiAgLy8gaHR0cDovL2Vhc3l4ZG0ubmV0L1xuICAvLyBDb3B5cmlnaHQoYykgMjAwOS0yMDExLCDDmHl2aW5kIFNlYW4gS2luc2V5LCBveXZpbmRAa2luc2V5Lm5vLlxuICAvL1xuICAvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gIC8vIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAgLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICAvLyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gIC8vIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICAvLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuICAvL1xuICAvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICAvLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAgLy9cbiAgLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICAvLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAgLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gIC8vIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAgLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAgLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICAvLyBUSEUgU09GVFdBUkUuXG4gIC8vXG5cbiAgLyoqXHJcbiAgICogQGNsYXNzIGVhc3lYRE0uc3RhY2suUXVldWVCZWhhdmlvclxyXG4gICAqIFRoaXMgaXMgYSBiZWhhdmlvciB0aGF0IGVuYWJsZXMgcXVldWVpbmcgb2YgbWVzc2FnZXMuIDxici8+XHJcbiAgICogSXQgd2lsbCBidWZmZXIgaW5jb21pbmcgbWVzc2FnZXMgYW5kIGRpc3BhY2ggdGhlc2UgYXMgZmFzdCBhcyB0aGUgdW5kZXJseWluZyB0cmFuc3BvcnQgYWxsb3dzLlxyXG4gICAqIFRoaXMgd2lsbCBhbHNvIGZyYWdtZW50L2RlZnJhZ21lbnQgbWVzc2FnZXMgc28gdGhhdCB0aGUgb3V0Z29pbmcgbWVzc2FnZSBpcyBuZXZlciBiaWdnZXIgdGhhbiB0aGVcclxuICAgKiBzZXQgbGVuZ3RoLlxyXG4gICAqIEBuYW1lc3BhY2UgZWFzeVhETS5zdGFja1xyXG4gICAqIEBjb25zdHJ1Y3RvclxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgVGhlIGJlaGF2aW9ycyBjb25maWd1cmF0aW9uLiBPcHRpb25hbC5cclxuICAgKiBAY2ZnIHtOdW1iZXJ9IG1heExlbmd0aCBUaGUgbWF4aW11bSBsZW5ndGggb2YgZWFjaCBvdXRnb2luZyBtZXNzYWdlLiBTZXQgdGhpcyB0byBlbmFibGUgZnJhZ21lbnRhdGlvbi5cclxuICAgKi9cblxuXG4gIGVhc3lYRE0uc3RhY2suUXVldWVCZWhhdmlvciA9IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICB2YXIgcHViLFxuICAgICAgICBxdWV1ZSA9IFtdLFxuICAgICAgICB3YWl0aW5nID0gdHJ1ZSxcbiAgICAgICAgX2luY29taW5nID0gXCJcIixcbiAgICAgICAgZGVzdHJveWluZyxcbiAgICAgICAgbWF4TGVuZ3RoID0gMCxcbiAgICAgICAgbGF6eSA9IGZhbHNlLFxuICAgICAgICBkb0ZyYWdtZW50ID0gZmFsc2U7XG5cbiAgICBmdW5jdGlvbiBkaXNwYXRjaCgpIHtcbiAgICAgIGlmIChjb25maWcucmVtb3ZlICYmIHF1ZXVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZW1vdmVGcm9tU3RhY2socHViKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAod2FpdGluZyB8fCBxdWV1ZS5sZW5ndGggPT09IDAgfHwgZGVzdHJveWluZykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHdhaXRpbmcgPSB0cnVlO1xuICAgICAgdmFyIG1lc3NhZ2UgPSBxdWV1ZS5zaGlmdCgpO1xuICAgICAgcHViLmRvd24ub3V0Z29pbmcobWVzc2FnZS5kYXRhLCBtZXNzYWdlLm9yaWdpbiwgZnVuY3Rpb24gKHN1Y2Nlc3MpIHtcbiAgICAgICAgd2FpdGluZyA9IGZhbHNlO1xuXG4gICAgICAgIGlmIChtZXNzYWdlLmNhbGxiYWNrKSB7XG4gICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBtZXNzYWdlLmNhbGxiYWNrKHN1Y2Nlc3MpO1xuICAgICAgICAgIH0sIDApO1xuICAgICAgICB9XG5cbiAgICAgICAgZGlzcGF0Y2goKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBwdWIgPSB7XG4gICAgICBpbml0OiBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICBpZiAodW5kZWYoY29uZmlnKSkge1xuICAgICAgICAgIGNvbmZpZyA9IHt9O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNvbmZpZy5tYXhMZW5ndGgpIHtcbiAgICAgICAgICBtYXhMZW5ndGggPSBjb25maWcubWF4TGVuZ3RoO1xuICAgICAgICAgIGRvRnJhZ21lbnQgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNvbmZpZy5sYXp5KSB7XG4gICAgICAgICAgbGF6eSA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcHViLmRvd24uaW5pdCgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIGNhbGxiYWNrKHN1Y2Nlc3MpIHtcbiAgICAgICAgd2FpdGluZyA9IGZhbHNlO1xuICAgICAgICB2YXIgdXAgPSBwdWIudXA7IC8vIGluIGNhc2UgZGlzcGF0Y2ggY2FsbHMgcmVtb3ZlRnJvbVN0YWNrXG5cbiAgICAgICAgZGlzcGF0Y2goKTtcbiAgICAgICAgdXAuY2FsbGJhY2soc3VjY2Vzcyk7XG4gICAgICB9LFxuICAgICAgaW5jb21pbmc6IGZ1bmN0aW9uIGluY29taW5nKG1lc3NhZ2UsIG9yaWdpbikge1xuICAgICAgICBpZiAoZG9GcmFnbWVudCkge1xuICAgICAgICAgIHZhciBpbmRleE9mID0gbWVzc2FnZS5pbmRleE9mKFwiX1wiKSxcbiAgICAgICAgICAgICAgc2VxID0gcGFyc2VJbnQobWVzc2FnZS5zdWJzdHJpbmcoMCwgaW5kZXhPZiksIDEwKTtcbiAgICAgICAgICBfaW5jb21pbmcgKz0gbWVzc2FnZS5zdWJzdHJpbmcoaW5kZXhPZiArIDEpO1xuXG4gICAgICAgICAgaWYgKHNlcSA9PT0gMCkge1xuICAgICAgICAgICAgaWYgKGNvbmZpZy5lbmNvZGUpIHtcbiAgICAgICAgICAgICAgX2luY29taW5nID0gZGVjb2RlVVJJQ29tcG9uZW50KF9pbmNvbWluZyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHB1Yi51cC5pbmNvbWluZyhfaW5jb21pbmcsIG9yaWdpbik7XG4gICAgICAgICAgICBfaW5jb21pbmcgPSBcIlwiO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwdWIudXAuaW5jb21pbmcobWVzc2FnZSwgb3JpZ2luKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG91dGdvaW5nOiBmdW5jdGlvbiBvdXRnb2luZyhtZXNzYWdlLCBvcmlnaW4sIGZuKSB7XG4gICAgICAgIGlmIChjb25maWcuZW5jb2RlKSB7XG4gICAgICAgICAgbWVzc2FnZSA9IGVuY29kZVVSSUNvbXBvbmVudChtZXNzYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBmcmFnbWVudHMgPSBbXSxcbiAgICAgICAgICAgIGZyYWdtZW50O1xuXG4gICAgICAgIGlmIChkb0ZyYWdtZW50KSB7XG4gICAgICAgICAgLy8gZnJhZ21lbnQgaW50byBjaHVua3NcbiAgICAgICAgICB3aGlsZSAobWVzc2FnZS5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgIGZyYWdtZW50ID0gbWVzc2FnZS5zdWJzdHJpbmcoMCwgbWF4TGVuZ3RoKTtcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlLnN1YnN0cmluZyhmcmFnbWVudC5sZW5ndGgpO1xuICAgICAgICAgICAgZnJhZ21lbnRzLnB1c2goZnJhZ21lbnQpO1xuICAgICAgICAgIH0gLy8gZW5xdWV1ZSB0aGUgY2h1bmtzXG5cblxuICAgICAgICAgIHdoaWxlIChmcmFnbWVudCA9IGZyYWdtZW50cy5zaGlmdCgpKSB7XG4gICAgICAgICAgICBxdWV1ZS5wdXNoKHtcbiAgICAgICAgICAgICAgZGF0YTogZnJhZ21lbnRzLmxlbmd0aCArIFwiX1wiICsgZnJhZ21lbnQsXG4gICAgICAgICAgICAgIG9yaWdpbjogb3JpZ2luLFxuICAgICAgICAgICAgICBjYWxsYmFjazogZnJhZ21lbnRzLmxlbmd0aCA9PT0gMCA/IGZuIDogbnVsbFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHF1ZXVlLnB1c2goe1xuICAgICAgICAgICAgZGF0YTogbWVzc2FnZSxcbiAgICAgICAgICAgIG9yaWdpbjogb3JpZ2luLFxuICAgICAgICAgICAgY2FsbGJhY2s6IGZuXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobGF6eSkge1xuICAgICAgICAgIHB1Yi5kb3duLmluaXQoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkaXNwYXRjaCgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGVzdHJveTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgZGVzdHJveWluZyA9IHRydWU7XG4gICAgICAgIHB1Yi5kb3duLmRlc3Ryb3koKTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xuICAvKmpzbGludCBldmlsOiB0cnVlLCBicm93c2VyOiB0cnVlLCBpbW1lZDogdHJ1ZSwgcGFzc2ZhaWw6IHRydWUsIHVuZGVmOiB0cnVlLCBuZXdjYXA6IHRydWUqL1xuXG4gIC8qZ2xvYmFsIGVhc3lYRE0sIHdpbmRvdywgZXNjYXBlLCB1bmVzY2FwZSwgdW5kZWYsIGRlYnVnICovXG4gIC8vXG4gIC8vIGVhc3lYRE1cbiAgLy8gaHR0cDovL2Vhc3l4ZG0ubmV0L1xuICAvLyBDb3B5cmlnaHQoYykgMjAwOS0yMDExLCDDmHl2aW5kIFNlYW4gS2luc2V5LCBveXZpbmRAa2luc2V5Lm5vLlxuICAvL1xuICAvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gIC8vIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAgLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICAvLyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gIC8vIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICAvLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuICAvL1xuICAvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICAvLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAgLy9cbiAgLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICAvLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAgLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gIC8vIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAgLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAgLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICAvLyBUSEUgU09GVFdBUkUuXG4gIC8vXG5cbiAgLyoqXHJcbiAgICogQGNsYXNzIGVhc3lYRE0uc3RhY2suVmVyaWZ5QmVoYXZpb3JcclxuICAgKiBUaGlzIGJlaGF2aW9yIHdpbGwgdmVyaWZ5IHRoYXQgY29tbXVuaWNhdGlvbiB3aXRoIHRoZSByZW1vdGUgZW5kIGlzIHBvc3NpYmxlLCBhbmQgd2lsbCBhbHNvIHNpZ24gYWxsIG91dGdvaW5nLFxyXG4gICAqIGFuZCB2ZXJpZnkgYWxsIGluY29taW5nIG1lc3NhZ2VzLiBUaGlzIHJlbW92ZXMgdGhlIHJpc2sgb2Ygc29tZW9uZSBoaWphY2tpbmcgdGhlIGlmcmFtZSB0byBzZW5kIG1hbGljaW91cyBtZXNzYWdlcy5cclxuICAgKiBAbmFtZXNwYWNlIGVhc3lYRE0uc3RhY2tcclxuICAgKiBAY29uc3RydWN0b3JcclxuICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIFRoZSBiZWhhdmlvcnMgY29uZmlndXJhdGlvbi5cclxuICAgKiBAY2ZnIHtCb29sZWFufSBpbml0aWF0ZSBJZiB0aGUgdmVyaWZpY2F0aW9uIHNob3VsZCBiZSBpbml0aWF0ZWQgZnJvbSB0aGlzIGVuZC5cclxuICAgKi9cblxuXG4gIGVhc3lYRE0uc3RhY2suVmVyaWZ5QmVoYXZpb3IgPSBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgdmFyIHB1YixcbiAgICAgICAgbXlTZWNyZXQsXG4gICAgICAgIHRoZWlyU2VjcmV0LFxuICAgICAgICB2ZXJpZmllZCA9IGZhbHNlO1xuXG4gICAgZnVuY3Rpb24gc3RhcnRWZXJpZmljYXRpb24oKSB7XG4gICAgICBteVNlY3JldCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygyKTtcbiAgICAgIHB1Yi5kb3duLm91dGdvaW5nKG15U2VjcmV0KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcHViID0ge1xuICAgICAgaW5jb21pbmc6IGZ1bmN0aW9uIGluY29taW5nKG1lc3NhZ2UsIG9yaWdpbikge1xuICAgICAgICB2YXIgaW5kZXhPZiA9IG1lc3NhZ2UuaW5kZXhPZihcIl9cIik7XG5cbiAgICAgICAgaWYgKGluZGV4T2YgPT09IC0xKSB7XG4gICAgICAgICAgaWYgKG1lc3NhZ2UgPT09IG15U2VjcmV0KSB7XG4gICAgICAgICAgICBwdWIudXAuY2FsbGJhY2sodHJ1ZSk7XG4gICAgICAgICAgfSBlbHNlIGlmICghdGhlaXJTZWNyZXQpIHtcbiAgICAgICAgICAgIHRoZWlyU2VjcmV0ID0gbWVzc2FnZTtcblxuICAgICAgICAgICAgaWYgKCFjb25maWcuaW5pdGlhdGUpIHtcbiAgICAgICAgICAgICAgc3RhcnRWZXJpZmljYXRpb24oKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcHViLmRvd24ub3V0Z29pbmcobWVzc2FnZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChtZXNzYWdlLnN1YnN0cmluZygwLCBpbmRleE9mKSA9PT0gdGhlaXJTZWNyZXQpIHtcbiAgICAgICAgICAgIHB1Yi51cC5pbmNvbWluZyhtZXNzYWdlLnN1YnN0cmluZyhpbmRleE9mICsgMSksIG9yaWdpbik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgb3V0Z29pbmc6IGZ1bmN0aW9uIG91dGdvaW5nKG1lc3NhZ2UsIG9yaWdpbiwgZm4pIHtcbiAgICAgICAgcHViLmRvd24ub3V0Z29pbmcobXlTZWNyZXQgKyBcIl9cIiArIG1lc3NhZ2UsIG9yaWdpbiwgZm4pO1xuICAgICAgfSxcbiAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiBjYWxsYmFjayhzdWNjZXNzKSB7XG4gICAgICAgIGlmIChjb25maWcuaW5pdGlhdGUpIHtcbiAgICAgICAgICBzdGFydFZlcmlmaWNhdGlvbigpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfTtcbiAgLypqc2xpbnQgZXZpbDogdHJ1ZSwgYnJvd3NlcjogdHJ1ZSwgaW1tZWQ6IHRydWUsIHBhc3NmYWlsOiB0cnVlLCB1bmRlZjogdHJ1ZSwgbmV3Y2FwOiB0cnVlKi9cblxuICAvKmdsb2JhbCBlYXN5WERNLCB3aW5kb3csIGVzY2FwZSwgdW5lc2NhcGUsIHVuZGVmLCBnZXRKU09OLCBkZWJ1ZywgZW1wdHlGbiwgaXNBcnJheSAqL1xuICAvL1xuICAvLyBlYXN5WERNXG4gIC8vIGh0dHA6Ly9lYXN5eGRtLm5ldC9cbiAgLy8gQ29weXJpZ2h0KGMpIDIwMDktMjAxMSwgw5h5dmluZCBTZWFuIEtpbnNleSwgb3l2aW5kQGtpbnNleS5uby5cbiAgLy9cbiAgLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICAvLyBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gIC8vIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAgLy8gdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICAvLyBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAgLy8gZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbiAgLy9cbiAgLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAgLy8gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gIC8vXG4gIC8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAgLy8gSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gIC8vIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICAvLyBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gIC8vIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gIC8vIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAgLy8gVEhFIFNPRlRXQVJFLlxuICAvL1xuXG4gIC8qKlxyXG4gICAqIEBjbGFzcyBlYXN5WERNLnN0YWNrLlJwY0JlaGF2aW9yXHJcbiAgICogVGhpcyB1c2VzIEpTT04tUlBDIDIuMCB0byBleHBvc2UgbG9jYWwgbWV0aG9kcyBhbmQgdG8gaW52b2tlIHJlbW90ZSBtZXRob2RzIGFuZCBoYXZlIHJlc3BvbnNlcyByZXR1cm5lZCBvdmVyIHRoZSB0aGUgc3RyaW5nIGJhc2VkIHRyYW5zcG9ydCBzdGFjay48YnIvPlxyXG4gICAqIEV4cG9zZWQgbWV0aG9kcyBjYW4gcmV0dXJuIHZhbHVlcyBzeW5jaHJvbm91cywgYXN5bmNyb25vdXMsIG9yIGJldCBzZXQgdXAgdG8gbm90IHJldHVybiBhbnl0aGluZy5cclxuICAgKiBAbmFtZXNwYWNlIGVhc3lYRE0uc3RhY2tcclxuICAgKiBAY29uc3RydWN0b3JcclxuICAgKiBAcGFyYW0ge09iamVjdH0gcHJveHkgVGhlIG9iamVjdCB0byBhcHBseSB0aGUgbWV0aG9kcyB0by5cclxuICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIFRoZSBkZWZpbml0aW9uIG9mIHRoZSBsb2NhbCBhbmQgcmVtb3RlIGludGVyZmFjZSB0byBpbXBsZW1lbnQuXHJcbiAgICogQGNmZyB7T2JqZWN0fSBsb2NhbCBUaGUgbG9jYWwgaW50ZXJmYWNlIHRvIGV4cG9zZS5cclxuICAgKiBAY2ZnIHtPYmplY3R9IHJlbW90ZSBUaGUgcmVtb3RlIG1ldGhvZHMgdG8gZXhwb3NlIHRocm91Z2ggdGhlIHByb3h5LlxyXG4gICAqIEBjZmcge09iamVjdH0gc2VyaWFsaXplciBUaGUgc2VyaWFsaXplciB0byB1c2UgZm9yIHNlcmlhbGl6aW5nIGFuZCBkZXNlcmlhbGl6aW5nIHRoZSBKU09OLiBTaG91bGQgYmUgY29tcGF0aWJsZSB3aXRoIHRoZSBIVE1MNSBKU09OIG9iamVjdC4gT3B0aW9uYWwsIHdpbGwgZGVmYXVsdCB0byBKU09OLlxyXG4gICAqL1xuXG5cbiAgZWFzeVhETS5zdGFjay5ScGNCZWhhdmlvciA9IGZ1bmN0aW9uIChwcm94eSwgY29uZmlnKSB7XG4gICAgdmFyIHB1YixcbiAgICAgICAgc2VyaWFsaXplciA9IGNvbmZpZy5zZXJpYWxpemVyIHx8IF9nZXRKU09OKCk7XG5cbiAgICB2YXIgX2NhbGxiYWNrQ291bnRlciA9IDAsXG4gICAgICAgIF9jYWxsYmFja3MgPSB7fTtcbiAgICAvKipcclxuICAgICAqIFNlcmlhbGl6ZXMgYW5kIHNlbmRzIHRoZSBtZXNzYWdlXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGEgVGhlIEpTT04tUlBDIG1lc3NhZ2UgdG8gYmUgc2VudC4gVGhlIGpzb25ycGMgcHJvcGVydHkgd2lsbCBiZSBhZGRlZC5cclxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gX3NlbmQoZGF0YSkge1xuICAgICAgZGF0YS5qc29ucnBjID0gXCIyLjBcIjtcbiAgICAgIHB1Yi5kb3duLm91dGdvaW5nKHNlcmlhbGl6ZXIuc3RyaW5naWZ5KGRhdGEpKTtcbiAgICB9XG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgbWV0aG9kIHRoYXQgaW1wbGVtZW50cyB0aGUgZ2l2ZW4gZGVmaW5pdGlvblxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBUaGUgbWV0aG9kIGNvbmZpZ3VyYXRpb25cclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtZXRob2QgVGhlIG5hbWUgb2YgdGhlIG1ldGhvZFxyXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IEEgc3R1YiBjYXBhYmxlIG9mIHByb3h5aW5nIHRoZSByZXF1ZXN0ZWQgbWV0aG9kIGNhbGxcclxuICAgICAqL1xuXG5cbiAgICBmdW5jdGlvbiBfY3JlYXRlTWV0aG9kKGRlZmluaXRpb24sIG1ldGhvZCkge1xuICAgICAgdmFyIHNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlO1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGwgPSBhcmd1bWVudHMubGVuZ3RoLFxuICAgICAgICAgICAgY2FsbGJhY2ssXG4gICAgICAgICAgICBtZXNzYWdlID0ge1xuICAgICAgICAgIG1ldGhvZDogbWV0aG9kXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKGwgPiAwICYmIHR5cGVvZiBhcmd1bWVudHNbbCAtIDFdID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAvL3dpdGggY2FsbGJhY2ssIHByb2NlZHVyZVxuICAgICAgICAgIGlmIChsID4gMSAmJiB0eXBlb2YgYXJndW1lbnRzW2wgLSAyXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAvLyB0d28gY2FsbGJhY2tzLCBzdWNjZXNzIGFuZCBlcnJvclxuICAgICAgICAgICAgY2FsbGJhY2sgPSB7XG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IGFyZ3VtZW50c1tsIC0gMl0sXG4gICAgICAgICAgICAgIGVycm9yOiBhcmd1bWVudHNbbCAtIDFdXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgbWVzc2FnZS5wYXJhbXMgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMCwgbCAtIDIpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBzaW5nbGUgY2FsbGJhY2ssIHN1Y2Nlc3NcbiAgICAgICAgICAgIGNhbGxiYWNrID0ge1xuICAgICAgICAgICAgICBzdWNjZXNzOiBhcmd1bWVudHNbbCAtIDFdXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgbWVzc2FnZS5wYXJhbXMgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMCwgbCAtIDEpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIF9jYWxsYmFja3NbXCJcIiArICsrX2NhbGxiYWNrQ291bnRlcl0gPSBjYWxsYmFjaztcbiAgICAgICAgICBtZXNzYWdlLmlkID0gX2NhbGxiYWNrQ291bnRlcjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBubyBjYWxsYmFja3MsIGEgbm90aWZpY2F0aW9uXG4gICAgICAgICAgbWVzc2FnZS5wYXJhbXMgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZGVmaW5pdGlvbi5uYW1lZFBhcmFtcyAmJiBtZXNzYWdlLnBhcmFtcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICBtZXNzYWdlLnBhcmFtcyA9IG1lc3NhZ2UucGFyYW1zWzBdO1xuICAgICAgICB9IC8vIFNlbmQgdGhlIG1ldGhvZCByZXF1ZXN0XG5cblxuICAgICAgICBfc2VuZChtZXNzYWdlKTtcbiAgICAgIH07XG4gICAgfVxuICAgIC8qKlxyXG4gICAgICogRXhlY3V0ZXMgdGhlIGV4cG9zZWQgbWV0aG9kXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG1ldGhvZCBUaGUgbmFtZSBvZiB0aGUgbWV0aG9kXHJcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gaWQgVGhlIGNhbGxiYWNrIGlkIHRvIHVzZVxyXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gbWV0aG9kIFRoZSBleHBvc2VkIGltcGxlbWVudGF0aW9uXHJcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBwYXJhbXMgVGhlIHBhcmFtZXRlcnMgc3VwcGxpZWQgYnkgdGhlIHJlbW90ZSBlbmRcclxuICAgICAqL1xuXG5cbiAgICBmdW5jdGlvbiBfZXhlY3V0ZU1ldGhvZChtZXRob2QsIGlkLCBmbiwgcGFyYW1zKSB7XG4gICAgICBpZiAoIWZuKSB7XG4gICAgICAgIGlmIChpZCkge1xuICAgICAgICAgIF9zZW5kKHtcbiAgICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICAgIGNvZGU6IC0zMjYwMSxcbiAgICAgICAgICAgICAgbWVzc2FnZTogXCJQcm9jZWR1cmUgbm90IGZvdW5kLlwiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBfc3VjY2VzcywgX2Vycm9yO1xuXG4gICAgICBpZiAoaWQpIHtcbiAgICAgICAgX3N1Y2Nlc3MgPSBmdW5jdGlvbiBzdWNjZXNzKHJlc3VsdCkge1xuICAgICAgICAgIF9zdWNjZXNzID0gZW1wdHlGbjtcblxuICAgICAgICAgIF9zZW5kKHtcbiAgICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICAgIHJlc3VsdDogcmVzdWx0XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgX2Vycm9yID0gZnVuY3Rpb24gZXJyb3IobWVzc2FnZSwgZGF0YSkge1xuICAgICAgICAgIF9lcnJvciA9IGVtcHR5Rm47XG4gICAgICAgICAgdmFyIG1zZyA9IHtcbiAgICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICAgIGNvZGU6IC0zMjA5OSxcbiAgICAgICAgICAgICAgbWVzc2FnZTogbWVzc2FnZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgbXNnLmVycm9yLmRhdGEgPSBkYXRhO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIF9zZW5kKG1zZyk7XG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfc3VjY2VzcyA9IF9lcnJvciA9IGVtcHR5Rm47XG4gICAgICB9IC8vIENhbGwgbG9jYWwgbWV0aG9kXG5cblxuICAgICAgaWYgKCFpc0FycmF5KHBhcmFtcykpIHtcbiAgICAgICAgcGFyYW1zID0gW3BhcmFtc107XG4gICAgICB9XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBmbi5tZXRob2QuYXBwbHkoZm4uc2NvcGUsIHBhcmFtcy5jb25jYXQoW19zdWNjZXNzLCBfZXJyb3JdKSk7XG5cbiAgICAgICAgaWYgKCF1bmRlZihyZXN1bHQpKSB7XG4gICAgICAgICAgX3N1Y2Nlc3MocmVzdWx0KTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXgxKSB7XG4gICAgICAgIF9lcnJvcihleDEubWVzc2FnZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHB1YiA9IHtcbiAgICAgIGluY29taW5nOiBmdW5jdGlvbiBpbmNvbWluZyhtZXNzYWdlLCBvcmlnaW4pIHtcbiAgICAgICAgdmFyIGRhdGEgPSBzZXJpYWxpemVyLnBhcnNlKG1lc3NhZ2UpO1xuXG4gICAgICAgIGlmIChkYXRhLm1ldGhvZCkge1xuICAgICAgICAgIC8vIEEgbWV0aG9kIGNhbGwgZnJvbSB0aGUgcmVtb3RlIGVuZFxuICAgICAgICAgIGlmIChjb25maWcuaGFuZGxlKSB7XG4gICAgICAgICAgICBjb25maWcuaGFuZGxlKGRhdGEsIF9zZW5kKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgX2V4ZWN1dGVNZXRob2QoZGF0YS5tZXRob2QsIGRhdGEuaWQsIGNvbmZpZy5sb2NhbFtkYXRhLm1ldGhvZF0sIGRhdGEucGFyYW1zKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gQSBtZXRob2QgcmVzcG9uc2UgZnJvbSB0aGUgb3RoZXIgZW5kXG4gICAgICAgICAgdmFyIGNhbGxiYWNrID0gX2NhbGxiYWNrc1tkYXRhLmlkXTtcblxuICAgICAgICAgIGlmIChkYXRhLmVycm9yKSB7XG4gICAgICAgICAgICBpZiAoY2FsbGJhY2suZXJyb3IpIHtcbiAgICAgICAgICAgICAgY2FsbGJhY2suZXJyb3IoZGF0YS5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmIChjYWxsYmFjay5zdWNjZXNzKSB7XG4gICAgICAgICAgICBjYWxsYmFjay5zdWNjZXNzKGRhdGEucmVzdWx0KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBkZWxldGUgX2NhbGxiYWNrc1tkYXRhLmlkXTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGluaXQ6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgIGlmIChjb25maWcucmVtb3RlKSB7XG4gICAgICAgICAgLy8gSW1wbGVtZW50IHRoZSByZW1vdGUgc2lkZXMgZXhwb3NlZCBtZXRob2RzXG4gICAgICAgICAgZm9yICh2YXIgbWV0aG9kIGluIGNvbmZpZy5yZW1vdGUpIHtcbiAgICAgICAgICAgIGlmIChjb25maWcucmVtb3RlLmhhc093blByb3BlcnR5KG1ldGhvZCkpIHtcbiAgICAgICAgICAgICAgcHJveHlbbWV0aG9kXSA9IF9jcmVhdGVNZXRob2QoY29uZmlnLnJlbW90ZVttZXRob2RdLCBtZXRob2QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHB1Yi5kb3duLmluaXQoKTtcbiAgICAgIH0sXG4gICAgICBkZXN0cm95OiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICBmb3IgKHZhciBtZXRob2QgaW4gY29uZmlnLnJlbW90ZSkge1xuICAgICAgICAgIGlmIChjb25maWcucmVtb3RlLmhhc093blByb3BlcnR5KG1ldGhvZCkgJiYgcHJveHkuaGFzT3duUHJvcGVydHkobWV0aG9kKSkge1xuICAgICAgICAgICAgZGVsZXRlIHByb3h5W21ldGhvZF07XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcHViLmRvd24uZGVzdHJveSgpO1xuICAgICAgfVxuICAgIH07XG4gIH07XG5cbiAgd2luZG93LmVhc3lYRE0gPSBlYXN5WERNO1xufSkod2luZG93LCBkb2N1bWVudCwgbG9jYXRpb24sIHdpbmRvdy5zZXRUaW1lb3V0LCBkZWNvZGVVUklDb21wb25lbnQsIGVuY29kZVVSSUNvbXBvbmVudCk7XG5cbi8qKiovIH0pLFxuLyogNyAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgX193ZWJwYWNrX2V4cG9ydHNfXywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShfX3dlYnBhY2tfZXhwb3J0c19fLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihnbG9iYWwpIHsvKiBoYXJtb255IGltcG9ydCAqLyB2YXIgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX2hlbHBlcnNfcG9seWZpbGxfXyA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7XG4vKiBoYXJtb255IGltcG9ydCAqLyB2YXIgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX2hlbHBlcnNfcG9seWZpbGxfX19kZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXy5uKF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9oZWxwZXJzX3BvbHlmaWxsX18pO1xuLyogaGFybW9ueSBpbXBvcnQgKi8gdmFyIF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV92ZW5kb3JzX2Vhc3lYRE1fanNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oNik7XG4vKiBoYXJtb255IGltcG9ydCAqLyB2YXIgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX3ZlbmRvcnNfZWFzeVhETV9qc19fX2RlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLm4oX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX3ZlbmRvcnNfZWFzeVhETV9qc19fKTtcbi8qIGhhcm1vbnkgaW1wb3J0ICovIHZhciBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX2NvbmZpZ19fID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qIGhhcm1vbnkgaW1wb3J0ICovIHZhciBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX2NvbmZpZ19fX2RlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLm4oX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8yX19jb25maWdfXyk7XG4vKiBoYXJtb255IGltcG9ydCAqLyB2YXIgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8zX19PbWlzZV9fID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTtcbi8qIGhhcm1vbnkgaW1wb3J0ICovIHZhciBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzRfX09taXNlQ2FyZF9fID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTtcbi8qKlxuICogLT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT1cbiAqIFRoZSBuZXcgT21pc2UuanNcbiAqIC09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09XG4gKi9cblxuXG5cblxuXG4vKiBoYXJtb255IGRlZmF1bHQgZXhwb3J0ICovIF9fd2VicGFja19leHBvcnRzX19bXCJkZWZhdWx0XCJdID0gKF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfM19fT21pc2VfX1tcImFcIiAvKiBkZWZhdWx0ICovXSk7XG5nbG9iYWwuT21pc2UgPSBuZXcgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8zX19PbWlzZV9fW1wiYVwiIC8qIGRlZmF1bHQgKi9dKF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fY29uZmlnX19fZGVmYXVsdC5hKTtcbmdsb2JhbC5PbWlzZUNhcmQgPSBuZXcgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV80X19PbWlzZUNhcmRfX1tcImFcIiAvKiBkZWZhdWx0ICovXShfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX2NvbmZpZ19fX2RlZmF1bHQuYSk7XG4vKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoX193ZWJwYWNrX2V4cG9ydHNfXywgX193ZWJwYWNrX3JlcXVpcmVfXygxKSkpXG5cbi8qKiovIH0pLFxuLyogOCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgX193ZWJwYWNrX2V4cG9ydHNfXywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcbi8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihnbG9iYWwpIHsvKiB1bnVzZWQgaGFybW9ueSBleHBvcnQgbWVzc2FnZVR5cGUgKi9cbi8qIGhhcm1vbnkgZXhwb3J0IChpbW11dGFibGUpICovIF9fd2VicGFja19leHBvcnRzX19bXCJhXCJdID0gbGlzdGVuTWVzc2FnZTtcbi8qIGhhcm1vbnkgZXhwb3J0IChpbW11dGFibGUpICovIF9fd2VicGFja19leHBvcnRzX19bXCJiXCJdID0gbWVzc2FnZVNob3dJZnJhbWVBcHBGb3JtO1xuLyogaGFybW9ueSBleHBvcnQgKGltbXV0YWJsZSkgKi8gX193ZWJwYWNrX2V4cG9ydHNfX1tcImNcIl0gPSBtZXNzYWdlQ2xvc2VJZnJhbWU7XG4vKiBoYXJtb255IGV4cG9ydCAoaW1tdXRhYmxlKSAqLyBfX3dlYnBhY2tfZXhwb3J0c19fW1wiZFwiXSA9IG1lc3NhZ2VDbG9zZUFuZFNlbmRUb2tlbjtcbi8qIGhhcm1vbnkgaW1wb3J0ICovIHZhciBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX2NvbmZpZ19fID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qIGhhcm1vbnkgaW1wb3J0ICovIHZhciBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX2NvbmZpZ19fX2RlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLm4oX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX19jb25maWdfXyk7XG4vKiBoYXJtb255IGltcG9ydCAqLyB2YXIgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX2hlbHBlcnNfdXRpbHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG4vKipcbiAqIC09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09XG4gKiBQb3N0IG1lc3NhZ2VcbiAqIC09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09XG4gKi9cblxuXG52YXIgbWVzc2FnZVR5cGUgPSB7XG4gIENMT1NFX0lGUkFNRTogJ0NMT1NFX0lGUkFNRScsXG4gIFNIT1dfSUZSQU1FX0FQUF9GT1JNOiAnU0hPV19JRlJBTUVfQVBQX0ZPUk0nLFxuICBDTE9TRV9BTkRfU0VORF9UT0tFTjogJ0NMT1NFX0FORF9TRU5EX1RPS0VOJ1xufTtcbmZ1bmN0aW9uIGxpc3Rlbk1lc3NhZ2UoT21pc2VDYXJkSW5zdGFuY2UpIHtcbiAgZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbiAocmVjZWl2ZU1lc3NhZ2UpIHtcbiAgICB2YXIgbWVzc2FnZURhdGEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmkoX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX2hlbHBlcnNfdXRpbHNfX1tcImNcIiAvKiBzYWZlSnNvblBhcnNlICovXSkocmVjZWl2ZU1lc3NhZ2UuZGF0YSk7XG4gICAgdmFyIHR5cGUgPSBtZXNzYWdlRGF0YS50eXBlLFxuICAgICAgICBkYXRhID0gbWVzc2FnZURhdGEuZGF0YTtcbiAgICBtZXNzYWdlVHlwZUhhbmRsZXIoT21pc2VDYXJkSW5zdGFuY2UsIHR5cGUsIGRhdGEpO1xuICB9LCBmYWxzZSk7XG59XG5mdW5jdGlvbiBtZXNzYWdlU2hvd0lmcmFtZUFwcEZvcm0odGFyZ2V0LCBkYXRhKSB7XG4gIHBvc3RNZXNzYWdlKHRhcmdldCwgbWVzc2FnZVR5cGUuU0hPV19JRlJBTUVfQVBQX0ZPUk0sIGRhdGEsIF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fY29uZmlnX19fZGVmYXVsdC5hLmNhcmRIb3N0KTtcbn1cbmZ1bmN0aW9uIG1lc3NhZ2VDbG9zZUlmcmFtZSgpIHtcbiAgcG9zdE1lc3NhZ2UocGFyZW50LndpbmRvdywgbWVzc2FnZVR5cGUuQ0xPU0VfSUZSQU1FLCBudWxsLCAnKicpO1xufVxuZnVuY3Rpb24gbWVzc2FnZUNsb3NlQW5kU2VuZFRva2VuKHRva2VuKSB7XG4gIHBvc3RNZXNzYWdlKHBhcmVudC53aW5kb3csIG1lc3NhZ2VUeXBlLkNMT1NFX0FORF9TRU5EX1RPS0VOLCB0b2tlbiwgJyonKTtcbn1cblxuZnVuY3Rpb24gbWVzc2FnZVR5cGVIYW5kbGVyKE9taXNlQ2FyZEluc3RhbmNlLCB0eXBlLCBkYXRhKSB7XG4gIHN3aXRjaCAodHlwZSkge1xuICAgIGNhc2UgbWVzc2FnZVR5cGUuQ0xPU0VfSUZSQU1FOlxuICAgICAgT21pc2VDYXJkSW5zdGFuY2UuY2xvc2UoKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBtZXNzYWdlVHlwZS5DTE9TRV9BTkRfU0VORF9UT0tFTjpcbiAgICAgIE9taXNlQ2FyZEluc3RhbmNlLmNsb3NlKCk7XG4gICAgICBPbWlzZUNhcmRJbnN0YW5jZS5zZXRUb2tlbkF0T21pc2VUb2tlbkZpZWxkKGRhdGEpO1xuICAgICAgYnJlYWs7XG4gIH1cbn1cblxuZnVuY3Rpb24gcG9zdE1lc3NhZ2UodGFyZ2V0LCB0eXBlLCBkYXRhLCB0YXJnZXRPcmlnaW4pIHtcbiAgdmFyIG1lc3NhZ2VEYXRhID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgIHR5cGU6IHR5cGUsXG4gICAgZGF0YTogZGF0YVxuICB9KTtcbiAgdGFyZ2V0LnBvc3RNZXNzYWdlKG1lc3NhZ2VEYXRhLCB0YXJnZXRPcmlnaW4pO1xufVxuLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKF9fd2VicGFja19leHBvcnRzX18sIF9fd2VicGFja19yZXF1aXJlX18oMSkpKVxuXG4vKioqLyB9KSxcbi8qIDkgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKG1vZHVsZSkgeyhmdW5jdGlvbihtb2R1bGUpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBtb2R1bGUuZXhwb3J0cy5pc191cmkgPSBpc19pcmk7XG4gICAgbW9kdWxlLmV4cG9ydHMuaXNfaHR0cF91cmkgPSBpc19odHRwX2lyaTtcbiAgICBtb2R1bGUuZXhwb3J0cy5pc19odHRwc191cmkgPSBpc19odHRwc19pcmk7XG4gICAgbW9kdWxlLmV4cG9ydHMuaXNfd2ViX3VyaSA9IGlzX3dlYl9pcmk7XG4gICAgLy8gQ3JlYXRlIGFsaWFzZXNcbiAgICBtb2R1bGUuZXhwb3J0cy5pc1VyaSA9IGlzX2lyaTtcbiAgICBtb2R1bGUuZXhwb3J0cy5pc0h0dHBVcmkgPSBpc19odHRwX2lyaTtcbiAgICBtb2R1bGUuZXhwb3J0cy5pc0h0dHBzVXJpID0gaXNfaHR0cHNfaXJpO1xuICAgIG1vZHVsZS5leHBvcnRzLmlzV2ViVXJpID0gaXNfd2ViX2lyaTtcblxuXG4gICAgLy8gcHJpdmF0ZSBmdW5jdGlvblxuICAgIC8vIGludGVybmFsIFVSSSBzcGl0dGVyIG1ldGhvZCAtIGRpcmVjdCBmcm9tIFJGQyAzOTg2XG4gICAgdmFyIHNwbGl0VXJpID0gZnVuY3Rpb24odXJpKSB7XG4gICAgICAgIHZhciBzcGxpdHRlZCA9IHVyaS5tYXRjaCgvKD86KFteOlxcLz8jXSspOik/KD86XFwvXFwvKFteXFwvPyNdKikpPyhbXj8jXSopKD86XFw/KFteI10qKSk/KD86IyguKikpPy8pO1xuICAgICAgICByZXR1cm4gc3BsaXR0ZWQ7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGlzX2lyaSh2YWx1ZSkge1xuICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBjaGVjayBmb3IgaWxsZWdhbCBjaGFyYWN0ZXJzXG4gICAgICAgIGlmICgvW15hLXowLTlcXDpcXC9cXD9cXCNcXFtcXF1cXEBcXCFcXCRcXCZcXCdcXChcXClcXCpcXCtcXCxcXDtcXD1cXC5cXC1cXF9cXH5cXCVdL2kudGVzdCh2YWx1ZSkpIHJldHVybjtcblxuICAgICAgICAvLyBjaGVjayBmb3IgaGV4IGVzY2FwZXMgdGhhdCBhcmVuJ3QgY29tcGxldGVcbiAgICAgICAgaWYgKC8lW14wLTlhLWZdL2kudGVzdCh2YWx1ZSkpIHJldHVybjtcbiAgICAgICAgaWYgKC8lWzAtOWEtZl0oOj9bXjAtOWEtZl18JCkvaS50ZXN0KHZhbHVlKSkgcmV0dXJuO1xuXG4gICAgICAgIHZhciBzcGxpdHRlZCA9IFtdO1xuICAgICAgICB2YXIgc2NoZW1lID0gJyc7XG4gICAgICAgIHZhciBhdXRob3JpdHkgPSAnJztcbiAgICAgICAgdmFyIHBhdGggPSAnJztcbiAgICAgICAgdmFyIHF1ZXJ5ID0gJyc7XG4gICAgICAgIHZhciBmcmFnbWVudCA9ICcnO1xuICAgICAgICB2YXIgb3V0ID0gJyc7XG5cbiAgICAgICAgLy8gZnJvbSBSRkMgMzk4NlxuICAgICAgICBzcGxpdHRlZCA9IHNwbGl0VXJpKHZhbHVlKTtcbiAgICAgICAgc2NoZW1lID0gc3BsaXR0ZWRbMV07IFxuICAgICAgICBhdXRob3JpdHkgPSBzcGxpdHRlZFsyXTtcbiAgICAgICAgcGF0aCA9IHNwbGl0dGVkWzNdO1xuICAgICAgICBxdWVyeSA9IHNwbGl0dGVkWzRdO1xuICAgICAgICBmcmFnbWVudCA9IHNwbGl0dGVkWzVdO1xuXG4gICAgICAgIC8vIHNjaGVtZSBhbmQgcGF0aCBhcmUgcmVxdWlyZWQsIHRob3VnaCB0aGUgcGF0aCBjYW4gYmUgZW1wdHlcbiAgICAgICAgaWYgKCEoc2NoZW1lICYmIHNjaGVtZS5sZW5ndGggJiYgcGF0aC5sZW5ndGggPj0gMCkpIHJldHVybjtcblxuICAgICAgICAvLyBpZiBhdXRob3JpdHkgaXMgcHJlc2VudCwgdGhlIHBhdGggbXVzdCBiZSBlbXB0eSBvciBiZWdpbiB3aXRoIGEgL1xuICAgICAgICBpZiAoYXV0aG9yaXR5ICYmIGF1dGhvcml0eS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGlmICghKHBhdGgubGVuZ3RoID09PSAwIHx8IC9eXFwvLy50ZXN0KHBhdGgpKSkgcmV0dXJuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gaWYgYXV0aG9yaXR5IGlzIG5vdCBwcmVzZW50LCB0aGUgcGF0aCBtdXN0IG5vdCBzdGFydCB3aXRoIC8vXG4gICAgICAgICAgICBpZiAoL15cXC9cXC8vLnRlc3QocGF0aCkpIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHNjaGVtZSBtdXN0IGJlZ2luIHdpdGggYSBsZXR0ZXIsIHRoZW4gY29uc2lzdCBvZiBsZXR0ZXJzLCBkaWdpdHMsICssIC4sIG9yIC1cbiAgICAgICAgaWYgKCEvXlthLXpdW2EtejAtOVxcK1xcLVxcLl0qJC8udGVzdChzY2hlbWUudG9Mb3dlckNhc2UoKSkpICByZXR1cm47XG5cbiAgICAgICAgLy8gcmUtYXNzZW1ibGUgdGhlIFVSTCBwZXIgc2VjdGlvbiA1LjMgaW4gUkZDIDM5ODZcbiAgICAgICAgb3V0ICs9IHNjaGVtZSArICc6JztcbiAgICAgICAgaWYgKGF1dGhvcml0eSAmJiBhdXRob3JpdHkubGVuZ3RoKSB7XG4gICAgICAgICAgICBvdXQgKz0gJy8vJyArIGF1dGhvcml0eTtcbiAgICAgICAgfVxuXG4gICAgICAgIG91dCArPSBwYXRoO1xuXG4gICAgICAgIGlmIChxdWVyeSAmJiBxdWVyeS5sZW5ndGgpIHtcbiAgICAgICAgICAgIG91dCArPSAnPycgKyBxdWVyeTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChmcmFnbWVudCAmJiBmcmFnbWVudC5sZW5ndGgpIHtcbiAgICAgICAgICAgIG91dCArPSAnIycgKyBmcmFnbWVudDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaXNfaHR0cF9pcmkodmFsdWUsIGFsbG93SHR0cHMpIHtcbiAgICAgICAgaWYgKCFpc19pcmkodmFsdWUpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc3BsaXR0ZWQgPSBbXTtcbiAgICAgICAgdmFyIHNjaGVtZSA9ICcnO1xuICAgICAgICB2YXIgYXV0aG9yaXR5ID0gJyc7XG4gICAgICAgIHZhciBwYXRoID0gJyc7XG4gICAgICAgIHZhciBwb3J0ID0gJyc7XG4gICAgICAgIHZhciBxdWVyeSA9ICcnO1xuICAgICAgICB2YXIgZnJhZ21lbnQgPSAnJztcbiAgICAgICAgdmFyIG91dCA9ICcnO1xuXG4gICAgICAgIC8vIGZyb20gUkZDIDM5ODZcbiAgICAgICAgc3BsaXR0ZWQgPSBzcGxpdFVyaSh2YWx1ZSk7XG4gICAgICAgIHNjaGVtZSA9IHNwbGl0dGVkWzFdOyBcbiAgICAgICAgYXV0aG9yaXR5ID0gc3BsaXR0ZWRbMl07XG4gICAgICAgIHBhdGggPSBzcGxpdHRlZFszXTtcbiAgICAgICAgcXVlcnkgPSBzcGxpdHRlZFs0XTtcbiAgICAgICAgZnJhZ21lbnQgPSBzcGxpdHRlZFs1XTtcblxuICAgICAgICBpZiAoIXNjaGVtZSkgIHJldHVybjtcblxuICAgICAgICBpZihhbGxvd0h0dHBzKSB7XG4gICAgICAgICAgICBpZiAoc2NoZW1lLnRvTG93ZXJDYXNlKCkgIT0gJ2h0dHBzJykgcmV0dXJuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHNjaGVtZS50b0xvd2VyQ2FzZSgpICE9ICdodHRwJykgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZnVsbHktcXVhbGlmaWVkIFVSSXMgbXVzdCBoYXZlIGFuIGF1dGhvcml0eSBzZWN0aW9uIHRoYXQgaXNcbiAgICAgICAgLy8gYSB2YWxpZCBob3N0XG4gICAgICAgIGlmICghYXV0aG9yaXR5KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBlbmFibGUgcG9ydCBjb21wb25lbnRcbiAgICAgICAgaWYgKC86KFxcZCspJC8udGVzdChhdXRob3JpdHkpKSB7XG4gICAgICAgICAgICBwb3J0ID0gYXV0aG9yaXR5Lm1hdGNoKC86KFxcZCspJC8pWzBdO1xuICAgICAgICAgICAgYXV0aG9yaXR5ID0gYXV0aG9yaXR5LnJlcGxhY2UoLzpcXGQrJC8sICcnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG91dCArPSBzY2hlbWUgKyAnOic7XG4gICAgICAgIG91dCArPSAnLy8nICsgYXV0aG9yaXR5O1xuICAgICAgICBcbiAgICAgICAgaWYgKHBvcnQpIHtcbiAgICAgICAgICAgIG91dCArPSBwb3J0O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBvdXQgKz0gcGF0aDtcbiAgICAgICAgXG4gICAgICAgIGlmKHF1ZXJ5ICYmIHF1ZXJ5Lmxlbmd0aCl7XG4gICAgICAgICAgICBvdXQgKz0gJz8nICsgcXVlcnk7XG4gICAgICAgIH1cblxuICAgICAgICBpZihmcmFnbWVudCAmJiBmcmFnbWVudC5sZW5ndGgpe1xuICAgICAgICAgICAgb3V0ICs9ICcjJyArIGZyYWdtZW50O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzX2h0dHBzX2lyaSh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gaXNfaHR0cF9pcmkodmFsdWUsIHRydWUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzX3dlYl9pcmkodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIChpc19odHRwX2lyaSh2YWx1ZSkgfHwgaXNfaHR0cHNfaXJpKHZhbHVlKSk7XG4gICAgfVxuXG59KShtb2R1bGUpO1xuXG4vKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXygxMCkobW9kdWxlKSkpXG5cbi8qKiovIH0pLFxuLyogMTAgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihtb2R1bGUpIHtcclxuXHRpZighbW9kdWxlLndlYnBhY2tQb2x5ZmlsbCkge1xyXG5cdFx0bW9kdWxlLmRlcHJlY2F0ZSA9IGZ1bmN0aW9uKCkge307XHJcblx0XHRtb2R1bGUucGF0aHMgPSBbXTtcclxuXHRcdC8vIG1vZHVsZS5wYXJlbnQgPSB1bmRlZmluZWQgYnkgZGVmYXVsdFxyXG5cdFx0aWYoIW1vZHVsZS5jaGlsZHJlbikgbW9kdWxlLmNoaWxkcmVuID0gW107XHJcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobW9kdWxlLCBcImxvYWRlZFwiLCB7XHJcblx0XHRcdGVudW1lcmFibGU6IHRydWUsXHJcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0cmV0dXJuIG1vZHVsZS5sO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShtb2R1bGUsIFwiaWRcIiwge1xyXG5cdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxyXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHJldHVybiBtb2R1bGUuaTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRtb2R1bGUud2VicGFja1BvbHlmaWxsID0gMTtcclxuXHR9XHJcblx0cmV0dXJuIG1vZHVsZTtcclxufTtcclxuXG5cbi8qKiovIH0pLFxuLyogMTEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuKGZ1bmN0aW9uKHNlbGYpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGlmIChzZWxmLmZldGNoKSB7XG4gICAgcmV0dXJuXG4gIH1cblxuICB2YXIgc3VwcG9ydCA9IHtcbiAgICBzZWFyY2hQYXJhbXM6ICdVUkxTZWFyY2hQYXJhbXMnIGluIHNlbGYsXG4gICAgaXRlcmFibGU6ICdTeW1ib2wnIGluIHNlbGYgJiYgJ2l0ZXJhdG9yJyBpbiBTeW1ib2wsXG4gICAgYmxvYjogJ0ZpbGVSZWFkZXInIGluIHNlbGYgJiYgJ0Jsb2InIGluIHNlbGYgJiYgKGZ1bmN0aW9uKCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgbmV3IEJsb2IoKVxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfSBjYXRjaChlKSB7XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgfVxuICAgIH0pKCksXG4gICAgZm9ybURhdGE6ICdGb3JtRGF0YScgaW4gc2VsZixcbiAgICBhcnJheUJ1ZmZlcjogJ0FycmF5QnVmZmVyJyBpbiBzZWxmXG4gIH1cblxuICBpZiAoc3VwcG9ydC5hcnJheUJ1ZmZlcikge1xuICAgIHZhciB2aWV3Q2xhc3NlcyA9IFtcbiAgICAgICdbb2JqZWN0IEludDhBcnJheV0nLFxuICAgICAgJ1tvYmplY3QgVWludDhBcnJheV0nLFxuICAgICAgJ1tvYmplY3QgVWludDhDbGFtcGVkQXJyYXldJyxcbiAgICAgICdbb2JqZWN0IEludDE2QXJyYXldJyxcbiAgICAgICdbb2JqZWN0IFVpbnQxNkFycmF5XScsXG4gICAgICAnW29iamVjdCBJbnQzMkFycmF5XScsXG4gICAgICAnW29iamVjdCBVaW50MzJBcnJheV0nLFxuICAgICAgJ1tvYmplY3QgRmxvYXQzMkFycmF5XScsXG4gICAgICAnW29iamVjdCBGbG9hdDY0QXJyYXldJ1xuICAgIF1cblxuICAgIHZhciBpc0RhdGFWaWV3ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gb2JqICYmIERhdGFWaWV3LnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKG9iailcbiAgICB9XG5cbiAgICB2YXIgaXNBcnJheUJ1ZmZlclZpZXcgPSBBcnJheUJ1ZmZlci5pc1ZpZXcgfHwgZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gb2JqICYmIHZpZXdDbGFzc2VzLmluZGV4T2YoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikpID4gLTFcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBub3JtYWxpemVOYW1lKG5hbWUpIHtcbiAgICBpZiAodHlwZW9mIG5hbWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICBuYW1lID0gU3RyaW5nKG5hbWUpXG4gICAgfVxuICAgIGlmICgvW15hLXowLTlcXC0jJCUmJyorLlxcXl9gfH5dL2kudGVzdChuYW1lKSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBjaGFyYWN0ZXIgaW4gaGVhZGVyIGZpZWxkIG5hbWUnKVxuICAgIH1cbiAgICByZXR1cm4gbmFtZS50b0xvd2VyQ2FzZSgpXG4gIH1cblxuICBmdW5jdGlvbiBub3JtYWxpemVWYWx1ZSh2YWx1ZSkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICB2YWx1ZSA9IFN0cmluZyh2YWx1ZSlcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlXG4gIH1cblxuICAvLyBCdWlsZCBhIGRlc3RydWN0aXZlIGl0ZXJhdG9yIGZvciB0aGUgdmFsdWUgbGlzdFxuICBmdW5jdGlvbiBpdGVyYXRvckZvcihpdGVtcykge1xuICAgIHZhciBpdGVyYXRvciA9IHtcbiAgICAgIG5leHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBpdGVtcy5zaGlmdCgpXG4gICAgICAgIHJldHVybiB7ZG9uZTogdmFsdWUgPT09IHVuZGVmaW5lZCwgdmFsdWU6IHZhbHVlfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChzdXBwb3J0Lml0ZXJhYmxlKSB7XG4gICAgICBpdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBpdGVyYXRvclxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBpdGVyYXRvclxuICB9XG5cbiAgZnVuY3Rpb24gSGVhZGVycyhoZWFkZXJzKSB7XG4gICAgdGhpcy5tYXAgPSB7fVxuXG4gICAgaWYgKGhlYWRlcnMgaW5zdGFuY2VvZiBIZWFkZXJzKSB7XG4gICAgICBoZWFkZXJzLmZvckVhY2goZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcbiAgICAgICAgdGhpcy5hcHBlbmQobmFtZSwgdmFsdWUpXG4gICAgICB9LCB0aGlzKVxuICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShoZWFkZXJzKSkge1xuICAgICAgaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uKGhlYWRlcikge1xuICAgICAgICB0aGlzLmFwcGVuZChoZWFkZXJbMF0sIGhlYWRlclsxXSlcbiAgICAgIH0sIHRoaXMpXG4gICAgfSBlbHNlIGlmIChoZWFkZXJzKSB7XG4gICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhoZWFkZXJzKS5mb3JFYWNoKGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgICAgdGhpcy5hcHBlbmQobmFtZSwgaGVhZGVyc1tuYW1lXSlcbiAgICAgIH0sIHRoaXMpXG4gICAgfVxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuYXBwZW5kID0gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgICBuYW1lID0gbm9ybWFsaXplTmFtZShuYW1lKVxuICAgIHZhbHVlID0gbm9ybWFsaXplVmFsdWUodmFsdWUpXG4gICAgdmFyIG9sZFZhbHVlID0gdGhpcy5tYXBbbmFtZV1cbiAgICB0aGlzLm1hcFtuYW1lXSA9IG9sZFZhbHVlID8gb2xkVmFsdWUrJywnK3ZhbHVlIDogdmFsdWVcbiAgfVxuXG4gIEhlYWRlcnMucHJvdG90eXBlWydkZWxldGUnXSA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICBkZWxldGUgdGhpcy5tYXBbbm9ybWFsaXplTmFtZShuYW1lKV1cbiAgfVxuXG4gIEhlYWRlcnMucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICBuYW1lID0gbm9ybWFsaXplTmFtZShuYW1lKVxuICAgIHJldHVybiB0aGlzLmhhcyhuYW1lKSA/IHRoaXMubWFwW25hbWVdIDogbnVsbFxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuaGFzID0gZnVuY3Rpb24obmFtZSkge1xuICAgIHJldHVybiB0aGlzLm1hcC5oYXNPd25Qcm9wZXJ0eShub3JtYWxpemVOYW1lKG5hbWUpKVxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgICB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXSA9IG5vcm1hbGl6ZVZhbHVlKHZhbHVlKVxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uKGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgZm9yICh2YXIgbmFtZSBpbiB0aGlzLm1hcCkge1xuICAgICAgaWYgKHRoaXMubWFwLmhhc093blByb3BlcnR5KG5hbWUpKSB7XG4gICAgICAgIGNhbGxiYWNrLmNhbGwodGhpc0FyZywgdGhpcy5tYXBbbmFtZV0sIG5hbWUsIHRoaXMpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUua2V5cyA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBpdGVtcyA9IFtdXG4gICAgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7IGl0ZW1zLnB1c2gobmFtZSkgfSlcbiAgICByZXR1cm4gaXRlcmF0b3JGb3IoaXRlbXMpXG4gIH1cblxuICBIZWFkZXJzLnByb3RvdHlwZS52YWx1ZXMgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaXRlbXMgPSBbXVxuICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSkgeyBpdGVtcy5wdXNoKHZhbHVlKSB9KVxuICAgIHJldHVybiBpdGVyYXRvckZvcihpdGVtcylcbiAgfVxuXG4gIEhlYWRlcnMucHJvdG90eXBlLmVudHJpZXMgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaXRlbXMgPSBbXVxuICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSwgbmFtZSkgeyBpdGVtcy5wdXNoKFtuYW1lLCB2YWx1ZV0pIH0pXG4gICAgcmV0dXJuIGl0ZXJhdG9yRm9yKGl0ZW1zKVxuICB9XG5cbiAgaWYgKHN1cHBvcnQuaXRlcmFibGUpIHtcbiAgICBIZWFkZXJzLnByb3RvdHlwZVtTeW1ib2wuaXRlcmF0b3JdID0gSGVhZGVycy5wcm90b3R5cGUuZW50cmllc1xuICB9XG5cbiAgZnVuY3Rpb24gY29uc3VtZWQoYm9keSkge1xuICAgIGlmIChib2R5LmJvZHlVc2VkKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFR5cGVFcnJvcignQWxyZWFkeSByZWFkJykpXG4gICAgfVxuICAgIGJvZHkuYm9keVVzZWQgPSB0cnVlXG4gIH1cblxuICBmdW5jdGlvbiBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXNvbHZlKHJlYWRlci5yZXN1bHQpXG4gICAgICB9XG4gICAgICByZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QocmVhZGVyLmVycm9yKVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICBmdW5jdGlvbiByZWFkQmxvYkFzQXJyYXlCdWZmZXIoYmxvYikge1xuICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpXG4gICAgdmFyIHByb21pc2UgPSBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKVxuICAgIHJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihibG9iKVxuICAgIHJldHVybiBwcm9taXNlXG4gIH1cblxuICBmdW5jdGlvbiByZWFkQmxvYkFzVGV4dChibG9iKSB7XG4gICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKClcbiAgICB2YXIgcHJvbWlzZSA9IGZpbGVSZWFkZXJSZWFkeShyZWFkZXIpXG4gICAgcmVhZGVyLnJlYWRBc1RleHQoYmxvYilcbiAgICByZXR1cm4gcHJvbWlzZVxuICB9XG5cbiAgZnVuY3Rpb24gcmVhZEFycmF5QnVmZmVyQXNUZXh0KGJ1Zikge1xuICAgIHZhciB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoYnVmKVxuICAgIHZhciBjaGFycyA9IG5ldyBBcnJheSh2aWV3Lmxlbmd0aClcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmlldy5sZW5ndGg7IGkrKykge1xuICAgICAgY2hhcnNbaV0gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHZpZXdbaV0pXG4gICAgfVxuICAgIHJldHVybiBjaGFycy5qb2luKCcnKVxuICB9XG5cbiAgZnVuY3Rpb24gYnVmZmVyQ2xvbmUoYnVmKSB7XG4gICAgaWYgKGJ1Zi5zbGljZSkge1xuICAgICAgcmV0dXJuIGJ1Zi5zbGljZSgwKVxuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgdmlldyA9IG5ldyBVaW50OEFycmF5KGJ1Zi5ieXRlTGVuZ3RoKVxuICAgICAgdmlldy5zZXQobmV3IFVpbnQ4QXJyYXkoYnVmKSlcbiAgICAgIHJldHVybiB2aWV3LmJ1ZmZlclxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIEJvZHkoKSB7XG4gICAgdGhpcy5ib2R5VXNlZCA9IGZhbHNlXG5cbiAgICB0aGlzLl9pbml0Qm9keSA9IGZ1bmN0aW9uKGJvZHkpIHtcbiAgICAgIHRoaXMuX2JvZHlJbml0ID0gYm9keVxuICAgICAgaWYgKCFib2R5KSB7XG4gICAgICAgIHRoaXMuX2JvZHlUZXh0ID0gJydcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGJvZHkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRoaXMuX2JvZHlUZXh0ID0gYm9keVxuICAgICAgfSBlbHNlIGlmIChzdXBwb3J0LmJsb2IgJiYgQmxvYi5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICB0aGlzLl9ib2R5QmxvYiA9IGJvZHlcbiAgICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5mb3JtRGF0YSAmJiBGb3JtRGF0YS5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICB0aGlzLl9ib2R5Rm9ybURhdGEgPSBib2R5XG4gICAgICB9IGVsc2UgaWYgKHN1cHBvcnQuc2VhcmNoUGFyYW1zICYmIFVSTFNlYXJjaFBhcmFtcy5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICB0aGlzLl9ib2R5VGV4dCA9IGJvZHkudG9TdHJpbmcoKVxuICAgICAgfSBlbHNlIGlmIChzdXBwb3J0LmFycmF5QnVmZmVyICYmIHN1cHBvcnQuYmxvYiAmJiBpc0RhdGFWaWV3KGJvZHkpKSB7XG4gICAgICAgIHRoaXMuX2JvZHlBcnJheUJ1ZmZlciA9IGJ1ZmZlckNsb25lKGJvZHkuYnVmZmVyKVxuICAgICAgICAvLyBJRSAxMC0xMSBjYW4ndCBoYW5kbGUgYSBEYXRhVmlldyBib2R5LlxuICAgICAgICB0aGlzLl9ib2R5SW5pdCA9IG5ldyBCbG9iKFt0aGlzLl9ib2R5QXJyYXlCdWZmZXJdKVxuICAgICAgfSBlbHNlIGlmIChzdXBwb3J0LmFycmF5QnVmZmVyICYmIChBcnJheUJ1ZmZlci5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSB8fCBpc0FycmF5QnVmZmVyVmlldyhib2R5KSkpIHtcbiAgICAgICAgdGhpcy5fYm9keUFycmF5QnVmZmVyID0gYnVmZmVyQ2xvbmUoYm9keSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcigndW5zdXBwb3J0ZWQgQm9keUluaXQgdHlwZScpXG4gICAgICB9XG5cbiAgICAgIGlmICghdGhpcy5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJykpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBib2R5ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgIHRoaXMuaGVhZGVycy5zZXQoJ2NvbnRlbnQtdHlwZScsICd0ZXh0L3BsYWluO2NoYXJzZXQ9VVRGLTgnKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlCbG9iICYmIHRoaXMuX2JvZHlCbG9iLnR5cGUpIHtcbiAgICAgICAgICB0aGlzLmhlYWRlcnMuc2V0KCdjb250ZW50LXR5cGUnLCB0aGlzLl9ib2R5QmxvYi50eXBlKVxuICAgICAgICB9IGVsc2UgaWYgKHN1cHBvcnQuc2VhcmNoUGFyYW1zICYmIFVSTFNlYXJjaFBhcmFtcy5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICAgIHRoaXMuaGVhZGVycy5zZXQoJ2NvbnRlbnQtdHlwZScsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD1VVEYtOCcpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoc3VwcG9ydC5ibG9iKSB7XG4gICAgICB0aGlzLmJsb2IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHJlamVjdGVkID0gY29uc3VtZWQodGhpcylcbiAgICAgICAgaWYgKHJlamVjdGVkKSB7XG4gICAgICAgICAgcmV0dXJuIHJlamVjdGVkXG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fYm9keUJsb2IpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlCbG9iKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IEJsb2IoW3RoaXMuX2JvZHlBcnJheUJ1ZmZlcl0pKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlGb3JtRGF0YSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignY291bGQgbm90IHJlYWQgRm9ybURhdGEgYm9keSBhcyBibG9iJylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBCbG9iKFt0aGlzLl9ib2R5VGV4dF0pKVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRoaXMuYXJyYXlCdWZmZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikge1xuICAgICAgICAgIHJldHVybiBjb25zdW1lZCh0aGlzKSB8fCBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keUFycmF5QnVmZmVyKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB0aGlzLmJsb2IoKS50aGVuKHJlYWRCbG9iQXNBcnJheUJ1ZmZlcilcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMudGV4dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJlamVjdGVkID0gY29uc3VtZWQodGhpcylcbiAgICAgIGlmIChyZWplY3RlZCkge1xuICAgICAgICByZXR1cm4gcmVqZWN0ZWRcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX2JvZHlCbG9iKSB7XG4gICAgICAgIHJldHVybiByZWFkQmxvYkFzVGV4dCh0aGlzLl9ib2R5QmxvYilcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5fYm9keUFycmF5QnVmZmVyKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVhZEFycmF5QnVmZmVyQXNUZXh0KHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikpXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlGb3JtRGF0YSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvdWxkIG5vdCByZWFkIEZvcm1EYXRhIGJvZHkgYXMgdGV4dCcpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlUZXh0KVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChzdXBwb3J0LmZvcm1EYXRhKSB7XG4gICAgICB0aGlzLmZvcm1EYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRleHQoKS50aGVuKGRlY29kZSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmpzb24gPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLnRleHQoKS50aGVuKEpTT04ucGFyc2UpXG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIC8vIEhUVFAgbWV0aG9kcyB3aG9zZSBjYXBpdGFsaXphdGlvbiBzaG91bGQgYmUgbm9ybWFsaXplZFxuICB2YXIgbWV0aG9kcyA9IFsnREVMRVRFJywgJ0dFVCcsICdIRUFEJywgJ09QVElPTlMnLCAnUE9TVCcsICdQVVQnXVxuXG4gIGZ1bmN0aW9uIG5vcm1hbGl6ZU1ldGhvZChtZXRob2QpIHtcbiAgICB2YXIgdXBjYXNlZCA9IG1ldGhvZC50b1VwcGVyQ2FzZSgpXG4gICAgcmV0dXJuIChtZXRob2RzLmluZGV4T2YodXBjYXNlZCkgPiAtMSkgPyB1cGNhc2VkIDogbWV0aG9kXG4gIH1cblxuICBmdW5jdGlvbiBSZXF1ZXN0KGlucHV0LCBvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge31cbiAgICB2YXIgYm9keSA9IG9wdGlvbnMuYm9keVxuXG4gICAgaWYgKGlucHV0IGluc3RhbmNlb2YgUmVxdWVzdCkge1xuICAgICAgaWYgKGlucHV0LmJvZHlVc2VkKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FscmVhZHkgcmVhZCcpXG4gICAgICB9XG4gICAgICB0aGlzLnVybCA9IGlucHV0LnVybFxuICAgICAgdGhpcy5jcmVkZW50aWFscyA9IGlucHV0LmNyZWRlbnRpYWxzXG4gICAgICBpZiAoIW9wdGlvbnMuaGVhZGVycykge1xuICAgICAgICB0aGlzLmhlYWRlcnMgPSBuZXcgSGVhZGVycyhpbnB1dC5oZWFkZXJzKVxuICAgICAgfVxuICAgICAgdGhpcy5tZXRob2QgPSBpbnB1dC5tZXRob2RcbiAgICAgIHRoaXMubW9kZSA9IGlucHV0Lm1vZGVcbiAgICAgIGlmICghYm9keSAmJiBpbnB1dC5fYm9keUluaXQgIT0gbnVsbCkge1xuICAgICAgICBib2R5ID0gaW5wdXQuX2JvZHlJbml0XG4gICAgICAgIGlucHV0LmJvZHlVc2VkID0gdHJ1ZVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnVybCA9IFN0cmluZyhpbnB1dClcbiAgICB9XG5cbiAgICB0aGlzLmNyZWRlbnRpYWxzID0gb3B0aW9ucy5jcmVkZW50aWFscyB8fCB0aGlzLmNyZWRlbnRpYWxzIHx8ICdvbWl0J1xuICAgIGlmIChvcHRpb25zLmhlYWRlcnMgfHwgIXRoaXMuaGVhZGVycykge1xuICAgICAgdGhpcy5oZWFkZXJzID0gbmV3IEhlYWRlcnMob3B0aW9ucy5oZWFkZXJzKVxuICAgIH1cbiAgICB0aGlzLm1ldGhvZCA9IG5vcm1hbGl6ZU1ldGhvZChvcHRpb25zLm1ldGhvZCB8fCB0aGlzLm1ldGhvZCB8fCAnR0VUJylcbiAgICB0aGlzLm1vZGUgPSBvcHRpb25zLm1vZGUgfHwgdGhpcy5tb2RlIHx8IG51bGxcbiAgICB0aGlzLnJlZmVycmVyID0gbnVsbFxuXG4gICAgaWYgKCh0aGlzLm1ldGhvZCA9PT0gJ0dFVCcgfHwgdGhpcy5tZXRob2QgPT09ICdIRUFEJykgJiYgYm9keSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQm9keSBub3QgYWxsb3dlZCBmb3IgR0VUIG9yIEhFQUQgcmVxdWVzdHMnKVxuICAgIH1cbiAgICB0aGlzLl9pbml0Qm9keShib2R5KVxuICB9XG5cbiAgUmVxdWVzdC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IFJlcXVlc3QodGhpcywgeyBib2R5OiB0aGlzLl9ib2R5SW5pdCB9KVxuICB9XG5cbiAgZnVuY3Rpb24gZGVjb2RlKGJvZHkpIHtcbiAgICB2YXIgZm9ybSA9IG5ldyBGb3JtRGF0YSgpXG4gICAgYm9keS50cmltKCkuc3BsaXQoJyYnKS5mb3JFYWNoKGZ1bmN0aW9uKGJ5dGVzKSB7XG4gICAgICBpZiAoYnl0ZXMpIHtcbiAgICAgICAgdmFyIHNwbGl0ID0gYnl0ZXMuc3BsaXQoJz0nKVxuICAgICAgICB2YXIgbmFtZSA9IHNwbGl0LnNoaWZ0KCkucmVwbGFjZSgvXFwrL2csICcgJylcbiAgICAgICAgdmFyIHZhbHVlID0gc3BsaXQuam9pbignPScpLnJlcGxhY2UoL1xcKy9nLCAnICcpXG4gICAgICAgIGZvcm0uYXBwZW5kKGRlY29kZVVSSUNvbXBvbmVudChuYW1lKSwgZGVjb2RlVVJJQ29tcG9uZW50KHZhbHVlKSlcbiAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiBmb3JtXG4gIH1cblxuICBmdW5jdGlvbiBwYXJzZUhlYWRlcnMocmF3SGVhZGVycykge1xuICAgIHZhciBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKVxuICAgIC8vIFJlcGxhY2UgaW5zdGFuY2VzIG9mIFxcclxcbiBhbmQgXFxuIGZvbGxvd2VkIGJ5IGF0IGxlYXN0IG9uZSBzcGFjZSBvciBob3Jpem9udGFsIHRhYiB3aXRoIGEgc3BhY2VcbiAgICAvLyBodHRwczovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjNzIzMCNzZWN0aW9uLTMuMlxuICAgIHZhciBwcmVQcm9jZXNzZWRIZWFkZXJzID0gcmF3SGVhZGVycy5yZXBsYWNlKC9cXHI/XFxuW1xcdCBdKy9nLCAnICcpXG4gICAgcHJlUHJvY2Vzc2VkSGVhZGVycy5zcGxpdCgvXFxyP1xcbi8pLmZvckVhY2goZnVuY3Rpb24obGluZSkge1xuICAgICAgdmFyIHBhcnRzID0gbGluZS5zcGxpdCgnOicpXG4gICAgICB2YXIga2V5ID0gcGFydHMuc2hpZnQoKS50cmltKClcbiAgICAgIGlmIChrZXkpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gcGFydHMuam9pbignOicpLnRyaW0oKVxuICAgICAgICBoZWFkZXJzLmFwcGVuZChrZXksIHZhbHVlKVxuICAgICAgfVxuICAgIH0pXG4gICAgcmV0dXJuIGhlYWRlcnNcbiAgfVxuXG4gIEJvZHkuY2FsbChSZXF1ZXN0LnByb3RvdHlwZSlcblxuICBmdW5jdGlvbiBSZXNwb25zZShib2R5SW5pdCwgb3B0aW9ucykge1xuICAgIGlmICghb3B0aW9ucykge1xuICAgICAgb3B0aW9ucyA9IHt9XG4gICAgfVxuXG4gICAgdGhpcy50eXBlID0gJ2RlZmF1bHQnXG4gICAgdGhpcy5zdGF0dXMgPSBvcHRpb25zLnN0YXR1cyA9PT0gdW5kZWZpbmVkID8gMjAwIDogb3B0aW9ucy5zdGF0dXNcbiAgICB0aGlzLm9rID0gdGhpcy5zdGF0dXMgPj0gMjAwICYmIHRoaXMuc3RhdHVzIDwgMzAwXG4gICAgdGhpcy5zdGF0dXNUZXh0ID0gJ3N0YXR1c1RleHQnIGluIG9wdGlvbnMgPyBvcHRpb25zLnN0YXR1c1RleHQgOiAnT0snXG4gICAgdGhpcy5oZWFkZXJzID0gbmV3IEhlYWRlcnMob3B0aW9ucy5oZWFkZXJzKVxuICAgIHRoaXMudXJsID0gb3B0aW9ucy51cmwgfHwgJydcbiAgICB0aGlzLl9pbml0Qm9keShib2R5SW5pdClcbiAgfVxuXG4gIEJvZHkuY2FsbChSZXNwb25zZS5wcm90b3R5cGUpXG5cbiAgUmVzcG9uc2UucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBSZXNwb25zZSh0aGlzLl9ib2R5SW5pdCwge1xuICAgICAgc3RhdHVzOiB0aGlzLnN0YXR1cyxcbiAgICAgIHN0YXR1c1RleHQ6IHRoaXMuc3RhdHVzVGV4dCxcbiAgICAgIGhlYWRlcnM6IG5ldyBIZWFkZXJzKHRoaXMuaGVhZGVycyksXG4gICAgICB1cmw6IHRoaXMudXJsXG4gICAgfSlcbiAgfVxuXG4gIFJlc3BvbnNlLmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHJlc3BvbnNlID0gbmV3IFJlc3BvbnNlKG51bGwsIHtzdGF0dXM6IDAsIHN0YXR1c1RleHQ6ICcnfSlcbiAgICByZXNwb25zZS50eXBlID0gJ2Vycm9yJ1xuICAgIHJldHVybiByZXNwb25zZVxuICB9XG5cbiAgdmFyIHJlZGlyZWN0U3RhdHVzZXMgPSBbMzAxLCAzMDIsIDMwMywgMzA3LCAzMDhdXG5cbiAgUmVzcG9uc2UucmVkaXJlY3QgPSBmdW5jdGlvbih1cmwsIHN0YXR1cykge1xuICAgIGlmIChyZWRpcmVjdFN0YXR1c2VzLmluZGV4T2Yoc3RhdHVzKSA9PT0gLTEpIHtcbiAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbnZhbGlkIHN0YXR1cyBjb2RlJylcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKG51bGwsIHtzdGF0dXM6IHN0YXR1cywgaGVhZGVyczoge2xvY2F0aW9uOiB1cmx9fSlcbiAgfVxuXG4gIHNlbGYuSGVhZGVycyA9IEhlYWRlcnNcbiAgc2VsZi5SZXF1ZXN0ID0gUmVxdWVzdFxuICBzZWxmLlJlc3BvbnNlID0gUmVzcG9uc2VcblxuICBzZWxmLmZldGNoID0gZnVuY3Rpb24oaW5wdXQsIGluaXQpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICB2YXIgcmVxdWVzdCA9IG5ldyBSZXF1ZXN0KGlucHV0LCBpbml0KVxuICAgICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpXG5cbiAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgICAgc3RhdHVzOiB4aHIuc3RhdHVzLFxuICAgICAgICAgIHN0YXR1c1RleHQ6IHhoci5zdGF0dXNUZXh0LFxuICAgICAgICAgIGhlYWRlcnM6IHBhcnNlSGVhZGVycyh4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkgfHwgJycpXG4gICAgICAgIH1cbiAgICAgICAgb3B0aW9ucy51cmwgPSAncmVzcG9uc2VVUkwnIGluIHhociA/IHhoci5yZXNwb25zZVVSTCA6IG9wdGlvbnMuaGVhZGVycy5nZXQoJ1gtUmVxdWVzdC1VUkwnKVxuICAgICAgICB2YXIgYm9keSA9ICdyZXNwb25zZScgaW4geGhyID8geGhyLnJlc3BvbnNlIDogeGhyLnJlc3BvbnNlVGV4dFxuICAgICAgICByZXNvbHZlKG5ldyBSZXNwb25zZShib2R5LCBvcHRpb25zKSlcbiAgICAgIH1cblxuICAgICAgeGhyLm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KG5ldyBUeXBlRXJyb3IoJ05ldHdvcmsgcmVxdWVzdCBmYWlsZWQnKSlcbiAgICAgIH1cblxuICAgICAgeGhyLm9udGltZW91dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QobmV3IFR5cGVFcnJvcignTmV0d29yayByZXF1ZXN0IGZhaWxlZCcpKVxuICAgICAgfVxuXG4gICAgICB4aHIub3BlbihyZXF1ZXN0Lm1ldGhvZCwgcmVxdWVzdC51cmwsIHRydWUpXG5cbiAgICAgIGlmIChyZXF1ZXN0LmNyZWRlbnRpYWxzID09PSAnaW5jbHVkZScpIHtcbiAgICAgICAgeGhyLndpdGhDcmVkZW50aWFscyA9IHRydWVcbiAgICAgIH0gZWxzZSBpZiAocmVxdWVzdC5jcmVkZW50aWFscyA9PT0gJ29taXQnKSB7XG4gICAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSBmYWxzZVxuICAgICAgfVxuXG4gICAgICBpZiAoJ3Jlc3BvbnNlVHlwZScgaW4geGhyICYmIHN1cHBvcnQuYmxvYikge1xuICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2Jsb2InXG4gICAgICB9XG5cbiAgICAgIHJlcXVlc3QuaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG4gICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKG5hbWUsIHZhbHVlKVxuICAgICAgfSlcblxuICAgICAgeGhyLnNlbmQodHlwZW9mIHJlcXVlc3QuX2JvZHlJbml0ID09PSAndW5kZWZpbmVkJyA/IG51bGwgOiByZXF1ZXN0Ll9ib2R5SW5pdClcbiAgICB9KVxuICB9XG4gIHNlbGYuZmV0Y2gucG9seWZpbGwgPSB0cnVlXG59KSh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDogdGhpcyk7XG5cblxuLyoqKi8gfSlcbi8qKioqKiovIF0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBvbWlzZS5qcyIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGlkZW50aXR5IGZ1bmN0aW9uIGZvciBjYWxsaW5nIGhhcm1vbnkgaW1wb3J0cyB3aXRoIHRoZSBjb3JyZWN0IGNvbnRleHRcbiBcdF9fd2VicGFja19yZXF1aXJlX18uaSA9IGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2YWx1ZTsgfTtcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbiBcdFx0XHRcdGdldDogZ2V0dGVyXG4gXHRcdFx0fSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiL1wiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDcpO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svYm9vdHN0cmFwIDBjZWI0YmU2NGFmNzAwNTYyMWM1IiwiY29uc3QgZW52ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgfHwgJ2RldmVsb3BtZW50J1xuXG5jb25zdCBjb25maWcgPSB7XG4gIHRlc3Q6IHtcbiAgICB2YXVsdFVybDogcHJvY2Vzcy5lbnYuVEVTVF9WQVVMVF9VUkwsXG4gICAgY2FyZEhvc3Q6IHByb2Nlc3MuZW52LlRFU1RfQ0FSRF9IT1NULFxuICAgIGludGVyZmFjZVVybDogcHJvY2Vzcy5lbnYuVEVTVF9JTlRFUkZBQ0VfVVJMLFxuICB9LFxuICBkZXZlbG9wbWVudDoge1xuICAgIHZhdWx0VXJsOiBwcm9jZXNzLmVudi5ERVZfVkFVTFRfVVJMLFxuICAgIGNhcmRIb3N0OiBwcm9jZXNzLmVudi5ERVZfQ0FSRF9IT1NULFxuICAgIGludGVyZmFjZVVybDogcHJvY2Vzcy5lbnYuREVWX0lOVEVSRkFDRV9VUkwsXG4gIH0sXG4gIHN0YWdpbmc6IHtcbiAgICB2YXVsdFVybDogcHJvY2Vzcy5lbnYuU1RBR0lOR19WQVVMVF9VUkwsXG4gICAgY2FyZEhvc3Q6IHByb2Nlc3MuZW52LlNUQUdJTkdfQ0FSRF9IT1NULFxuICAgIGludGVyZmFjZVVybDogcHJvY2Vzcy5lbnYuU1RBR0lOR19JTlRFUkZBQ0VfVVJMLFxuICB9LFxuICBwcm9kdWN0aW9uOiB7XG4gICAgdmF1bHRVcmw6IHByb2Nlc3MuZW52LlBST0RVQ1RJT05fVkFVTFRfVVJMLFxuICAgIGNhcmRIb3N0OiBwcm9jZXNzLmVudi5QUk9EVUNUSU9OX0NBUkRfSE9TVCxcbiAgICBpbnRlcmZhY2VVcmw6IHByb2Nlc3MuZW52LlBST0RVQ1RJT05fSU5URVJGQUNFX1VSTCxcbiAgfSxcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBjb25maWdbZW52XVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbmZpZy5qcyIsInZhciBnO1xyXG5cclxuLy8gVGhpcyB3b3JrcyBpbiBub24tc3RyaWN0IG1vZGVcclxuZyA9IChmdW5jdGlvbigpIHtcclxuXHRyZXR1cm4gdGhpcztcclxufSkoKTtcclxuXHJcbnRyeSB7XHJcblx0Ly8gVGhpcyB3b3JrcyBpZiBldmFsIGlzIGFsbG93ZWQgKHNlZSBDU1ApXHJcblx0ZyA9IGcgfHwgRnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpIHx8ICgxLGV2YWwpKFwidGhpc1wiKTtcclxufSBjYXRjaChlKSB7XHJcblx0Ly8gVGhpcyB3b3JrcyBpZiB0aGUgd2luZG93IHJlZmVyZW5jZSBpcyBhdmFpbGFibGVcclxuXHRpZih0eXBlb2Ygd2luZG93ID09PSBcIm9iamVjdFwiKVxyXG5cdFx0ZyA9IHdpbmRvdztcclxufVxyXG5cclxuLy8gZyBjYW4gc3RpbGwgYmUgdW5kZWZpbmVkLCBidXQgbm90aGluZyB0byBkbyBhYm91dCBpdC4uLlxyXG4vLyBXZSByZXR1cm4gdW5kZWZpbmVkLCBpbnN0ZWFkIG9mIG5vdGhpbmcgaGVyZSwgc28gaXQnc1xyXG4vLyBlYXNpZXIgdG8gaGFuZGxlIHRoaXMgY2FzZS4gaWYoIWdsb2JhbCkgeyAuLi59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGc7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vICh3ZWJwYWNrKS9idWlsZGluL2dsb2JhbC5qc1xuLy8gbW9kdWxlIGlkID0gMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcbiAqIC09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09XG4gKiBIZWxwZXJzIC0gdXRpbHNcbiAqIC09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09XG4gKi9cblxuZXhwb3J0IGZ1bmN0aW9uIG1lcmdlKGRlc3QsIHNvdXJjZSkge1xuICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgZGVzdCwgc291cmNlKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xvbmUoc291cmNlKSB7XG4gIHJldHVybiBzYWZlSnNvblBhcnNlKEpTT04uc3RyaW5naWZ5KHNvdXJjZSkpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzYWZlSnNvblBhcnNlKHN0cikge1xuICB0cnkge1xuICAgIHJldHVybiBKU09OLnBhcnNlKHN0cilcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBzdHJcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNFbXB0eSh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgPT0gbnVsbCB8fCB2YWx1ZSA9PT0gJycgPyB0cnVlIDogZmFsc2Vcbn1cblxuLyoqXG4gKiBIZWxwZXIgZm9yIHRyYW5zZnJvbSBzdHJpbmcgYGNhbWVsQ2FzZWAgdG8gYGRhc2hgLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHIgLSBzdHJpbmcgZm9yIHRyYW5zZm9ybS5cbiAqIEByZXR1cm4ge3N0cmluZ30gc3RyaW5nIGFmdGVyIHRyYW5zZm9ybS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNhbWVsQ2FzZVRvRGFzaChzdHIpIHtcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKC8oW2Etel0pKFtBLVpdKS9nLCAnJDEtJDInKVxufVxuXG4vLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzY2NjA5NzcvY29udmVydC1oeXBoZW5zLXRvLWNhbWVsLWNhc2UtY2FtZWxjYXNlXG5leHBvcnQgZnVuY3Rpb24gZGFzaFRvQ2FtZWxDYXNlKHN0cikge1xuICByZXR1cm4gc3RyLnJlcGxhY2UoLy0oW2Etel0pL2csIGcgPT4gZ1sxXS50b1VwcGVyQ2FzZSgpKVxufVxuXG4vKipcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBleHRyYWNrIGFsbCBkYXRhIGZyb20gZWxlbWVudC5cbiAqXG4gKiBAcGFyYW0ge2VsZW1lbnR9IGVsZW1lbnQgLSBlbGVtZW50IGZvciBleHRyYWN0IGRhdGEuXG4gKiBAcmV0dXJuIHtvYmplY3R9IGFsbCBkYXRhIGFuZCB2YWx1ZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3REYXRhRnJvbUVsZW1lbnQoZWxlbWVudCkge1xuICBjb25zdCBleHRyYWN0RGF0YSA9IHt9XG4gIGNvbnN0IHRvdGFsQXR0cnMgPSBlbGVtZW50LmF0dHJpYnV0ZXMubGVuZ3RoXG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b3RhbEF0dHJzOyBpKyspIHtcbiAgICBjb25zdCBhdHRyID0gZWxlbWVudC5hdHRyaWJ1dGVzW2ldXG5cbiAgICAvLyBFeHRlYWN0IGFsbCBvbmx5IGRhdGEgZnJvbSBlbGVtZW50XG4gICAgaWYgKC9eZGF0YS8udGVzdChhdHRyLm5hbWUpKSB7XG4gICAgICBjb25zdCBuYW1lID0gZGFzaFRvQ2FtZWxDYXNlKGF0dHIubmFtZS5yZXBsYWNlKCdkYXRhLScsICcnKSlcbiAgICAgIGV4dHJhY3REYXRhW25hbWVdID0gYXR0ci52YWx1ZVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBleHRyYWN0RGF0YVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2hlbHBlcnMvdXRpbHMuanMiLCIvKipcbiAqIC09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09XG4gKiBPbWlzZS5qcyBDb3JlXG4gKiAtPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPVxuICovXG5pbXBvcnQgeyBpc1VyaSB9IGZyb20gJ3ZhbGlkLXVybCdcbmltcG9ydCAnd2hhdHdnLWZldGNoJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBPbWlzZSB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZykge1xuICAgIGNvbnN0IHJlc3VsdCA9IHZlcmlmeUNvbmZpZ1N0cnVjdHVyZShjb25maWcpXG4gICAgaWYgKHJlc3VsdC5lcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKHJlc3VsdC5tZXNzYWdlKVxuICAgIH1cblxuICAgIHRoaXMuY29uZmlnID0gY29uZmlnXG4gICAgdGhpcy5wdWJsaWNLZXkgPSBudWxsXG4gICAgdGhpcy5fcnBjID0gbnVsbFxuICB9XG5cbiAgX2NyZWF0ZVJwYyhjYWxsYmFjaykge1xuICAgIGlmICh0aGlzLl9ycGMpIHtcbiAgICAgIHJldHVybiB0aGlzLl9ycGNcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgeyB2YXVsdFVybCB9ID0gdGhpcy5jb25maWdcbiAgICAgIGNvbnN0IHRtID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHRoaXMuX3JwYy5kZXN0cm95KClcbiAgICAgICAgdGhpcy5fcnBjID0gbnVsbFxuXG4gICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgIGNhbGxiYWNrKClcbiAgICAgICAgfVxuICAgICAgfSwgMzAwMDApXG5cbiAgICAgIHRoaXMuX3JwYyA9IG5ldyBlYXN5WERNLlJwYyhcbiAgICAgICAge1xuICAgICAgICAgIHJlbW90ZTogYCR7dmF1bHRVcmx9L3Byb3ZpZGVyYCxcbiAgICAgICAgICBvblJlYWR5KCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRtKVxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICByZW1vdGU6IHtcbiAgICAgICAgICAgIGNyZWF0ZVRva2VuOiB7fSxcbiAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgICApXG5cbiAgICAgIHJldHVybiB0aGlzLl9ycGNcbiAgICB9XG4gIH1cblxuICBzZXRQdWJsaWNLZXkocHVibGljS2V5KSB7XG4gICAgdGhpcy5wdWJsaWNLZXkgPSBwdWJsaWNLZXlcbiAgICByZXR1cm4gdGhpcy5wdWJsaWNLZXlcbiAgfVxuXG4gIGNyZWF0ZVNvdXJjZSh0eXBlLCBvcHRpb25zLCBjYWxsYmFjaykge1xuICAgIGNvbnN0IGF1dGggPSBidG9hKHRoaXMucHVibGljS2V5KVxuXG4gICAgb3B0aW9ucy50eXBlID0gdHlwZVxuXG4gICAgY29uc3QgdXJsID0gYCR7dGhpcy5jb25maWcuaW50ZXJmYWNlVXJsfS9zb3VyY2VzL2BcbiAgICBmZXRjaCh1cmwsIHtcbiAgICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBBdXRob3JpemF0aW9uOiBgQmFzaWMgJHthdXRofWAsXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkob3B0aW9ucyksXG4gICAgfSlcbiAgICAgIC50aGVuKHJlc3BvbnNlID0+XG4gICAgICAgIHJlc3BvbnNlLmpzb24oKS50aGVuKGRhdGEgPT4gY2FsbGJhY2socmVzcG9uc2Uuc3RhdHVzLCBkYXRhKSlcbiAgICAgIClcbiAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgIGNhbGxiYWNrKDAsIHtcbiAgICAgICAgICBjb2RlOiAnY3JlYXRlX3NvdXJjZV9lcnJvcicsXG4gICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgIH0pXG4gICAgICB9KVxuICB9XG5cbiAgY3JlYXRlVG9rZW4oYXMsIGF0dHJpYnV0ZXMsIGhhbmRsZXIpIHtcbiAgICBjb25zdCBkYXRhID0ge31cbiAgICBkYXRhW2FzXSA9IGF0dHJpYnV0ZXNcblxuICAgIHRoaXMuX2NyZWF0ZVJwYygoKSA9PiB7XG4gICAgICBoYW5kbGVyKDAsIHtcbiAgICAgICAgY29kZTogJ3JwY19lcnJvcicsXG4gICAgICAgIG1lc3NhZ2U6ICd1bmFibGUgdG8gY29ubmVjdCB0byBwcm92aWRlciBhZnRlciB0aW1lb3V0JyxcbiAgICAgIH0pXG4gICAgfSkuY3JlYXRlVG9rZW4oXG4gICAgICB0aGlzLnB1YmxpY0tleSxcbiAgICAgIGRhdGEsXG4gICAgICByZXNwb25zZSA9PiB7XG4gICAgICAgIGhhbmRsZXIocmVzcG9uc2Uuc3RhdHVzLCByZXNwb25zZS5kYXRhKVxuICAgICAgfSxcbiAgICAgIGUgPT4ge1xuICAgICAgICBoYW5kbGVyKGUuZGF0YS5zdGF0dXMsIGUuZGF0YS5kYXRhKVxuICAgICAgfVxuICAgIClcbiAgfVxufVxuXG4vKipcbiAqIEhlbHBlciB0byB2ZXJpZnkgY29uZmlnIHN0cnVjdHVyZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgLSBjb25maWcgZm9yIG9taXNlLmpzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdmVyaWZ5Q29uZmlnU3RydWN0dXJlKGNvbmZpZykge1xuICBjb25zdCByZXN1bHQgPSB7XG4gICAgZXJyb3I6IGZhbHNlLFxuICAgIG1lc3NhZ2U6ICcnLFxuICB9XG5cbiAgaWYgKCFjb25maWcudmF1bHRVcmwgfHwgIWlzVXJpKGNvbmZpZy52YXVsdFVybCkpIHtcbiAgICByZXN1bHQubWVzc2FnZSA9ICdNaXNzaW5nIHZhbHV0VXJsJ1xuICB9IGVsc2UgaWYgKCFjb25maWcuY2FyZEhvc3QgfHwgIWlzVXJpKGNvbmZpZy5jYXJkSG9zdCkpIHtcbiAgICByZXN1bHQubWVzc2FnZSA9ICdNaXNzaW5nIGNhcmRIb3N0J1xuICB9IGVsc2UgaWYgKCFjb25maWcuaW50ZXJmYWNlVXJsIHx8ICFpc1VyaShjb25maWcuaW50ZXJmYWNlVXJsKSkge1xuICAgIHJlc3VsdC5tZXNzYWdlID0gJ01pc3NpbmcgaW50ZXJmYWNlVXJsJ1xuICB9XG5cbiAgcmVzdWx0LmVycm9yID0gcmVzdWx0Lm1lc3NhZ2UgIT09ICcnXG5cbiAgcmV0dXJuIHJlc3VsdFxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL09taXNlLmpzIiwiLyoqXG4gKiAtPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPVxuICogT21pc2VDYXJkXG4gKiAtPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPVxuICovXG5pbXBvcnQgbGlzdGVuTWVzc2FnZSwge1xuICBtZXNzYWdlU2hvd0lmcmFtZUFwcEZvcm0sXG4gIG1lc3NhZ2VDbG9zZUlmcmFtZSxcbiAgbWVzc2FnZUNsb3NlQW5kU2VuZFRva2VuLFxufSBmcm9tICcuL21lc3NhZ2UnXG5cbmltcG9ydCB7XG4gIG1lcmdlLFxuICBpc0VtcHR5LFxuICBleHRyYWN0RGF0YUZyb21FbGVtZW50LFxuICBjYW1lbENhc2VUb0Rhc2gsXG59IGZyb20gJ2hlbHBlcnMvdXRpbHMnXG5cbmV4cG9ydCBjb25zdCBkZWZhdWx0SWZyYW1lQXBwQ29uZmlnID0ge1xuICBrZXk6ICcnLFxuICBhbW91bnQ6IDAsXG4gIGN1cnJlbmN5OiAnVEhCJywgLy8gVEhCLFVTRCxKUFlcbiAgaW1hZ2U6ICdodHRwczovL2Nkbi5vbWlzZS5jby9hc3NldHMvZnJvbnRlbmQtaW1hZ2VzL3N0b3JlLWxvZ28uc3ZnJyxcbiAgZnJhbWVMYWJlbDogJ09taXNlJyxcbiAgZGVmYXVsdFBheW1lbnRNZXRob2Q6ICdjcmVkaXRfY2FyZCcsXG4gIG90aGVyUGF5bWVudE1ldGhvZHM6IFtdLFxuICBmcmFtZURlc2NyaXB0aW9uOiAnU2VjdXJlZCBieSBPbWlzZScsXG4gIHN1Ym1pdExhYmVsOiAnUGF5JyxcbiAgYnV0dG9uTGFiZWw6ICdQYXkgd2l0aCBPbWlzZScsXG4gIGxvY2F0aW9uOiAnbm8nLFxuICBzdWJtaXRBdXRvOiAneWVzJyxcbiAgc3VibWl0Rm9ybVRhcmdldDogJycsXG4gIGNhcmRCcmFuZHM6ICd2aXNhIG1hc3RlcmNhcmQnLFxuICBsb2NhbGU6ICdlbicsIC8vIGVuLHRoLGphXG4gIGF1dG9DYXJkTnVtYmVyRm9ybWF0OiAneWVzJywgLy8geWVzLG5vXG4gIGV4cGlyeURhdGVTdHlsZTogJycsIC8vIGJhc2ljXG4gIGhpZGVBbW91bnQ6ICdmYWxzZScsIC8vIGZhbHNlLCB0cnVlXG59XG5cbmV4cG9ydCBjb25zdCBpZnJhbWVEZWZhdWx0U3R5bGUgPSBbXG4gICdkaXNwbGF5OiBub25lJyxcbiAgJ3Zpc2liaWxpdHk6IHZpc2libGUnLFxuICAncG9zaXRpb246IGZpeGVkJyxcbiAgJ2xlZnQ6IDBweCcsXG4gICd0b3A6IDBweCcsXG4gICd3aWR0aDogMTAwJScsXG4gICdoZWlnaHQ6IDEwMCUnLFxuICAnei1pbmRleDogMjE0NzQ4MzY0NycsXG4gICdwYWRkaW5nOiAwJyxcbiAgJ21hcmdpbjogMCcsXG4gICdib3JkZXI6IDAgbm9uZSB0cmFuc3BhcmVudCcsXG4gICdiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDAsIDAsIDApJyxcbiAgJ292ZXJmbG93LXg6IGhpZGRlbicsXG4gICdvdmVyZmxvdy15OiBhdXRvJyxcbiAgJy13ZWJraXQtdGFwLWhpZ2hsaWdodC1jb2xvcjogdHJhbnNwYXJlbnQnLFxuICAndHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAuMnMnLFxuXVxuXG5jb25zdCBub29wID0gKCkgPT4ge31cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgT21pc2VDYXJkIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGluaXRXaGVuU3RhcnQgPSB0cnVlKSB7XG4gICAgdGhpcy5zZXR1cChzZXR0aW5ncylcblxuICAgIGlmIChpbml0V2hlblN0YXJ0KSB7XG4gICAgICB0aGlzLmluaXQoKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTZXR1cCBPbWlzZS5qc1xuICAgKiBAcGFyYW0ge09iamVjdH0gc2V0dGluZ3MgLSBzZXR0aW5nIGZvciBPbWlzZS5qc1xuICAgKi9cbiAgc2V0dXAoc2V0dGluZ3MpIHtcbiAgICB0aGlzLmFwcCA9IHtcbiAgICAgIHNldHRpbmdzOiB7IC4uLnNldHRpbmdzIH0sXG4gICAgICBpZnJhbWU6IG51bGwsXG4gICAgICBpZnJhbWVMb2FkZWQ6IGZhbHNlLFxuICAgICAgb21pc2VTY3JpcHRUYWc6IG51bGwsXG4gICAgICBvbWlzZUdlbmVyYXRlQ2hlY2tvdXRCdXR0b246IG51bGwsXG4gICAgICBpZnJhbWVBcHBJZDogJ29taXNlLWNoZWNrb3V0LWlmcmFtZS1hcHAnLFxuICAgICAgZGVmYXVsdENvbmZpZzogeyAuLi5kZWZhdWx0SWZyYW1lQXBwQ29uZmlnIH0sXG4gICAgICBjb25maWdGb3JJZnJhbWVPbkxvYWQ6IHsgLi4uZGVmYXVsdElmcmFtZUFwcENvbmZpZyB9LFxuICAgICAgY3VycmVudE9wZW5Db25maWc6IHt9LFxuICAgICAgZm9ybUVsZW1lbnQ6IG51bGwsXG4gICAgICBhbGxDb25maWd1cmVCdXR0b25zOiBbXSxcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5hcHBcbiAgfVxuXG4gIC8qKlxuICAgKiBSdW4gb24gc3RhcnQgdXBcbiAgICovXG4gIGluaXQoKSB7XG4gICAgY29uc3QgZm91bmRJZnJhbWUgPSB0aGlzLmFwcC5pZnJhbWUgIT0gbnVsbFxuICAgIGNvbnN0IHNjcmlwdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2NyaXB0JylcblxuICAgIGNvbnN0IHNjcmlwdHNMZW4gPSBzY3JpcHRzLmxlbmd0aFxuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzY3JpcHRzTGVuOyBpKyspIHtcbiAgICAgIGNvbnN0IHNjcmlwdCA9IHNjcmlwdHNbaV1cbiAgICAgIGlmIChcbiAgICAgICAgc2NyaXB0Lmhhc0F0dHJpYnV0ZSgnZGF0YS1rZXknKSAmJlxuICAgICAgICBzY3JpcHQuaGFzQXR0cmlidXRlKCdkYXRhLWFtb3VudCcpXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5hcHAub21pc2VTY3JpcHRUYWcgPSBzY3JpcHRcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIWZvdW5kSWZyYW1lICYmICF0aGlzLmlzSW5zaWRlSWZyYW1lQXBwKCkgJiYgdGhpcy5hcHAub21pc2VTY3JpcHRUYWcpIHtcbiAgICAgIHRoaXMuY3JlYXRlSWZyYW1lKClcbiAgICAgIHRoaXMuYXBwLm9taXNlR2VuZXJhdGVDaGVja291dEJ1dHRvbiA9IHRoaXMuY3JlYXRlT21pc2VDaGVja291dEJ1dHRvbigpXG4gICAgICBsaXN0ZW5NZXNzYWdlKHRoaXMpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBkZWZhdWx0IGNvbmZpZ1xuICAgKlxuICAgKiBAcmV0dXJuIHtvYmplY3R9IGN1cnJlbnQgZGVmYXVsdCBjb25maWcuXG4gICAqL1xuICBnZXREZWZhdWx0Q29uZmlnKCkge1xuICAgIHJldHVybiB0aGlzLmFwcC5kZWZhdWx0Q29uZmlnXG4gIH1cblxuICAvKipcbiAgICogR2V0IGFsbCBjb25maWd1cmUgYnV0dG9ucy5cbiAgICogQHJldHVybiB7QXJyYXl9IGFsbCBjb25maWd1cmUgYnV0dG9ucy5cbiAgICovXG4gIGdldEFsbENvbmZpZ3VyZUJ1dHRvbnMoKSB7XG4gICAgcmV0dXJuIHRoaXMuYXBwLmFsbENvbmZpZ3VyZUJ1dHRvbnNcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgdG9rZW4gYXQgb21pc2UgdG9rZW4gaGlkZGVuIGZpZWxkLlxuICAgKiBAcGFyYW0ge1N0cmluZ30gdG9rZW4gLSBvbWlzZSB0b2tlbi5cbiAgICovXG4gIHNldFRva2VuQXRPbWlzZVRva2VuRmllbGQodG9rZW4pIHtcbiAgICBjb25zdCBtZXJnZWRDb25maWcgPSB7XG4gICAgICAuLi50aGlzLmFwcC5kZWZhdWx0Q29uZmlnLFxuICAgICAgLi4udGhpcy5hcHAuY3VycmVudE9wZW5Db25maWcsXG4gICAgfVxuICAgIGNvbnN0IHsgc3VibWl0QXV0bywgb25DcmVhdGVUb2tlblN1Y2Nlc3MgfSA9IG1lcmdlZENvbmZpZ1xuXG4gICAgaWYgKHRoaXMuYXBwLmZvcm1FbGVtZW50KSB7XG4gICAgICBpZiAodGhpcy5pc09taXNlU291cmNlKHRva2VuKSkge1xuICAgICAgICB0aGlzLmFwcC5mb3JtRWxlbWVudC5vbWlzZVNvdXJjZS52YWx1ZSA9IHRva2VuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmFwcC5mb3JtRWxlbWVudC5vbWlzZVRva2VuLnZhbHVlID0gdG9rZW5cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoc3VibWl0QXV0byA9PT0gJ3llcycgJiYgdGhpcy5hcHAuZm9ybUVsZW1lbnQpIHtcbiAgICAgIHRoaXMuYXBwLmZvcm1FbGVtZW50LnN1Ym1pdCgpXG4gICAgfVxuXG4gICAgOyhvbkNyZWF0ZVRva2VuU3VjY2VzcyB8fCBub29wKSh0b2tlbilcblxuICAgIC8vIGNsZWFyIGN1cnJlbnQgb3BlbiBjb25maWcgYWZ0ZXIgc3VibWl0ZWRcbiAgICB0aGlzLmFwcC5jdXJyZW50T3BlbkNvbmZpZyA9IHt9XG4gIH1cblxuICBpc09taXNlU291cmNlKHN0cmluZykge1xuICAgIHJldHVybiAvXnNyY18vLnRlc3Qoc3RyaW5nKVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBmb3JtIGVsZW1lbnQgZnJvbSB0YXJnZXQgYnkgdHJhdmVsIHVwIHRvIERPTSB0cmVlLlxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IHRhcmdldCAtIHRhcmdldCBlbGVtZW50IGZvciBmaW5kIGZvcm0gZWxlbWVudC5cbiAgICogQHJldHVybiB7RWxlbWVudH0gZm9ybSBlbGVtZW50LlxuICAgKi9cbiAgZ2V0Rm9ybUJ5VGFyZ2V0KHRhcmdldCkge1xuICAgIGxldCBjdXJyZW50Tm9kZSA9IHRhcmdldFxuXG4gICAgLy8gdHJhdmVsIERPTSB1bnRpbCBmb3VuZCBmb3JtIHRhZ1xuICAgIHdoaWxlIChjdXJyZW50Tm9kZSAmJiBjdXJyZW50Tm9kZS50YWdOYW1lICE9PSAnRk9STScpIHtcbiAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUucGFyZW50Tm9kZVxuICAgIH1cblxuICAgIHJldHVybiBjdXJyZW50Tm9kZVxuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBpZnJhbWUgYXQgbWVyY2hhbnQgcGFnZVxuICAgKi9cbiAgY3JlYXRlSWZyYW1lKCkge1xuICAgIGNvbnN0IGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpXG4gICAgaWZyYW1lLmlkID0gdGhpcy5hcHAuaWZyYW1lQXBwSWRcbiAgICBpZnJhbWUuc3JjID0gYCR7dGhpcy5hcHAuc2V0dGluZ3MuY2FyZEhvc3R9L3BheS5odG1sYFxuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgaWZyYW1lRGVmYXVsdFN0eWxlLmpvaW4oJzsgJykpXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpZnJhbWUpXG4gICAgaWZyYW1lLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgIGlmICh0aGlzLmFwcC5pZnJhbWUuc3R5bGUuZGlzcGxheSA9PT0gJ2Jsb2NrJykge1xuICAgICAgICBtZXNzYWdlU2hvd0lmcmFtZUFwcEZvcm0oaWZyYW1lLmNvbnRlbnRXaW5kb3csIHtcbiAgICAgICAgICBjb25maWc6IHRoaXMuYXBwLmNvbmZpZ0ZvcklmcmFtZU9uTG9hZCxcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIHRoaXMuYXBwLmlmcmFtZUxvYWRlZCA9IHRydWVcbiAgICB9XG5cbiAgICB0aGlzLmFwcC5pZnJhbWUgPSBpZnJhbWVcblxuICAgIHJldHVybiB0aGlzLmFwcC5pZnJhbWVcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgaGlkZGVuIGlucHV0IGZvciBzdG9yZSBPbWlzZSBUb2tlbi5cbiAgICogQHBhcmFtICB7RWxlbWVudH0gdGFyZ2V0IC0gdGFyZ2V0IGVsZW1lbnQgZm9yIGluc2VydCBpbnB1dC5cbiAgICogQHJldHVybiB7RWxlbWVudH0gaGlkZGVuIGlucHV0IGVsZW1lbnQuXG4gICAqL1xuICBjcmVhdGVIaWRkZW5JbnB1dEZvck9taXNlVG9rZW4odGFyZ2V0KSB7XG4gICAgbGV0IGZvcm1FbGVtZW50ID0gbnVsbFxuXG4gICAgaWYgKHRhcmdldCAmJiB0YXJnZXQudGFnTmFtZSA9PT0gJ0ZPUk0nKSB7XG4gICAgICBmb3JtRWxlbWVudCA9IHRhcmdldFxuICAgIH1cblxuICAgIGlmICghZm9ybUVsZW1lbnQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgW1xuICAgICAgICAgICdNaXNzaW5nIGZvcm0gZWxlbWVudC4gR2VuZXJhdGUgYnV0dG9uIG9yIGN1c3RvbSBidXR0b24gbXVzdCBjb250YWluIGluIGZvcm0gZWxlbWVudC4nLFxuICAgICAgICAgICdodHRwczovL2dpdGh1Yi5jb20vb21pc2UvZXhhbXBsZXMvYmxvYi9tYXN0ZXIvb21pc2UuanMvZXhhbXBsZS00LWN1c3RvbS1pbnRlZ3JhdGlvbi1tdWx0aXBsZS1idXR0b25zLmh0bWwnLFxuICAgICAgICAgICdPciBzZXR0aW5nIHN1Ym1pdCBmb3JtIHRhcmdldCcsXG4gICAgICAgICAgJ2h0dHBzOi8vZ2l0aHViLmNvbS9vbWlzZS9leGFtcGxlcy9ibG9iL21hc3Rlci9vbWlzZS5qcy9leGFtcGxlLTUtY3VzdG9tLWludGVncmF0aW9uLXNwZWNpZnktY2hlY2tvdXQtZm9ybS5odG1sJyxcbiAgICAgICAgXS5qb2luKCdcXG4nKVxuICAgICAgKVxuICAgIH1cblxuICAgIGxldCBpbnB1dE9taXNlVG9rZW4gPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwib21pc2VUb2tlblwiXScpXG5cbiAgICBpZiAoaW5wdXRPbWlzZVRva2VuID09IG51bGwpIHtcbiAgICAgIGlucHV0T21pc2VUb2tlbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JylcbiAgICAgIGlucHV0T21pc2VUb2tlbi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnaGlkZGVuJylcbiAgICAgIGlucHV0T21pc2VUb2tlbi5zZXRBdHRyaWJ1dGUoJ25hbWUnLCAnb21pc2VUb2tlbicpXG4gICAgICBmb3JtRWxlbWVudC5hcHBlbmRDaGlsZChpbnB1dE9taXNlVG9rZW4pXG4gICAgfVxuXG4gICAgbGV0IGlucHV0T21pc2VTb3VyY2UgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgJ2lucHV0W25hbWU9XCJvbWlzZVNvdXJjZVwiXSdcbiAgICApXG5cbiAgICBpZiAoaW5wdXRPbWlzZVNvdXJjZSA9PSBudWxsKSB7XG4gICAgICBpbnB1dE9taXNlU291cmNlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKVxuICAgICAgaW5wdXRPbWlzZVNvdXJjZS5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnaGlkZGVuJylcbiAgICAgIGlucHV0T21pc2VTb3VyY2Uuc2V0QXR0cmlidXRlKCduYW1lJywgJ29taXNlU291cmNlJylcbiAgICAgIGZvcm1FbGVtZW50LmFwcGVuZENoaWxkKGlucHV0T21pc2VTb3VyY2UpXG4gICAgfVxuXG4gICAgcmV0dXJuIGlucHV0T21pc2VUb2tlblxuICB9XG5cbiAgLyoqXG4gICAqIEF1dG8gY3JlYXRlIHBheSB3aXRoIG9taXNlIGJ1dHRvbiBhdCBuZXh0IG9taXNlIHNjcmlwdCB0YWdzXG4gICAqIEByZXR1cm4ge0VsZW1lbnR9IG9taXNlIGdlbmVyYXRlIGNoZWNrb3V0IGJ1dHRvbi5cbiAgICovXG4gIGNyZWF0ZU9taXNlQ2hlY2tvdXRCdXR0b24oKSB7XG4gICAgY29uc3QgY29uZmlnID0gdGhpcy5wcmVwYXJlQ29uZmlnKFxuICAgICAgZXh0cmFjdERhdGFGcm9tRWxlbWVudCh0aGlzLmFwcC5vbWlzZVNjcmlwdFRhZylcbiAgICApXG4gICAgY29uc3QgY2hlY2tvdXRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuICAgIGNoZWNrb3V0QnV0dG9uLmNsYXNzTmFtZSA9ICdvbWlzZS1jaGVja291dC1idXR0b24nXG4gICAgY2hlY2tvdXRCdXR0b24uaW5uZXJIVE1MID0gY29uZmlnLmJ1dHRvbkxhYmVsXG5cbiAgICBjb25zdCB7IG9taXNlU2NyaXB0VGFnIH0gPSB0aGlzLmFwcFxuICAgIGlmIChvbWlzZVNjcmlwdFRhZykge1xuICAgICAgY29uc3QgZm9ybUVsZW1lbnQgPSB0aGlzLmdldEZvcm1CeVRhcmdldChvbWlzZVNjcmlwdFRhZylcbiAgICAgIHRoaXMuYXBwLmZvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnRcbiAgICAgIHRoaXMuY3JlYXRlSGlkZGVuSW5wdXRGb3JPbWlzZVRva2VuKGZvcm1FbGVtZW50KVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLndhcm4oJ01pc3NpbmcgT21pc2Ugc2NyaXB0IHRhZycpXG4gICAgfVxuXG4gICAgLy8gYmluZCBidXR0b24gZXZlbnQuXG4gICAgY2hlY2tvdXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICdjbGljaycsXG4gICAgICBldmVudCA9PiB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcblxuICAgICAgICBpZiAob21pc2VTY3JpcHRUYWcpIHtcbiAgICAgICAgICBjb25zdCBjb25maWdGcm9tU2NyaXB0VGFnID0gZXh0cmFjdERhdGFGcm9tRWxlbWVudChvbWlzZVNjcmlwdFRhZylcbiAgICAgICAgICBjb25zdCBjb25maWcgPSB0aGlzLnByZXBhcmVDb25maWcoY29uZmlnRnJvbVNjcmlwdFRhZylcbiAgICAgICAgICB0aGlzLmFwcC5jb25maWdGb3JJZnJhbWVPbkxvYWQgPSB7IC4uLmNvbmZpZyB9XG4gICAgICAgICAgdGhpcy5vcGVuKGNvbmZpZylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oJ01pc3NpbmcgT21pc2Ugc2NyaXB0IHRhZycpXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBmYWxzZVxuICAgIClcblxuICAgIC8vIGluamVjdCBidXR0b24gbmV4dCBzY3JpcHQgdGFnLlxuICAgIG9taXNlU2NyaXB0VGFnLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKFxuICAgICAgY2hlY2tvdXRCdXR0b24sXG4gICAgICBvbWlzZVNjcmlwdFRhZy5uZXh0U2libGluZ1xuICAgIClcblxuICAgIHJldHVybiBjaGVja291dEJ1dHRvblxuICB9XG5cbiAgLyoqXG4gICAqIENoZWNraW5nIG9taXNlQ2FyZC5qcyBhcmUgcnVubmluZyBhdCBPbWlzZSBpZnJhbWUgYXBwIG9yIG5vdFxuICAgKi9cbiAgaXNJbnNpZGVJZnJhbWVBcHAoKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuYXBwLmlmcmFtZUFwcElkKSAhPSBudWxsXG4gIH1cblxuICAvKipcbiAgICogUHJlcGFyZSBjb25maWd1cmUgYmVmb3JlIHNlbmQgdG8gY2hlY2tvdXQgZm9ybS5cbiAgICogQHBhcmFtIHtPYmplY3R9IG5ld0NvbmZpZyAgICAgLSBuZXcgY29uZmlnIGZvciBtZXJnZSB3aXRoIGRlZmF1bHQgY29uZmlnLlxuICAgKiBAcmV0dXJuIHtPYmplY3R9IGNvbmZpZ3VyZSBhZnRlciBtZXJnZWQgYW5kIGZpeC5cbiAgICovXG4gIHByZXBhcmVDb25maWcobmV3Q29uZmlnID0ge30pIHtcbiAgICBjb25zdCB7IG90aGVyUGF5bWVudE1ldGhvZHMgfSA9IG5ld0NvbmZpZ1xuXG4gICAgaWYgKG90aGVyUGF5bWVudE1ldGhvZHMgJiYgdHlwZW9mIG90aGVyUGF5bWVudE1ldGhvZHMgPT0gJ3N0cmluZycpIHtcbiAgICAgIG5ld0NvbmZpZy5vdGhlclBheW1lbnRNZXRob2RzID0gdGhpcy5zdHJpbmdUb0FycmF5KG90aGVyUGF5bWVudE1ldGhvZHMpXG4gICAgfVxuXG4gICAgcmV0dXJuIG1lcmdlKHRoaXMuYXBwLmRlZmF1bHRDb25maWcsIGZpeENvbmZpZ05hbWUobmV3Q29uZmlnKSlcbiAgfVxuXG4gIHN0cmluZ1RvQXJyYXkoc3RyKSB7XG4gICAgcmV0dXJuIHN0ci5zcGxpdCgnLCcpLm1hcChzID0+IHMudHJpbSgpKVxuICB9XG5cbiAgLyoqXG4gICAqIFNldCBkZWZhdWx0IGNvbmZpZ3VyZS5cbiAgICogQHBhcmFtICB7b2JqZWN0fSBuZXdDb25maWcgLSBuZXcgY29uZmlnIGZvciBtZXJnZSB3aXRoIGRlZmF1bHQuXG4gICAqIEByZXR1cm4ge29iamVjdH0gZGVmYXVsdCBjb25maWcuXG4gICAqL1xuICBjb25maWd1cmUobmV3Q29uZmlnKSB7XG4gICAgdGhpcy5hcHAuZGVmYXVsdENvbmZpZyA9IHRoaXMucHJlcGFyZUNvbmZpZyhuZXdDb25maWcpXG5cbiAgICBpZiAoIXRoaXMuaXNJbnNpZGVJZnJhbWVBcHAoKSkge1xuICAgICAgaWYgKCF0aGlzLmFwcC5pZnJhbWUpIHtcbiAgICAgICAgdGhpcy5jcmVhdGVJZnJhbWUoKVxuICAgICAgICBsaXN0ZW5NZXNzYWdlKHRoaXMpXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuYXBwLmRlZmF1bHRDb25maWdcbiAgfVxuXG4gIC8qKlxuICAgKiBPcGVuIGlmcmFtZSBhcHAuXG4gICAqIEBwYXJhbSAge09iamVjdH0gICBuZXdDb25maWcgLSBuZXcgY29uZmlnIGZvciBpZnJhbWUgYXBwLlxuICAgKiBAcGFyYW0gIHtGdW5jdGlvbn0gY2FsbGJhY2sgIC0gY2FsbGJhY2sgZmlyZSBhZnRlciBpZnJhbWUgYXBwIG9wZW5lZC5cbiAgICogQHJldHVybiByZXN1bHQgZm9yIG9wZW4uXG4gICAqL1xuICBvcGVuKG5ld0NvbmZpZyA9IHt9LCBjYWxsYmFjayA9IG5vb3ApIHtcbiAgICBpZiAoIXRoaXMuYXBwLmlmcmFtZSkge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgY29uc3Qgb3BlbklmcmFtZVdpdGhOZXdDb25maWcgPSAoKSA9PiB7XG4gICAgICBjb25zdCBjb25maWcgPSB0aGlzLnByZXBhcmVDb25maWcobmV3Q29uZmlnKVxuICAgICAgdGhpcy5hcHAuY3VycmVudE9wZW5Db25maWcgPSB7IC4uLmNvbmZpZyB9XG4gICAgICB0aGlzLmFwcC5pZnJhbWUuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3JnYmEoMCwgMCwgMCwgLjQpJ1xuICAgICAgdGhpcy5hcHAuaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgbWVzc2FnZVNob3dJZnJhbWVBcHBGb3JtKHRoaXMuYXBwLmlmcmFtZS5jb250ZW50V2luZG93LCB7XG4gICAgICAgICAgY29uZmlnLFxuICAgICAgICB9KVxuICAgICAgICBjYWxsYmFjayh0aGlzLmFwcC5pZnJhbWUpXG4gICAgICB9KVxuICAgIH1cblxuICAgIGlmICh0aGlzLmFwcC5pZnJhbWVMb2FkZWQpIHtcbiAgICAgIG9wZW5JZnJhbWVXaXRoTmV3Q29uZmlnKClcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3Qgb2JzZXJ2ZVRpbWVvdXQgPSAzMDAwXG4gICAgICBjb25zdCBvYnNlcnZlRGVsYXkgPSAxMDBcbiAgICAgIGxldCBvYnNlcnZlQ291bnQgPSAwXG5cbiAgICAgIGNvbnN0IG9ic2VydmVUaW1lciA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgb2JzZXJ2ZUNvdW50ICs9IG9ic2VydmVEZWxheVxuICAgICAgICBpZiAob2JzZXJ2ZUNvdW50ID49IG9ic2VydmVUaW1lb3V0IHx8IHRoaXMuYXBwLmlmcmFtZUxvYWRlZCkge1xuICAgICAgICAgIGlmICh0aGlzLmFwcC5pZnJhbWVMb2FkZWQpIHtcbiAgICAgICAgICAgIG9wZW5JZnJhbWVXaXRoTmV3Q29uZmlnKClcbiAgICAgICAgICB9XG4gICAgICAgICAgY2xlYXJJbnRlcnZhbChvYnNlcnZlVGltZXIpXG4gICAgICAgIH1cbiAgICAgIH0sIG9ic2VydmVEZWxheSlcbiAgICB9XG4gICAgcmV0dXJuIHRydWVcbiAgfVxuXG4gIC8qKlxuICAgKiBDbG9zZSBpZnJhbWUgYXBwXG4gICAqIEBwYXJhbSAge0Z1bmN0aW9ufSBjYWxsYmFjayAgLSBjYWxsYmFjayBmaXJlIGFmdGVyIGlmcmFtZSBhcHAgY2xvc2VkLlxuICAgKiBAcmV0dXJuIHJlc3VsdCBmb3IgY2xvc2UuXG4gICAqL1xuICBjbG9zZShjYWxsYmFjayA9IG5vb3ApIHtcbiAgICBpZiAoIXRoaXMuYXBwLmlmcmFtZSkge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgdGhpcy5hcHAuaWZyYW1lLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdyZ2JhKDAsIDAsIDAsIDApJ1xuXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0aGlzLmFwcC5pZnJhbWUuc3R5bGUuZGlzcGxheSA9ICdub25lJ1xuICAgICAgY2FsbGJhY2sodGhpcy5hcHAuaWZyYW1lKVxuICAgICAgY29uc3QgeyBvbkZvcm1DbG9zZWQgfSA9IHRoaXMuYXBwLmN1cnJlbnRPcGVuQ29uZmlnXG4gICAgICA7KG9uRm9ybUNsb3NlZCB8fCBub29wKSh0aGlzLmFwcC5pZnJhbWUpXG4gICAgfSwgMjUwKVxuXG4gICAgcmV0dXJuIHRydWVcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXN0cm95IGlmcmFtZSBhcHBcbiAgICovXG4gIGRlc3Ryb3koKSB7XG4gICAgY29uc3QgaWZyYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5hcHAuaWZyYW1lQXBwSWQpXG5cbiAgICBpZiAodGhpcy5hcHAuaWZyYW1lICYmIGlmcmFtZSkge1xuICAgICAgY29uc3QgaWZyYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5hcHAuaWZyYW1lQXBwSWQpXG4gICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGlmcmFtZSlcblxuICAgICAgLy8gcmVzZXQgYXBwIG9iamVjdCB0byBkZWZhdWx0XG4gICAgICB0aGlzLnNldHVwKClcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGhhbmRsZXIgZm9yIGlmcmFtZSBhcHAgZm9yIGNvbnRyb2wgT21pc2VDYXJkLmpzXG4gICAqL1xuICBjcmVhdGVQYXJlbnRGcmFtZUhhbmRsZXIoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGNsb3NlSWZyYW1lKCkge1xuICAgICAgICBtZXNzYWdlQ2xvc2VJZnJhbWUoKVxuICAgICAgfSxcblxuICAgICAgY2xvc2VBbmRTZW5kVG9rZW4odG9rZW4pIHtcbiAgICAgICAgbWVzc2FnZUNsb3NlQW5kU2VuZFRva2VuKHRva2VuKVxuICAgICAgfSxcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTk9URTogTEVHQUNZXG4gICAqIFNldCBjb25maWd1cmUgdG8gcGF5IGJ1dHRvblxuICAgKiBAcGFyYW0ge3N0cmluZ30gYnV0dG9uSWQgLSBidXR0b24gdGFyZ2V0IGlkLlxuICAgKiBAcGFyYW0ge29iamVjdH0gY29uZmlnICAgLSBjb25maWd1cmUgZm9yIHBheSBidXR0b24uXG4gICAqIEByZXR1cm4ge29iamVjdH0gbmV3IGJ1dHRvbiBjb25maWd1cmUuXG4gICAqL1xuICBjb25maWd1cmVCdXR0b24oYnV0dG9uSWQsIGNvbmZpZykge1xuICAgIGNvbnN0IGNvbmZpZ0ZvckJ1dHRvbiA9IHRoaXMucHJlcGFyZUNvbmZpZyhjb25maWcpXG4gICAgY29uc3QgbmV3QnV0dG9uQ29uZmlnID0ge1xuICAgICAgYnV0dG9uSWQsXG4gICAgICBjb25maWd1cmF0aW9uOiBjb25maWdGb3JCdXR0b24sXG4gICAgfVxuXG4gICAgdGhpcy5hcHAuYWxsQ29uZmlndXJlQnV0dG9ucy5wdXNoKG5ld0J1dHRvbkNvbmZpZylcblxuICAgIHJldHVybiBuZXdCdXR0b25Db25maWdcbiAgfVxuXG4gIC8qKlxuICAgKiBOT1RFOiBMRUdBQ1lcbiAgICogQWN0aXZhdGUgYWxsIGNvbmZpZ3VyZSBidXR0b25zLlxuICAgKi9cbiAgYXR0YWNoKCkge1xuICAgIGNvbnN0IGF0dGFjaGVkQnV0dG9ucyA9IFtdXG4gICAgdGhpcy5hcHAuYWxsQ29uZmlndXJlQnV0dG9ucy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgY29uc3QgeyBjb25maWd1cmF0aW9uIH0gPSBpdGVtXG4gICAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGl0ZW0uYnV0dG9uSWQpXG4gICAgICBjb25zdCBkZWZhdWx0QnV0dG9uVGV4dCA9IHRoaXMuYXBwLmRlZmF1bHRDb25maWcuYnV0dG9uTGFiZWxcbiAgICAgIGxldCBidXR0b25UZXh0ID0gZGVmYXVsdEJ1dHRvblRleHRcblxuICAgICAgaWYgKFxuICAgICAgICBjb25maWd1cmF0aW9uLmJ1dHRvbkxhYmVsICYmXG4gICAgICAgIGJ1dHRvblRleHQgIT09IGNvbmZpZ3VyYXRpb24uYnV0dG9uTGFiZWxcbiAgICAgICkge1xuICAgICAgICBidXR0b25UZXh0ID0gY29uZmlndXJhdGlvbi5idXR0b25MYWJlbFxuICAgICAgfSBlbHNlIGlmIChidXR0b24uaW5uZXJIVE1MKSB7XG4gICAgICAgIGJ1dHRvblRleHQgPSBidXR0b24uaW5uZXJIVE1MXG4gICAgICB9XG5cbiAgICAgIGJ1dHRvbi5pbm5lckhUTUwgPSBidXR0b25UZXh0XG5cbiAgICAgIGNvbnN0IHsgc3VibWl0Rm9ybVRhcmdldCB9ID0gdGhpcy5hcHAuZGVmYXVsdENvbmZpZ1xuICAgICAgY29uc3QgZm9ybUVsZW1lbnQgPSBzdWJtaXRGb3JtVGFyZ2V0XG4gICAgICAgID8gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzdWJtaXRGb3JtVGFyZ2V0KVxuICAgICAgICA6IHRoaXMuZ2V0Rm9ybUJ5VGFyZ2V0KGJ1dHRvbilcbiAgICAgIHRoaXMuY3JlYXRlSGlkZGVuSW5wdXRGb3JPbWlzZVRva2VuKGZvcm1FbGVtZW50KVxuXG4gICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgJ2NsaWNrJyxcbiAgICAgICAgZXZlbnQgPT4ge1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgICBjb25zdCB7IHRhcmdldCB9ID0gZXZlbnRcbiAgICAgICAgICB0aGlzLmFwcC5jb25maWdGb3JJZnJhbWVPbkxvYWQgPSBjb25maWd1cmF0aW9uXG4gICAgICAgICAgdGhpcy5hcHAuZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudFxuICAgICAgICAgIHRoaXMub3Blbihjb25maWd1cmF0aW9uKVxuICAgICAgICB9LFxuICAgICAgICBmYWxzZVxuICAgICAgKVxuXG4gICAgICBhdHRhY2hlZEJ1dHRvbnMucHVzaChidXR0b24pXG4gICAgfSlcblxuICAgIGlmICghdGhpcy5pc0luc2lkZUlmcmFtZUFwcCgpKSB7XG4gICAgICBpZiAoIXRoaXMuYXBwLmlmcmFtZSkge1xuICAgICAgICB0aGlzLmNyZWF0ZUlmcmFtZSgpXG4gICAgICAgIGxpc3Rlbk1lc3NhZ2UodGhpcylcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gYXR0YWNoZWRCdXR0b25zXG4gIH1cbn1cblxuLyoqXG4gKiBGaXggY29uZmlnIG5hbWUgdGhhdCBkb2Vzbid0IG1hdGNoIHdpdGggb3RoZXIuXG4gKiBAcGFyYW0ge29iamVjdH0gY29uZmlnIC0gY29uZmlnIGZvciBpZnJhbWUgYXBwLlxuICogQHJldHVybiB7b2JqZWN0fSBmaXggY29uZmlnLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZml4Q29uZmlnTmFtZShjb25maWcpIHtcbiAgY29uc3QgZml4Q29uZmlnID0ge31cbiAgY29uc3QgbmVlZFRvRml4S2V5cyA9IHtcbiAgICBwdWJsaWNLZXk6ICdrZXknLFxuICAgIGxvZ286ICdpbWFnZScsXG4gICAgbG9jYXRpb25GaWVsZDogJ2xvY2F0aW9uJyxcbiAgfVxuXG4gIC8vIGFzc2lnbiB2YWx1ZSBhbmQgZml4IGtleVxuICBmb3IgKGNvbnN0IGtleSBpbiBjb25maWcpIHtcbiAgICAvLyBmb3VuZCBrZXkgdGhhdCBuZWVkIHRvIGZpeFxuICAgIGNvbnN0IGNvcnJlY3RLZXlOYW1lID0gbmVlZFRvRml4S2V5c1trZXldXG4gICAgaWYgKGNvcnJlY3RLZXlOYW1lKSB7XG4gICAgICBmaXhDb25maWdbY29ycmVjdEtleU5hbWVdID0gY29uZmlnW2tleV1cbiAgICB9IGVsc2Uge1xuICAgICAgZml4Q29uZmlnW2tleV0gPSBjb25maWdba2V5XVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBmaXhDb25maWdcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9PbWlzZUNhcmQuanMiLCIvKiBlc2xpbnQtZGlzYWJsZSAqL1xuLyoqXG4gKiAtPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPVxuICogUG9seWZpbGwgbWlzc2luZyBqcyBmZWF0dXJlc1xuICogTk9URTogaW1wb3J0IHRoaXMgZmlsZSBhdCBmaXJzdCBsaW5lIG9mIC4vc3JjL2luZGV4LmpzXG4gKiAtPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPVxuICovXG5cbi8qKlxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIFBvbHlmaWxsIC0gT2JqZWN0LmFzc2lnblxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqL1xuaWYgKHR5cGVvZiBPYmplY3QuYXNzaWduICE9ICdmdW5jdGlvbicpIHtcbiAgLy8gTXVzdCBiZSB3cml0YWJsZTogdHJ1ZSwgZW51bWVyYWJsZTogZmFsc2UsIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoT2JqZWN0LCAnYXNzaWduJywge1xuICAgIHZhbHVlOiBmdW5jdGlvbiBhc3NpZ24odGFyZ2V0LCB2YXJBcmdzKSB7XG4gICAgICAvLyAubGVuZ3RoIG9mIGZ1bmN0aW9uIGlzIDJcbiAgICAgICd1c2Ugc3RyaWN0J1xuICAgICAgaWYgKHRhcmdldCA9PSBudWxsKSB7XG4gICAgICAgIC8vIFR5cGVFcnJvciBpZiB1bmRlZmluZWQgb3IgbnVsbFxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY29udmVydCB1bmRlZmluZWQgb3IgbnVsbCB0byBvYmplY3QnKVxuICAgICAgfVxuXG4gICAgICB2YXIgdG8gPSBPYmplY3QodGFyZ2V0KVxuXG4gICAgICBmb3IgKHZhciBpbmRleCA9IDE7IGluZGV4IDwgYXJndW1lbnRzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICB2YXIgbmV4dFNvdXJjZSA9IGFyZ3VtZW50c1tpbmRleF1cblxuICAgICAgICBpZiAobmV4dFNvdXJjZSAhPSBudWxsKSB7XG4gICAgICAgICAgLy8gU2tpcCBvdmVyIGlmIHVuZGVmaW5lZCBvciBudWxsXG4gICAgICAgICAgZm9yICh2YXIgbmV4dEtleSBpbiBuZXh0U291cmNlKSB7XG4gICAgICAgICAgICAvLyBBdm9pZCBidWdzIHdoZW4gaGFzT3duUHJvcGVydHkgaXMgc2hhZG93ZWRcbiAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobmV4dFNvdXJjZSwgbmV4dEtleSkpIHtcbiAgICAgICAgICAgICAgdG9bbmV4dEtleV0gPSBuZXh0U291cmNlW25leHRLZXldXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdG9cbiAgICB9LFxuICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgfSlcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9oZWxwZXJzL3BvbHlmaWxsLmpzIiwiLyoqXHJcbiAqIGVhc3lYRE1cclxuICogaHR0cDovL2Vhc3l4ZG0ubmV0L1xyXG4gKiBDb3B5cmlnaHQoYykgMjAwOS0yMDExLCDDmHl2aW5kIFNlYW4gS2luc2V5LCBveXZpbmRAa2luc2V5Lm5vLlxyXG4gKlxyXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XHJcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcclxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xyXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXHJcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xyXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG4gKlxyXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxyXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuICpcclxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxyXG4gKiBUSEUgU09GVFdBUkUuXHJcbiAqL1xyXG4oZnVuY3Rpb24gKHdpbmRvdywgZG9jdW1lbnQsIGxvY2F0aW9uLCBzZXRUaW1lb3V0LCBkZWNvZGVVUklDb21wb25lbnQsIGVuY29kZVVSSUNvbXBvbmVudCkge1xyXG4vKmpzbGludCBldmlsOiB0cnVlLCBicm93c2VyOiB0cnVlLCBpbW1lZDogdHJ1ZSwgcGFzc2ZhaWw6IHRydWUsIHVuZGVmOiB0cnVlLCBuZXdjYXA6IHRydWUqL1xyXG4vKmdsb2JhbCBKU09OLCBYTUxIdHRwUmVxdWVzdCwgd2luZG93LCBlc2NhcGUsIHVuZXNjYXBlLCBBY3RpdmVYT2JqZWN0ICovXHJcbi8vXHJcbi8vIGVhc3lYRE1cclxuLy8gaHR0cDovL2Vhc3l4ZG0ubmV0L1xyXG4vLyBDb3B5cmlnaHQoYykgMjAwOS0yMDExLCDDmHl2aW5kIFNlYW4gS2luc2V5LCBveXZpbmRAa2luc2V5Lm5vLlxyXG4vL1xyXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XHJcbi8vIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcclxuLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xyXG4vLyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXHJcbi8vIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xyXG4vLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG4vL1xyXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxyXG4vLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuLy9cclxuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4vLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbi8vIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxyXG4vLyBUSEUgU09GVFdBUkUuXHJcbi8vXHJcblxyXG52YXIgZ2xvYmFsID0gdGhpcztcclxudmFyIGNoYW5uZWxJZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwKTsgLy8gcmFuZG9taXplIHRoZSBpbml0aWFsIGlkIGluIGNhc2Ugb2YgbXVsdGlwbGUgY2xvc3VyZXMgbG9hZGVkXHJcbnZhciBlbXB0eUZuID0gRnVuY3Rpb24ucHJvdG90eXBlO1xyXG52YXIgcmVVUkkgPSAvXigoaHR0cC4/OilcXC9cXC8oW146XFwvXFxzXSspKDpcXGQrKSopLzsgLy8gcmV0dXJucyBncm91cHMgZm9yIHByb3RvY29sICgyKSwgZG9tYWluICgzKSBhbmQgcG9ydCAoNClcclxudmFyIHJlUGFyZW50ID0gL1tcXC1cXHddK1xcL1xcLlxcLlxcLy87IC8vIG1hdGNoZXMgYSBmb28vLi4vIGV4cHJlc3Npb25cclxudmFyIHJlRG91YmxlU2xhc2ggPSAvKFteOl0pXFwvXFwvL2c7IC8vIG1hdGNoZXMgLy8gYW55d2hlcmUgYnV0IGluIHRoZSBwcm90b2NvbFxyXG52YXIgbmFtZXNwYWNlID0gXCJcIjsgLy8gc3RvcmVzIG5hbWVzcGFjZSB1bmRlciB3aGljaCBlYXN5WERNIG9iamVjdCBpcyBzdG9yZWQgb24gdGhlIHBhZ2UgKGVtcHR5IGlmIG9iamVjdCBpcyBnbG9iYWwpXHJcbnZhciBlYXN5WERNID0ge307XHJcbnZhciBfZWFzeVhETSA9IHdpbmRvdy5lYXN5WERNOyAvLyBtYXAgb3ZlciBnbG9iYWwgZWFzeVhETSBpbiBjYXNlIG9mIG92ZXJ3cml0ZVxyXG52YXIgSUZSQU1FX1BSRUZJWCA9IFwiZWFzeVhETV9cIjtcclxudmFyIEhBU19OQU1FX1BST1BFUlRZX0JVRztcclxudmFyIHVzZUhhc2ggPSBmYWxzZTsgLy8gd2hldGhlciB0byB1c2UgdGhlIGhhc2ggb3ZlciB0aGUgcXVlcnlcclxudmFyIGZsYXNoVmVyc2lvbjsgLy8gd2lsbCBiZSBzZXQgaWYgdXNpbmcgZmxhc2hcclxudmFyIEhBU19GTEFTSF9USFJPVFRMRURfQlVHO1xyXG5cclxuXHJcbi8vIGh0dHA6Ly9wZXRlci5taWNoYXV4LmNhL2FydGljbGVzL2ZlYXR1cmUtZGV0ZWN0aW9uLXN0YXRlLW9mLXRoZS1hcnQtYnJvd3Nlci1zY3JpcHRpbmdcclxuZnVuY3Rpb24gaXNIb3N0TWV0aG9kKG9iamVjdCwgcHJvcGVydHkpe1xyXG4gICAgdmFyIHQgPSB0eXBlb2Ygb2JqZWN0W3Byb3BlcnR5XTtcclxuICAgIHJldHVybiB0ID09ICdmdW5jdGlvbicgfHxcclxuICAgICghISh0ID09ICdvYmplY3QnICYmIG9iamVjdFtwcm9wZXJ0eV0pKSB8fFxyXG4gICAgdCA9PSAndW5rbm93bic7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzSG9zdE9iamVjdChvYmplY3QsIHByb3BlcnR5KXtcclxuICAgIHJldHVybiAhISh0eXBlb2Yob2JqZWN0W3Byb3BlcnR5XSkgPT0gJ29iamVjdCcgJiYgb2JqZWN0W3Byb3BlcnR5XSk7XHJcbn1cclxuXHJcbi8vIGVuZFxyXG5cclxuLy8gaHR0cDovL3BlcmZlY3Rpb25raWxscy5jb20vaW5zdGFuY2VvZi1jb25zaWRlcmVkLWhhcm1mdWwtb3ItaG93LXRvLXdyaXRlLWEtcm9idXN0LWlzYXJyYXkvXHJcbmZ1bmN0aW9uIGlzQXJyYXkobyl7XHJcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pID09PSAnW29iamVjdCBBcnJheV0nO1xyXG59XHJcblxyXG4vLyBlbmRcclxuZnVuY3Rpb24gaGFzRmxhc2goKXtcclxuICAgIHZhciBuYW1lID0gXCJTaG9ja3dhdmUgRmxhc2hcIiwgbWltZVR5cGUgPSBcImFwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoXCI7XHJcblxyXG4gICAgaWYgKCF1bmRlZihuYXZpZ2F0b3IucGx1Z2lucykgJiYgdHlwZW9mIG5hdmlnYXRvci5wbHVnaW5zW25hbWVdID09IFwib2JqZWN0XCIpIHtcclxuICAgICAgICAvLyBhZGFwdGVkIGZyb20gdGhlIHN3Zm9iamVjdCBjb2RlXHJcbiAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gbmF2aWdhdG9yLnBsdWdpbnNbbmFtZV0uZGVzY3JpcHRpb247XHJcbiAgICAgICAgaWYgKGRlc2NyaXB0aW9uICYmICF1bmRlZihuYXZpZ2F0b3IubWltZVR5cGVzKSAmJiBuYXZpZ2F0b3IubWltZVR5cGVzW21pbWVUeXBlXSAmJiBuYXZpZ2F0b3IubWltZVR5cGVzW21pbWVUeXBlXS5lbmFibGVkUGx1Z2luKSB7XHJcbiAgICAgICAgICAgIGZsYXNoVmVyc2lvbiA9IGRlc2NyaXB0aW9uLm1hdGNoKC9cXGQrL2cpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICghZmxhc2hWZXJzaW9uKSB7XHJcbiAgICAgICAgdmFyIGZsYXNoO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGZsYXNoID0gbmV3IEFjdGl2ZVhPYmplY3QoXCJTaG9ja3dhdmVGbGFzaC5TaG9ja3dhdmVGbGFzaFwiKTtcclxuICAgICAgICAgICAgZmxhc2hWZXJzaW9uID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZmxhc2guR2V0VmFyaWFibGUoXCIkdmVyc2lvblwiKS5tYXRjaCgvKFxcZCspLChcXGQrKSwoXFxkKyksKFxcZCspLyksIDEpO1xyXG4gICAgICAgICAgICBmbGFzaCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChub3RTdXBwb3J0ZWRFeGNlcHRpb24pIHtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoIWZsYXNoVmVyc2lvbikge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHZhciBtYWpvciA9IHBhcnNlSW50KGZsYXNoVmVyc2lvblswXSwgMTApLCBtaW5vciA9IHBhcnNlSW50KGZsYXNoVmVyc2lvblsxXSwgMTApO1xyXG4gICAgSEFTX0ZMQVNIX1RIUk9UVExFRF9CVUcgPSBtYWpvciA+IDkgJiYgbWlub3IgPiAwO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuXHJcbi8qXHJcbiAqIENyb3NzIEJyb3dzZXIgaW1wbGVtZW50YXRpb24gZm9yIGFkZGluZyBhbmQgcmVtb3ZpbmcgZXZlbnQgbGlzdGVuZXJzLlxyXG4gKi9cclxudmFyIG9uLCB1bjtcclxuaWYgKGlzSG9zdE1ldGhvZCh3aW5kb3csIFwiYWRkRXZlbnRMaXN0ZW5lclwiKSkge1xyXG4gICAgb24gPSBmdW5jdGlvbih0YXJnZXQsIHR5cGUsIGxpc3RlbmVyKXtcclxuICAgICAgICB0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgZmFsc2UpO1xyXG4gICAgfTtcclxuICAgIHVuID0gZnVuY3Rpb24odGFyZ2V0LCB0eXBlLCBsaXN0ZW5lcil7XHJcbiAgICAgICAgdGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIsIGZhbHNlKTtcclxuICAgIH07XHJcbn1cclxuZWxzZSBpZiAoaXNIb3N0TWV0aG9kKHdpbmRvdywgXCJhdHRhY2hFdmVudFwiKSkge1xyXG4gICAgb24gPSBmdW5jdGlvbihvYmplY3QsIHNFdmVudCwgZnBOb3RpZnkpe1xyXG4gICAgICAgIG9iamVjdC5hdHRhY2hFdmVudChcIm9uXCIgKyBzRXZlbnQsIGZwTm90aWZ5KTtcclxuICAgIH07XHJcbiAgICB1biA9IGZ1bmN0aW9uKG9iamVjdCwgc0V2ZW50LCBmcE5vdGlmeSl7XHJcbiAgICAgICAgb2JqZWN0LmRldGFjaEV2ZW50KFwib25cIiArIHNFdmVudCwgZnBOb3RpZnkpO1xyXG4gICAgfTtcclxufVxyXG5lbHNlIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcIkJyb3dzZXIgbm90IHN1cHBvcnRlZFwiKTtcclxufVxyXG5cclxuLypcclxuICogQ3Jvc3MgQnJvd3NlciBpbXBsZW1lbnRhdGlvbiBvZiBET01Db250ZW50TG9hZGVkLlxyXG4gKi9cclxudmFyIGRvbUlzUmVhZHkgPSBmYWxzZSwgZG9tUmVhZHlRdWV1ZSA9IFtdLCByZWFkeVN0YXRlO1xyXG5pZiAoXCJyZWFkeVN0YXRlXCIgaW4gZG9jdW1lbnQpIHtcclxuICAgIC8vIElmIGJyb3dzZXIgaXMgV2ViS2l0LXBvd2VyZWQsIGNoZWNrIGZvciBib3RoICdsb2FkZWQnIChsZWdhY3kgYnJvd3NlcnMpIGFuZFxyXG4gICAgLy8gJ2ludGVyYWN0aXZlJyAoSFRNTDUgc3BlY3MsIHJlY2VudCBXZWJLaXQgYnVpbGRzKSBzdGF0ZXMuXHJcbiAgICAvLyBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9NDUxMTlcclxuICAgIHJlYWR5U3RhdGUgPSBkb2N1bWVudC5yZWFkeVN0YXRlO1xyXG4gICAgZG9tSXNSZWFkeSA9IHJlYWR5U3RhdGUgPT0gXCJjb21wbGV0ZVwiIHx8ICh+IG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZignQXBwbGVXZWJLaXQvJykgJiYgKHJlYWR5U3RhdGUgPT0gXCJsb2FkZWRcIiB8fCByZWFkeVN0YXRlID09IFwiaW50ZXJhY3RpdmVcIikpO1xyXG59XHJcbmVsc2Uge1xyXG4gICAgLy8gSWYgcmVhZHlTdGF0ZSBpcyBub3Qgc3VwcG9ydGVkIGluIHRoZSBicm93c2VyLCB0aGVuIGluIG9yZGVyIHRvIGJlIGFibGUgdG8gZmlyZSB3aGVuUmVhZHkgZnVuY3Rpb25zIGFwcm9wcmlhdGVseVxyXG4gICAgLy8gd2hlbiBhZGRlZCBkeW5hbWljYWxseSBfYWZ0ZXJfIERPTSBsb2FkLCB3ZSBoYXZlIHRvIGRlZHVjZSB3ZXRoZXIgdGhlIERPTSBpcyByZWFkeSBvciBub3QuXHJcbiAgICAvLyBXZSBvbmx5IG5lZWQgYSBib2R5IHRvIGFkZCBlbGVtZW50cyB0bywgc28gdGhlIGV4aXN0ZW5jZSBvZiBkb2N1bWVudC5ib2R5IGlzIGVub3VnaCBmb3IgdXMuXHJcbiAgICBkb21Jc1JlYWR5ID0gISFkb2N1bWVudC5ib2R5O1xyXG59XHJcblxyXG5mdW5jdGlvbiBkb21fb25SZWFkeSgpe1xyXG4gICAgaWYgKGRvbUlzUmVhZHkpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBkb21Jc1JlYWR5ID0gdHJ1ZTtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZG9tUmVhZHlRdWV1ZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGRvbVJlYWR5UXVldWVbaV0oKTtcclxuICAgIH1cclxuICAgIGRvbVJlYWR5UXVldWUubGVuZ3RoID0gMDtcclxufVxyXG5cclxuXHJcbmlmICghZG9tSXNSZWFkeSkge1xyXG4gICAgaWYgKGlzSG9zdE1ldGhvZCh3aW5kb3csIFwiYWRkRXZlbnRMaXN0ZW5lclwiKSkge1xyXG4gICAgICAgIG9uKGRvY3VtZW50LCBcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZG9tX29uUmVhZHkpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgb24oZG9jdW1lbnQsIFwicmVhZHlzdGF0ZWNoYW5nZVwiLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PSBcImNvbXBsZXRlXCIpIHtcclxuICAgICAgICAgICAgICAgIGRvbV9vblJlYWR5KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmRvU2Nyb2xsICYmIHdpbmRvdyA9PT0gdG9wKSB7XHJcbiAgICAgICAgICAgIHZhciBkb1Njcm9sbENoZWNrID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIGlmIChkb21Jc1JlYWR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gaHR0cDovL2phdmFzY3JpcHQubndib3guY29tL0lFQ29udGVudExvYWRlZC9cclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmRvU2Nyb2xsKFwibGVmdFwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChkb1Njcm9sbENoZWNrLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBkb21fb25SZWFkeSgpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBkb1Njcm9sbENoZWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEEgZmFsbGJhY2sgdG8gd2luZG93Lm9ubG9hZCwgdGhhdCB3aWxsIGFsd2F5cyB3b3JrXHJcbiAgICBvbih3aW5kb3csIFwibG9hZFwiLCBkb21fb25SZWFkeSk7XHJcbn1cclxuLyoqXHJcbiAqIFRoaXMgd2lsbCBhZGQgYSBmdW5jdGlvbiB0byB0aGUgcXVldWUgb2YgZnVuY3Rpb25zIHRvIGJlIHJ1biBvbmNlIHRoZSBET00gcmVhY2hlcyBhIHJlYWR5IHN0YXRlLlxyXG4gKiBJZiBmdW5jdGlvbnMgYXJlIGFkZGVkIGFmdGVyIHRoaXMgZXZlbnQgdGhlbiB0aGV5IHdpbGwgYmUgZXhlY3V0ZWQgaW1tZWRpYXRlbHkuXHJcbiAqIEBwYXJhbSB7ZnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBhZGRcclxuICogQHBhcmFtIHtPYmplY3R9IHNjb3BlIEFuIG9wdGlvbmFsIHNjb3BlIGZvciB0aGUgZnVuY3Rpb24gdG8gYmUgY2FsbGVkIHdpdGguXHJcbiAqL1xyXG5mdW5jdGlvbiB3aGVuUmVhZHkoZm4sIHNjb3BlKXtcclxuICAgIGlmIChkb21Jc1JlYWR5KSB7XHJcbiAgICAgICAgZm4uY2FsbChzY29wZSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgZG9tUmVhZHlRdWV1ZS5wdXNoKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgZm4uY2FsbChzY29wZSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFJldHVybnMgYW4gaW5zdGFuY2Ugb2YgZWFzeVhETSBmcm9tIHRoZSBwYXJlbnQgd2luZG93IHdpdGhcclxuICogcmVzcGVjdCB0byB0aGUgbmFtZXNwYWNlLlxyXG4gKlxyXG4gKiBAcmV0dXJuIEFuIGluc3RhbmNlIG9mIGVhc3lYRE0gKGluIHRoZSBwYXJlbnQgd2luZG93KVxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0UGFyZW50T2JqZWN0KCl7XHJcbiAgICB2YXIgb2JqID0gcGFyZW50O1xyXG4gICAgaWYgKG5hbWVzcGFjZSAhPT0gXCJcIikge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IG5hbWVzcGFjZS5zcGxpdChcIi5cIik7IGkgPCBpaS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBvYmogPSBvYmpbaWlbaV1dO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBvYmouZWFzeVhETTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFJlbW92ZXMgZWFzeVhETSB2YXJpYWJsZSBmcm9tIHRoZSBnbG9iYWwgc2NvcGUuIEl0IGFsc28gcmV0dXJucyBjb250cm9sXHJcbiAqIG9mIHRoZSBlYXN5WERNIHZhcmlhYmxlIHRvIHdoYXRldmVyIGNvZGUgdXNlZCBpdCBiZWZvcmUuXHJcbiAqXHJcbiAqIEBwYXJhbSB7U3RyaW5nfSBucyBBIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiBhbiBvYmplY3QgdGhhdCB3aWxsIGhvbGRcclxuICogICAgICAgICAgICAgICAgICAgIGFuIGluc3RhbmNlIG9mIGVhc3lYRE0uXHJcbiAqIEByZXR1cm4gQW4gaW5zdGFuY2Ugb2YgZWFzeVhETVxyXG4gKi9cclxuZnVuY3Rpb24gbm9Db25mbGljdChucyl7XHJcblxyXG4gICAgd2luZG93LmVhc3lYRE0gPSBfZWFzeVhETTtcclxuICAgIG5hbWVzcGFjZSA9IG5zO1xyXG4gICAgaWYgKG5hbWVzcGFjZSkge1xyXG4gICAgICAgIElGUkFNRV9QUkVGSVggPSBcImVhc3lYRE1fXCIgKyBuYW1lc3BhY2UucmVwbGFjZShcIi5cIiwgXCJfXCIpICsgXCJfXCI7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZWFzeVhETTtcclxufVxyXG5cclxuLypcclxuICogTWV0aG9kcyBmb3Igd29ya2luZyB3aXRoIFVSTHNcclxuICovXHJcbi8qKlxyXG4gKiBHZXQgdGhlIGRvbWFpbiBuYW1lIGZyb20gYSB1cmwuXHJcbiAqIEBwYXJhbSB7U3RyaW5nfSB1cmwgVGhlIHVybCB0byBleHRyYWN0IHRoZSBkb21haW4gZnJvbS5cclxuICogQHJldHVybiBUaGUgZG9tYWluIHBhcnQgb2YgdGhlIHVybC5cclxuICogQHR5cGUge1N0cmluZ31cclxuICovXHJcbmZ1bmN0aW9uIGdldERvbWFpbk5hbWUodXJsKXtcclxuICAgIHJldHVybiB1cmwubWF0Y2gocmVVUkkpWzNdO1xyXG59XHJcblxyXG4vKipcclxuICogR2V0IHRoZSBwb3J0IGZvciBhIGdpdmVuIFVSTCwgb3IgXCJcIiBpZiBub25lXHJcbiAqIEBwYXJhbSB7U3RyaW5nfSB1cmwgVGhlIHVybCB0byBleHRyYWN0IHRoZSBwb3J0IGZyb20uXHJcbiAqIEByZXR1cm4gVGhlIHBvcnQgcGFydCBvZiB0aGUgdXJsLlxyXG4gKiBAdHlwZSB7U3RyaW5nfVxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0UG9ydCh1cmwpe1xyXG4gICAgcmV0dXJuIHVybC5tYXRjaChyZVVSSSlbNF0gfHwgXCJcIjtcclxufVxyXG5cclxuLyoqXHJcbiAqIFJldHVybnMgIGEgc3RyaW5nIGNvbnRhaW5pbmcgdGhlIHNjaGVtYSwgZG9tYWluIGFuZCBpZiBwcmVzZW50IHRoZSBwb3J0XHJcbiAqIEBwYXJhbSB7U3RyaW5nfSB1cmwgVGhlIHVybCB0byBleHRyYWN0IHRoZSBsb2NhdGlvbiBmcm9tXHJcbiAqIEByZXR1cm4ge1N0cmluZ30gVGhlIGxvY2F0aW9uIHBhcnQgb2YgdGhlIHVybFxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0TG9jYXRpb24odXJsKXtcclxuICAgIHZhciBtID0gdXJsLnRvTG93ZXJDYXNlKCkubWF0Y2gocmVVUkkpO1xyXG4gICAgdmFyIHByb3RvID0gbVsyXSwgZG9tYWluID0gbVszXSwgcG9ydCA9IG1bNF0gfHwgXCJcIjtcclxuICAgIGlmICgocHJvdG8gPT0gXCJodHRwOlwiICYmIHBvcnQgPT0gXCI6ODBcIikgfHwgKHByb3RvID09IFwiaHR0cHM6XCIgJiYgcG9ydCA9PSBcIjo0NDNcIikpIHtcclxuICAgICAgICBwb3J0ID0gXCJcIjtcclxuICAgIH1cclxuICAgIHJldHVybiBwcm90byArIFwiLy9cIiArIGRvbWFpbiArIHBvcnQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZXNvbHZlcyBhIHJlbGF0aXZlIHVybCBpbnRvIGFuIGFic29sdXRlIG9uZS5cclxuICogQHBhcmFtIHtTdHJpbmd9IHVybCBUaGUgcGF0aCB0byByZXNvbHZlLlxyXG4gKiBAcmV0dXJuIHtTdHJpbmd9IFRoZSByZXNvbHZlZCB1cmwuXHJcbiAqL1xyXG5mdW5jdGlvbiByZXNvbHZlVXJsKHVybCl7XHJcblxyXG4gICAgLy8gcmVwbGFjZSBhbGwgLy8gZXhjZXB0IHRoZSBvbmUgaW4gcHJvdG8gd2l0aCAvXHJcbiAgICB1cmwgPSB1cmwucmVwbGFjZShyZURvdWJsZVNsYXNoLCBcIiQxL1wiKTtcclxuXHJcbiAgICAvLyBJZiB0aGUgdXJsIGlzIGEgdmFsaWQgdXJsIHdlIGRvIG5vdGhpbmdcclxuICAgIGlmICghdXJsLm1hdGNoKC9eKGh0dHB8fGh0dHBzKTpcXC9cXC8vKSkge1xyXG4gICAgICAgIC8vIElmIHRoaXMgaXMgYSByZWxhdGl2ZSBwYXRoXHJcbiAgICAgICAgdmFyIHBhdGggPSAodXJsLnN1YnN0cmluZygwLCAxKSA9PT0gXCIvXCIpID8gXCJcIiA6IGxvY2F0aW9uLnBhdGhuYW1lO1xyXG4gICAgICAgIGlmIChwYXRoLnN1YnN0cmluZyhwYXRoLmxlbmd0aCAtIDEpICE9PSBcIi9cIikge1xyXG4gICAgICAgICAgICBwYXRoID0gcGF0aC5zdWJzdHJpbmcoMCwgcGF0aC5sYXN0SW5kZXhPZihcIi9cIikgKyAxKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHVybCA9IGxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgbG9jYXRpb24uaG9zdCArIHBhdGggKyB1cmw7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gcmVkdWNlIGFsbCAneHl6Ly4uLycgdG8ganVzdCAnJ1xyXG4gICAgd2hpbGUgKHJlUGFyZW50LnRlc3QodXJsKSkge1xyXG4gICAgICAgIHVybCA9IHVybC5yZXBsYWNlKHJlUGFyZW50LCBcIlwiKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdXJsO1xyXG59XHJcblxyXG4vKipcclxuICogQXBwZW5kcyB0aGUgcGFyYW1ldGVycyB0byB0aGUgZ2l2ZW4gdXJsLjxici8+XHJcbiAqIFRoZSBiYXNlIHVybCBjYW4gY29udGFpbiBleGlzdGluZyBxdWVyeSBwYXJhbWV0ZXJzLlxyXG4gKiBAcGFyYW0ge1N0cmluZ30gdXJsIFRoZSBiYXNlIHVybC5cclxuICogQHBhcmFtIHtPYmplY3R9IHBhcmFtZXRlcnMgVGhlIHBhcmFtZXRlcnMgdG8gYWRkLlxyXG4gKiBAcmV0dXJuIHtTdHJpbmd9IEEgbmV3IHZhbGlkIHVybCB3aXRoIHRoZSBwYXJhbWV0ZXJzIGFwcGVuZGVkLlxyXG4gKi9cclxuZnVuY3Rpb24gYXBwZW5kUXVlcnlQYXJhbWV0ZXJzKHVybCwgcGFyYW1ldGVycyl7XHJcblxyXG4gICAgdmFyIGhhc2ggPSBcIlwiLCBpbmRleE9mID0gdXJsLmluZGV4T2YoXCIjXCIpO1xyXG4gICAgaWYgKGluZGV4T2YgIT09IC0xKSB7XHJcbiAgICAgICAgaGFzaCA9IHVybC5zdWJzdHJpbmcoaW5kZXhPZik7XHJcbiAgICAgICAgdXJsID0gdXJsLnN1YnN0cmluZygwLCBpbmRleE9mKTtcclxuICAgIH1cclxuICAgIHZhciBxID0gW107XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gcGFyYW1ldGVycykge1xyXG4gICAgICAgIGlmIChwYXJhbWV0ZXJzLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuICAgICAgICAgICAgcS5wdXNoKGtleSArIFwiPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KHBhcmFtZXRlcnNba2V5XSkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB1cmwgKyAodXNlSGFzaCA/IFwiI1wiIDogKHVybC5pbmRleE9mKFwiP1wiKSA9PSAtMSA/IFwiP1wiIDogXCImXCIpKSArIHEuam9pbihcIiZcIikgKyBoYXNoO1xyXG59XHJcblxyXG5cclxuLy8gYnVpbGQgdGhlIHF1ZXJ5IG9iamVjdCBlaXRoZXIgZnJvbSBsb2NhdGlvbi5xdWVyeSwgaWYgaXQgY29udGFpbnMgdGhlIHhkbV9lIGFyZ3VtZW50LCBvciBmcm9tIGxvY2F0aW9uLmhhc2hcclxudmFyIHF1ZXJ5ID0gKGZ1bmN0aW9uKGlucHV0KXtcclxuICAgIGlucHV0ID0gaW5wdXQuc3Vic3RyaW5nKDEpLnNwbGl0KFwiJlwiKTtcclxuICAgIHZhciBkYXRhID0ge30sIHBhaXIsIGkgPSBpbnB1dC5sZW5ndGg7XHJcbiAgICB3aGlsZSAoaS0tKSB7XHJcbiAgICAgICAgcGFpciA9IGlucHV0W2ldLnNwbGl0KFwiPVwiKTtcclxuICAgICAgICBkYXRhW3BhaXJbMF1dID0gZGVjb2RlVVJJQ29tcG9uZW50KHBhaXJbMV0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRhdGE7XHJcbn0oL3hkbV9lPS8udGVzdChsb2NhdGlvbi5zZWFyY2gpID8gbG9jYXRpb24uc2VhcmNoIDogbG9jYXRpb24uaGFzaCkpO1xyXG5cclxuLypcclxuICogSGVscGVyIG1ldGhvZHNcclxuICovXHJcbi8qKlxyXG4gKiBIZWxwZXIgZm9yIGNoZWNraW5nIGlmIGEgdmFyaWFibGUvcHJvcGVydHkgaXMgdW5kZWZpbmVkXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSB2IFRoZSB2YXJpYWJsZSB0byB0ZXN0XHJcbiAqIEByZXR1cm4ge0Jvb2xlYW59IFRydWUgaWYgdGhlIHBhc3NlZCB2YXJpYWJsZSBpcyB1bmRlZmluZWRcclxuICovXHJcbmZ1bmN0aW9uIHVuZGVmKHYpe1xyXG4gICAgcmV0dXJuIHR5cGVvZiB2ID09PSBcInVuZGVmaW5lZFwiO1xyXG59XHJcblxyXG4vKipcclxuICogQSBzYWZlIGltcGxlbWVudGF0aW9uIG9mIEhUTUw1IEpTT04uIEZlYXR1cmUgdGVzdGluZyBpcyB1c2VkIHRvIG1ha2Ugc3VyZSB0aGUgaW1wbGVtZW50YXRpb24gd29ya3MuXHJcbiAqIEByZXR1cm4ge0pTT059IEEgdmFsaWQgSlNPTiBjb25mb3JtaW5nIG9iamVjdCwgb3IgbnVsbCBpZiBub3QgZm91bmQuXHJcbiAqL1xyXG52YXIgZ2V0SlNPTiA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgY2FjaGVkID0ge307XHJcbiAgICB2YXIgb2JqID0ge1xyXG4gICAgICAgIGE6IFsxLCAyLCAzXVxyXG4gICAgfSwganNvbiA9IFwie1xcXCJhXFxcIjpbMSwyLDNdfVwiO1xyXG5cclxuICAgIGlmICh0eXBlb2YgSlNPTiAhPSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBKU09OLnN0cmluZ2lmeSA9PT0gXCJmdW5jdGlvblwiICYmIEpTT04uc3RyaW5naWZ5KG9iaikucmVwbGFjZSgoL1xccy9nKSwgXCJcIikgPT09IGpzb24pIHtcclxuICAgICAgICAvLyB0aGlzIGlzIGEgd29ya2luZyBKU09OIGluc3RhbmNlXHJcbiAgICAgICAgcmV0dXJuIEpTT047XHJcbiAgICB9XHJcbiAgICBpZiAoT2JqZWN0LnRvSlNPTikge1xyXG4gICAgICAgIGlmIChPYmplY3QudG9KU09OKG9iaikucmVwbGFjZSgoL1xccy9nKSwgXCJcIikgPT09IGpzb24pIHtcclxuICAgICAgICAgICAgLy8gdGhpcyBpcyBhIHdvcmtpbmcgc3RyaW5naWZ5IG1ldGhvZFxyXG4gICAgICAgICAgICBjYWNoZWQuc3RyaW5naWZ5ID0gT2JqZWN0LnRvSlNPTjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHR5cGVvZiBTdHJpbmcucHJvdG90eXBlLmV2YWxKU09OID09PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgICBvYmogPSBqc29uLmV2YWxKU09OKCk7XHJcbiAgICAgICAgaWYgKG9iai5hICYmIG9iai5hLmxlbmd0aCA9PT0gMyAmJiBvYmouYVsyXSA9PT0gMykge1xyXG4gICAgICAgICAgICAvLyB0aGlzIGlzIGEgd29ya2luZyBwYXJzZSBtZXRob2RcclxuICAgICAgICAgICAgY2FjaGVkLnBhcnNlID0gZnVuY3Rpb24oc3RyKXtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzdHIuZXZhbEpTT04oKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGNhY2hlZC5zdHJpbmdpZnkgJiYgY2FjaGVkLnBhcnNlKSB7XHJcbiAgICAgICAgLy8gT25seSBtZW1vaXplIHRoZSByZXN1bHQgaWYgd2UgaGF2ZSB2YWxpZCBpbnN0YW5jZVxyXG4gICAgICAgIGdldEpTT04gPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIGNhY2hlZDtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEFwcGxpZXMgcHJvcGVydGllcyBmcm9tIHRoZSBzb3VyY2Ugb2JqZWN0IHRvIHRoZSB0YXJnZXQgb2JqZWN0Ljxici8+XHJcbiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXQgVGhlIHRhcmdldCBvZiB0aGUgcHJvcGVydGllcy5cclxuICogQHBhcmFtIHtPYmplY3R9IHNvdXJjZSBUaGUgc291cmNlIG9mIHRoZSBwcm9wZXJ0aWVzLlxyXG4gKiBAcGFyYW0ge0Jvb2xlYW59IG5vT3ZlcndyaXRlIFNldCB0byBUcnVlIHRvIG9ubHkgc2V0IG5vbi1leGlzdGluZyBwcm9wZXJ0aWVzLlxyXG4gKi9cclxuZnVuY3Rpb24gYXBwbHkoZGVzdGluYXRpb24sIHNvdXJjZSwgbm9PdmVyd3JpdGUpe1xyXG4gICAgdmFyIG1lbWJlcjtcclxuICAgIGZvciAodmFyIHByb3AgaW4gc291cmNlKSB7XHJcbiAgICAgICAgaWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShwcm9wKSkge1xyXG4gICAgICAgICAgICBpZiAocHJvcCBpbiBkZXN0aW5hdGlvbikge1xyXG4gICAgICAgICAgICAgICAgbWVtYmVyID0gc291cmNlW3Byb3BdO1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtZW1iZXIgPT09IFwib2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBhcHBseShkZXN0aW5hdGlvbltwcm9wXSwgbWVtYmVyLCBub092ZXJ3cml0ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmICghbm9PdmVyd3JpdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbltwcm9wXSA9IHNvdXJjZVtwcm9wXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uW3Byb3BdID0gc291cmNlW3Byb3BdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRlc3RpbmF0aW9uO1xyXG59XHJcblxyXG4vLyBUaGlzIHRlc3RzIGZvciB0aGUgYnVnIGluIElFIHdoZXJlIHNldHRpbmcgdGhlIFtuYW1lXSBwcm9wZXJ0eSB1c2luZyBqYXZhc2NyaXB0IGNhdXNlcyB0aGUgdmFsdWUgdG8gYmUgcmVkaXJlY3RlZCBpbnRvIFtzdWJtaXROYW1lXS5cclxuZnVuY3Rpb24gdGVzdEZvck5hbWVQcm9wZXJ0eUJ1Zygpe1xyXG4gICAgdmFyIGZvcm0gPSBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmb3JtXCIpKSwgaW5wdXQgPSBmb3JtLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKSk7XHJcbiAgICBpbnB1dC5uYW1lID0gSUZSQU1FX1BSRUZJWCArIFwiVEVTVFwiICsgY2hhbm5lbElkOyAvLyBhcHBlbmQgY2hhbm5lbElkIGluIG9yZGVyIHRvIGF2b2lkIGNhY2hpbmcgaXNzdWVzXHJcbiAgICBIQVNfTkFNRV9QUk9QRVJUWV9CVUcgPSBpbnB1dCAhPT0gZm9ybS5lbGVtZW50c1tpbnB1dC5uYW1lXTtcclxuICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZm9ybSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGVzIGEgZnJhbWUgYW5kIGFwcGVuZHMgaXQgdG8gdGhlIERPTS5cclxuICogQHBhcmFtIGNvbmZpZyB7b2JqZWN0fSBUaGlzIG9iamVjdCBjYW4gaGF2ZSB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXNcclxuICogPHVsPlxyXG4gKiA8bGk+IHtvYmplY3R9IHByb3AgVGhlIHByb3BlcnRpZXMgdGhhdCBzaG91bGQgYmUgc2V0IG9uIHRoZSBmcmFtZS4gVGhpcyBzaG91bGQgaW5jbHVkZSB0aGUgJ3NyYycgcHJvcGVydHkuPC9saT5cclxuICogPGxpPiB7b2JqZWN0fSBhdHRyIFRoZSBhdHRyaWJ1dGVzIHRoYXQgc2hvdWxkIGJlIHNldCBvbiB0aGUgZnJhbWUuPC9saT5cclxuICogPGxpPiB7RE9NRWxlbWVudH0gY29udGFpbmVyIEl0cyBwYXJlbnQgZWxlbWVudCAoT3B0aW9uYWwpLjwvbGk+XHJcbiAqIDxsaT4ge2Z1bmN0aW9ufSBvbkxvYWQgQSBtZXRob2QgdGhhdCBzaG91bGQgYmUgY2FsbGVkIHdpdGggdGhlIGZyYW1lcyBjb250ZW50V2luZG93IGFzIGFyZ3VtZW50IHdoZW4gdGhlIGZyYW1lIGlzIGZ1bGx5IGxvYWRlZC4gKE9wdGlvbmFsKTwvbGk+XHJcbiAqIDwvdWw+XHJcbiAqIEByZXR1cm4gVGhlIGZyYW1lcyBET01FbGVtZW50XHJcbiAqIEB0eXBlIERPTUVsZW1lbnRcclxuICovXHJcbmZ1bmN0aW9uIGNyZWF0ZUZyYW1lKGNvbmZpZyl7XHJcbiAgICBpZiAodW5kZWYoSEFTX05BTUVfUFJPUEVSVFlfQlVHKSkge1xyXG4gICAgICAgIHRlc3RGb3JOYW1lUHJvcGVydHlCdWcoKTtcclxuICAgIH1cclxuICAgIHZhciBmcmFtZTtcclxuICAgIC8vIFRoaXMgaXMgdG8gd29yayBhcm91bmQgdGhlIHByb2JsZW1zIGluIElFNi83IHdpdGggc2V0dGluZyB0aGUgbmFtZSBwcm9wZXJ0eS5cclxuICAgIC8vIEludGVybmFsbHkgdGhpcyBpcyBzZXQgYXMgJ3N1Ym1pdE5hbWUnIGluc3RlYWQgd2hlbiB1c2luZyAnaWZyYW1lLm5hbWUgPSAuLi4nXHJcbiAgICAvLyBUaGlzIGlzIG5vdCByZXF1aXJlZCBieSBlYXN5WERNIGl0c2VsZiwgYnV0IGlzIHRvIGZhY2lsaXRhdGUgb3RoZXIgdXNlIGNhc2VzXHJcbiAgICBpZiAoSEFTX05BTUVfUFJPUEVSVFlfQlVHKSB7XHJcbiAgICAgICAgZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiPGlmcmFtZSBuYW1lPVxcXCJcIiArIGNvbmZpZy5wcm9wcy5uYW1lICsgXCJcXFwiLz5cIik7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJJRlJBTUVcIik7XHJcbiAgICAgICAgZnJhbWUubmFtZSA9IGNvbmZpZy5wcm9wcy5uYW1lO1xyXG4gICAgfVxyXG5cclxuICAgIGZyYW1lLmlkID0gZnJhbWUubmFtZSA9IGNvbmZpZy5wcm9wcy5uYW1lO1xyXG4gICAgZGVsZXRlIGNvbmZpZy5wcm9wcy5uYW1lO1xyXG5cclxuICAgIGlmICh0eXBlb2YgY29uZmlnLmNvbnRhaW5lciA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgY29uZmlnLmNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbmZpZy5jb250YWluZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghY29uZmlnLmNvbnRhaW5lcikge1xyXG4gICAgICAgIC8vIFRoaXMgbmVlZHMgdG8gYmUgaGlkZGVuIGxpa2UgdGhpcywgc2ltcGx5IHNldHRpbmcgZGlzcGxheTpub25lIGFuZCB0aGUgbGlrZSB3aWxsIGNhdXNlIGZhaWx1cmVzIGluIHNvbWUgYnJvd3NlcnMuXHJcbiAgICAgICAgYXBwbHkoZnJhbWUuc3R5bGUsIHtcclxuICAgICAgICAgICAgcG9zaXRpb246IFwiYWJzb2x1dGVcIixcclxuICAgICAgICAgICAgdG9wOiBcIi0yMDAwcHhcIixcclxuICAgICAgICAgICAgLy8gQXZvaWQgcG90ZW50aWFsIGhvcml6b250YWwgc2Nyb2xsYmFyXHJcbiAgICAgICAgICAgIGxlZnQ6IFwiMHB4XCJcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25maWcuY29udGFpbmVyID0gZG9jdW1lbnQuYm9keTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBIQUNLOiBJRSBjYW5ub3QgaGF2ZSB0aGUgc3JjIGF0dHJpYnV0ZSBzZXQgd2hlbiB0aGUgZnJhbWUgaXMgYXBwZW5kZWRcclxuICAgIC8vICAgICAgIGludG8gdGhlIGNvbnRhaW5lciwgc28gd2Ugc2V0IGl0IHRvIFwiamF2YXNjcmlwdDpmYWxzZVwiIGFzIGFcclxuICAgIC8vICAgICAgIHBsYWNlaG9sZGVyIGZvciBub3cuICBJZiB3ZSBsZWZ0IHRoZSBzcmMgdW5kZWZpbmVkLCBpdCB3b3VsZFxyXG4gICAgLy8gICAgICAgaW5zdGVhZCBkZWZhdWx0IHRvIFwiYWJvdXQ6YmxhbmtcIiwgd2hpY2ggY2F1c2VzIFNTTCBtaXhlZC1jb250ZW50XHJcbiAgICAvLyAgICAgICB3YXJuaW5ncyBpbiBJRTYgd2hlbiBvbiBhbiBTU0wgcGFyZW50IHBhZ2UuXHJcbiAgICB2YXIgc3JjID0gY29uZmlnLnByb3BzLnNyYztcclxuICAgIGNvbmZpZy5wcm9wcy5zcmMgPSBcImphdmFzY3JpcHQ6ZmFsc2VcIjtcclxuXHJcbiAgICAvLyB0cmFuc2ZlciBwcm9wZXJ0aWVzIHRvIHRoZSBmcmFtZVxyXG4gICAgYXBwbHkoZnJhbWUsIGNvbmZpZy5wcm9wcyk7XHJcblxyXG4gICAgZnJhbWUuYm9yZGVyID0gZnJhbWUuZnJhbWVCb3JkZXIgPSAwO1xyXG4gICAgZnJhbWUuYWxsb3dUcmFuc3BhcmVuY3kgPSB0cnVlO1xyXG4gICAgY29uZmlnLmNvbnRhaW5lci5hcHBlbmRDaGlsZChmcmFtZSk7XHJcblxyXG4gICAgaWYgKGNvbmZpZy5vbkxvYWQpIHtcclxuICAgICAgICBvbihmcmFtZSwgXCJsb2FkXCIsIGNvbmZpZy5vbkxvYWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHNldCB0aGUgZnJhbWUgVVJMIHRvIHRoZSBwcm9wZXIgdmFsdWUgKHdlIHByZXZpb3VzbHkgc2V0IGl0IHRvXHJcbiAgICAvLyBcImphdmFzY3JpcHQ6ZmFsc2VcIiB0byB3b3JrIGFyb3VuZCB0aGUgSUUgaXNzdWUgbWVudGlvbmVkIGFib3ZlKVxyXG4gICAgaWYoY29uZmlnLnVzZVBvc3QpIHtcclxuICAgICAgICB2YXIgZm9ybSA9IGNvbmZpZy5jb250YWluZXIuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9ybScpKSwgaW5wdXQ7XHJcbiAgICAgICAgZm9ybS50YXJnZXQgPSBmcmFtZS5uYW1lO1xyXG4gICAgICAgIGZvcm0uYWN0aW9uID0gc3JjO1xyXG4gICAgICAgIGZvcm0ubWV0aG9kID0gJ1BPU1QnO1xyXG4gICAgICAgIGlmICh0eXBlb2YoY29uZmlnLnVzZVBvc3QpID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIGNvbmZpZy51c2VQb3N0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29uZmlnLnVzZVBvc3QuaGFzT3duUHJvcGVydHkoaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoSEFTX05BTUVfUFJPUEVSVFlfQlVHKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnPGlucHV0IG5hbWU9XCInICsgaSArICdcIi8+Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiSU5QVVRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0Lm5hbWUgPSBpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZSA9IGNvbmZpZy51c2VQb3N0W2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvcm0uYXBwZW5kQ2hpbGQoaW5wdXQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvcm0uc3VibWl0KCk7XHJcbiAgICAgICAgZm9ybS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGZvcm0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBmcmFtZS5zcmMgPSBzcmM7XHJcbiAgICB9XHJcbiAgICBjb25maWcucHJvcHMuc3JjID0gc3JjO1xyXG5cclxuICAgIHJldHVybiBmcmFtZTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENoZWNrIHdoZXRoZXIgYSBkb21haW4gaXMgYWxsb3dlZCB1c2luZyBhbiBBY2Nlc3MgQ29udHJvbCBMaXN0LlxyXG4gKiBUaGUgQUNMIGNhbiBjb250YWluICogYW5kID8gYXMgd2lsZGNhcmRzLCBvciBjYW4gYmUgcmVndWxhciBleHByZXNzaW9ucy5cclxuICogSWYgcmVndWxhciBleHByZXNzaW9ucyB0aGV5IG5lZWQgdG8gYmVnaW4gd2l0aCBeIGFuZCBlbmQgd2l0aCAkLlxyXG4gKiBAcGFyYW0ge0FycmF5L1N0cmluZ30gYWNsIFRoZSBsaXN0IG9mIGFsbG93ZWQgZG9tYWluc1xyXG4gKiBAcGFyYW0ge1N0cmluZ30gZG9tYWluIFRoZSBkb21haW4gdG8gdGVzdC5cclxuICogQHJldHVybiB7Qm9vbGVhbn0gVHJ1ZSBpZiB0aGUgZG9tYWluIGlzIGFsbG93ZWQsIGZhbHNlIGlmIG5vdC5cclxuICovXHJcbmZ1bmN0aW9uIGNoZWNrQWNsKGFjbCwgZG9tYWluKXtcclxuICAgIC8vIG5vcm1hbGl6ZSBpbnRvIGFuIGFycmF5XHJcbiAgICBpZiAodHlwZW9mIGFjbCA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgYWNsID0gW2FjbF07XHJcbiAgICB9XHJcbiAgICB2YXIgcmUsIGkgPSBhY2wubGVuZ3RoO1xyXG4gICAgd2hpbGUgKGktLSkge1xyXG4gICAgICAgIHJlID0gYWNsW2ldO1xyXG4gICAgICAgIHJlID0gbmV3IFJlZ0V4cChyZS5zdWJzdHIoMCwgMSkgPT0gXCJeXCIgPyByZSA6IChcIl5cIiArIHJlLnJlcGxhY2UoLyhcXCopL2csIFwiLiQxXCIpLnJlcGxhY2UoL1xcPy9nLCBcIi5cIikgKyBcIiRcIikpO1xyXG4gICAgICAgIGlmIChyZS50ZXN0KGRvbWFpbikpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59XHJcblxyXG4vKlxyXG4gKiBGdW5jdGlvbnMgcmVsYXRlZCB0byBzdGFja3NcclxuICovXHJcbi8qKlxyXG4gKiBQcmVwYXJlcyBhbiBhcnJheSBvZiBzdGFjay1lbGVtZW50cyBzdWl0YWJsZSBmb3IgdGhlIGN1cnJlbnQgY29uZmlndXJhdGlvblxyXG4gKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIFRoZSBUcmFuc3BvcnRzIGNvbmZpZ3VyYXRpb24uIFNlZSBlYXN5WERNLlNvY2tldCBmb3IgbW9yZS5cclxuICogQHJldHVybiB7QXJyYXl9IEFuIGFycmF5IG9mIHN0YWNrLWVsZW1lbnRzIHdpdGggdGhlIFRyYW5zcG9ydEVsZW1lbnQgYXQgaW5kZXggMC5cclxuICovXHJcbmZ1bmN0aW9uIHByZXBhcmVUcmFuc3BvcnRTdGFjayhjb25maWcpe1xyXG4gICAgdmFyIHByb3RvY29sID0gY29uZmlnLnByb3RvY29sLCBzdGFja0VscztcclxuICAgIGNvbmZpZy5pc0hvc3QgPSBjb25maWcuaXNIb3N0IHx8IHVuZGVmKHF1ZXJ5LnhkbV9wKTtcclxuICAgIHVzZUhhc2ggPSBjb25maWcuaGFzaCB8fCBmYWxzZTtcclxuXHJcbiAgICBpZiAoIWNvbmZpZy5wcm9wcykge1xyXG4gICAgICAgIGNvbmZpZy5wcm9wcyA9IHt9O1xyXG4gICAgfVxyXG4gICAgaWYgKCFjb25maWcuaXNIb3N0KSB7XHJcbiAgICAgICAgY29uZmlnLmNoYW5uZWwgPSBxdWVyeS54ZG1fYy5yZXBsYWNlKC9bXCInPD5cXFxcXS9nLCBcIlwiKTtcclxuICAgICAgICBjb25maWcuc2VjcmV0ID0gcXVlcnkueGRtX3M7XHJcbiAgICAgICAgY29uZmlnLnJlbW90ZSA9IHF1ZXJ5LnhkbV9lLnJlcGxhY2UoL1tcIic8PlxcXFxdL2csIFwiXCIpO1xyXG4gICAgICAgIDtcclxuICAgICAgICBwcm90b2NvbCA9IHF1ZXJ5LnhkbV9wO1xyXG4gICAgICAgIGlmIChjb25maWcuYWNsICYmICFjaGVja0FjbChjb25maWcuYWNsLCBjb25maWcucmVtb3RlKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBY2Nlc3MgZGVuaWVkIGZvciBcIiArIGNvbmZpZy5yZW1vdGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGNvbmZpZy5yZW1vdGUgPSByZXNvbHZlVXJsKGNvbmZpZy5yZW1vdGUpO1xyXG4gICAgICAgIGNvbmZpZy5jaGFubmVsID0gY29uZmlnLmNoYW5uZWwgfHwgXCJkZWZhdWx0XCIgKyBjaGFubmVsSWQrKztcclxuICAgICAgICBjb25maWcuc2VjcmV0ID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygxNikuc3Vic3RyaW5nKDIpO1xyXG4gICAgICAgIGlmICh1bmRlZihwcm90b2NvbCkpIHtcclxuICAgICAgICAgICAgaWYgKGdldExvY2F0aW9uKGxvY2F0aW9uLmhyZWYpID09IGdldExvY2F0aW9uKGNvbmZpZy5yZW1vdGUpKSB7XHJcbiAgICAgICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICAgICAgICogQm90aCBkb2N1bWVudHMgaGFzIHRoZSBzYW1lIG9yaWdpbiwgbGV0cyB1c2UgZGlyZWN0IGFjY2Vzcy5cclxuICAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgcHJvdG9jb2wgPSBcIjRcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChpc0hvc3RNZXRob2Qod2luZG93LCBcInBvc3RNZXNzYWdlXCIpIHx8IGlzSG9zdE1ldGhvZChkb2N1bWVudCwgXCJwb3N0TWVzc2FnZVwiKSkge1xyXG4gICAgICAgICAgICAgICAgLypcclxuICAgICAgICAgICAgICAgICAqIFRoaXMgaXMgc3VwcG9ydGVkIGluIElFOCssIEZpcmVmb3ggMyssIE9wZXJhIDkrLCBDaHJvbWUgMisgYW5kIFNhZmFyaSA0K1xyXG4gICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICBwcm90b2NvbCA9IFwiMVwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGNvbmZpZy5zd2YgJiYgaXNIb3N0TWV0aG9kKHdpbmRvdywgXCJBY3RpdmVYT2JqZWN0XCIpICYmIGhhc0ZsYXNoKCkpIHtcclxuICAgICAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgICAgICAgKiBUaGUgRmxhc2ggdHJhbnNwb3J0IHN1cGVyc2VlZGVzIHRoZSBOaXhUcmFuc3BvcnQgYXMgdGhlIE5peFRyYW5zcG9ydCBoYXMgYmVlbiBibG9ja2VkIGJ5IE1TXHJcbiAgICAgICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgICAgIHByb3RvY29sID0gXCI2XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAobmF2aWdhdG9yLnByb2R1Y3QgPT09IFwiR2Vja29cIiAmJiBcImZyYW1lRWxlbWVudFwiIGluIHdpbmRvdyAmJiBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ1dlYktpdCcpID09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICAgICAgICogVGhpcyBpcyBzdXBwb3J0ZWQgaW4gR2Vja28gKEZpcmVmb3ggMSspXHJcbiAgICAgICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgICAgIHByb3RvY29sID0gXCI1XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoY29uZmlnLnJlbW90ZUhlbHBlcikge1xyXG4gICAgICAgICAgICAgICAgLypcclxuICAgICAgICAgICAgICAgICAqIFRoaXMgaXMgc3VwcG9ydGVkIGluIGFsbCBicm93c2VycyB0aGF0IHJldGFpbnMgdGhlIHZhbHVlIG9mIHdpbmRvdy5uYW1lIHdoZW5cclxuICAgICAgICAgICAgICAgICAqIG5hdmlnYXRpbmcgZnJvbSBvbmUgZG9tYWluIHRvIGFub3RoZXIsIGFuZCB3aGVyZSBwYXJlbnQuZnJhbWVzW2Zvb10gY2FuIGJlIHVzZWRcclxuICAgICAgICAgICAgICAgICAqIHRvIGdldCBhY2Nlc3MgdG8gYSBmcmFtZSBmcm9tIHRoZSBzYW1lIGRvbWFpblxyXG4gICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICBwcm90b2NvbCA9IFwiMlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLypcclxuICAgICAgICAgICAgICAgICAqIFRoaXMgaXMgc3VwcG9ydGVkIGluIGFsbCBicm93c2VycyB3aGVyZSBbd2luZG93XS5sb2NhdGlvbiBpcyB3cml0YWJsZSBmb3IgYWxsXHJcbiAgICAgICAgICAgICAgICAgKiBUaGUgcmVzaXplIGV2ZW50IHdpbGwgYmUgdXNlZCBpZiByZXNpemUgaXMgc3VwcG9ydGVkIGFuZCB0aGUgaWZyYW1lIGlzIG5vdCBwdXRcclxuICAgICAgICAgICAgICAgICAqIGludG8gYSBjb250YWluZXIsIGVsc2UgcG9sbGluZyB3aWxsIGJlIHVzZWQuXHJcbiAgICAgICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgICAgIHByb3RvY29sID0gXCIwXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25maWcucHJvdG9jb2wgPSBwcm90b2NvbDsgLy8gZm9yIGNvbmRpdGlvbmFsIGJyYW5jaGluZ1xyXG4gICAgc3dpdGNoIChwcm90b2NvbCkge1xyXG4gICAgICAgIGNhc2UgXCIwXCI6Ly8gMCA9IEhhc2hUcmFuc3BvcnRcclxuICAgICAgICAgICAgYXBwbHkoY29uZmlnLCB7XHJcbiAgICAgICAgICAgICAgICBpbnRlcnZhbDogMTAwLFxyXG4gICAgICAgICAgICAgICAgZGVsYXk6IDIwMDAsXHJcbiAgICAgICAgICAgICAgICB1c2VSZXNpemU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICB1c2VQYXJlbnQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgdXNlUG9sbGluZzogZmFsc2VcclxuICAgICAgICAgICAgfSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIGlmIChjb25maWcuaXNIb3N0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWNvbmZpZy5sb2NhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIG5vIGxvY2FsIGlzIHNldCB0aGVuIHdlIG5lZWQgdG8gZmluZCBhbiBpbWFnZSBob3N0ZWQgb24gdGhlIGN1cnJlbnQgZG9tYWluXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRvbWFpbiA9IGxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgbG9jYXRpb24uaG9zdCwgaW1hZ2VzID0gZG9jdW1lbnQuYm9keS5nZXRFbGVtZW50c0J5VGFnTmFtZShcImltZ1wiKSwgaW1hZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBpbWFnZXMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2UgPSBpbWFnZXNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbWFnZS5zcmMuc3Vic3RyaW5nKDAsIGRvbWFpbi5sZW5ndGgpID09PSBkb21haW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZy5sb2NhbCA9IGltYWdlLnNyYztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghY29uZmlnLmxvY2FsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIG5vIGxvY2FsIHdhcyBzZXQsIGFuZCB3ZSBhcmUgdW5hYmxlIHRvIGZpbmQgYSBzdWl0YWJsZSBmaWxlLCB0aGVuIHdlIHJlc29ydCB0byB1c2luZyB0aGUgY3VycmVudCB3aW5kb3dcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnLmxvY2FsID0gd2luZG93O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcGFyYW1ldGVycyA9IHtcclxuICAgICAgICAgICAgICAgICAgICB4ZG1fYzogY29uZmlnLmNoYW5uZWwsXHJcbiAgICAgICAgICAgICAgICAgICAgeGRtX3A6IDBcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGNvbmZpZy5sb2NhbCA9PT0gd2luZG93KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UgYXJlIHVzaW5nIHRoZSBjdXJyZW50IHdpbmRvdyB0byBsaXN0ZW4gdG9cclxuICAgICAgICAgICAgICAgICAgICBjb25maWcudXNlUG9sbGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uZmlnLnVzZVBhcmVudCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uZmlnLmxvY2FsID0gbG9jYXRpb24ucHJvdG9jb2wgKyBcIi8vXCIgKyBsb2NhdGlvbi5ob3N0ICsgbG9jYXRpb24ucGF0aG5hbWUgKyBsb2NhdGlvbi5zZWFyY2g7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVycy54ZG1fZSA9IGNvbmZpZy5sb2NhbDtcclxuICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzLnhkbV9wYSA9IDE7IC8vIHVzZSBwYXJlbnRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnMueGRtX2UgPSByZXNvbHZlVXJsKGNvbmZpZy5sb2NhbCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGNvbmZpZy5jb250YWluZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25maWcudXNlUmVzaXplID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVycy54ZG1fcG8gPSAxOyAvLyB1c2UgcG9sbGluZ1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uZmlnLnJlbW90ZSA9IGFwcGVuZFF1ZXJ5UGFyYW1ldGVycyhjb25maWcucmVtb3RlLCBwYXJhbWV0ZXJzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFwcGx5KGNvbmZpZywge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5uZWw6IHF1ZXJ5LnhkbV9jLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZTogcXVlcnkueGRtX2UsXHJcbiAgICAgICAgICAgICAgICAgICAgdXNlUGFyZW50OiAhdW5kZWYocXVlcnkueGRtX3BhKSxcclxuICAgICAgICAgICAgICAgICAgICB1c2VQb2xsaW5nOiAhdW5kZWYocXVlcnkueGRtX3BvKSxcclxuICAgICAgICAgICAgICAgICAgICB1c2VSZXNpemU6IGNvbmZpZy51c2VQYXJlbnQgPyBmYWxzZSA6IGNvbmZpZy51c2VSZXNpemVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHN0YWNrRWxzID0gW25ldyBlYXN5WERNLnN0YWNrLkhhc2hUcmFuc3BvcnQoY29uZmlnKSwgbmV3IGVhc3lYRE0uc3RhY2suUmVsaWFibGVCZWhhdmlvcih7fSksIG5ldyBlYXN5WERNLnN0YWNrLlF1ZXVlQmVoYXZpb3Ioe1xyXG4gICAgICAgICAgICAgICAgZW5jb2RlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgbWF4TGVuZ3RoOiA0MDAwIC0gY29uZmlnLnJlbW90ZS5sZW5ndGhcclxuICAgICAgICAgICAgfSksIG5ldyBlYXN5WERNLnN0YWNrLlZlcmlmeUJlaGF2aW9yKHtcclxuICAgICAgICAgICAgICAgIGluaXRpYXRlOiBjb25maWcuaXNIb3N0XHJcbiAgICAgICAgICAgIH0pXTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcIjFcIjpcclxuICAgICAgICAgICAgc3RhY2tFbHMgPSBbbmV3IGVhc3lYRE0uc3RhY2suUG9zdE1lc3NhZ2VUcmFuc3BvcnQoY29uZmlnKV07XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCIyXCI6XHJcbiAgICAgICAgICAgIGlmIChjb25maWcuaXNIb3N0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25maWcucmVtb3RlSGVscGVyID0gcmVzb2x2ZVVybChjb25maWcucmVtb3RlSGVscGVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzdGFja0VscyA9IFtuZXcgZWFzeVhETS5zdGFjay5OYW1lVHJhbnNwb3J0KGNvbmZpZyksIG5ldyBlYXN5WERNLnN0YWNrLlF1ZXVlQmVoYXZpb3IoKSwgbmV3IGVhc3lYRE0uc3RhY2suVmVyaWZ5QmVoYXZpb3Ioe1xyXG4gICAgICAgICAgICAgICAgaW5pdGlhdGU6IGNvbmZpZy5pc0hvc3RcclxuICAgICAgICAgICAgfSldO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwiM1wiOlxyXG4gICAgICAgICAgICBzdGFja0VscyA9IFtuZXcgZWFzeVhETS5zdGFjay5OaXhUcmFuc3BvcnQoY29uZmlnKV07XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCI0XCI6XHJcbiAgICAgICAgICAgIHN0YWNrRWxzID0gW25ldyBlYXN5WERNLnN0YWNrLlNhbWVPcmlnaW5UcmFuc3BvcnQoY29uZmlnKV07XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCI1XCI6XHJcbiAgICAgICAgICAgIHN0YWNrRWxzID0gW25ldyBlYXN5WERNLnN0YWNrLkZyYW1lRWxlbWVudFRyYW5zcG9ydChjb25maWcpXTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcIjZcIjpcclxuICAgICAgICAgICAgaWYgKCFmbGFzaFZlcnNpb24pIHtcclxuICAgICAgICAgICAgICAgIGhhc0ZsYXNoKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc3RhY2tFbHMgPSBbbmV3IGVhc3lYRE0uc3RhY2suRmxhc2hUcmFuc3BvcnQoY29uZmlnKV07XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gICAgLy8gdGhpcyBiZWhhdmlvciBpcyByZXNwb25zaWJsZSBmb3IgYnVmZmVyaW5nIG91dGdvaW5nIG1lc3NhZ2VzLCBhbmQgZm9yIHBlcmZvcm1pbmcgbGF6eSBpbml0aWFsaXphdGlvblxyXG4gICAgc3RhY2tFbHMucHVzaChuZXcgZWFzeVhETS5zdGFjay5RdWV1ZUJlaGF2aW9yKHtcclxuICAgICAgICBsYXp5OiBjb25maWcubGF6eSxcclxuICAgICAgICByZW1vdmU6IHRydWVcclxuICAgIH0pKTtcclxuICAgIHJldHVybiBzdGFja0VscztcclxufVxyXG5cclxuLyoqXHJcbiAqIENoYWlucyBhbGwgdGhlIHNlcGFyYXRlIHN0YWNrIGVsZW1lbnRzIGludG8gYSBzaW5nbGUgdXNhYmxlIHN0YWNrLjxici8+XHJcbiAqIElmIGFuIGVsZW1lbnQgaXMgbWlzc2luZyBhIG5lY2Vzc2FyeSBtZXRob2QgdGhlbiBpdCB3aWxsIGhhdmUgYSBwYXNzLXRocm91Z2ggbWV0aG9kIGFwcGxpZWQuXHJcbiAqIEBwYXJhbSB7QXJyYXl9IHN0YWNrRWxlbWVudHMgQW4gYXJyYXkgb2Ygc3RhY2sgZWxlbWVudHMgdG8gYmUgbGlua2VkLlxyXG4gKiBAcmV0dXJuIHtlYXN5WERNLnN0YWNrLlN0YWNrRWxlbWVudH0gVGhlIGxhc3QgZWxlbWVudCBpbiB0aGUgY2hhaW4uXHJcbiAqL1xyXG5mdW5jdGlvbiBjaGFpblN0YWNrKHN0YWNrRWxlbWVudHMpe1xyXG4gICAgdmFyIHN0YWNrRWwsIGRlZmF1bHRzID0ge1xyXG4gICAgICAgIGluY29taW5nOiBmdW5jdGlvbihtZXNzYWdlLCBvcmlnaW4pe1xyXG4gICAgICAgICAgICB0aGlzLnVwLmluY29taW5nKG1lc3NhZ2UsIG9yaWdpbik7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvdXRnb2luZzogZnVuY3Rpb24obWVzc2FnZSwgcmVjaXBpZW50KXtcclxuICAgICAgICAgICAgdGhpcy5kb3duLm91dGdvaW5nKG1lc3NhZ2UsIHJlY2lwaWVudCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oc3VjY2Vzcyl7XHJcbiAgICAgICAgICAgIHRoaXMudXAuY2FsbGJhY2soc3VjY2Vzcyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBpbml0OiBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB0aGlzLmRvd24uaW5pdCgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGVzdHJveTogZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGhpcy5kb3duLmRlc3Ryb3koKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHN0YWNrRWxlbWVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICBzdGFja0VsID0gc3RhY2tFbGVtZW50c1tpXTtcclxuICAgICAgICBhcHBseShzdGFja0VsLCBkZWZhdWx0cywgdHJ1ZSk7XHJcbiAgICAgICAgaWYgKGkgIT09IDApIHtcclxuICAgICAgICAgICAgc3RhY2tFbC5kb3duID0gc3RhY2tFbGVtZW50c1tpIC0gMV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpICE9PSBsZW4gLSAxKSB7XHJcbiAgICAgICAgICAgIHN0YWNrRWwudXAgPSBzdGFja0VsZW1lbnRzW2kgKyAxXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3RhY2tFbDtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRoaXMgd2lsbCByZW1vdmUgYSBzdGFja2VsZW1lbnQgZnJvbSBpdHMgc3RhY2sgd2hpbGUgbGVhdmluZyB0aGUgc3RhY2sgZnVuY3Rpb25hbC5cclxuICogQHBhcmFtIHtPYmplY3R9IGVsZW1lbnQgVGhlIGVsbWVudCB0byByZW1vdmUgZnJvbSB0aGUgc3RhY2suXHJcbiAqL1xyXG5mdW5jdGlvbiByZW1vdmVGcm9tU3RhY2soZWxlbWVudCl7XHJcbiAgICBlbGVtZW50LnVwLmRvd24gPSBlbGVtZW50LmRvd247XHJcbiAgICBlbGVtZW50LmRvd24udXAgPSBlbGVtZW50LnVwO1xyXG4gICAgZWxlbWVudC51cCA9IGVsZW1lbnQuZG93biA9IG51bGw7XHJcbn1cclxuXHJcbi8qXHJcbiAqIEV4cG9ydCB0aGUgbWFpbiBvYmplY3QgYW5kIGFueSBvdGhlciBtZXRob2RzIGFwcGxpY2FibGVcclxuICovXHJcbi8qKlxyXG4gKiBAY2xhc3MgZWFzeVhETVxyXG4gKiBBIGphdmFzY3JpcHQgbGlicmFyeSBwcm92aWRpbmcgY3Jvc3MtYnJvd3NlciwgY3Jvc3MtZG9tYWluIG1lc3NhZ2luZy9SUEMuXHJcbiAqIEB2ZXJzaW9uIDIuNC4xOS4zXHJcbiAqIEBzaW5nbGV0b25cclxuICovXHJcbmFwcGx5KGVhc3lYRE0sIHtcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHZlcnNpb24gb2YgdGhlIGxpYnJhcnlcclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKi9cclxuICAgIHZlcnNpb246IFwiMi40LjE5LjNcIixcclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBpcyBhIG1hcCBjb250YWluaW5nIGFsbCB0aGUgcXVlcnkgcGFyYW1ldGVycyBwYXNzZWQgdG8gdGhlIGRvY3VtZW50LlxyXG4gICAgICogQWxsIHRoZSB2YWx1ZXMgaGFzIGJlZW4gZGVjb2RlZCB1c2luZyBkZWNvZGVVUklDb21wb25lbnQuXHJcbiAgICAgKiBAdHlwZSB7b2JqZWN0fVxyXG4gICAgICovXHJcbiAgICBxdWVyeTogcXVlcnksXHJcbiAgICAvKipcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIHN0YWNrOiB7fSxcclxuICAgIC8qKlxyXG4gICAgICogQXBwbGllcyBwcm9wZXJ0aWVzIGZyb20gdGhlIHNvdXJjZSBvYmplY3QgdG8gdGhlIHRhcmdldCBvYmplY3QuPGJyLz5cclxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSB0YXJnZXQgVGhlIHRhcmdldCBvZiB0aGUgcHJvcGVydGllcy5cclxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBzb3VyY2UgVGhlIHNvdXJjZSBvZiB0aGUgcHJvcGVydGllcy5cclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gbm9PdmVyd3JpdGUgU2V0IHRvIFRydWUgdG8gb25seSBzZXQgbm9uLWV4aXN0aW5nIHByb3BlcnRpZXMuXHJcbiAgICAgKi9cclxuICAgIGFwcGx5OiBhcHBseSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIEEgc2FmZSBpbXBsZW1lbnRhdGlvbiBvZiBIVE1MNSBKU09OLiBGZWF0dXJlIHRlc3RpbmcgaXMgdXNlZCB0byBtYWtlIHN1cmUgdGhlIGltcGxlbWVudGF0aW9uIHdvcmtzLlxyXG4gICAgICogQHJldHVybiB7SlNPTn0gQSB2YWxpZCBKU09OIGNvbmZvcm1pbmcgb2JqZWN0LCBvciBudWxsIGlmIG5vdCBmb3VuZC5cclxuICAgICAqL1xyXG4gICAgZ2V0SlNPTk9iamVjdDogZ2V0SlNPTixcclxuICAgIC8qKlxyXG4gICAgICogVGhpcyB3aWxsIGFkZCBhIGZ1bmN0aW9uIHRvIHRoZSBxdWV1ZSBvZiBmdW5jdGlvbnMgdG8gYmUgcnVuIG9uY2UgdGhlIERPTSByZWFjaGVzIGEgcmVhZHkgc3RhdGUuXHJcbiAgICAgKiBJZiBmdW5jdGlvbnMgYXJlIGFkZGVkIGFmdGVyIHRoaXMgZXZlbnQgdGhlbiB0aGV5IHdpbGwgYmUgZXhlY3V0ZWQgaW1tZWRpYXRlbHkuXHJcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gYWRkXHJcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gc2NvcGUgQW4gb3B0aW9uYWwgc2NvcGUgZm9yIHRoZSBmdW5jdGlvbiB0byBiZSBjYWxsZWQgd2l0aC5cclxuICAgICAqL1xyXG4gICAgd2hlblJlYWR5OiB3aGVuUmVhZHksXHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZXMgZWFzeVhETSB2YXJpYWJsZSBmcm9tIHRoZSBnbG9iYWwgc2NvcGUuIEl0IGFsc28gcmV0dXJucyBjb250cm9sXHJcbiAgICAgKiBvZiB0aGUgZWFzeVhETSB2YXJpYWJsZSB0byB3aGF0ZXZlciBjb2RlIHVzZWQgaXQgYmVmb3JlLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBucyBBIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiBhbiBvYmplY3QgdGhhdCB3aWxsIGhvbGRcclxuICAgICAqICAgICAgICAgICAgICAgICAgICBhbiBpbnN0YW5jZSBvZiBlYXN5WERNLlxyXG4gICAgICogQHJldHVybiBBbiBpbnN0YW5jZSBvZiBlYXN5WERNXHJcbiAgICAgKi9cclxuICAgIG5vQ29uZmxpY3Q6IG5vQ29uZmxpY3RcclxufSk7XHJcblxyXG4vKmpzbGludCBldmlsOiB0cnVlLCBicm93c2VyOiB0cnVlLCBpbW1lZDogdHJ1ZSwgcGFzc2ZhaWw6IHRydWUsIHVuZGVmOiB0cnVlLCBuZXdjYXA6IHRydWUqL1xyXG4vKmdsb2JhbCBjb25zb2xlLCBfRmlyZWJ1Z0NvbW1hbmRMaW5lLCAgZWFzeVhETSwgd2luZG93LCBlc2NhcGUsIHVuZXNjYXBlLCBpc0hvc3RPYmplY3QsIHVuZGVmLCBfdHJhY2UsIGRvbUlzUmVhZHksIGVtcHR5Rm4sIG5hbWVzcGFjZSAqL1xyXG4vL1xyXG4vLyBlYXN5WERNXHJcbi8vIGh0dHA6Ly9lYXN5eGRtLm5ldC9cclxuLy8gQ29weXJpZ2h0KGMpIDIwMDktMjAxMSwgw5h5dmluZCBTZWFuIEtpbnNleSwgb3l2aW5kQGtpbnNleS5uby5cclxuLy9cclxuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxyXG4vLyBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXHJcbi8vIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcclxuLy8gdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxyXG4vLyBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcclxuLy8gZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcclxuLy9cclxuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cclxuLy8gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXHJcbi8vXHJcbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcclxuLy8gSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXHJcbi8vIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4vLyBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXHJcbi8vIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXHJcbi8vIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cclxuLy8gVEhFIFNPRlRXQVJFLlxyXG4vL1xyXG5cclxuLypqc2xpbnQgZXZpbDogdHJ1ZSwgYnJvd3NlcjogdHJ1ZSwgaW1tZWQ6IHRydWUsIHBhc3NmYWlsOiB0cnVlLCB1bmRlZjogdHJ1ZSwgbmV3Y2FwOiB0cnVlKi9cclxuLypnbG9iYWwgZWFzeVhETSwgd2luZG93LCBlc2NhcGUsIHVuZXNjYXBlLCBpc0hvc3RPYmplY3QsIGlzSG9zdE1ldGhvZCwgdW4sIG9uLCBjcmVhdGVGcmFtZSwgZGVidWcgKi9cclxuLy9cclxuLy8gZWFzeVhETVxyXG4vLyBodHRwOi8vZWFzeXhkbS5uZXQvXHJcbi8vIENvcHlyaWdodChjKSAyMDA5LTIwMTEsIMOYeXZpbmQgU2VhbiBLaW5zZXksIG95dmluZEBraW5zZXkubm8uXHJcbi8vXHJcbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcclxuLy8gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxyXG4vLyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXHJcbi8vIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcclxuLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXHJcbi8vIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XHJcbi8vXHJcbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXHJcbi8vIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG4vL1xyXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbi8vIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxyXG4vLyBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcclxuLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4vLyBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxyXG4vLyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXHJcbi8vIFRIRSBTT0ZUV0FSRS5cclxuLy9cclxuXHJcbi8qKlxyXG4gKiBAY2xhc3MgZWFzeVhETS5Eb21IZWxwZXJcclxuICogQ29udGFpbnMgbWV0aG9kcyBmb3IgZGVhbGluZyB3aXRoIHRoZSBET01cclxuICogQHNpbmdsZXRvblxyXG4gKi9cclxuZWFzeVhETS5Eb21IZWxwZXIgPSB7XHJcbiAgICAvKipcclxuICAgICAqIFByb3ZpZGVzIGEgY29uc2lzdGVudCBpbnRlcmZhY2UgZm9yIGFkZGluZyBldmVudGhhbmRsZXJzXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0IFRoZSB0YXJnZXQgdG8gYWRkIHRoZSBldmVudCB0b1xyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHR5cGUgVGhlIG5hbWUgb2YgdGhlIGV2ZW50XHJcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBsaXN0ZW5lciBUaGUgbGlzdGVuZXJcclxuICAgICAqL1xyXG4gICAgb246IG9uLFxyXG4gICAgLyoqXHJcbiAgICAgKiBQcm92aWRlcyBhIGNvbnNpc3RlbnQgaW50ZXJmYWNlIGZvciByZW1vdmluZyBldmVudGhhbmRsZXJzXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0IFRoZSB0YXJnZXQgdG8gcmVtb3ZlIHRoZSBldmVudCBmcm9tXHJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdHlwZSBUaGUgbmFtZSBvZiB0aGUgZXZlbnRcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGxpc3RlbmVyIFRoZSBsaXN0ZW5lclxyXG4gICAgICovXHJcbiAgICB1bjogdW4sXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrcyBmb3IgdGhlIHByZXNlbmNlIG9mIHRoZSBKU09OIG9iamVjdC5cclxuICAgICAqIElmIGl0IGlzIG5vdCBwcmVzZW50IGl0IHdpbGwgdXNlIHRoZSBzdXBwbGllZCBwYXRoIHRvIGxvYWQgdGhlIEpTT04yIGxpYnJhcnkuXHJcbiAgICAgKiBUaGlzIHNob3VsZCBiZSBjYWxsZWQgaW4gdGhlIGRvY3VtZW50cyBoZWFkIHJpZ2h0IGFmdGVyIHRoZSBlYXN5WERNIHNjcmlwdCB0YWcuXHJcbiAgICAgKiBodHRwOi8vanNvbi5vcmcvanNvbjIuanNcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwYXRoIEEgdmFsaWQgcGF0aCB0byBqc29uMi5qc1xyXG4gICAgICovXHJcbiAgICByZXF1aXJlc0pTT046IGZ1bmN0aW9uKHBhdGgpe1xyXG4gICAgICAgIGlmICghaXNIb3N0T2JqZWN0KHdpbmRvdywgXCJKU09OXCIpKSB7XHJcbiAgICAgICAgICAgIC8vIHdlIG5lZWQgdG8gZW5jb2RlIHRoZSA8IGluIG9yZGVyIHRvIGF2b2lkIGFuIGlsbGVnYWwgdG9rZW4gZXJyb3JcclxuICAgICAgICAgICAgLy8gd2hlbiB0aGUgc2NyaXB0IGlzIGlubGluZWQgaW4gYSBkb2N1bWVudC5cclxuICAgICAgICAgICAgZG9jdW1lbnQud3JpdGUoJzwnICsgJ3NjcmlwdCB0eXBlPVwidGV4dC9qYXZhc2NyaXB0XCIgc3JjPVwiJyArIHBhdGggKyAnXCI+PCcgKyAnL3NjcmlwdD4nKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbi8qanNsaW50IGV2aWw6IHRydWUsIGJyb3dzZXI6IHRydWUsIGltbWVkOiB0cnVlLCBwYXNzZmFpbDogdHJ1ZSwgdW5kZWY6IHRydWUsIG5ld2NhcDogdHJ1ZSovXHJcbi8qZ2xvYmFsIGVhc3lYRE0sIHdpbmRvdywgZXNjYXBlLCB1bmVzY2FwZSwgZGVidWcgKi9cclxuLy9cclxuLy8gZWFzeVhETVxyXG4vLyBodHRwOi8vZWFzeXhkbS5uZXQvXHJcbi8vIENvcHlyaWdodChjKSAyMDA5LTIwMTEsIMOYeXZpbmQgU2VhbiBLaW5zZXksIG95dmluZEBraW5zZXkubm8uXHJcbi8vXHJcbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcclxuLy8gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxyXG4vLyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXHJcbi8vIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcclxuLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXHJcbi8vIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XHJcbi8vXHJcbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXHJcbi8vIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG4vL1xyXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbi8vIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxyXG4vLyBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcclxuLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4vLyBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxyXG4vLyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXHJcbi8vIFRIRSBTT0ZUV0FSRS5cclxuLy9cclxuXHJcbihmdW5jdGlvbigpe1xyXG4gICAgLy8gVGhlIG1hcCBjb250YWluaW5nIHRoZSBzdG9yZWQgZnVuY3Rpb25zXHJcbiAgICB2YXIgX21hcCA9IHt9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIGVhc3lYRE0uRm5cclxuICAgICAqIFRoaXMgY29udGFpbnMgbWV0aG9kcyByZWxhdGVkIHRvIGZ1bmN0aW9uIGhhbmRsaW5nLCBzdWNoIGFzIHN0b3JpbmcgY2FsbGJhY2tzLlxyXG4gICAgICogQHNpbmdsZXRvblxyXG4gICAgICogQG5hbWVzcGFjZSBlYXN5WERNXHJcbiAgICAgKi9cclxuICAgIGVhc3lYRE0uRm4gPSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogU3RvcmVzIGEgZnVuY3Rpb24gdXNpbmcgdGhlIGdpdmVuIG5hbWUgZm9yIHJlZmVyZW5jZVxyXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIFRoZSBuYW1lIHRoYXQgdGhlIGZ1bmN0aW9uIHNob3VsZCBiZSByZWZlcnJlZCBieVxyXG4gICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBzdG9yZVxyXG4gICAgICAgICAqIEBuYW1lc3BhY2UgZWFzeVhETS5mblxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldDogZnVuY3Rpb24obmFtZSwgZm4pe1xyXG4gICAgICAgICAgICBfbWFwW25hbWVdID0gZm47XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZXRyaWV2ZXMgdGhlIGZ1bmN0aW9uIHJlZmVycmVkIHRvIGJ5IHRoZSBnaXZlbiBuYW1lXHJcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgVGhlIG5hbWUgb2YgdGhlIGZ1bmN0aW9uIHRvIHJldHJpZXZlXHJcbiAgICAgICAgICogQHBhcmFtIHtCb29sZWFufSBkZWwgSWYgdGhlIGZ1bmN0aW9uIHNob3VsZCBiZSBkZWxldGVkIGFmdGVyIHJldHJpZXZhbFxyXG4gICAgICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBUaGUgc3RvcmVkIGZ1bmN0aW9uXHJcbiAgICAgICAgICogQG5hbWVzcGFjZSBlYXN5WERNLmZuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbihuYW1lLCBkZWwpe1xyXG4gICAgICAgICAgICBpZiAoIV9tYXAuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgZm4gPSBfbWFwW25hbWVdO1xyXG5cclxuICAgICAgICAgICAgaWYgKGRlbCkge1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlIF9tYXBbbmFtZV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZuO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG59KCkpO1xyXG4vKmpzbGludCBldmlsOiB0cnVlLCBicm93c2VyOiB0cnVlLCBpbW1lZDogdHJ1ZSwgcGFzc2ZhaWw6IHRydWUsIHVuZGVmOiB0cnVlLCBuZXdjYXA6IHRydWUqL1xyXG4vKmdsb2JhbCBlYXN5WERNLCB3aW5kb3csIGVzY2FwZSwgdW5lc2NhcGUsIGNoYWluU3RhY2ssIHByZXBhcmVUcmFuc3BvcnRTdGFjaywgZ2V0TG9jYXRpb24sIGRlYnVnICovXHJcbi8vXHJcbi8vIGVhc3lYRE1cclxuLy8gaHR0cDovL2Vhc3l4ZG0ubmV0L1xyXG4vLyBDb3B5cmlnaHQoYykgMjAwOS0yMDExLCDDmHl2aW5kIFNlYW4gS2luc2V5LCBveXZpbmRAa2luc2V5Lm5vLlxyXG4vL1xyXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XHJcbi8vIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcclxuLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xyXG4vLyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXHJcbi8vIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xyXG4vLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG4vL1xyXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxyXG4vLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuLy9cclxuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4vLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbi8vIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxyXG4vLyBUSEUgU09GVFdBUkUuXHJcbi8vXHJcblxyXG4vKipcclxuICogQGNsYXNzIGVhc3lYRE0uU29ja2V0XHJcbiAqIFRoaXMgY2xhc3MgY3JlYXRlcyBhIHRyYW5zcG9ydCBjaGFubmVsIGJldHdlZW4gdHdvIGRvbWFpbnMgdGhhdCBpcyB1c2FibGUgZm9yIHNlbmRpbmcgYW5kIHJlY2VpdmluZyBzdHJpbmctYmFzZWQgbWVzc2FnZXMuPGJyLz5cclxuICogVGhlIGNoYW5uZWwgaXMgcmVsaWFibGUsIHN1cHBvcnRzIHF1ZXVlaW5nLCBhbmQgZW5zdXJlcyB0aGF0IHRoZSBtZXNzYWdlIG9yaWdpbmF0ZXMgZnJvbSB0aGUgZXhwZWN0ZWQgZG9tYWluLjxici8+XHJcbiAqIEludGVybmFsbHkgZGlmZmVyZW50IHN0YWNrcyB3aWxsIGJlIHVzZWQgZGVwZW5kaW5nIG9uIHRoZSBicm93c2VycyBmZWF0dXJlcyBhbmQgdGhlIGF2YWlsYWJsZSBwYXJhbWV0ZXJzLlxyXG4gKiA8aDI+SG93IHRvIHNldCB1cDwvaDI+XHJcbiAqIFNldHRpbmcgdXAgdGhlIHByb3ZpZGVyOlxyXG4gKiA8cHJlPjxjb2RlPlxyXG4gKiB2YXIgc29ja2V0ID0gbmV3IGVhc3lYRE0uU29ja2V0KHtcclxuICogJm5ic3A7IGxvY2FsOiBcIm5hbWUuaHRtbFwiLFxyXG4gKiAmbmJzcDsgb25SZWFkeTogZnVuY3Rpb24oKXtcclxuICogJm5ic3A7ICZuYnNwOyAmIzQ3OyYjNDc7IHlvdSBuZWVkIHRvIHdhaXQgZm9yIHRoZSBvblJlYWR5IGNhbGxiYWNrIGJlZm9yZSB1c2luZyB0aGUgc29ja2V0XHJcbiAqICZuYnNwOyAmbmJzcDsgc29ja2V0LnBvc3RNZXNzYWdlKFwiZm9vLW1lc3NhZ2VcIik7XHJcbiAqICZuYnNwOyB9LFxyXG4gKiAmbmJzcDsgb25NZXNzYWdlOiBmdW5jdGlvbihtZXNzYWdlLCBvcmlnaW4pIHtcclxuICogJm5ic3A7Jm5ic3A7IGFsZXJ0KFwicmVjZWl2ZWQgXCIgKyBtZXNzYWdlICsgXCIgZnJvbSBcIiArIG9yaWdpbik7XHJcbiAqICZuYnNwOyB9XHJcbiAqIH0pO1xyXG4gKiA8L2NvZGU+PC9wcmU+XHJcbiAqIFNldHRpbmcgdXAgdGhlIGNvbnN1bWVyOlxyXG4gKiA8cHJlPjxjb2RlPlxyXG4gKiB2YXIgc29ja2V0ID0gbmV3IGVhc3lYRE0uU29ja2V0KHtcclxuICogJm5ic3A7IHJlbW90ZTogXCJodHRwOiYjNDc7JiM0NztyZW1vdGVkb21haW4vcGFnZS5odG1sXCIsXHJcbiAqICZuYnNwOyByZW1vdGVIZWxwZXI6IFwiaHR0cDomIzQ3OyYjNDc7cmVtb3RlZG9tYWluL25hbWUuaHRtbFwiLFxyXG4gKiAmbmJzcDsgb25SZWFkeTogZnVuY3Rpb24oKXtcclxuICogJm5ic3A7ICZuYnNwOyAmIzQ3OyYjNDc7IHlvdSBuZWVkIHRvIHdhaXQgZm9yIHRoZSBvblJlYWR5IGNhbGxiYWNrIGJlZm9yZSB1c2luZyB0aGUgc29ja2V0XHJcbiAqICZuYnNwOyAmbmJzcDsgc29ja2V0LnBvc3RNZXNzYWdlKFwiZm9vLW1lc3NhZ2VcIik7XHJcbiAqICZuYnNwOyB9LFxyXG4gKiAmbmJzcDsgb25NZXNzYWdlOiBmdW5jdGlvbihtZXNzYWdlLCBvcmlnaW4pIHtcclxuICogJm5ic3A7Jm5ic3A7IGFsZXJ0KFwicmVjZWl2ZWQgXCIgKyBtZXNzYWdlICsgXCIgZnJvbSBcIiArIG9yaWdpbik7XHJcbiAqICZuYnNwOyB9XHJcbiAqIH0pO1xyXG4gKiA8L2NvZGU+PC9wcmU+XHJcbiAqIElmIHlvdSBhcmUgdW5hYmxlIHRvIHVwbG9hZCB0aGUgPGNvZGU+bmFtZS5odG1sPC9jb2RlPiBmaWxlIHRvIHRoZSBjb25zdW1lcnMgZG9tYWluIHRoZW4gcmVtb3ZlIHRoZSA8Y29kZT5yZW1vdGVIZWxwZXI8L2NvZGU+IHByb3BlcnR5XHJcbiAqIGFuZCBlYXN5WERNIHdpbGwgZmFsbCBiYWNrIHRvIHVzaW5nIHRoZSBIYXNoVHJhbnNwb3J0IGluc3RlYWQgb2YgdGhlIE5hbWVUcmFuc3BvcnQgd2hlbiBub3QgYWJsZSB0byB1c2UgYW55IG9mIHRoZSBwcmltYXJ5IHRyYW5zcG9ydHMuXHJcbiAqIEBuYW1lc3BhY2UgZWFzeVhETVxyXG4gKiBAY29uc3RydWN0b3JcclxuICogQGNmZyB7U3RyaW5nL1dpbmRvd30gbG9jYWwgVGhlIHVybCB0byB0aGUgbG9jYWwgbmFtZS5odG1sIGRvY3VtZW50LCBhIGxvY2FsIHN0YXRpYyBmaWxlLCBvciBhIHJlZmVyZW5jZSB0byB0aGUgbG9jYWwgd2luZG93LlxyXG4gKiBAY2ZnIHtCb29sZWFufSBsYXp5IChDb25zdW1lciBvbmx5KSBTZXQgdGhpcyB0byB0cnVlIGlmIHlvdSB3YW50IGVhc3lYRE0gdG8gZGVmZXIgY3JlYXRpbmcgdGhlIHRyYW5zcG9ydCB1bnRpbCByZWFsbHkgbmVlZGVkLlxyXG4gKiBAY2ZnIHtTdHJpbmd9IHJlbW90ZSAoQ29uc3VtZXIgb25seSkgVGhlIHVybCB0byB0aGUgcHJvdmlkZXJzIGRvY3VtZW50LlxyXG4gKiBAY2ZnIHtTdHJpbmd9IHJlbW90ZUhlbHBlciAoQ29uc3VtZXIgb25seSkgVGhlIHVybCB0byB0aGUgcmVtb3RlIG5hbWUuaHRtbCBmaWxlLiBUaGlzIGlzIHRvIHN1cHBvcnQgTmFtZVRyYW5zcG9ydCBhcyBhIGZhbGxiYWNrLiBPcHRpb25hbC5cclxuICogQGNmZyB7TnVtYmVyfSBkZWxheSBUaGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBlYXN5WERNIHNob3VsZCB0cnkgdG8gZ2V0IGEgcmVmZXJlbmNlIHRvIHRoZSBsb2NhbCB3aW5kb3cuICBPcHRpb25hbCwgZGVmYXVsdHMgdG8gMjAwMC5cclxuICogQGNmZyB7TnVtYmVyfSBpbnRlcnZhbCBUaGUgaW50ZXJ2YWwgdXNlZCB3aGVuIHBvbGxpbmcgZm9yIG1lc3NhZ2VzLiBPcHRpb25hbCwgZGVmYXVsdHMgdG8gMzAwLlxyXG4gKiBAY2ZnIHtTdHJpbmd9IGNoYW5uZWwgKENvbnN1bWVyIG9ubHkpIFRoZSBuYW1lIG9mIHRoZSBjaGFubmVsIHRvIHVzZS4gQ2FuIGJlIHVzZWQgdG8gc2V0IGNvbnNpc3RlbnQgaWZyYW1lIG5hbWVzLiBNdXN0IGJlIHVuaXF1ZS4gT3B0aW9uYWwuXHJcbiAqIEBjZmcge0Z1bmN0aW9ufSBvbk1lc3NhZ2UgVGhlIG1ldGhvZCB0aGF0IHNob3VsZCBoYW5kbGUgaW5jb21pbmcgbWVzc2FnZXMuPGJyLz4gVGhpcyBtZXRob2Qgc2hvdWxkIGFjY2VwdCB0d28gYXJndW1lbnRzLCB0aGUgbWVzc2FnZSBhcyBhIHN0cmluZywgYW5kIHRoZSBvcmlnaW4gYXMgYSBzdHJpbmcuIE9wdGlvbmFsLlxyXG4gKiBAY2ZnIHtGdW5jdGlvbn0gb25SZWFkeSBBIG1ldGhvZCB0aGF0IHNob3VsZCBiZSBjYWxsZWQgd2hlbiB0aGUgdHJhbnNwb3J0IGlzIHJlYWR5LiBPcHRpb25hbC5cclxuICogQGNmZyB7RE9NRWxlbWVudHxTdHJpbmd9IGNvbnRhaW5lciAoQ29uc3VtZXIgb25seSkgVGhlIGVsZW1lbnQsIG9yIHRoZSBpZCBvZiB0aGUgZWxlbWVudCB0aGF0IHRoZSBwcmltYXJ5IGlmcmFtZSBzaG91bGQgYmUgaW5zZXJ0ZWQgaW50by4gSWYgbm90IHNldCB0aGVuIHRoZSBpZnJhbWUgd2lsbCBiZSBwb3NpdGlvbmVkIG9mZi1zY3JlZW4uIE9wdGlvbmFsLlxyXG4gKiBAY2ZnIHtBcnJheS9TdHJpbmd9IGFjbCAoUHJvdmlkZXIgb25seSkgSGVyZSB5b3UgY2FuIHNwZWNpZnkgd2hpY2ggJ1twcm90b2NvbF06Ly9bZG9tYWluXScgcGF0dGVybnMgdGhhdCBzaG91bGQgYmUgYWxsb3dlZCB0byBhY3QgYXMgdGhlIGNvbnN1bWVyIHRvd2FyZHMgdGhpcyBwcm92aWRlci48YnIvPlxyXG4gKiBUaGlzIGNhbiBjb250YWluIHRoZSB3aWxkY2FyZHMgPyBhbmQgKi4gIEV4YW1wbGVzIGFyZSAnaHR0cDovL2V4YW1wbGUuY29tJywgJyouZm9vLmNvbScgYW5kICcqZG9tPy5jb20nLiBJZiB5b3Ugd2FudCB0byB1c2UgcmVxdWxhciBleHByZXNzaW9ucyB0aGVuIHlvdSBwYXR0ZXJuIG5lZWRzIHRvIHN0YXJ0IHdpdGggXiBhbmQgZW5kIHdpdGggJC5cclxuICogSWYgbm9uZSBvZiB0aGUgcGF0dGVybnMgbWF0Y2ggYW4gRXJyb3Igd2lsbCBiZSB0aHJvd24uXHJcbiAqIEBjZmcge09iamVjdH0gcHJvcHMgKENvbnN1bWVyIG9ubHkpIEFkZGl0aW9uYWwgcHJvcGVydGllcyB0aGF0IHNob3VsZCBiZSBhcHBsaWVkIHRvIHRoZSBpZnJhbWUuIFRoaXMgY2FuIGFsc28gY29udGFpbiBuZXN0ZWQgb2JqZWN0cyBlLmc6IDxjb2RlPntzdHlsZTp7d2lkdGg6XCIxMDBweFwiLCBoZWlnaHQ6XCIxMDBweFwifX08L2NvZGU+LlxyXG4gKiBQcm9wZXJ0aWVzIHN1Y2ggYXMgJ25hbWUnIGFuZCAnc3JjJyB3aWxsIGJlIG92ZXJyaWRlZC4gT3B0aW9uYWwuXHJcbiAqL1xyXG5lYXN5WERNLlNvY2tldCA9IGZ1bmN0aW9uKGNvbmZpZyl7XHJcblxyXG4gICAgLy8gY3JlYXRlIHRoZSBzdGFja1xyXG4gICAgdmFyIHN0YWNrID0gY2hhaW5TdGFjayhwcmVwYXJlVHJhbnNwb3J0U3RhY2soY29uZmlnKS5jb25jYXQoW3tcclxuICAgICAgICBpbmNvbWluZzogZnVuY3Rpb24obWVzc2FnZSwgb3JpZ2luKXtcclxuICAgICAgICAgICAgY29uZmlnLm9uTWVzc2FnZShtZXNzYWdlLCBvcmlnaW4pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uKHN1Y2Nlc3Mpe1xyXG4gICAgICAgICAgICBpZiAoY29uZmlnLm9uUmVhZHkpIHtcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5vblJlYWR5KHN1Y2Nlc3MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfV0pKSwgcmVjaXBpZW50ID0gZ2V0TG9jYXRpb24oY29uZmlnLnJlbW90ZSk7XHJcblxyXG4gICAgLy8gc2V0IHRoZSBvcmlnaW5cclxuICAgIHRoaXMub3JpZ2luID0gZ2V0TG9jYXRpb24oY29uZmlnLnJlbW90ZSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBJbml0aWF0ZXMgdGhlIGRlc3RydWN0aW9uIG9mIHRoZSBzdGFjay5cclxuICAgICAqL1xyXG4gICAgdGhpcy5kZXN0cm95ID0gZnVuY3Rpb24oKXtcclxuICAgICAgICBzdGFjay5kZXN0cm95KCk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUG9zdHMgYSBtZXNzYWdlIHRvIHRoZSByZW1vdGUgZW5kIG9mIHRoZSBjaGFubmVsXHJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbWVzc2FnZSBUaGUgbWVzc2FnZSB0byBzZW5kXHJcbiAgICAgKi9cclxuICAgIHRoaXMucG9zdE1lc3NhZ2UgPSBmdW5jdGlvbihtZXNzYWdlKXtcclxuICAgICAgICBzdGFjay5vdXRnb2luZyhtZXNzYWdlLCByZWNpcGllbnQpO1xyXG4gICAgfTtcclxuXHJcbiAgICBzdGFjay5pbml0KCk7XHJcbn07XHJcbi8qanNsaW50IGV2aWw6IHRydWUsIGJyb3dzZXI6IHRydWUsIGltbWVkOiB0cnVlLCBwYXNzZmFpbDogdHJ1ZSwgdW5kZWY6IHRydWUsIG5ld2NhcDogdHJ1ZSovXHJcbi8qZ2xvYmFsIGVhc3lYRE0sIHdpbmRvdywgZXNjYXBlLCB1bmVzY2FwZSwgdW5kZWYsLCBjaGFpblN0YWNrLCBwcmVwYXJlVHJhbnNwb3J0U3RhY2ssIGRlYnVnLCBnZXRMb2NhdGlvbiAqL1xyXG4vL1xyXG4vLyBlYXN5WERNXHJcbi8vIGh0dHA6Ly9lYXN5eGRtLm5ldC9cclxuLy8gQ29weXJpZ2h0KGMpIDIwMDktMjAxMSwgw5h5dmluZCBTZWFuIEtpbnNleSwgb3l2aW5kQGtpbnNleS5uby5cclxuLy9cclxuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxyXG4vLyBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXHJcbi8vIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcclxuLy8gdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxyXG4vLyBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcclxuLy8gZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcclxuLy9cclxuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cclxuLy8gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXHJcbi8vXHJcbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcclxuLy8gSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXHJcbi8vIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4vLyBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXHJcbi8vIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXHJcbi8vIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cclxuLy8gVEhFIFNPRlRXQVJFLlxyXG4vL1xyXG5cclxuLyoqXHJcbiAqIEBjbGFzcyBlYXN5WERNLlJwY1xyXG4gKiBDcmVhdGVzIGEgcHJveHkgb2JqZWN0IHRoYXQgY2FuIGJlIHVzZWQgdG8gY2FsbCBtZXRob2RzIGltcGxlbWVudGVkIG9uIHRoZSByZW1vdGUgZW5kIG9mIHRoZSBjaGFubmVsLCBhbmQgYWxzbyB0byBwcm92aWRlIHRoZSBpbXBsZW1lbnRhdGlvblxyXG4gKiBvZiBtZXRob2RzIHRvIGJlIGNhbGxlZCBmcm9tIHRoZSByZW1vdGUgZW5kLjxici8+XHJcbiAqIFRoZSBpbnN0YW50aWF0ZWQgb2JqZWN0IHdpbGwgaGF2ZSBtZXRob2RzIG1hdGNoaW5nIHRob3NlIHNwZWNpZmllZCBpbiA8Y29kZT5jb25maWcucmVtb3RlPC9jb2RlPi48YnIvPlxyXG4gKiBUaGlzIHJlcXVpcmVzIHRoZSBKU09OIG9iamVjdCBwcmVzZW50IGluIHRoZSBkb2N1bWVudCwgZWl0aGVyIG5hdGl2ZWx5LCB1c2luZyBqc29uLm9yZydzIGpzb24yIG9yIGFzIGEgd3JhcHBlciBhcm91bmQgbGlicmFyeSBzcGVzaWZpYyBtZXRob2RzLlxyXG4gKiA8aDI+SG93IHRvIHNldCB1cDwvaDI+XHJcbiAqIDxwcmU+PGNvZGU+XHJcbiAqIHZhciBycGMgPSBuZXcgZWFzeVhETS5ScGMoe1xyXG4gKiAmbmJzcDsgJiM0NzsmIzQ3OyB0aGlzIGNvbmZpZ3VyYXRpb24gaXMgZXF1YWwgdG8gdGhhdCB1c2VkIGJ5IHRoZSBTb2NrZXQuXHJcbiAqICZuYnNwOyByZW1vdGU6IFwiaHR0cDomIzQ3OyYjNDc7cmVtb3RlZG9tYWluLy4uLlwiLFxyXG4gKiAmbmJzcDsgb25SZWFkeTogZnVuY3Rpb24oKXtcclxuICogJm5ic3A7ICZuYnNwOyAmIzQ3OyYjNDc7IHlvdSBuZWVkIHRvIHdhaXQgZm9yIHRoZSBvblJlYWR5IGNhbGxiYWNrIGJlZm9yZSB1c2luZyB0aGUgcHJveHlcclxuICogJm5ic3A7ICZuYnNwOyBycGMuZm9vKC4uLlxyXG4gKiAmbmJzcDsgfVxyXG4gKiB9LHtcclxuICogJm5ic3A7IGxvY2FsOiB7Li59LFxyXG4gKiAmbmJzcDsgcmVtb3RlOiB7Li59XHJcbiAqIH0pO1xyXG4gKiA8L2NvZGU+PC9wcmU+XHJcbiAqXHJcbiAqIDxoMj5FeHBvc2luZyBmdW5jdGlvbnMgKHByb2NlZHVyZXMpPC9oMj5cclxuICogPHByZT48Y29kZT5cclxuICogdmFyIHJwYyA9IG5ldyBlYXN5WERNLlJwYyh7XHJcbiAqICZuYnNwOyAuLi5cclxuICogfSx7XHJcbiAqICZuYnNwOyBsb2NhbDoge1xyXG4gKiAmbmJzcDsgJm5ic3A7IG5hbWVPZk1ldGhvZDoge1xyXG4gKiAmbmJzcDsgJm5ic3A7ICZuYnNwOyBtZXRob2Q6IGZ1bmN0aW9uKGFyZzEsIGFyZzIsIHN1Y2Nlc3MsIGVycm9yKXtcclxuICogJm5ic3A7ICZuYnNwOyAmbmJzcDsgJm5ic3A7IC4uLlxyXG4gKiAmbmJzcDsgJm5ic3A7ICZuYnNwOyB9XHJcbiAqICZuYnNwOyAmbmJzcDsgfSxcclxuICogJm5ic3A7ICZuYnNwOyAmIzQ3OyYjNDc7IHdpdGggc2hvcnRoYW5kIG5vdGF0aW9uXHJcbiAqICZuYnNwOyAmbmJzcDsgbmFtZU9mQW5vdGhlck1ldGhvZDogIGZ1bmN0aW9uKGFyZzEsIGFyZzIsIHN1Y2Nlc3MsIGVycm9yKXtcclxuICogJm5ic3A7ICZuYnNwOyB9XHJcbiAqICZuYnNwOyB9LFxyXG4gKiAmbmJzcDsgcmVtb3RlOiB7Li4ufVxyXG4gKiB9KTtcclxuICogPC9jb2RlPjwvcHJlPlxyXG5cclxuICogVGhlIGZ1bmN0aW9uIHJlZmVyZW5jZWQgYnkgIFttZXRob2RdIHdpbGwgcmVjZWl2ZSB0aGUgcGFzc2VkIGFyZ3VtZW50cyBmb2xsb3dlZCBieSB0aGUgY2FsbGJhY2sgZnVuY3Rpb25zIDxjb2RlPnN1Y2Nlc3M8L2NvZGU+IGFuZCA8Y29kZT5lcnJvcjwvY29kZT4uPGJyLz5cclxuICogVG8gc2VuZCBhIHN1Y2Nlc3NmdWxsIHJlc3VsdCBiYWNrIHlvdSBjYW4gdXNlXHJcbiAqICAgICA8cHJlPjxjb2RlPlxyXG4gKiAgICAgcmV0dXJuIGZvbztcclxuICogICAgIDwvcHJlPjwvY29kZT5cclxuICogb3JcclxuICogICAgIDxwcmU+PGNvZGU+XHJcbiAqICAgICBzdWNjZXNzKGZvbyk7XHJcbiAqICAgICA8L3ByZT48L2NvZGU+XHJcbiAqICBUbyByZXR1cm4gYW4gZXJyb3IgeW91IGNhbiB1c2VcclxuICogICAgIDxwcmU+PGNvZGU+XHJcbiAqICAgICB0aHJvdyBuZXcgRXJyb3IoXCJmb28gZXJyb3JcIik7XHJcbiAqICAgICA8L2NvZGU+PC9wcmU+XHJcbiAqIG9yXHJcbiAqICAgICA8cHJlPjxjb2RlPlxyXG4gKiAgICAgZXJyb3IoXCJmb28gZXJyb3JcIik7XHJcbiAqICAgICA8L2NvZGU+PC9wcmU+XHJcbiAqXHJcbiAqIDxoMj5EZWZpbmluZyByZW1vdGVseSBleHBvc2VkIG1ldGhvZHMgKHByb2NlZHVyZXMvbm90aWZpY2F0aW9ucyk8L2gyPlxyXG4gKiBUaGUgZGVmaW5pdGlvbiBvZiB0aGUgcmVtb3RlIGVuZCBpcyBxdWl0ZSBzaW1pbGFyOlxyXG4gKiA8cHJlPjxjb2RlPlxyXG4gKiB2YXIgcnBjID0gbmV3IGVhc3lYRE0uUnBjKHtcclxuICogJm5ic3A7IC4uLlxyXG4gKiB9LHtcclxuICogJm5ic3A7IGxvY2FsOiB7Li4ufSxcclxuICogJm5ic3A7IHJlbW90ZToge1xyXG4gKiAmbmJzcDsgJm5ic3A7IG5hbWVPZk1ldGhvZDoge31cclxuICogJm5ic3A7IH1cclxuICogfSk7XHJcbiAqIDwvY29kZT48L3ByZT5cclxuICogVG8gY2FsbCBhIHJlbW90ZSBtZXRob2QgdXNlXHJcbiAqIDxwcmU+PGNvZGU+XHJcbiAqIHJwYy5uYW1lT2ZNZXRob2QoXCJhcmcxXCIsIFwiYXJnMlwiLCBmdW5jdGlvbih2YWx1ZSkge1xyXG4gKiAmbmJzcDsgYWxlcnQoXCJzdWNjZXNzOiBcIiArIHZhbHVlKTtcclxuICogfSwgZnVuY3Rpb24obWVzc2FnZSkge1xyXG4gKiAmbmJzcDsgYWxlcnQoXCJlcnJvcjogXCIgKyBtZXNzYWdlICsgKTtcclxuICogfSk7XHJcbiAqIDwvY29kZT48L3ByZT5cclxuICogQm90aCB0aGUgPGNvZGU+c3VjY2VzczwvY29kZT4gYW5kIDxjb2RlPmVycnJvcjwvY29kZT4gY2FsbGJhY2tzIGFyZSBvcHRpb25hbC48YnIvPlxyXG4gKiBXaGVuIGNhbGxlZCB3aXRoIG5vIGNhbGxiYWNrIGEgSlNPTi1SUEMgMi4wIG5vdGlmaWNhdGlvbiB3aWxsIGJlIGV4ZWN1dGVkLlxyXG4gKiBCZSBhd2FyZSB0aGF0IHlvdSB3aWxsIG5vdCBiZSBub3RpZmllZCBvZiBhbnkgZXJyb3JzIHdpdGggdGhpcyBtZXRob2QuXHJcbiAqIDxici8+XHJcbiAqIDxoMj5TcGVjaWZ5aW5nIGEgY3VzdG9tIHNlcmlhbGl6ZXI8L2gyPlxyXG4gKiBJZiB5b3UgZG8gbm90IHdhbnQgdG8gdXNlIHRoZSBKU09OMiBsaWJyYXJ5IGZvciBub24tbmF0aXZlIEpTT04gc3VwcG9ydCwgYnV0IGluc3RlYWQgY2FwYWJpbGl0aWVzIHByb3ZpZGVkIGJ5IHNvbWUgb3RoZXIgbGlicmFyeVxyXG4gKiB0aGVuIHlvdSBjYW4gc3BlY2lmeSBhIGN1c3RvbSBzZXJpYWxpemVyIHVzaW5nIDxjb2RlPnNlcmlhbGl6ZXI6IGZvbzwvY29kZT5cclxuICogPHByZT48Y29kZT5cclxuICogdmFyIHJwYyA9IG5ldyBlYXN5WERNLlJwYyh7XHJcbiAqICZuYnNwOyAuLi5cclxuICogfSx7XHJcbiAqICZuYnNwOyBsb2NhbDogey4uLn0sXHJcbiAqICZuYnNwOyByZW1vdGU6IHsuLi59LFxyXG4gKiAmbmJzcDsgc2VyaWFsaXplciA6IHtcclxuICogJm5ic3A7ICZuYnNwOyBwYXJzZTogZnVuY3Rpb24oc3RyaW5nKXsgLi4uIH0sXHJcbiAqICZuYnNwOyAmbmJzcDsgc3RyaW5naWZ5OiBmdW5jdGlvbihvYmplY3QpIHsuLi59XHJcbiAqICZuYnNwOyB9XHJcbiAqIH0pO1xyXG4gKiA8L2NvZGU+PC9wcmU+XHJcbiAqIElmIDxjb2RlPnNlcmlhbGl6ZXI8L2NvZGU+IGlzIHNldCB0aGVuIHRoZSBjbGFzcyB3aWxsIG5vdCBhdHRlbXB0IHRvIHVzZSB0aGUgbmF0aXZlIGltcGxlbWVudGF0aW9uLlxyXG4gKiBAbmFtZXNwYWNlIGVhc3lYRE1cclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgVGhlIHVuZGVybHlpbmcgdHJhbnNwb3J0cyBjb25maWd1cmF0aW9uLiBTZWUgZWFzeVhETS5Tb2NrZXQgZm9yIGF2YWlsYWJsZSBwYXJhbWV0ZXJzLlxyXG4gKiBAcGFyYW0ge09iamVjdH0ganNvblJwY0NvbmZpZyBUaGUgZGVzY3JpcHRpb24gb2YgdGhlIGludGVyZmFjZSB0byBpbXBsZW1lbnQuXHJcbiAqL1xyXG5lYXN5WERNLlJwYyA9IGZ1bmN0aW9uKGNvbmZpZywganNvblJwY0NvbmZpZyl7XHJcblxyXG4gICAgLy8gZXhwYW5kIHNob3J0aGFuZCBub3RhdGlvblxyXG4gICAgaWYgKGpzb25ScGNDb25maWcubG9jYWwpIHtcclxuICAgICAgICBmb3IgKHZhciBtZXRob2QgaW4ganNvblJwY0NvbmZpZy5sb2NhbCkge1xyXG4gICAgICAgICAgICBpZiAoanNvblJwY0NvbmZpZy5sb2NhbC5oYXNPd25Qcm9wZXJ0eShtZXRob2QpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWVtYmVyID0ganNvblJwY0NvbmZpZy5sb2NhbFttZXRob2RdO1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtZW1iZXIgPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGpzb25ScGNDb25maWcubG9jYWxbbWV0aG9kXSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBtZW1iZXJcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGNyZWF0ZSB0aGUgc3RhY2tcclxuICAgIHZhciBzdGFjayA9IGNoYWluU3RhY2socHJlcGFyZVRyYW5zcG9ydFN0YWNrKGNvbmZpZykuY29uY2F0KFtuZXcgZWFzeVhETS5zdGFjay5ScGNCZWhhdmlvcih0aGlzLCBqc29uUnBjQ29uZmlnKSwge1xyXG4gICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbihzdWNjZXNzKXtcclxuICAgICAgICAgICAgaWYgKGNvbmZpZy5vblJlYWR5KSB7XHJcbiAgICAgICAgICAgICAgICBjb25maWcub25SZWFkeShzdWNjZXNzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1dKSk7XHJcblxyXG4gICAgLy8gc2V0IHRoZSBvcmlnaW5cclxuICAgIHRoaXMub3JpZ2luID0gZ2V0TG9jYXRpb24oY29uZmlnLnJlbW90ZSk7XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSW5pdGlhdGVzIHRoZSBkZXN0cnVjdGlvbiBvZiB0aGUgc3RhY2suXHJcbiAgICAgKi9cclxuICAgIHRoaXMuZGVzdHJveSA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgc3RhY2suZGVzdHJveSgpO1xyXG4gICAgfTtcclxuXHJcbiAgICBzdGFjay5pbml0KCk7XHJcbn07XHJcbi8qanNsaW50IGV2aWw6IHRydWUsIGJyb3dzZXI6IHRydWUsIGltbWVkOiB0cnVlLCBwYXNzZmFpbDogdHJ1ZSwgdW5kZWY6IHRydWUsIG5ld2NhcDogdHJ1ZSovXHJcbi8qZ2xvYmFsIGVhc3lYRE0sIHdpbmRvdywgZXNjYXBlLCB1bmVzY2FwZSwgZ2V0TG9jYXRpb24sIGFwcGVuZFF1ZXJ5UGFyYW1ldGVycywgY3JlYXRlRnJhbWUsIGRlYnVnLCB1biwgb24sIGFwcGx5LCB3aGVuUmVhZHksIGdldFBhcmVudE9iamVjdCwgSUZSQU1FX1BSRUZJWCovXHJcbi8vXHJcbi8vIGVhc3lYRE1cclxuLy8gaHR0cDovL2Vhc3l4ZG0ubmV0L1xyXG4vLyBDb3B5cmlnaHQoYykgMjAwOS0yMDExLCDDmHl2aW5kIFNlYW4gS2luc2V5LCBveXZpbmRAa2luc2V5Lm5vLlxyXG4vL1xyXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XHJcbi8vIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcclxuLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xyXG4vLyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXHJcbi8vIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xyXG4vLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG4vL1xyXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxyXG4vLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuLy9cclxuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4vLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbi8vIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxyXG4vLyBUSEUgU09GVFdBUkUuXHJcbi8vXHJcblxyXG4vKipcclxuICogQGNsYXNzIGVhc3lYRE0uc3RhY2suU2FtZU9yaWdpblRyYW5zcG9ydFxyXG4gKiBTYW1lT3JpZ2luVHJhbnNwb3J0IGlzIGEgdHJhbnNwb3J0IGNsYXNzIHRoYXQgY2FuIGJlIHVzZWQgd2hlbiBib3RoIGRvbWFpbnMgaGF2ZSB0aGUgc2FtZSBvcmlnaW4uPGJyLz5cclxuICogVGhpcyBjYW4gYmUgdXNlZnVsIGZvciB0ZXN0aW5nIGFuZCBmb3Igd2hlbiB0aGUgbWFpbiBhcHBsaWNhdGlvbiBzdXBwb3J0cyBib3RoIGludGVybmFsIGFuZCBleHRlcm5hbCBzb3VyY2VzLlxyXG4gKiBAbmFtZXNwYWNlIGVhc3lYRE0uc3RhY2tcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgVGhlIHRyYW5zcG9ydHMgY29uZmlndXJhdGlvbi5cclxuICogQGNmZyB7U3RyaW5nfSByZW1vdGUgVGhlIHJlbW90ZSBkb2N1bWVudCB0byBjb21tdW5pY2F0ZSB3aXRoLlxyXG4gKi9cclxuZWFzeVhETS5zdGFjay5TYW1lT3JpZ2luVHJhbnNwb3J0ID0gZnVuY3Rpb24oY29uZmlnKXtcclxuICAgIHZhciBwdWIsIGZyYW1lLCBzZW5kLCB0YXJnZXRPcmlnaW47XHJcblxyXG4gICAgcmV0dXJuIChwdWIgPSB7XHJcbiAgICAgICAgb3V0Z29pbmc6IGZ1bmN0aW9uKG1lc3NhZ2UsIGRvbWFpbiwgZm4pe1xyXG4gICAgICAgICAgICBzZW5kKG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICBpZiAoZm4pIHtcclxuICAgICAgICAgICAgICAgIGZuKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIGlmIChmcmFtZSkge1xyXG4gICAgICAgICAgICAgICAgZnJhbWUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChmcmFtZSk7XHJcbiAgICAgICAgICAgICAgICBmcmFtZSA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIG9uRE9NUmVhZHk6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHRhcmdldE9yaWdpbiA9IGdldExvY2F0aW9uKGNvbmZpZy5yZW1vdGUpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGNvbmZpZy5pc0hvc3QpIHtcclxuICAgICAgICAgICAgICAgIC8vIHNldCB1cCB0aGUgaWZyYW1lXHJcbiAgICAgICAgICAgICAgICBhcHBseShjb25maWcucHJvcHMsIHtcclxuICAgICAgICAgICAgICAgICAgICBzcmM6IGFwcGVuZFF1ZXJ5UGFyYW1ldGVycyhjb25maWcucmVtb3RlLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHhkbV9lOiBsb2NhdGlvbi5wcm90b2NvbCArIFwiLy9cIiArIGxvY2F0aW9uLmhvc3QgKyBsb2NhdGlvbi5wYXRobmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeGRtX2M6IGNvbmZpZy5jaGFubmVsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB4ZG1fcDogNCAvLyA0ID0gU2FtZU9yaWdpblRyYW5zcG9ydFxyXG4gICAgICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IElGUkFNRV9QUkVGSVggKyBjb25maWcuY2hhbm5lbCArIFwiX3Byb3ZpZGVyXCJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgZnJhbWUgPSBjcmVhdGVGcmFtZShjb25maWcpO1xyXG4gICAgICAgICAgICAgICAgZWFzeVhETS5Gbi5zZXQoY29uZmlnLmNoYW5uZWwsIGZ1bmN0aW9uKHNlbmRGbil7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VuZCA9IHNlbmRGbjtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHB1Yi51cC5jYWxsYmFjayh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24obXNnKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHViLnVwLmluY29taW5nKG1zZywgdGFyZ2V0T3JpZ2luKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzZW5kID0gZ2V0UGFyZW50T2JqZWN0KCkuRm4uZ2V0KGNvbmZpZy5jaGFubmVsLCB0cnVlKShmdW5jdGlvbihtc2cpe1xyXG4gICAgICAgICAgICAgICAgICAgIHB1Yi51cC5pbmNvbWluZyhtc2csIHRhcmdldE9yaWdpbik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICBwdWIudXAuY2FsbGJhY2sodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgd2hlblJlYWR5KHB1Yi5vbkRPTVJlYWR5LCBwdWIpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59O1xyXG4vKmpzbGludCBldmlsOiB0cnVlLCBicm93c2VyOiB0cnVlLCBpbW1lZDogdHJ1ZSwgcGFzc2ZhaWw6IHRydWUsIHVuZGVmOiB0cnVlLCBuZXdjYXA6IHRydWUqL1xyXG4vKmdsb2JhbCBnbG9iYWwsIGVhc3lYRE0sIHdpbmRvdywgZ2V0TG9jYXRpb24sIGFwcGVuZFF1ZXJ5UGFyYW1ldGVycywgY3JlYXRlRnJhbWUsIGRlYnVnLCBhcHBseSwgd2hlblJlYWR5LCBJRlJBTUVfUFJFRklYLCBuYW1lc3BhY2UsIHJlc29sdmVVcmwsIGdldERvbWFpbk5hbWUsIEhBU19GTEFTSF9USFJPVFRMRURfQlVHLCBnZXRQb3J0LCBxdWVyeSovXHJcbi8vXHJcbi8vIGVhc3lYRE1cclxuLy8gaHR0cDovL2Vhc3l4ZG0ubmV0L1xyXG4vLyBDb3B5cmlnaHQoYykgMjAwOS0yMDExLCDDmHl2aW5kIFNlYW4gS2luc2V5LCBveXZpbmRAa2luc2V5Lm5vLlxyXG4vL1xyXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XHJcbi8vIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcclxuLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xyXG4vLyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXHJcbi8vIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xyXG4vLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG4vL1xyXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxyXG4vLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuLy9cclxuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4vLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbi8vIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxyXG4vLyBUSEUgU09GVFdBUkUuXHJcbi8vXHJcblxyXG4vKipcclxuICogQGNsYXNzIGVhc3lYRE0uc3RhY2suRmxhc2hUcmFuc3BvcnRcclxuICogRmxhc2hUcmFuc3BvcnQgaXMgYSB0cmFuc3BvcnQgY2xhc3MgdGhhdCB1c2VzIGFuIFNXRiB3aXRoIExvY2FsQ29ubmVjdGlvbiB0byBwYXNzIG1lc3NhZ2VzIGJhY2sgYW5kIGZvcnRoLlxyXG4gKiBAbmFtZXNwYWNlIGVhc3lYRE0uc3RhY2tcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgVGhlIHRyYW5zcG9ydHMgY29uZmlndXJhdGlvbi5cclxuICogQGNmZyB7U3RyaW5nfSByZW1vdGUgVGhlIHJlbW90ZSBkb21haW4gdG8gY29tbXVuaWNhdGUgd2l0aC5cclxuICogQGNmZyB7U3RyaW5nfSBzZWNyZXQgdGhlIHByZS1zaGFyZWQgc2VjcmV0IHVzZWQgdG8gc2VjdXJlIHRoZSBjb21tdW5pY2F0aW9uLlxyXG4gKiBAY2ZnIHtTdHJpbmd9IHN3ZiBUaGUgcGF0aCB0byB0aGUgc3dmIGZpbGVcclxuICogQGNmZyB7Qm9vbGVhbn0gc3dmTm9UaHJvdHRsZSBTZXQgdGhpcyB0byB0cnVlIGlmIHlvdSB3YW50IHRvIHRha2Ugc3RlcHMgdG8gYXZvaWQgYmVlaW5nIHRocm90dGxlZCB3aGVuIGhpZGRlbi5cclxuICogQGNmZyB7U3RyaW5nIHx8IERPTUVsZW1lbnR9IHN3ZkNvbnRhaW5lciBTZXQgdGhpcyBpZiB5b3Ugd2FudCB0byBjb250cm9sIHdoZXJlIHRoZSBzd2YgaXMgcGxhY2VkXHJcbiAqL1xyXG5lYXN5WERNLnN0YWNrLkZsYXNoVHJhbnNwb3J0ID0gZnVuY3Rpb24oY29uZmlnKXtcclxuICAgIHZhciBwdWIsIC8vIHRoZSBwdWJsaWMgaW50ZXJmYWNlXHJcbiBmcmFtZSwgc2VuZCwgdGFyZ2V0T3JpZ2luLCBzd2YsIHN3ZkNvbnRhaW5lcjtcclxuXHJcbiAgICBmdW5jdGlvbiBvbk1lc3NhZ2UobWVzc2FnZSwgb3JpZ2luKXtcclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHB1Yi51cC5pbmNvbWluZyhtZXNzYWdlLCB0YXJnZXRPcmlnaW4pO1xyXG4gICAgICAgIH0sIDApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBtZXRob2QgYWRkcyB0aGUgU1dGIHRvIHRoZSBET00gYW5kIHByZXBhcmVzIHRoZSBpbml0aWFsaXphdGlvbiBvZiB0aGUgY2hhbm5lbFxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBhZGRTd2YoZG9tYWluKXtcclxuICAgICAgICAvLyB0aGUgZGlmZmVyZW50aWF0aW5nIHF1ZXJ5IGFyZ3VtZW50IGlzIG5lZWRlZCBpbiBGbGFzaDkgdG8gYXZvaWQgYSBjYWNoaW5nIGlzc3VlIHdoZXJlIExvY2FsQ29ubmVjdGlvbiB3b3VsZCB0aHJvdyBhbiBlcnJvci5cclxuICAgICAgICB2YXIgdXJsID0gY29uZmlnLnN3ZiArIFwiP2hvc3Q9XCIgKyBjb25maWcuaXNIb3N0O1xyXG4gICAgICAgIHZhciBpZCA9IFwiZWFzeVhETV9zd2ZfXCIgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMCk7XHJcblxyXG4gICAgICAgIC8vIHByZXBhcmUgdGhlIGluaXQgZnVuY3Rpb24gdGhhdCB3aWxsIGZpcmUgb25jZSB0aGUgc3dmIGlzIHJlYWR5XHJcbiAgICAgICAgZWFzeVhETS5Gbi5zZXQoXCJmbGFzaF9sb2FkZWRcIiArIGRvbWFpbi5yZXBsYWNlKC9bXFwtLl0vZywgXCJfXCIpLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBlYXN5WERNLnN0YWNrLkZsYXNoVHJhbnNwb3J0W2RvbWFpbl0uc3dmID0gc3dmID0gc3dmQ29udGFpbmVyLmZpcnN0Q2hpbGQ7XHJcbiAgICAgICAgICAgIHZhciBxdWV1ZSA9IGVhc3lYRE0uc3RhY2suRmxhc2hUcmFuc3BvcnRbZG9tYWluXS5xdWV1ZTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBxdWV1ZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgcXVldWVbaV0oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBxdWV1ZS5sZW5ndGggPSAwO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoY29uZmlnLnN3ZkNvbnRhaW5lcikge1xyXG4gICAgICAgICAgICBzd2ZDb250YWluZXIgPSAodHlwZW9mIGNvbmZpZy5zd2ZDb250YWluZXIgPT0gXCJzdHJpbmdcIikgPyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb25maWcuc3dmQ29udGFpbmVyKSA6IGNvbmZpZy5zd2ZDb250YWluZXI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBjcmVhdGUgdGhlIGNvbnRhaW5lciB0aGF0IHdpbGwgaG9sZCB0aGUgc3dmXHJcbiAgICAgICAgICAgIHN3ZkNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cclxuICAgICAgICAgICAgLy8gaHR0cDovL2J1Z3MuYWRvYmUuY29tL2ppcmEvYnJvd3NlL0ZQLTQ3OTZcclxuICAgICAgICAgICAgLy8gaHR0cDovL3RlY2guZ3JvdXBzLnlhaG9vLmNvbS9ncm91cC9mbGV4Y29kZXJzL21lc3NhZ2UvMTYyMzY1XHJcbiAgICAgICAgICAgIC8vIGh0dHBzOi8vZ3JvdXBzLmdvb2dsZS5jb20vZm9ydW0vIyF0b3BpYy9lYXN5eGRtL21KWkpoV2Fnb0xjXHJcbiAgICAgICAgICAgIGFwcGx5KHN3ZkNvbnRhaW5lci5zdHlsZSwgSEFTX0ZMQVNIX1RIUk9UVExFRF9CVUcgJiYgY29uZmlnLnN3Zk5vVGhyb3R0bGUgPyB7XHJcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IFwiMjBweFwiLFxyXG4gICAgICAgICAgICAgICAgd2lkdGg6IFwiMjBweFwiLFxyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IFwiZml4ZWRcIixcclxuICAgICAgICAgICAgICAgIHJpZ2h0OiAwLFxyXG4gICAgICAgICAgICAgICAgdG9wOiAwXHJcbiAgICAgICAgICAgIH0gOiB7XHJcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IFwiMXB4XCIsXHJcbiAgICAgICAgICAgICAgICB3aWR0aDogXCIxcHhcIixcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBcImFic29sdXRlXCIsXHJcbiAgICAgICAgICAgICAgICBvdmVyZmxvdzogXCJoaWRkZW5cIixcclxuICAgICAgICAgICAgICAgIHJpZ2h0OiAwLFxyXG4gICAgICAgICAgICAgICAgdG9wOiAwXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHN3ZkNvbnRhaW5lcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBjcmVhdGUgdGhlIG9iamVjdC9lbWJlZFxyXG4gICAgICAgIHZhciBmbGFzaFZhcnMgPSBcImNhbGxiYWNrPWZsYXNoX2xvYWRlZFwiICsgZW5jb2RlVVJJQ29tcG9uZW50KGRvbWFpbi5yZXBsYWNlKC9bXFwtLl0vZywgXCJfXCIpKVxyXG4gICAgICAgICAgICArIFwiJnByb3RvPVwiICsgZ2xvYmFsLmxvY2F0aW9uLnByb3RvY29sXHJcbiAgICAgICAgICAgICsgXCImZG9tYWluPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KGdldERvbWFpbk5hbWUoZ2xvYmFsLmxvY2F0aW9uLmhyZWYpKVxyXG4gICAgICAgICAgICArIFwiJnBvcnQ9XCIgKyBlbmNvZGVVUklDb21wb25lbnQoZ2V0UG9ydChnbG9iYWwubG9jYXRpb24uaHJlZikpXHJcbiAgICAgICAgICAgICsgXCImbnM9XCIgKyBlbmNvZGVVUklDb21wb25lbnQobmFtZXNwYWNlKTtcclxuICAgICAgICBzd2ZDb250YWluZXIuaW5uZXJIVE1MID0gXCI8b2JqZWN0IGhlaWdodD0nMjAnIHdpZHRoPScyMCcgdHlwZT0nYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2gnIGlkPSdcIiArIGlkICsgXCInIGRhdGE9J1wiICsgdXJsICsgXCInPlwiICtcclxuICAgICAgICBcIjxwYXJhbSBuYW1lPSdhbGxvd1NjcmlwdEFjY2VzcycgdmFsdWU9J2Fsd2F5cyc+PC9wYXJhbT5cIiArXHJcbiAgICAgICAgXCI8cGFyYW0gbmFtZT0nd21vZGUnIHZhbHVlPSd0cmFuc3BhcmVudCc+XCIgK1xyXG4gICAgICAgIFwiPHBhcmFtIG5hbWU9J21vdmllJyB2YWx1ZT0nXCIgK1xyXG4gICAgICAgIHVybCArXHJcbiAgICAgICAgXCInPjwvcGFyYW0+XCIgK1xyXG4gICAgICAgIFwiPHBhcmFtIG5hbWU9J2ZsYXNodmFycycgdmFsdWU9J1wiICtcclxuICAgICAgICBmbGFzaFZhcnMgK1xyXG4gICAgICAgIFwiJz48L3BhcmFtPlwiICtcclxuICAgICAgICBcIjxlbWJlZCB0eXBlPSdhcHBsaWNhdGlvbi94LXNob2Nrd2F2ZS1mbGFzaCcgRmxhc2hWYXJzPSdcIiArXHJcbiAgICAgICAgZmxhc2hWYXJzICtcclxuICAgICAgICBcIicgYWxsb3dTY3JpcHRBY2Nlc3M9J2Fsd2F5cycgd21vZGU9J3RyYW5zcGFyZW50JyBzcmM9J1wiICtcclxuICAgICAgICB1cmwgK1xyXG4gICAgICAgIFwiJyBoZWlnaHQ9JzEnIHdpZHRoPScxJz48L2VtYmVkPlwiICtcclxuICAgICAgICBcIjwvb2JqZWN0PlwiO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiAocHViID0ge1xyXG4gICAgICAgIG91dGdvaW5nOiBmdW5jdGlvbihtZXNzYWdlLCBkb21haW4sIGZuKXtcclxuICAgICAgICAgICAgc3dmLnBvc3RNZXNzYWdlKGNvbmZpZy5jaGFubmVsLCBtZXNzYWdlLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICBpZiAoZm4pIHtcclxuICAgICAgICAgICAgICAgIGZuKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBzd2YuZGVzdHJveUNoYW5uZWwoY29uZmlnLmNoYW5uZWwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc3dmID0gbnVsbDtcclxuICAgICAgICAgICAgaWYgKGZyYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBmcmFtZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGZyYW1lKTtcclxuICAgICAgICAgICAgICAgIGZyYW1lID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25ET01SZWFkeTogZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgICAgIHRhcmdldE9yaWdpbiA9IGNvbmZpZy5yZW1vdGU7XHJcblxyXG4gICAgICAgICAgICAvLyBQcmVwYXJlIHRoZSBjb2RlIHRoYXQgd2lsbCBiZSBydW4gYWZ0ZXIgdGhlIHN3ZiBoYXMgYmVlbiBpbnRpYWxpemVkXHJcbiAgICAgICAgICAgIGVhc3lYRE0uRm4uc2V0KFwiZmxhc2hfXCIgKyBjb25maWcuY2hhbm5lbCArIFwiX2luaXRcIiwgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICBwdWIudXAuY2FsbGJhY2sodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBzZXQgdXAgdGhlIG9tTWVzc2FnZSBoYW5kbGVyXHJcbiAgICAgICAgICAgIGVhc3lYRE0uRm4uc2V0KFwiZmxhc2hfXCIgKyBjb25maWcuY2hhbm5lbCArIFwiX29uTWVzc2FnZVwiLCBvbk1lc3NhZ2UpO1xyXG5cclxuICAgICAgICAgICAgY29uZmlnLnN3ZiA9IHJlc29sdmVVcmwoY29uZmlnLnN3Zik7IC8vIHJlcG9ydHMgaGF2ZSBiZWVuIG1hZGUgb2YgcmVxdWVzdHMgZ29uZSByb2d1ZSB3aGVuIHVzaW5nIHJlbGF0aXZlIHBhdGhzXHJcbiAgICAgICAgICAgIHZhciBzd2Zkb21haW4gPSBnZXREb21haW5OYW1lKGNvbmZpZy5zd2YpO1xyXG4gICAgICAgICAgICB2YXIgZm4gPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgLy8gc2V0IGluaXQgdG8gdHJ1ZSBpbiBjYXNlIHRoZSBmbiB3YXMgY2FsbGVkIHdhcyBpbnZva2VkIGZyb20gYSBzZXBhcmF0ZSBpbnN0YW5jZVxyXG4gICAgICAgICAgICAgICAgZWFzeVhETS5zdGFjay5GbGFzaFRyYW5zcG9ydFtzd2Zkb21haW5dLmluaXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgc3dmID0gZWFzeVhETS5zdGFjay5GbGFzaFRyYW5zcG9ydFtzd2Zkb21haW5dLnN3ZjtcclxuICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSB0aGUgY2hhbm5lbFxyXG4gICAgICAgICAgICAgICAgc3dmLmNyZWF0ZUNoYW5uZWwoY29uZmlnLmNoYW5uZWwsIGNvbmZpZy5zZWNyZXQsIGdldExvY2F0aW9uKGNvbmZpZy5yZW1vdGUpLCBjb25maWcuaXNIb3N0KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoY29uZmlnLmlzSG9zdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIEZsYXNoIGlzIGdvaW5nIHRvIGJlIHRocm90dGxlZCBhbmQgd2Ugd2FudCB0byBhdm9pZCB0aGlzXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKEhBU19GTEFTSF9USFJPVFRMRURfQlVHICYmIGNvbmZpZy5zd2ZOb1Rocm90dGxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwcGx5KGNvbmZpZy5wcm9wcywge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFwiZml4ZWRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0OiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBcIjIwcHhcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBcIjIwcHhcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gc2V0IHVwIHRoZSBpZnJhbWVcclxuICAgICAgICAgICAgICAgICAgICBhcHBseShjb25maWcucHJvcHMsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3JjOiBhcHBlbmRRdWVyeVBhcmFtZXRlcnMoY29uZmlnLnJlbW90ZSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeGRtX2U6IGdldExvY2F0aW9uKGxvY2F0aW9uLmhyZWYpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeGRtX2M6IGNvbmZpZy5jaGFubmVsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeGRtX3A6IDYsIC8vIDYgPSBGbGFzaFRyYW5zcG9ydFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeGRtX3M6IGNvbmZpZy5zZWNyZXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IElGUkFNRV9QUkVGSVggKyBjb25maWcuY2hhbm5lbCArIFwiX3Byb3ZpZGVyXCJcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBmcmFtZSA9IGNyZWF0ZUZyYW1lKGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBpZiAoZWFzeVhETS5zdGFjay5GbGFzaFRyYW5zcG9ydFtzd2Zkb21haW5dICYmIGVhc3lYRE0uc3RhY2suRmxhc2hUcmFuc3BvcnRbc3dmZG9tYWluXS5pbml0KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpZiB0aGUgc3dmIGlzIGluIHBsYWNlIGFuZCB3ZSBhcmUgdGhlIGNvbnN1bWVyXHJcbiAgICAgICAgICAgICAgICBmbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgdGhlIHN3ZiBkb2VzIG5vdCB5ZXQgZXhpc3RcclxuICAgICAgICAgICAgICAgIGlmICghZWFzeVhETS5zdGFjay5GbGFzaFRyYW5zcG9ydFtzd2Zkb21haW5dKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIHRoZSBxdWV1ZSB0byBob2xkIHRoZSBpbml0IGZuJ3NcclxuICAgICAgICAgICAgICAgICAgICBlYXN5WERNLnN0YWNrLkZsYXNoVHJhbnNwb3J0W3N3ZmRvbWFpbl0gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXVlOiBbZm5dXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBhZGRTd2Yoc3dmZG9tYWluKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGVhc3lYRE0uc3RhY2suRmxhc2hUcmFuc3BvcnRbc3dmZG9tYWluXS5xdWV1ZS5wdXNoKGZuKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgd2hlblJlYWR5KHB1Yi5vbkRPTVJlYWR5LCBwdWIpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59O1xyXG4vKmpzbGludCBldmlsOiB0cnVlLCBicm93c2VyOiB0cnVlLCBpbW1lZDogdHJ1ZSwgcGFzc2ZhaWw6IHRydWUsIHVuZGVmOiB0cnVlLCBuZXdjYXA6IHRydWUqL1xyXG4vKmdsb2JhbCBlYXN5WERNLCB3aW5kb3csIGVzY2FwZSwgdW5lc2NhcGUsIGdldExvY2F0aW9uLCBhcHBlbmRRdWVyeVBhcmFtZXRlcnMsIGNyZWF0ZUZyYW1lLCBkZWJ1ZywgdW4sIG9uLCBhcHBseSwgd2hlblJlYWR5LCBJRlJBTUVfUFJFRklYKi9cclxuLy9cclxuLy8gZWFzeVhETVxyXG4vLyBodHRwOi8vZWFzeXhkbS5uZXQvXHJcbi8vIENvcHlyaWdodChjKSAyMDA5LTIwMTEsIMOYeXZpbmQgU2VhbiBLaW5zZXksIG95dmluZEBraW5zZXkubm8uXHJcbi8vXHJcbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcclxuLy8gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxyXG4vLyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXHJcbi8vIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcclxuLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXHJcbi8vIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XHJcbi8vXHJcbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXHJcbi8vIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG4vL1xyXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbi8vIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxyXG4vLyBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcclxuLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4vLyBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxyXG4vLyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXHJcbi8vIFRIRSBTT0ZUV0FSRS5cclxuLy9cclxuXHJcbi8qKlxyXG4gKiBAY2xhc3MgZWFzeVhETS5zdGFjay5Qb3N0TWVzc2FnZVRyYW5zcG9ydFxyXG4gKiBQb3N0TWVzc2FnZVRyYW5zcG9ydCBpcyBhIHRyYW5zcG9ydCBjbGFzcyB0aGF0IHVzZXMgSFRNTDUgcG9zdE1lc3NhZ2UgZm9yIGNvbW11bmljYXRpb24uPGJyLz5cclxuICogPGEgaHJlZj1cImh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9tczY0NDk0NChWUy44NSkuYXNweFwiPmh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9tczY0NDk0NChWUy44NSkuYXNweDwvYT48YnIvPlxyXG4gKiA8YSBocmVmPVwiaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vRE9NL3dpbmRvdy5wb3N0TWVzc2FnZVwiPmh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL0RPTS93aW5kb3cucG9zdE1lc3NhZ2U8L2E+XHJcbiAqIEBuYW1lc3BhY2UgZWFzeVhETS5zdGFja1xyXG4gKiBAY29uc3RydWN0b3JcclxuICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZyBUaGUgdHJhbnNwb3J0cyBjb25maWd1cmF0aW9uLlxyXG4gKiBAY2ZnIHtTdHJpbmd9IHJlbW90ZSBUaGUgcmVtb3RlIGRvbWFpbiB0byBjb21tdW5pY2F0ZSB3aXRoLlxyXG4gKi9cclxuZWFzeVhETS5zdGFjay5Qb3N0TWVzc2FnZVRyYW5zcG9ydCA9IGZ1bmN0aW9uKGNvbmZpZyl7XHJcbiAgICB2YXIgcHViLCAvLyB0aGUgcHVibGljIGludGVyZmFjZVxyXG4gZnJhbWUsIC8vIHRoZSByZW1vdGUgZnJhbWUsIGlmIGFueVxyXG4gY2FsbGVyV2luZG93LCAvLyB0aGUgd2luZG93IHRoYXQgd2Ugd2lsbCBjYWxsIHdpdGhcclxuIHRhcmdldE9yaWdpbjsgLy8gdGhlIGRvbWFpbiB0byBjb21tdW5pY2F0ZSB3aXRoXHJcbiAgICAvKipcclxuICAgICAqIFJlc29sdmVzIHRoZSBvcmlnaW4gZnJvbSB0aGUgZXZlbnQgb2JqZWN0XHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGV2ZW50IFRoZSBtZXNzYWdlZXZlbnRcclxuICAgICAqIEByZXR1cm4ge1N0cmluZ30gVGhlIHNjaGVtZSwgaG9zdCBhbmQgcG9ydCBvZiB0aGUgb3JpZ2luXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIF9nZXRPcmlnaW4oZXZlbnQpe1xyXG4gICAgICAgIGlmIChldmVudC5vcmlnaW4pIHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyB0aGUgSFRNTDUgcHJvcGVydHlcclxuICAgICAgICAgICAgcmV0dXJuIGdldExvY2F0aW9uKGV2ZW50Lm9yaWdpbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChldmVudC51cmkpIHtcclxuICAgICAgICAgICAgLy8gRnJvbSBlYXJsaWVyIGltcGxlbWVudGF0aW9uc1xyXG4gICAgICAgICAgICByZXR1cm4gZ2V0TG9jYXRpb24oZXZlbnQudXJpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGV2ZW50LmRvbWFpbikge1xyXG4gICAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBsYXN0IG9wdGlvbiBhbmQgd2lsbCBmYWlsIGlmIHRoZVxyXG4gICAgICAgICAgICAvLyBvcmlnaW4gaXMgbm90IHVzaW5nIHRoZSBzYW1lIHNjaGVtYSBhcyB3ZSBhcmVcclxuICAgICAgICAgICAgcmV0dXJuIGxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgZXZlbnQuZG9tYWluO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aHJvdyBcIlVuYWJsZSB0byByZXRyaWV2ZSB0aGUgb3JpZ2luIG9mIHRoZSBldmVudFwiO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBpcyB0aGUgbWFpbiBpbXBsZW1lbnRhdGlvbiBmb3IgdGhlIG9uTWVzc2FnZSBldmVudC48YnIvPlxyXG4gICAgICogSXQgY2hlY2tzIHRoZSB2YWxpZGl0eSBvZiB0aGUgb3JpZ2luIGFuZCBwYXNzZXMgdGhlIG1lc3NhZ2Ugb24gaWYgYXBwcm9wcmlhdGUuXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGV2ZW50IFRoZSBtZXNzYWdlZXZlbnRcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gX3dpbmRvd19vbk1lc3NhZ2UoZXZlbnQpe1xyXG4gICAgICAgIHZhciBvcmlnaW4gPSBfZ2V0T3JpZ2luKGV2ZW50KTtcclxuICAgICAgICBpZiAob3JpZ2luID09IHRhcmdldE9yaWdpbiAmJiBldmVudC5kYXRhLnN1YnN0cmluZygwLCBjb25maWcuY2hhbm5lbC5sZW5ndGggKyAxKSA9PSBjb25maWcuY2hhbm5lbCArIFwiIFwiKSB7XHJcbiAgICAgICAgICAgIHB1Yi51cC5pbmNvbWluZyhldmVudC5kYXRhLnN1YnN0cmluZyhjb25maWcuY2hhbm5lbC5sZW5ndGggKyAxKSwgb3JpZ2luKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIChwdWIgPSB7XHJcbiAgICAgICAgb3V0Z29pbmc6IGZ1bmN0aW9uKG1lc3NhZ2UsIGRvbWFpbiwgZm4pe1xyXG4gICAgICAgICAgICBjYWxsZXJXaW5kb3cucG9zdE1lc3NhZ2UoY29uZmlnLmNoYW5uZWwgKyBcIiBcIiArIG1lc3NhZ2UsIGRvbWFpbiB8fCB0YXJnZXRPcmlnaW4pO1xyXG4gICAgICAgICAgICBpZiAoZm4pIHtcclxuICAgICAgICAgICAgICAgIGZuKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHVuKHdpbmRvdywgXCJtZXNzYWdlXCIsIF93aW5kb3dfb25NZXNzYWdlKTtcclxuICAgICAgICAgICAgaWYgKGZyYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsZXJXaW5kb3cgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgZnJhbWUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChmcmFtZSk7XHJcbiAgICAgICAgICAgICAgICBmcmFtZSA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIG9uRE9NUmVhZHk6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHRhcmdldE9yaWdpbiA9IGdldExvY2F0aW9uKGNvbmZpZy5yZW1vdGUpO1xyXG4gICAgICAgICAgICBpZiAoY29uZmlnLmlzSG9zdCkge1xyXG4gICAgICAgICAgICAgICAgLy8gYWRkIHRoZSBldmVudCBoYW5kbGVyIGZvciBsaXN0ZW5pbmdcclxuICAgICAgICAgICAgICAgIHZhciB3YWl0Rm9yUmVhZHkgPSBmdW5jdGlvbihldmVudCl7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LmRhdGEgPT0gY29uZmlnLmNoYW5uZWwgKyBcIi1yZWFkeVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlcGxhY2UgdGhlIGV2ZW50bGlzdGVuZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGVyV2luZG93ID0gKFwicG9zdE1lc3NhZ2VcIiBpbiBmcmFtZS5jb250ZW50V2luZG93KSA/IGZyYW1lLmNvbnRlbnRXaW5kb3cgOiBmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1bih3aW5kb3csIFwibWVzc2FnZVwiLCB3YWl0Rm9yUmVhZHkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbih3aW5kb3csIFwibWVzc2FnZVwiLCBfd2luZG93X29uTWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1Yi51cC5jYWxsYmFjayh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIG9uKHdpbmRvdywgXCJtZXNzYWdlXCIsIHdhaXRGb3JSZWFkeSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gc2V0IHVwIHRoZSBpZnJhbWVcclxuICAgICAgICAgICAgICAgIGFwcGx5KGNvbmZpZy5wcm9wcywge1xyXG4gICAgICAgICAgICAgICAgICAgIHNyYzogYXBwZW5kUXVlcnlQYXJhbWV0ZXJzKGNvbmZpZy5yZW1vdGUsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeGRtX2U6IGdldExvY2F0aW9uKGxvY2F0aW9uLmhyZWYpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB4ZG1fYzogY29uZmlnLmNoYW5uZWwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHhkbV9wOiAxIC8vIDEgPSBQb3N0TWVzc2FnZVxyXG4gICAgICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IElGUkFNRV9QUkVGSVggKyBjb25maWcuY2hhbm5lbCArIFwiX3Byb3ZpZGVyXCJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgZnJhbWUgPSBjcmVhdGVGcmFtZShjb25maWcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gYWRkIHRoZSBldmVudCBoYW5kbGVyIGZvciBsaXN0ZW5pbmdcclxuICAgICAgICAgICAgICAgIG9uKHdpbmRvdywgXCJtZXNzYWdlXCIsIF93aW5kb3dfb25NZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgIGNhbGxlcldpbmRvdyA9IChcInBvc3RNZXNzYWdlXCIgaW4gd2luZG93LnBhcmVudCkgPyB3aW5kb3cucGFyZW50IDogd2luZG93LnBhcmVudC5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIGNhbGxlcldpbmRvdy5wb3N0TWVzc2FnZShjb25maWcuY2hhbm5lbCArIFwiLXJlYWR5XCIsIHRhcmdldE9yaWdpbik7XHJcblxyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgIHB1Yi51cC5jYWxsYmFjayh0cnVlKTtcclxuICAgICAgICAgICAgICAgIH0sIDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBpbml0OiBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB3aGVuUmVhZHkocHViLm9uRE9NUmVhZHksIHB1Yik7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn07XHJcbi8qanNsaW50IGV2aWw6IHRydWUsIGJyb3dzZXI6IHRydWUsIGltbWVkOiB0cnVlLCBwYXNzZmFpbDogdHJ1ZSwgdW5kZWY6IHRydWUsIG5ld2NhcDogdHJ1ZSovXHJcbi8qZ2xvYmFsIGVhc3lYRE0sIHdpbmRvdywgZXNjYXBlLCB1bmVzY2FwZSwgZ2V0TG9jYXRpb24sIGFwcGVuZFF1ZXJ5UGFyYW1ldGVycywgY3JlYXRlRnJhbWUsIGRlYnVnLCBhcHBseSwgcXVlcnksIHdoZW5SZWFkeSwgSUZSQU1FX1BSRUZJWCovXHJcbi8vXHJcbi8vIGVhc3lYRE1cclxuLy8gaHR0cDovL2Vhc3l4ZG0ubmV0L1xyXG4vLyBDb3B5cmlnaHQoYykgMjAwOS0yMDExLCDDmHl2aW5kIFNlYW4gS2luc2V5LCBveXZpbmRAa2luc2V5Lm5vLlxyXG4vL1xyXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XHJcbi8vIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcclxuLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xyXG4vLyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXHJcbi8vIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xyXG4vLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG4vL1xyXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxyXG4vLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuLy9cclxuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4vLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbi8vIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxyXG4vLyBUSEUgU09GVFdBUkUuXHJcbi8vXHJcblxyXG4vKipcclxuICogQGNsYXNzIGVhc3lYRE0uc3RhY2suRnJhbWVFbGVtZW50VHJhbnNwb3J0XHJcbiAqIEZyYW1lRWxlbWVudFRyYW5zcG9ydCBpcyBhIHRyYW5zcG9ydCBjbGFzcyB0aGF0IGNhbiBiZSB1c2VkIHdpdGggR2Vja28tYnJvd3NlciBhcyB0aGVzZSBhbGxvdyBwYXNzaW5nIHZhcmlhYmxlcyB1c2luZyB0aGUgZnJhbWVFbGVtZW50IHByb3BlcnR5Ljxici8+XHJcbiAqIFNlY3VyaXR5IGlzIG1haW50YWluZWQgYXMgR2VjaG8gdXNlcyBMZXhpY2FsIEF1dGhvcml6YXRpb24gdG8gZGV0ZXJtaW5lIHVuZGVyIHdoaWNoIHNjb3BlIGEgZnVuY3Rpb24gaXMgcnVubmluZy5cclxuICogQG5hbWVzcGFjZSBlYXN5WERNLnN0YWNrXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIFRoZSB0cmFuc3BvcnRzIGNvbmZpZ3VyYXRpb24uXHJcbiAqIEBjZmcge1N0cmluZ30gcmVtb3RlIFRoZSByZW1vdGUgZG9jdW1lbnQgdG8gY29tbXVuaWNhdGUgd2l0aC5cclxuICovXHJcbmVhc3lYRE0uc3RhY2suRnJhbWVFbGVtZW50VHJhbnNwb3J0ID0gZnVuY3Rpb24oY29uZmlnKXtcclxuICAgIHZhciBwdWIsIGZyYW1lLCBzZW5kLCB0YXJnZXRPcmlnaW47XHJcblxyXG4gICAgcmV0dXJuIChwdWIgPSB7XHJcbiAgICAgICAgb3V0Z29pbmc6IGZ1bmN0aW9uKG1lc3NhZ2UsIGRvbWFpbiwgZm4pe1xyXG4gICAgICAgICAgICBzZW5kLmNhbGwodGhpcywgbWVzc2FnZSk7XHJcbiAgICAgICAgICAgIGlmIChmbikge1xyXG4gICAgICAgICAgICAgICAgZm4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGVzdHJveTogZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgaWYgKGZyYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBmcmFtZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGZyYW1lKTtcclxuICAgICAgICAgICAgICAgIGZyYW1lID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25ET01SZWFkeTogZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdGFyZ2V0T3JpZ2luID0gZ2V0TG9jYXRpb24oY29uZmlnLnJlbW90ZSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoY29uZmlnLmlzSG9zdCkge1xyXG4gICAgICAgICAgICAgICAgLy8gc2V0IHVwIHRoZSBpZnJhbWVcclxuICAgICAgICAgICAgICAgIGFwcGx5KGNvbmZpZy5wcm9wcywge1xyXG4gICAgICAgICAgICAgICAgICAgIHNyYzogYXBwZW5kUXVlcnlQYXJhbWV0ZXJzKGNvbmZpZy5yZW1vdGUsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeGRtX2U6IGdldExvY2F0aW9uKGxvY2F0aW9uLmhyZWYpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB4ZG1fYzogY29uZmlnLmNoYW5uZWwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHhkbV9wOiA1IC8vIDUgPSBGcmFtZUVsZW1lbnRUcmFuc3BvcnRcclxuICAgICAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBJRlJBTUVfUFJFRklYICsgY29uZmlnLmNoYW5uZWwgKyBcIl9wcm92aWRlclwiXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGZyYW1lID0gY3JlYXRlRnJhbWUoY29uZmlnKTtcclxuICAgICAgICAgICAgICAgIGZyYW1lLmZuID0gZnVuY3Rpb24oc2VuZEZuKXtcclxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgZnJhbWUuZm47XHJcbiAgICAgICAgICAgICAgICAgICAgc2VuZCA9IHNlbmRGbjtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHB1Yi51cC5jYWxsYmFjayh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgdGhlIGZ1bmN0aW9uIHNvIHRoYXQgaXQgY2Fubm90IGJlIHVzZWQgdG8gb3ZlcndyaXRlIHRoZSBzZW5kIGZ1bmN0aW9uIGxhdGVyIG9uXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKG1zZyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHB1Yi51cC5pbmNvbWluZyhtc2csIHRhcmdldE9yaWdpbik7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIHRvIG1pdGlnYXRlIG9yaWdpbi1zcG9vZmluZ1xyXG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LnJlZmVycmVyICYmIGdldExvY2F0aW9uKGRvY3VtZW50LnJlZmVycmVyKSAhPSBxdWVyeS54ZG1fZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy50b3AubG9jYXRpb24gPSBxdWVyeS54ZG1fZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNlbmQgPSB3aW5kb3cuZnJhbWVFbGVtZW50LmZuKGZ1bmN0aW9uKG1zZyl7XHJcbiAgICAgICAgICAgICAgICAgICAgcHViLnVwLmluY29taW5nKG1zZywgdGFyZ2V0T3JpZ2luKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcHViLnVwLmNhbGxiYWNrKHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBpbml0OiBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB3aGVuUmVhZHkocHViLm9uRE9NUmVhZHksIHB1Yik7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn07XHJcbi8qanNsaW50IGV2aWw6IHRydWUsIGJyb3dzZXI6IHRydWUsIGltbWVkOiB0cnVlLCBwYXNzZmFpbDogdHJ1ZSwgdW5kZWY6IHRydWUsIG5ld2NhcDogdHJ1ZSovXHJcbi8qZ2xvYmFsIGVhc3lYRE0sIHdpbmRvdywgZXNjYXBlLCB1bmVzY2FwZSwgdW5kZWYsIGdldExvY2F0aW9uLCBhcHBlbmRRdWVyeVBhcmFtZXRlcnMsIHJlc29sdmVVcmwsIGNyZWF0ZUZyYW1lLCBkZWJ1ZywgdW4sIGFwcGx5LCB3aGVuUmVhZHksIElGUkFNRV9QUkVGSVgqL1xyXG4vL1xyXG4vLyBlYXN5WERNXHJcbi8vIGh0dHA6Ly9lYXN5eGRtLm5ldC9cclxuLy8gQ29weXJpZ2h0KGMpIDIwMDktMjAxMSwgw5h5dmluZCBTZWFuIEtpbnNleSwgb3l2aW5kQGtpbnNleS5uby5cclxuLy9cclxuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxyXG4vLyBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXHJcbi8vIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcclxuLy8gdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxyXG4vLyBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcclxuLy8gZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcclxuLy9cclxuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cclxuLy8gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXHJcbi8vXHJcbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcclxuLy8gSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXHJcbi8vIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4vLyBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXHJcbi8vIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXHJcbi8vIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cclxuLy8gVEhFIFNPRlRXQVJFLlxyXG4vL1xyXG5cclxuLyoqXHJcbiAqIEBjbGFzcyBlYXN5WERNLnN0YWNrLk5hbWVUcmFuc3BvcnRcclxuICogTmFtZVRyYW5zcG9ydCB1c2VzIHRoZSB3aW5kb3cubmFtZSBwcm9wZXJ0eSB0byByZWxheSBkYXRhLlxyXG4gKiBUaGUgPGNvZGU+bG9jYWw8L2NvZGU+IHBhcmFtZXRlciBuZWVkcyB0byBiZSBzZXQgb24gYm90aCB0aGUgY29uc3VtZXIgYW5kIHByb3ZpZGVyLDxici8+XHJcbiAqIGFuZCB0aGUgPGNvZGU+cmVtb3RlSGVscGVyPC9jb2RlPiBwYXJhbWV0ZXIgbmVlZHMgdG8gYmUgc2V0IG9uIHRoZSBjb25zdW1lci5cclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgVGhlIHRyYW5zcG9ydHMgY29uZmlndXJhdGlvbi5cclxuICogQGNmZyB7U3RyaW5nfSByZW1vdGVIZWxwZXIgVGhlIHVybCB0byB0aGUgcmVtb3RlIGluc3RhbmNlIG9mIGhhc2guaHRtbCAtIHRoaXMgaXMgb25seSBuZWVkZWQgZm9yIHRoZSBob3N0LlxyXG4gKiBAbmFtZXNwYWNlIGVhc3lYRE0uc3RhY2tcclxuICovXHJcbmVhc3lYRE0uc3RhY2suTmFtZVRyYW5zcG9ydCA9IGZ1bmN0aW9uKGNvbmZpZyl7XHJcblxyXG4gICAgdmFyIHB1YjsgLy8gdGhlIHB1YmxpYyBpbnRlcmZhY2VcclxuICAgIHZhciBpc0hvc3QsIGNhbGxlcldpbmRvdywgcmVtb3RlV2luZG93LCByZWFkeUNvdW50LCBjYWxsYmFjaywgcmVtb3RlT3JpZ2luLCByZW1vdGVVcmw7XHJcblxyXG4gICAgZnVuY3Rpb24gX3NlbmRNZXNzYWdlKG1lc3NhZ2Upe1xyXG4gICAgICAgIHZhciB1cmwgPSBjb25maWcucmVtb3RlSGVscGVyICsgKGlzSG9zdCA/IFwiI18zXCIgOiBcIiNfMlwiKSArIGNvbmZpZy5jaGFubmVsO1xyXG4gICAgICAgIGNhbGxlcldpbmRvdy5jb250ZW50V2luZG93LnNlbmRNZXNzYWdlKG1lc3NhZ2UsIHVybCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gX29uUmVhZHkoKXtcclxuICAgICAgICBpZiAoaXNIb3N0KSB7XHJcbiAgICAgICAgICAgIGlmICgrK3JlYWR5Q291bnQgPT09IDIgfHwgIWlzSG9zdCkge1xyXG4gICAgICAgICAgICAgICAgcHViLnVwLmNhbGxiYWNrKHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBfc2VuZE1lc3NhZ2UoXCJyZWFkeVwiKTtcclxuICAgICAgICAgICAgcHViLnVwLmNhbGxiYWNrKHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBfb25NZXNzYWdlKG1lc3NhZ2Upe1xyXG4gICAgICAgIHB1Yi51cC5pbmNvbWluZyhtZXNzYWdlLCByZW1vdGVPcmlnaW4pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIF9vbkxvYWQoKXtcclxuICAgICAgICBpZiAoY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2sodHJ1ZSk7XHJcbiAgICAgICAgICAgIH0sIDApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gKHB1YiA9IHtcclxuICAgICAgICBvdXRnb2luZzogZnVuY3Rpb24obWVzc2FnZSwgZG9tYWluLCBmbil7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrID0gZm47XHJcbiAgICAgICAgICAgIF9zZW5kTWVzc2FnZShtZXNzYWdlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIGNhbGxlcldpbmRvdy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGNhbGxlcldpbmRvdyk7XHJcbiAgICAgICAgICAgIGNhbGxlcldpbmRvdyA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmIChpc0hvc3QpIHtcclxuICAgICAgICAgICAgICAgIHJlbW90ZVdpbmRvdy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHJlbW90ZVdpbmRvdyk7XHJcbiAgICAgICAgICAgICAgICByZW1vdGVXaW5kb3cgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbkRPTVJlYWR5OiBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBpc0hvc3QgPSBjb25maWcuaXNIb3N0O1xyXG4gICAgICAgICAgICByZWFkeUNvdW50ID0gMDtcclxuICAgICAgICAgICAgcmVtb3RlT3JpZ2luID0gZ2V0TG9jYXRpb24oY29uZmlnLnJlbW90ZSk7XHJcbiAgICAgICAgICAgIGNvbmZpZy5sb2NhbCA9IHJlc29sdmVVcmwoY29uZmlnLmxvY2FsKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChpc0hvc3QpIHtcclxuICAgICAgICAgICAgICAgIC8vIFJlZ2lzdGVyIHRoZSBjYWxsYmFja1xyXG4gICAgICAgICAgICAgICAgZWFzeVhETS5Gbi5zZXQoY29uZmlnLmNoYW5uZWwsIGZ1bmN0aW9uKG1lc3NhZ2Upe1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0hvc3QgJiYgbWVzc2FnZSA9PT0gXCJyZWFkeVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgdGhlIGhhbmRsZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWFzeVhETS5Gbi5zZXQoY29uZmlnLmNoYW5uZWwsIF9vbk1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfb25SZWFkeSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFNldCB1cCB0aGUgZnJhbWUgdGhhdCBwb2ludHMgdG8gdGhlIHJlbW90ZSBpbnN0YW5jZVxyXG4gICAgICAgICAgICAgICAgcmVtb3RlVXJsID0gYXBwZW5kUXVlcnlQYXJhbWV0ZXJzKGNvbmZpZy5yZW1vdGUsIHtcclxuICAgICAgICAgICAgICAgICAgICB4ZG1fZTogY29uZmlnLmxvY2FsLFxyXG4gICAgICAgICAgICAgICAgICAgIHhkbV9jOiBjb25maWcuY2hhbm5lbCxcclxuICAgICAgICAgICAgICAgICAgICB4ZG1fcDogMlxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhcHBseShjb25maWcucHJvcHMsIHtcclxuICAgICAgICAgICAgICAgICAgICBzcmM6IHJlbW90ZVVybCArICcjJyArIGNvbmZpZy5jaGFubmVsLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IElGUkFNRV9QUkVGSVggKyBjb25maWcuY2hhbm5lbCArIFwiX3Byb3ZpZGVyXCJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmVtb3RlV2luZG93ID0gY3JlYXRlRnJhbWUoY29uZmlnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5yZW1vdGVIZWxwZXIgPSBjb25maWcucmVtb3RlO1xyXG4gICAgICAgICAgICAgICAgZWFzeVhETS5Gbi5zZXQoY29uZmlnLmNoYW5uZWwsIF9vbk1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBTZXQgdXAgdGhlIGlmcmFtZSB0aGF0IHdpbGwgYmUgdXNlZCBmb3IgdGhlIHRyYW5zcG9ydFxyXG4gICAgICAgICAgICB2YXIgb25Mb2FkID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgaGFuZGxlclxyXG4gICAgICAgICAgICAgICAgdmFyIHcgPSBjYWxsZXJXaW5kb3cgfHwgdGhpcztcclxuICAgICAgICAgICAgICAgIHVuKHcsIFwibG9hZFwiLCBvbkxvYWQpO1xyXG4gICAgICAgICAgICAgICAgZWFzeVhETS5Gbi5zZXQoY29uZmlnLmNoYW5uZWwgKyBcIl9sb2FkXCIsIF9vbkxvYWQpO1xyXG4gICAgICAgICAgICAgICAgKGZ1bmN0aW9uIHRlc3QoKXtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHcuY29udGVudFdpbmRvdy5zZW5kTWVzc2FnZSA9PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX29uUmVhZHkoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQodGVzdCwgNTApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0oKSk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBjYWxsZXJXaW5kb3cgPSBjcmVhdGVGcmFtZSh7XHJcbiAgICAgICAgICAgICAgICBwcm9wczoge1xyXG4gICAgICAgICAgICAgICAgICAgIHNyYzogY29uZmlnLmxvY2FsICsgXCIjXzRcIiArIGNvbmZpZy5jaGFubmVsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb25Mb2FkOiBvbkxvYWRcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBpbml0OiBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB3aGVuUmVhZHkocHViLm9uRE9NUmVhZHksIHB1Yik7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn07XHJcbi8qanNsaW50IGV2aWw6IHRydWUsIGJyb3dzZXI6IHRydWUsIGltbWVkOiB0cnVlLCBwYXNzZmFpbDogdHJ1ZSwgdW5kZWY6IHRydWUsIG5ld2NhcDogdHJ1ZSovXHJcbi8qZ2xvYmFsIGVhc3lYRE0sIHdpbmRvdywgZXNjYXBlLCB1bmVzY2FwZSwgZ2V0TG9jYXRpb24sIGNyZWF0ZUZyYW1lLCBkZWJ1ZywgdW4sIG9uLCBhcHBseSwgd2hlblJlYWR5LCBJRlJBTUVfUFJFRklYKi9cclxuLy9cclxuLy8gZWFzeVhETVxyXG4vLyBodHRwOi8vZWFzeXhkbS5uZXQvXHJcbi8vIENvcHlyaWdodChjKSAyMDA5LTIwMTEsIMOYeXZpbmQgU2VhbiBLaW5zZXksIG95dmluZEBraW5zZXkubm8uXHJcbi8vXHJcbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcclxuLy8gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxyXG4vLyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXHJcbi8vIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcclxuLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXHJcbi8vIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XHJcbi8vXHJcbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXHJcbi8vIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG4vL1xyXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbi8vIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxyXG4vLyBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcclxuLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4vLyBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxyXG4vLyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXHJcbi8vIFRIRSBTT0ZUV0FSRS5cclxuLy9cclxuXHJcbi8qKlxyXG4gKiBAY2xhc3MgZWFzeVhETS5zdGFjay5IYXNoVHJhbnNwb3J0XHJcbiAqIEhhc2hUcmFuc3BvcnQgaXMgYSB0cmFuc3BvcnQgY2xhc3MgdGhhdCB1c2VzIHRoZSBJRnJhbWUgVVJMIFRlY2huaXF1ZSBmb3IgY29tbXVuaWNhdGlvbi48YnIvPlxyXG4gKiA8YSBocmVmPVwiaHR0cDovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L2JiNzM1MzA1LmFzcHhcIj5odHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvYmI3MzUzMDUuYXNweDwvYT48YnIvPlxyXG4gKiBAbmFtZXNwYWNlIGVhc3lYRE0uc3RhY2tcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgVGhlIHRyYW5zcG9ydHMgY29uZmlndXJhdGlvbi5cclxuICogQGNmZyB7U3RyaW5nL1dpbmRvd30gbG9jYWwgVGhlIHVybCB0byB0aGUgbG9jYWwgZmlsZSB1c2VkIGZvciBwcm94eWluZyBtZXNzYWdlcywgb3IgdGhlIGxvY2FsIHdpbmRvdy5cclxuICogQGNmZyB7TnVtYmVyfSBkZWxheSBUaGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBlYXN5WERNIHNob3VsZCB0cnkgdG8gZ2V0IGEgcmVmZXJlbmNlIHRvIHRoZSBsb2NhbCB3aW5kb3cuXHJcbiAqIEBjZmcge051bWJlcn0gaW50ZXJ2YWwgVGhlIGludGVydmFsIHVzZWQgd2hlbiBwb2xsaW5nIGZvciBtZXNzYWdlcy5cclxuICovXHJcbmVhc3lYRE0uc3RhY2suSGFzaFRyYW5zcG9ydCA9IGZ1bmN0aW9uKGNvbmZpZyl7XHJcbiAgICB2YXIgcHViO1xyXG4gICAgdmFyIG1lID0gdGhpcywgaXNIb3N0LCBfdGltZXIsIHBvbGxJbnRlcnZhbCwgX2xhc3RNc2csIF9tc2dOciwgX2xpc3RlbmVyV2luZG93LCBfY2FsbGVyV2luZG93O1xyXG4gICAgdmFyIHVzZVBhcmVudCwgX3JlbW90ZU9yaWdpbjtcclxuXHJcbiAgICBmdW5jdGlvbiBfc2VuZE1lc3NhZ2UobWVzc2FnZSl7XHJcbiAgICAgICAgaWYgKCFfY2FsbGVyV2luZG93KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHVybCA9IGNvbmZpZy5yZW1vdGUgKyBcIiNcIiArIChfbXNnTnIrKykgKyBcIl9cIiArIG1lc3NhZ2U7XHJcbiAgICAgICAgKChpc0hvc3QgfHwgIXVzZVBhcmVudCkgPyBfY2FsbGVyV2luZG93LmNvbnRlbnRXaW5kb3cgOiBfY2FsbGVyV2luZG93KS5sb2NhdGlvbiA9IHVybDtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBfaGFuZGxlSGFzaChoYXNoKXtcclxuICAgICAgICBfbGFzdE1zZyA9IGhhc2g7XHJcbiAgICAgICAgcHViLnVwLmluY29taW5nKF9sYXN0TXNnLnN1YnN0cmluZyhfbGFzdE1zZy5pbmRleE9mKFwiX1wiKSArIDEpLCBfcmVtb3RlT3JpZ2luKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrcyBsb2NhdGlvbi5oYXNoIGZvciBhIG5ldyBtZXNzYWdlIGFuZCByZWxheXMgdGhpcyB0byB0aGUgcmVjZWl2ZXIuXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBfcG9sbEhhc2goKXtcclxuICAgICAgICBpZiAoIV9saXN0ZW5lcldpbmRvdykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBocmVmID0gX2xpc3RlbmVyV2luZG93LmxvY2F0aW9uLmhyZWYsIGhhc2ggPSBcIlwiLCBpbmRleE9mID0gaHJlZi5pbmRleE9mKFwiI1wiKTtcclxuICAgICAgICBpZiAoaW5kZXhPZiAhPSAtMSkge1xyXG4gICAgICAgICAgICBoYXNoID0gaHJlZi5zdWJzdHJpbmcoaW5kZXhPZik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChoYXNoICYmIGhhc2ggIT0gX2xhc3RNc2cpIHtcclxuICAgICAgICAgICAgX2hhbmRsZUhhc2goaGFzaCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIF9hdHRhY2hMaXN0ZW5lcnMoKXtcclxuICAgICAgICBfdGltZXIgPSBzZXRJbnRlcnZhbChfcG9sbEhhc2gsIHBvbGxJbnRlcnZhbCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIChwdWIgPSB7XHJcbiAgICAgICAgb3V0Z29pbmc6IGZ1bmN0aW9uKG1lc3NhZ2UsIGRvbWFpbil7XHJcbiAgICAgICAgICAgIF9zZW5kTWVzc2FnZShtZXNzYWdlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKF90aW1lcik7XHJcbiAgICAgICAgICAgIGlmIChpc0hvc3QgfHwgIXVzZVBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgX2NhbGxlcldpbmRvdy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKF9jYWxsZXJXaW5kb3cpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF9jYWxsZXJXaW5kb3cgPSBudWxsO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25ET01SZWFkeTogZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgaXNIb3N0ID0gY29uZmlnLmlzSG9zdDtcclxuICAgICAgICAgICAgcG9sbEludGVydmFsID0gY29uZmlnLmludGVydmFsO1xyXG4gICAgICAgICAgICBfbGFzdE1zZyA9IFwiI1wiICsgY29uZmlnLmNoYW5uZWw7XHJcbiAgICAgICAgICAgIF9tc2dOciA9IDA7XHJcbiAgICAgICAgICAgIHVzZVBhcmVudCA9IGNvbmZpZy51c2VQYXJlbnQ7XHJcbiAgICAgICAgICAgIF9yZW1vdGVPcmlnaW4gPSBnZXRMb2NhdGlvbihjb25maWcucmVtb3RlKTtcclxuICAgICAgICAgICAgaWYgKGlzSG9zdCkge1xyXG4gICAgICAgICAgICAgICAgYXBwbHkoY29uZmlnLnByb3BzLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3JjOiBjb25maWcucmVtb3RlLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IElGUkFNRV9QUkVGSVggKyBjb25maWcuY2hhbm5lbCArIFwiX3Byb3ZpZGVyXCJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKHVzZVBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZy5vbkxvYWQgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfbGlzdGVuZXJXaW5kb3cgPSB3aW5kb3c7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hdHRhY2hMaXN0ZW5lcnMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHViLnVwLmNhbGxiYWNrKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdHJpZXMgPSAwLCBtYXggPSBjb25maWcuZGVsYXkgLyA1MDtcclxuICAgICAgICAgICAgICAgICAgICAoZnVuY3Rpb24gZ2V0UmVmKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgrK3RyaWVzID4gbWF4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbmFibGUgdG8gcmVmZXJlbmNlIGxpc3RlbmVyd2luZG93XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbGlzdGVuZXJXaW5kb3cgPSBfY2FsbGVyV2luZG93LmNvbnRlbnRXaW5kb3cuZnJhbWVzW0lGUkFNRV9QUkVGSVggKyBjb25maWcuY2hhbm5lbCArIFwiX2NvbnN1bWVyXCJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChleCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfbGlzdGVuZXJXaW5kb3cpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hdHRhY2hMaXN0ZW5lcnMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1Yi51cC5jYWxsYmFjayh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZ2V0UmVmLCA1MCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgX2NhbGxlcldpbmRvdyA9IGNyZWF0ZUZyYW1lKGNvbmZpZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBfbGlzdGVuZXJXaW5kb3cgPSB3aW5kb3c7XHJcbiAgICAgICAgICAgICAgICBfYXR0YWNoTGlzdGVuZXJzKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodXNlUGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2NhbGxlcldpbmRvdyA9IHBhcmVudDtcclxuICAgICAgICAgICAgICAgICAgICBwdWIudXAuY2FsbGJhY2sodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBhcHBseShjb25maWcsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcHM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNyYzogY29uZmlnLnJlbW90ZSArIFwiI1wiICsgY29uZmlnLmNoYW5uZWwgKyBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogSUZSQU1FX1BSRUZJWCArIGNvbmZpZy5jaGFubmVsICsgXCJfY29uc3VtZXJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkxvYWQ6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdWIudXAuY2FsbGJhY2sodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBfY2FsbGVyV2luZG93ID0gY3JlYXRlRnJhbWUoY29uZmlnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgd2hlblJlYWR5KHB1Yi5vbkRPTVJlYWR5LCBwdWIpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59O1xyXG4vKmpzbGludCBldmlsOiB0cnVlLCBicm93c2VyOiB0cnVlLCBpbW1lZDogdHJ1ZSwgcGFzc2ZhaWw6IHRydWUsIHVuZGVmOiB0cnVlLCBuZXdjYXA6IHRydWUqL1xyXG4vKmdsb2JhbCBlYXN5WERNLCB3aW5kb3csIGVzY2FwZSwgdW5lc2NhcGUsIGRlYnVnICovXHJcbi8vXHJcbi8vIGVhc3lYRE1cclxuLy8gaHR0cDovL2Vhc3l4ZG0ubmV0L1xyXG4vLyBDb3B5cmlnaHQoYykgMjAwOS0yMDExLCDDmHl2aW5kIFNlYW4gS2luc2V5LCBveXZpbmRAa2luc2V5Lm5vLlxyXG4vL1xyXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XHJcbi8vIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcclxuLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xyXG4vLyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXHJcbi8vIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xyXG4vLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG4vL1xyXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxyXG4vLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuLy9cclxuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4vLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbi8vIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxyXG4vLyBUSEUgU09GVFdBUkUuXHJcbi8vXHJcblxyXG4vKipcclxuICogQGNsYXNzIGVhc3lYRE0uc3RhY2suUmVsaWFibGVCZWhhdmlvclxyXG4gKiBUaGlzIGlzIGEgYmVoYXZpb3IgdGhhdCB0cmllcyB0byBtYWtlIHRoZSB1bmRlcmx5aW5nIHRyYW5zcG9ydCByZWxpYWJsZSBieSB1c2luZyBhY2tub3dsZWRnZW1lbnRzLlxyXG4gKiBAbmFtZXNwYWNlIGVhc3lYRE0uc3RhY2tcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgVGhlIGJlaGF2aW9ycyBjb25maWd1cmF0aW9uLlxyXG4gKi9cclxuZWFzeVhETS5zdGFjay5SZWxpYWJsZUJlaGF2aW9yID0gZnVuY3Rpb24oY29uZmlnKXtcclxuICAgIHZhciBwdWIsIC8vIHRoZSBwdWJsaWMgaW50ZXJmYWNlXHJcbiBjYWxsYmFjazsgLy8gdGhlIGNhbGxiYWNrIHRvIGV4ZWN1dGUgd2hlbiB3ZSBoYXZlIGEgY29uZmlybWVkIHN1Y2Nlc3MvZmFpbHVyZVxyXG4gICAgdmFyIGlkT3V0ID0gMCwgaWRJbiA9IDAsIGN1cnJlbnRNZXNzYWdlID0gXCJcIjtcclxuXHJcbiAgICByZXR1cm4gKHB1YiA9IHtcclxuICAgICAgICBpbmNvbWluZzogZnVuY3Rpb24obWVzc2FnZSwgb3JpZ2luKXtcclxuICAgICAgICAgICAgdmFyIGluZGV4T2YgPSBtZXNzYWdlLmluZGV4T2YoXCJfXCIpLCBhY2sgPSBtZXNzYWdlLnN1YnN0cmluZygwLCBpbmRleE9mKS5zcGxpdChcIixcIik7XHJcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlLnN1YnN0cmluZyhpbmRleE9mICsgMSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoYWNrWzBdID09IGlkT3V0KSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50TWVzc2FnZSA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayh0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobWVzc2FnZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBwdWIuZG93bi5vdXRnb2luZyhhY2tbMV0gKyBcIixcIiArIGlkT3V0ICsgXCJfXCIgKyBjdXJyZW50TWVzc2FnZSwgb3JpZ2luKTtcclxuICAgICAgICAgICAgICAgIGlmIChpZEluICE9IGFja1sxXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkSW4gPSBhY2tbMV07XHJcbiAgICAgICAgICAgICAgICAgICAgcHViLnVwLmluY29taW5nKG1lc3NhZ2UsIG9yaWdpbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSxcclxuICAgICAgICBvdXRnb2luZzogZnVuY3Rpb24obWVzc2FnZSwgb3JpZ2luLCBmbil7XHJcbiAgICAgICAgICAgIGN1cnJlbnRNZXNzYWdlID0gbWVzc2FnZTtcclxuICAgICAgICAgICAgY2FsbGJhY2sgPSBmbjtcclxuICAgICAgICAgICAgcHViLmRvd24ub3V0Z29pbmcoaWRJbiArIFwiLFwiICsgKCsraWRPdXQpICsgXCJfXCIgKyBtZXNzYWdlLCBvcmlnaW4pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59O1xyXG4vKmpzbGludCBldmlsOiB0cnVlLCBicm93c2VyOiB0cnVlLCBpbW1lZDogdHJ1ZSwgcGFzc2ZhaWw6IHRydWUsIHVuZGVmOiB0cnVlLCBuZXdjYXA6IHRydWUqL1xyXG4vKmdsb2JhbCBlYXN5WERNLCB3aW5kb3csIGVzY2FwZSwgdW5lc2NhcGUsIGRlYnVnLCB1bmRlZiwgcmVtb3ZlRnJvbVN0YWNrKi9cclxuLy9cclxuLy8gZWFzeVhETVxyXG4vLyBodHRwOi8vZWFzeXhkbS5uZXQvXHJcbi8vIENvcHlyaWdodChjKSAyMDA5LTIwMTEsIMOYeXZpbmQgU2VhbiBLaW5zZXksIG95dmluZEBraW5zZXkubm8uXHJcbi8vXHJcbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcclxuLy8gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxyXG4vLyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXHJcbi8vIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcclxuLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXHJcbi8vIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XHJcbi8vXHJcbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXHJcbi8vIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG4vL1xyXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbi8vIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxyXG4vLyBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcclxuLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4vLyBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxyXG4vLyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXHJcbi8vIFRIRSBTT0ZUV0FSRS5cclxuLy9cclxuXHJcbi8qKlxyXG4gKiBAY2xhc3MgZWFzeVhETS5zdGFjay5RdWV1ZUJlaGF2aW9yXHJcbiAqIFRoaXMgaXMgYSBiZWhhdmlvciB0aGF0IGVuYWJsZXMgcXVldWVpbmcgb2YgbWVzc2FnZXMuIDxici8+XHJcbiAqIEl0IHdpbGwgYnVmZmVyIGluY29taW5nIG1lc3NhZ2VzIGFuZCBkaXNwYWNoIHRoZXNlIGFzIGZhc3QgYXMgdGhlIHVuZGVybHlpbmcgdHJhbnNwb3J0IGFsbG93cy5cclxuICogVGhpcyB3aWxsIGFsc28gZnJhZ21lbnQvZGVmcmFnbWVudCBtZXNzYWdlcyBzbyB0aGF0IHRoZSBvdXRnb2luZyBtZXNzYWdlIGlzIG5ldmVyIGJpZ2dlciB0aGFuIHRoZVxyXG4gKiBzZXQgbGVuZ3RoLlxyXG4gKiBAbmFtZXNwYWNlIGVhc3lYRE0uc3RhY2tcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgVGhlIGJlaGF2aW9ycyBjb25maWd1cmF0aW9uLiBPcHRpb25hbC5cclxuICogQGNmZyB7TnVtYmVyfSBtYXhMZW5ndGggVGhlIG1heGltdW0gbGVuZ3RoIG9mIGVhY2ggb3V0Z29pbmcgbWVzc2FnZS4gU2V0IHRoaXMgdG8gZW5hYmxlIGZyYWdtZW50YXRpb24uXHJcbiAqL1xyXG5lYXN5WERNLnN0YWNrLlF1ZXVlQmVoYXZpb3IgPSBmdW5jdGlvbihjb25maWcpe1xyXG4gICAgdmFyIHB1YiwgcXVldWUgPSBbXSwgd2FpdGluZyA9IHRydWUsIGluY29taW5nID0gXCJcIiwgZGVzdHJveWluZywgbWF4TGVuZ3RoID0gMCwgbGF6eSA9IGZhbHNlLCBkb0ZyYWdtZW50ID0gZmFsc2U7XHJcblxyXG4gICAgZnVuY3Rpb24gZGlzcGF0Y2goKXtcclxuICAgICAgICBpZiAoY29uZmlnLnJlbW92ZSAmJiBxdWV1ZS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgcmVtb3ZlRnJvbVN0YWNrKHB1Yik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHdhaXRpbmcgfHwgcXVldWUubGVuZ3RoID09PSAwIHx8IGRlc3Ryb3lpbmcpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB3YWl0aW5nID0gdHJ1ZTtcclxuICAgICAgICB2YXIgbWVzc2FnZSA9IHF1ZXVlLnNoaWZ0KCk7XHJcblxyXG4gICAgICAgIHB1Yi5kb3duLm91dGdvaW5nKG1lc3NhZ2UuZGF0YSwgbWVzc2FnZS5vcmlnaW4sIGZ1bmN0aW9uKHN1Y2Nlc3Mpe1xyXG4gICAgICAgICAgICB3YWl0aW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmIChtZXNzYWdlLmNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZS5jYWxsYmFjayhzdWNjZXNzKTtcclxuICAgICAgICAgICAgICAgIH0sIDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGRpc3BhdGNoKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gKHB1YiA9IHtcclxuICAgICAgICBpbml0OiBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBpZiAodW5kZWYoY29uZmlnKSkge1xyXG4gICAgICAgICAgICAgICAgY29uZmlnID0ge307XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGNvbmZpZy5tYXhMZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIG1heExlbmd0aCA9IGNvbmZpZy5tYXhMZW5ndGg7XHJcbiAgICAgICAgICAgICAgICBkb0ZyYWdtZW50ID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY29uZmlnLmxhenkpIHtcclxuICAgICAgICAgICAgICAgIGxhenkgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcHViLmRvd24uaW5pdCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oc3VjY2Vzcyl7XHJcbiAgICAgICAgICAgIHdhaXRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgdmFyIHVwID0gcHViLnVwOyAvLyBpbiBjYXNlIGRpc3BhdGNoIGNhbGxzIHJlbW92ZUZyb21TdGFja1xyXG4gICAgICAgICAgICBkaXNwYXRjaCgpO1xyXG4gICAgICAgICAgICB1cC5jYWxsYmFjayhzdWNjZXNzKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGluY29taW5nOiBmdW5jdGlvbihtZXNzYWdlLCBvcmlnaW4pe1xyXG4gICAgICAgICAgICBpZiAoZG9GcmFnbWVudCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGluZGV4T2YgPSBtZXNzYWdlLmluZGV4T2YoXCJfXCIpLCBzZXEgPSBwYXJzZUludChtZXNzYWdlLnN1YnN0cmluZygwLCBpbmRleE9mKSwgMTApO1xyXG4gICAgICAgICAgICAgICAgaW5jb21pbmcgKz0gbWVzc2FnZS5zdWJzdHJpbmcoaW5kZXhPZiArIDEpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHNlcSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb25maWcuZW5jb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluY29taW5nID0gZGVjb2RlVVJJQ29tcG9uZW50KGluY29taW5nKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcHViLnVwLmluY29taW5nKGluY29taW5nLCBvcmlnaW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIGluY29taW5nID0gXCJcIjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHB1Yi51cC5pbmNvbWluZyhtZXNzYWdlLCBvcmlnaW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvdXRnb2luZzogZnVuY3Rpb24obWVzc2FnZSwgb3JpZ2luLCBmbil7XHJcbiAgICAgICAgICAgIGlmIChjb25maWcuZW5jb2RlKSB7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlID0gZW5jb2RlVVJJQ29tcG9uZW50KG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBmcmFnbWVudHMgPSBbXSwgZnJhZ21lbnQ7XHJcbiAgICAgICAgICAgIGlmIChkb0ZyYWdtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBmcmFnbWVudCBpbnRvIGNodW5rc1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKG1lc3NhZ2UubGVuZ3RoICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZnJhZ21lbnQgPSBtZXNzYWdlLnN1YnN0cmluZygwLCBtYXhMZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlLnN1YnN0cmluZyhmcmFnbWVudC5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZyYWdtZW50cy5wdXNoKGZyYWdtZW50KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIGVucXVldWUgdGhlIGNodW5rc1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKChmcmFnbWVudCA9IGZyYWdtZW50cy5zaGlmdCgpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXVlLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBmcmFnbWVudHMubGVuZ3RoICsgXCJfXCIgKyBmcmFnbWVudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBvcmlnaW4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmcmFnbWVudHMubGVuZ3RoID09PSAwID8gZm4gOiBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBxdWV1ZS5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBtZXNzYWdlLFxyXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbjogb3JpZ2luLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmblxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGxhenkpIHtcclxuICAgICAgICAgICAgICAgIHB1Yi5kb3duLmluaXQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRpc3BhdGNoKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIGRlc3Ryb3lpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICBwdWIuZG93bi5kZXN0cm95KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn07XHJcbi8qanNsaW50IGV2aWw6IHRydWUsIGJyb3dzZXI6IHRydWUsIGltbWVkOiB0cnVlLCBwYXNzZmFpbDogdHJ1ZSwgdW5kZWY6IHRydWUsIG5ld2NhcDogdHJ1ZSovXHJcbi8qZ2xvYmFsIGVhc3lYRE0sIHdpbmRvdywgZXNjYXBlLCB1bmVzY2FwZSwgdW5kZWYsIGRlYnVnICovXHJcbi8vXHJcbi8vIGVhc3lYRE1cclxuLy8gaHR0cDovL2Vhc3l4ZG0ubmV0L1xyXG4vLyBDb3B5cmlnaHQoYykgMjAwOS0yMDExLCDDmHl2aW5kIFNlYW4gS2luc2V5LCBveXZpbmRAa2luc2V5Lm5vLlxyXG4vL1xyXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XHJcbi8vIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcclxuLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xyXG4vLyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXHJcbi8vIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xyXG4vLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG4vL1xyXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxyXG4vLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuLy9cclxuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4vLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbi8vIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxyXG4vLyBUSEUgU09GVFdBUkUuXHJcbi8vXHJcblxyXG4vKipcclxuICogQGNsYXNzIGVhc3lYRE0uc3RhY2suVmVyaWZ5QmVoYXZpb3JcclxuICogVGhpcyBiZWhhdmlvciB3aWxsIHZlcmlmeSB0aGF0IGNvbW11bmljYXRpb24gd2l0aCB0aGUgcmVtb3RlIGVuZCBpcyBwb3NzaWJsZSwgYW5kIHdpbGwgYWxzbyBzaWduIGFsbCBvdXRnb2luZyxcclxuICogYW5kIHZlcmlmeSBhbGwgaW5jb21pbmcgbWVzc2FnZXMuIFRoaXMgcmVtb3ZlcyB0aGUgcmlzayBvZiBzb21lb25lIGhpamFja2luZyB0aGUgaWZyYW1lIHRvIHNlbmQgbWFsaWNpb3VzIG1lc3NhZ2VzLlxyXG4gKiBAbmFtZXNwYWNlIGVhc3lYRE0uc3RhY2tcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgVGhlIGJlaGF2aW9ycyBjb25maWd1cmF0aW9uLlxyXG4gKiBAY2ZnIHtCb29sZWFufSBpbml0aWF0ZSBJZiB0aGUgdmVyaWZpY2F0aW9uIHNob3VsZCBiZSBpbml0aWF0ZWQgZnJvbSB0aGlzIGVuZC5cclxuICovXHJcbmVhc3lYRE0uc3RhY2suVmVyaWZ5QmVoYXZpb3IgPSBmdW5jdGlvbihjb25maWcpe1xyXG4gICAgdmFyIHB1YiwgbXlTZWNyZXQsIHRoZWlyU2VjcmV0LCB2ZXJpZmllZCA9IGZhbHNlO1xyXG5cclxuICAgIGZ1bmN0aW9uIHN0YXJ0VmVyaWZpY2F0aW9uKCl7XHJcbiAgICAgICAgbXlTZWNyZXQgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDE2KS5zdWJzdHJpbmcoMik7XHJcbiAgICAgICAgcHViLmRvd24ub3V0Z29pbmcobXlTZWNyZXQpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiAocHViID0ge1xyXG4gICAgICAgIGluY29taW5nOiBmdW5jdGlvbihtZXNzYWdlLCBvcmlnaW4pe1xyXG4gICAgICAgICAgICB2YXIgaW5kZXhPZiA9IG1lc3NhZ2UuaW5kZXhPZihcIl9cIik7XHJcbiAgICAgICAgICAgIGlmIChpbmRleE9mID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG1lc3NhZ2UgPT09IG15U2VjcmV0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHViLnVwLmNhbGxiYWNrKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoIXRoZWlyU2VjcmV0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhlaXJTZWNyZXQgPSBtZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghY29uZmlnLmluaXRpYXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0VmVyaWZpY2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHB1Yi5kb3duLm91dGdvaW5nKG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKG1lc3NhZ2Uuc3Vic3RyaW5nKDAsIGluZGV4T2YpID09PSB0aGVpclNlY3JldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHB1Yi51cC5pbmNvbWluZyhtZXNzYWdlLnN1YnN0cmluZyhpbmRleE9mICsgMSksIG9yaWdpbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIG91dGdvaW5nOiBmdW5jdGlvbihtZXNzYWdlLCBvcmlnaW4sIGZuKXtcclxuICAgICAgICAgICAgcHViLmRvd24ub3V0Z29pbmcobXlTZWNyZXQgKyBcIl9cIiArIG1lc3NhZ2UsIG9yaWdpbiwgZm4pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uKHN1Y2Nlc3Mpe1xyXG4gICAgICAgICAgICBpZiAoY29uZmlnLmluaXRpYXRlKSB7XHJcbiAgICAgICAgICAgICAgICBzdGFydFZlcmlmaWNhdGlvbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn07XHJcbi8qanNsaW50IGV2aWw6IHRydWUsIGJyb3dzZXI6IHRydWUsIGltbWVkOiB0cnVlLCBwYXNzZmFpbDogdHJ1ZSwgdW5kZWY6IHRydWUsIG5ld2NhcDogdHJ1ZSovXHJcbi8qZ2xvYmFsIGVhc3lYRE0sIHdpbmRvdywgZXNjYXBlLCB1bmVzY2FwZSwgdW5kZWYsIGdldEpTT04sIGRlYnVnLCBlbXB0eUZuLCBpc0FycmF5ICovXHJcbi8vXHJcbi8vIGVhc3lYRE1cclxuLy8gaHR0cDovL2Vhc3l4ZG0ubmV0L1xyXG4vLyBDb3B5cmlnaHQoYykgMjAwOS0yMDExLCDDmHl2aW5kIFNlYW4gS2luc2V5LCBveXZpbmRAa2luc2V5Lm5vLlxyXG4vL1xyXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XHJcbi8vIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcclxuLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xyXG4vLyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXHJcbi8vIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xyXG4vLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG4vL1xyXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxyXG4vLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuLy9cclxuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4vLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbi8vIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxyXG4vLyBUSEUgU09GVFdBUkUuXHJcbi8vXHJcblxyXG4vKipcclxuICogQGNsYXNzIGVhc3lYRE0uc3RhY2suUnBjQmVoYXZpb3JcclxuICogVGhpcyB1c2VzIEpTT04tUlBDIDIuMCB0byBleHBvc2UgbG9jYWwgbWV0aG9kcyBhbmQgdG8gaW52b2tlIHJlbW90ZSBtZXRob2RzIGFuZCBoYXZlIHJlc3BvbnNlcyByZXR1cm5lZCBvdmVyIHRoZSB0aGUgc3RyaW5nIGJhc2VkIHRyYW5zcG9ydCBzdGFjay48YnIvPlxyXG4gKiBFeHBvc2VkIG1ldGhvZHMgY2FuIHJldHVybiB2YWx1ZXMgc3luY2hyb25vdXMsIGFzeW5jcm9ub3VzLCBvciBiZXQgc2V0IHVwIHRvIG5vdCByZXR1cm4gYW55dGhpbmcuXHJcbiAqIEBuYW1lc3BhY2UgZWFzeVhETS5zdGFja1xyXG4gKiBAY29uc3RydWN0b3JcclxuICogQHBhcmFtIHtPYmplY3R9IHByb3h5IFRoZSBvYmplY3QgdG8gYXBwbHkgdGhlIG1ldGhvZHMgdG8uXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgVGhlIGRlZmluaXRpb24gb2YgdGhlIGxvY2FsIGFuZCByZW1vdGUgaW50ZXJmYWNlIHRvIGltcGxlbWVudC5cclxuICogQGNmZyB7T2JqZWN0fSBsb2NhbCBUaGUgbG9jYWwgaW50ZXJmYWNlIHRvIGV4cG9zZS5cclxuICogQGNmZyB7T2JqZWN0fSByZW1vdGUgVGhlIHJlbW90ZSBtZXRob2RzIHRvIGV4cG9zZSB0aHJvdWdoIHRoZSBwcm94eS5cclxuICogQGNmZyB7T2JqZWN0fSBzZXJpYWxpemVyIFRoZSBzZXJpYWxpemVyIHRvIHVzZSBmb3Igc2VyaWFsaXppbmcgYW5kIGRlc2VyaWFsaXppbmcgdGhlIEpTT04uIFNob3VsZCBiZSBjb21wYXRpYmxlIHdpdGggdGhlIEhUTUw1IEpTT04gb2JqZWN0LiBPcHRpb25hbCwgd2lsbCBkZWZhdWx0IHRvIEpTT04uXHJcbiAqL1xyXG5lYXN5WERNLnN0YWNrLlJwY0JlaGF2aW9yID0gZnVuY3Rpb24ocHJveHksIGNvbmZpZyl7XHJcbiAgICB2YXIgcHViLCBzZXJpYWxpemVyID0gY29uZmlnLnNlcmlhbGl6ZXIgfHwgZ2V0SlNPTigpO1xyXG4gICAgdmFyIF9jYWxsYmFja0NvdW50ZXIgPSAwLCBfY2FsbGJhY2tzID0ge307XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXJpYWxpemVzIGFuZCBzZW5kcyB0aGUgbWVzc2FnZVxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhIFRoZSBKU09OLVJQQyBtZXNzYWdlIHRvIGJlIHNlbnQuIFRoZSBqc29ucnBjIHByb3BlcnR5IHdpbGwgYmUgYWRkZWQuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIF9zZW5kKGRhdGEpe1xyXG4gICAgICAgIGRhdGEuanNvbnJwYyA9IFwiMi4wXCI7XHJcbiAgICAgICAgcHViLmRvd24ub3V0Z29pbmcoc2VyaWFsaXplci5zdHJpbmdpZnkoZGF0YSkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIG1ldGhvZCB0aGF0IGltcGxlbWVudHMgdGhlIGdpdmVuIGRlZmluaXRpb25cclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gVGhlIG1ldGhvZCBjb25maWd1cmF0aW9uXHJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbWV0aG9kIFRoZSBuYW1lIG9mIHRoZSBtZXRob2RcclxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBBIHN0dWIgY2FwYWJsZSBvZiBwcm94eWluZyB0aGUgcmVxdWVzdGVkIG1ldGhvZCBjYWxsXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIF9jcmVhdGVNZXRob2QoZGVmaW5pdGlvbiwgbWV0aG9kKXtcclxuICAgICAgICB2YXIgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7XHJcblxyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB2YXIgbCA9IGFyZ3VtZW50cy5sZW5ndGgsIGNhbGxiYWNrLCBtZXNzYWdlID0ge1xyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBtZXRob2RcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGlmIChsID4gMCAmJiB0eXBlb2YgYXJndW1lbnRzW2wgLSAxXSA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAvL3dpdGggY2FsbGJhY2ssIHByb2NlZHVyZVxyXG4gICAgICAgICAgICAgICAgaWYgKGwgPiAxICYmIHR5cGVvZiBhcmd1bWVudHNbbCAtIDJdID09PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyB0d28gY2FsbGJhY2tzLCBzdWNjZXNzIGFuZCBlcnJvclxyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBhcmd1bWVudHNbbCAtIDJdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogYXJndW1lbnRzW2wgLSAxXVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZS5wYXJhbXMgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMCwgbCAtIDIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gc2luZ2xlIGNhbGxiYWNrLCBzdWNjZXNzXHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGFyZ3VtZW50c1tsIC0gMV1cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UucGFyYW1zID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDAsIGwgLSAxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIF9jYWxsYmFja3NbXCJcIiArICgrK19jYWxsYmFja0NvdW50ZXIpXSA9IGNhbGxiYWNrO1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZS5pZCA9IF9jYWxsYmFja0NvdW50ZXI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBubyBjYWxsYmFja3MsIGEgbm90aWZpY2F0aW9uXHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlLnBhcmFtcyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZGVmaW5pdGlvbi5uYW1lZFBhcmFtcyAmJiBtZXNzYWdlLnBhcmFtcy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2UucGFyYW1zID0gbWVzc2FnZS5wYXJhbXNbMF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gU2VuZCB0aGUgbWV0aG9kIHJlcXVlc3RcclxuICAgICAgICAgICAgX3NlbmQobWVzc2FnZSk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEV4ZWN1dGVzIHRoZSBleHBvc2VkIG1ldGhvZFxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtZXRob2QgVGhlIG5hbWUgb2YgdGhlIG1ldGhvZFxyXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGlkIFRoZSBjYWxsYmFjayBpZCB0byB1c2VcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IG1ldGhvZCBUaGUgZXhwb3NlZCBpbXBsZW1lbnRhdGlvblxyXG4gICAgICogQHBhcmFtIHtBcnJheX0gcGFyYW1zIFRoZSBwYXJhbWV0ZXJzIHN1cHBsaWVkIGJ5IHRoZSByZW1vdGUgZW5kXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIF9leGVjdXRlTWV0aG9kKG1ldGhvZCwgaWQsIGZuLCBwYXJhbXMpe1xyXG4gICAgICAgIGlmICghZm4pIHtcclxuICAgICAgICAgICAgaWYgKGlkKSB7XHJcbiAgICAgICAgICAgICAgICBfc2VuZCh7XHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLFxyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IC0zMjYwMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogXCJQcm9jZWR1cmUgbm90IGZvdW5kLlwiXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHN1Y2Nlc3MsIGVycm9yO1xyXG4gICAgICAgIGlmIChpZCkge1xyXG4gICAgICAgICAgICBzdWNjZXNzID0gZnVuY3Rpb24ocmVzdWx0KXtcclxuICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBlbXB0eUZuO1xyXG4gICAgICAgICAgICAgICAgX3NlbmQoe1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBpZCxcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IHJlc3VsdFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGVycm9yID0gZnVuY3Rpb24obWVzc2FnZSwgZGF0YSl7XHJcbiAgICAgICAgICAgICAgICBlcnJvciA9IGVtcHR5Rm47XHJcbiAgICAgICAgICAgICAgICB2YXIgbXNnID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBpZCxcclxuICAgICAgICAgICAgICAgICAgICBlcnJvcjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiAtMzIwOTksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2VcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBtc2cuZXJyb3IuZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBfc2VuZChtc2cpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgc3VjY2VzcyA9IGVycm9yID0gZW1wdHlGbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gQ2FsbCBsb2NhbCBtZXRob2RcclxuICAgICAgICBpZiAoIWlzQXJyYXkocGFyYW1zKSkge1xyXG4gICAgICAgICAgICBwYXJhbXMgPSBbcGFyYW1zXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGZuLm1ldGhvZC5hcHBseShmbi5zY29wZSwgcGFyYW1zLmNvbmNhdChbc3VjY2VzcywgZXJyb3JdKSk7XHJcbiAgICAgICAgICAgIGlmICghdW5kZWYocmVzdWx0KSkge1xyXG4gICAgICAgICAgICAgICAgc3VjY2VzcyhyZXN1bHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChleDEpIHtcclxuICAgICAgICAgICAgZXJyb3IoZXgxLm1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gKHB1YiA9IHtcclxuICAgICAgICBpbmNvbWluZzogZnVuY3Rpb24obWVzc2FnZSwgb3JpZ2luKXtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBzZXJpYWxpemVyLnBhcnNlKG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5tZXRob2QpIHtcclxuICAgICAgICAgICAgICAgIC8vIEEgbWV0aG9kIGNhbGwgZnJvbSB0aGUgcmVtb3RlIGVuZFxyXG4gICAgICAgICAgICAgICAgaWYgKGNvbmZpZy5oYW5kbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25maWcuaGFuZGxlKGRhdGEsIF9zZW5kKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9leGVjdXRlTWV0aG9kKGRhdGEubWV0aG9kLCBkYXRhLmlkLCBjb25maWcubG9jYWxbZGF0YS5tZXRob2RdLCBkYXRhLnBhcmFtcyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBBIG1ldGhvZCByZXNwb25zZSBmcm9tIHRoZSBvdGhlciBlbmRcclxuICAgICAgICAgICAgICAgIHZhciBjYWxsYmFjayA9IF9jYWxsYmFja3NbZGF0YS5pZF07XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5lcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjay5lcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5lcnJvcihkYXRhLmVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjYWxsYmFjay5zdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2suc3VjY2VzcyhkYXRhLnJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgX2NhbGxiYWNrc1tkYXRhLmlkXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgaWYgKGNvbmZpZy5yZW1vdGUpIHtcclxuICAgICAgICAgICAgICAgIC8vIEltcGxlbWVudCB0aGUgcmVtb3RlIHNpZGVzIGV4cG9zZWQgbWV0aG9kc1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgbWV0aG9kIGluIGNvbmZpZy5yZW1vdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmlnLnJlbW90ZS5oYXNPd25Qcm9wZXJ0eShtZXRob2QpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3h5W21ldGhvZF0gPSBfY3JlYXRlTWV0aG9kKGNvbmZpZy5yZW1vdGVbbWV0aG9kXSwgbWV0aG9kKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcHViLmRvd24uaW5pdCgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGVzdHJveTogZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgZm9yICh2YXIgbWV0aG9kIGluIGNvbmZpZy5yZW1vdGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjb25maWcucmVtb3RlLmhhc093blByb3BlcnR5KG1ldGhvZCkgJiYgcHJveHkuaGFzT3duUHJvcGVydHkobWV0aG9kKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBwcm94eVttZXRob2RdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHB1Yi5kb3duLmRlc3Ryb3koKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufTtcclxud2luZG93LmVhc3lYRE0gPSBlYXN5WERNO1xyXG59KSh3aW5kb3csIGRvY3VtZW50LCBsb2NhdGlvbiwgd2luZG93LnNldFRpbWVvdXQsIGRlY29kZVVSSUNvbXBvbmVudCwgZW5jb2RlVVJJQ29tcG9uZW50KTtcclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3ZlbmRvcnMvZWFzeVhETS5qcyIsIi8qKlxuICogLT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT1cbiAqIFRoZSBuZXcgT21pc2UuanNcbiAqIC09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09XG4gKi9cbmltcG9ydCAnaGVscGVycy9wb2x5ZmlsbCdcblxuaW1wb3J0ICd2ZW5kb3JzL2Vhc3lYRE0uanMnXG5cbmltcG9ydCBjb25maWcgZnJvbSAnLi9jb25maWcnXG5pbXBvcnQgT21pc2UgZnJvbSAnLi9PbWlzZSdcbmltcG9ydCBPbWlzZUNhcmQgZnJvbSAnLi9PbWlzZUNhcmQnXG5cbmV4cG9ydCBkZWZhdWx0IE9taXNlXG5cbmdsb2JhbC5PbWlzZSA9IG5ldyBPbWlzZShjb25maWcpXG5nbG9iYWwuT21pc2VDYXJkID0gbmV3IE9taXNlQ2FyZChjb25maWcpXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvaW5kZXguanMiLCIvKipcbiAqIC09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09XG4gKiBQb3N0IG1lc3NhZ2VcbiAqIC09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09LT0tPS09XG4gKi9cbmltcG9ydCBjb25maWcgZnJvbSAnLi9jb25maWcnXG5pbXBvcnQgeyBzYWZlSnNvblBhcnNlIH0gZnJvbSAnaGVscGVycy91dGlscydcblxuZXhwb3J0IGNvbnN0IG1lc3NhZ2VUeXBlID0ge1xuICBDTE9TRV9JRlJBTUU6ICdDTE9TRV9JRlJBTUUnLFxuICBTSE9XX0lGUkFNRV9BUFBfRk9STTogJ1NIT1dfSUZSQU1FX0FQUF9GT1JNJyxcbiAgQ0xPU0VfQU5EX1NFTkRfVE9LRU46ICdDTE9TRV9BTkRfU0VORF9UT0tFTicsXG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGxpc3Rlbk1lc3NhZ2UoT21pc2VDYXJkSW5zdGFuY2UpIHtcbiAgZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgJ21lc3NhZ2UnLFxuICAgIHJlY2VpdmVNZXNzYWdlID0+IHtcbiAgICAgIGNvbnN0IG1lc3NhZ2VEYXRhID0gc2FmZUpzb25QYXJzZShyZWNlaXZlTWVzc2FnZS5kYXRhKVxuICAgICAgY29uc3QgeyB0eXBlLCBkYXRhIH0gPSBtZXNzYWdlRGF0YVxuICAgICAgbWVzc2FnZVR5cGVIYW5kbGVyKE9taXNlQ2FyZEluc3RhbmNlLCB0eXBlLCBkYXRhKVxuICAgIH0sXG4gICAgZmFsc2VcbiAgKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbWVzc2FnZVNob3dJZnJhbWVBcHBGb3JtKHRhcmdldCwgZGF0YSkge1xuICBwb3N0TWVzc2FnZSh0YXJnZXQsIG1lc3NhZ2VUeXBlLlNIT1dfSUZSQU1FX0FQUF9GT1JNLCBkYXRhLCBjb25maWcuY2FyZEhvc3QpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtZXNzYWdlQ2xvc2VJZnJhbWUoKSB7XG4gIHBvc3RNZXNzYWdlKHBhcmVudC53aW5kb3csIG1lc3NhZ2VUeXBlLkNMT1NFX0lGUkFNRSwgbnVsbCwgJyonKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbWVzc2FnZUNsb3NlQW5kU2VuZFRva2VuKHRva2VuKSB7XG4gIHBvc3RNZXNzYWdlKHBhcmVudC53aW5kb3csIG1lc3NhZ2VUeXBlLkNMT1NFX0FORF9TRU5EX1RPS0VOLCB0b2tlbiwgJyonKVxufVxuXG5mdW5jdGlvbiBtZXNzYWdlVHlwZUhhbmRsZXIoT21pc2VDYXJkSW5zdGFuY2UsIHR5cGUsIGRhdGEpIHtcbiAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSBtZXNzYWdlVHlwZS5DTE9TRV9JRlJBTUU6XG4gICAgICBPbWlzZUNhcmRJbnN0YW5jZS5jbG9zZSgpXG4gICAgICBicmVha1xuICAgIGNhc2UgbWVzc2FnZVR5cGUuQ0xPU0VfQU5EX1NFTkRfVE9LRU46XG4gICAgICBPbWlzZUNhcmRJbnN0YW5jZS5jbG9zZSgpXG4gICAgICBPbWlzZUNhcmRJbnN0YW5jZS5zZXRUb2tlbkF0T21pc2VUb2tlbkZpZWxkKGRhdGEpXG4gICAgICBicmVha1xuICB9XG59XG5cbmZ1bmN0aW9uIHBvc3RNZXNzYWdlKHRhcmdldCwgdHlwZSwgZGF0YSwgdGFyZ2V0T3JpZ2luKSB7XG4gIGNvbnN0IG1lc3NhZ2VEYXRhID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgIHR5cGUsXG4gICAgZGF0YSxcbiAgfSlcblxuICB0YXJnZXQucG9zdE1lc3NhZ2UobWVzc2FnZURhdGEsIHRhcmdldE9yaWdpbilcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9tZXNzYWdlLmpzIiwiKGZ1bmN0aW9uKG1vZHVsZSkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIG1vZHVsZS5leHBvcnRzLmlzX3VyaSA9IGlzX2lyaTtcbiAgICBtb2R1bGUuZXhwb3J0cy5pc19odHRwX3VyaSA9IGlzX2h0dHBfaXJpO1xuICAgIG1vZHVsZS5leHBvcnRzLmlzX2h0dHBzX3VyaSA9IGlzX2h0dHBzX2lyaTtcbiAgICBtb2R1bGUuZXhwb3J0cy5pc193ZWJfdXJpID0gaXNfd2ViX2lyaTtcbiAgICAvLyBDcmVhdGUgYWxpYXNlc1xuICAgIG1vZHVsZS5leHBvcnRzLmlzVXJpID0gaXNfaXJpO1xuICAgIG1vZHVsZS5leHBvcnRzLmlzSHR0cFVyaSA9IGlzX2h0dHBfaXJpO1xuICAgIG1vZHVsZS5leHBvcnRzLmlzSHR0cHNVcmkgPSBpc19odHRwc19pcmk7XG4gICAgbW9kdWxlLmV4cG9ydHMuaXNXZWJVcmkgPSBpc193ZWJfaXJpO1xuXG5cbiAgICAvLyBwcml2YXRlIGZ1bmN0aW9uXG4gICAgLy8gaW50ZXJuYWwgVVJJIHNwaXR0ZXIgbWV0aG9kIC0gZGlyZWN0IGZyb20gUkZDIDM5ODZcbiAgICB2YXIgc3BsaXRVcmkgPSBmdW5jdGlvbih1cmkpIHtcbiAgICAgICAgdmFyIHNwbGl0dGVkID0gdXJpLm1hdGNoKC8oPzooW146XFwvPyNdKyk6KT8oPzpcXC9cXC8oW15cXC8/I10qKSk/KFtePyNdKikoPzpcXD8oW14jXSopKT8oPzojKC4qKSk/Lyk7XG4gICAgICAgIHJldHVybiBzcGxpdHRlZDtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gaXNfaXJpKHZhbHVlKSB7XG4gICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNoZWNrIGZvciBpbGxlZ2FsIGNoYXJhY3RlcnNcbiAgICAgICAgaWYgKC9bXmEtejAtOVxcOlxcL1xcP1xcI1xcW1xcXVxcQFxcIVxcJFxcJlxcJ1xcKFxcKVxcKlxcK1xcLFxcO1xcPVxcLlxcLVxcX1xcflxcJV0vaS50ZXN0KHZhbHVlKSkgcmV0dXJuO1xuXG4gICAgICAgIC8vIGNoZWNrIGZvciBoZXggZXNjYXBlcyB0aGF0IGFyZW4ndCBjb21wbGV0ZVxuICAgICAgICBpZiAoLyVbXjAtOWEtZl0vaS50ZXN0KHZhbHVlKSkgcmV0dXJuO1xuICAgICAgICBpZiAoLyVbMC05YS1mXSg6P1teMC05YS1mXXwkKS9pLnRlc3QodmFsdWUpKSByZXR1cm47XG5cbiAgICAgICAgdmFyIHNwbGl0dGVkID0gW107XG4gICAgICAgIHZhciBzY2hlbWUgPSAnJztcbiAgICAgICAgdmFyIGF1dGhvcml0eSA9ICcnO1xuICAgICAgICB2YXIgcGF0aCA9ICcnO1xuICAgICAgICB2YXIgcXVlcnkgPSAnJztcbiAgICAgICAgdmFyIGZyYWdtZW50ID0gJyc7XG4gICAgICAgIHZhciBvdXQgPSAnJztcblxuICAgICAgICAvLyBmcm9tIFJGQyAzOTg2XG4gICAgICAgIHNwbGl0dGVkID0gc3BsaXRVcmkodmFsdWUpO1xuICAgICAgICBzY2hlbWUgPSBzcGxpdHRlZFsxXTsgXG4gICAgICAgIGF1dGhvcml0eSA9IHNwbGl0dGVkWzJdO1xuICAgICAgICBwYXRoID0gc3BsaXR0ZWRbM107XG4gICAgICAgIHF1ZXJ5ID0gc3BsaXR0ZWRbNF07XG4gICAgICAgIGZyYWdtZW50ID0gc3BsaXR0ZWRbNV07XG5cbiAgICAgICAgLy8gc2NoZW1lIGFuZCBwYXRoIGFyZSByZXF1aXJlZCwgdGhvdWdoIHRoZSBwYXRoIGNhbiBiZSBlbXB0eVxuICAgICAgICBpZiAoIShzY2hlbWUgJiYgc2NoZW1lLmxlbmd0aCAmJiBwYXRoLmxlbmd0aCA+PSAwKSkgcmV0dXJuO1xuXG4gICAgICAgIC8vIGlmIGF1dGhvcml0eSBpcyBwcmVzZW50LCB0aGUgcGF0aCBtdXN0IGJlIGVtcHR5IG9yIGJlZ2luIHdpdGggYSAvXG4gICAgICAgIGlmIChhdXRob3JpdHkgJiYgYXV0aG9yaXR5Lmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKCEocGF0aC5sZW5ndGggPT09IDAgfHwgL15cXC8vLnRlc3QocGF0aCkpKSByZXR1cm47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBpZiBhdXRob3JpdHkgaXMgbm90IHByZXNlbnQsIHRoZSBwYXRoIG11c3Qgbm90IHN0YXJ0IHdpdGggLy9cbiAgICAgICAgICAgIGlmICgvXlxcL1xcLy8udGVzdChwYXRoKSkgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gc2NoZW1lIG11c3QgYmVnaW4gd2l0aCBhIGxldHRlciwgdGhlbiBjb25zaXN0IG9mIGxldHRlcnMsIGRpZ2l0cywgKywgLiwgb3IgLVxuICAgICAgICBpZiAoIS9eW2Etel1bYS16MC05XFwrXFwtXFwuXSokLy50ZXN0KHNjaGVtZS50b0xvd2VyQ2FzZSgpKSkgIHJldHVybjtcblxuICAgICAgICAvLyByZS1hc3NlbWJsZSB0aGUgVVJMIHBlciBzZWN0aW9uIDUuMyBpbiBSRkMgMzk4NlxuICAgICAgICBvdXQgKz0gc2NoZW1lICsgJzonO1xuICAgICAgICBpZiAoYXV0aG9yaXR5ICYmIGF1dGhvcml0eS5sZW5ndGgpIHtcbiAgICAgICAgICAgIG91dCArPSAnLy8nICsgYXV0aG9yaXR5O1xuICAgICAgICB9XG5cbiAgICAgICAgb3V0ICs9IHBhdGg7XG5cbiAgICAgICAgaWYgKHF1ZXJ5ICYmIHF1ZXJ5Lmxlbmd0aCkge1xuICAgICAgICAgICAgb3V0ICs9ICc/JyArIHF1ZXJ5O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGZyYWdtZW50ICYmIGZyYWdtZW50Lmxlbmd0aCkge1xuICAgICAgICAgICAgb3V0ICs9ICcjJyArIGZyYWdtZW50O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc19odHRwX2lyaSh2YWx1ZSwgYWxsb3dIdHRwcykge1xuICAgICAgICBpZiAoIWlzX2lyaSh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzcGxpdHRlZCA9IFtdO1xuICAgICAgICB2YXIgc2NoZW1lID0gJyc7XG4gICAgICAgIHZhciBhdXRob3JpdHkgPSAnJztcbiAgICAgICAgdmFyIHBhdGggPSAnJztcbiAgICAgICAgdmFyIHBvcnQgPSAnJztcbiAgICAgICAgdmFyIHF1ZXJ5ID0gJyc7XG4gICAgICAgIHZhciBmcmFnbWVudCA9ICcnO1xuICAgICAgICB2YXIgb3V0ID0gJyc7XG5cbiAgICAgICAgLy8gZnJvbSBSRkMgMzk4NlxuICAgICAgICBzcGxpdHRlZCA9IHNwbGl0VXJpKHZhbHVlKTtcbiAgICAgICAgc2NoZW1lID0gc3BsaXR0ZWRbMV07IFxuICAgICAgICBhdXRob3JpdHkgPSBzcGxpdHRlZFsyXTtcbiAgICAgICAgcGF0aCA9IHNwbGl0dGVkWzNdO1xuICAgICAgICBxdWVyeSA9IHNwbGl0dGVkWzRdO1xuICAgICAgICBmcmFnbWVudCA9IHNwbGl0dGVkWzVdO1xuXG4gICAgICAgIGlmICghc2NoZW1lKSAgcmV0dXJuO1xuXG4gICAgICAgIGlmKGFsbG93SHR0cHMpIHtcbiAgICAgICAgICAgIGlmIChzY2hlbWUudG9Mb3dlckNhc2UoKSAhPSAnaHR0cHMnKSByZXR1cm47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoc2NoZW1lLnRvTG93ZXJDYXNlKCkgIT0gJ2h0dHAnKSByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBmdWxseS1xdWFsaWZpZWQgVVJJcyBtdXN0IGhhdmUgYW4gYXV0aG9yaXR5IHNlY3Rpb24gdGhhdCBpc1xuICAgICAgICAvLyBhIHZhbGlkIGhvc3RcbiAgICAgICAgaWYgKCFhdXRob3JpdHkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGVuYWJsZSBwb3J0IGNvbXBvbmVudFxuICAgICAgICBpZiAoLzooXFxkKykkLy50ZXN0KGF1dGhvcml0eSkpIHtcbiAgICAgICAgICAgIHBvcnQgPSBhdXRob3JpdHkubWF0Y2goLzooXFxkKykkLylbMF07XG4gICAgICAgICAgICBhdXRob3JpdHkgPSBhdXRob3JpdHkucmVwbGFjZSgvOlxcZCskLywgJycpO1xuICAgICAgICB9XG5cbiAgICAgICAgb3V0ICs9IHNjaGVtZSArICc6JztcbiAgICAgICAgb3V0ICs9ICcvLycgKyBhdXRob3JpdHk7XG4gICAgICAgIFxuICAgICAgICBpZiAocG9ydCkge1xuICAgICAgICAgICAgb3V0ICs9IHBvcnQ7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIG91dCArPSBwYXRoO1xuICAgICAgICBcbiAgICAgICAgaWYocXVlcnkgJiYgcXVlcnkubGVuZ3RoKXtcbiAgICAgICAgICAgIG91dCArPSAnPycgKyBxdWVyeTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKGZyYWdtZW50ICYmIGZyYWdtZW50Lmxlbmd0aCl7XG4gICAgICAgICAgICBvdXQgKz0gJyMnICsgZnJhZ21lbnQ7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaXNfaHR0cHNfaXJpKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBpc19odHRwX2lyaSh2YWx1ZSwgdHJ1ZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaXNfd2ViX2lyaSh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gKGlzX2h0dHBfaXJpKHZhbHVlKSB8fCBpc19odHRwc19pcmkodmFsdWUpKTtcbiAgICB9XG5cbn0pKG1vZHVsZSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vdmFsaWQtdXJsL2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSA5XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obW9kdWxlKSB7XHJcblx0aWYoIW1vZHVsZS53ZWJwYWNrUG9seWZpbGwpIHtcclxuXHRcdG1vZHVsZS5kZXByZWNhdGUgPSBmdW5jdGlvbigpIHt9O1xyXG5cdFx0bW9kdWxlLnBhdGhzID0gW107XHJcblx0XHQvLyBtb2R1bGUucGFyZW50ID0gdW5kZWZpbmVkIGJ5IGRlZmF1bHRcclxuXHRcdGlmKCFtb2R1bGUuY2hpbGRyZW4pIG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xyXG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG1vZHVsZSwgXCJsb2FkZWRcIiwge1xyXG5cdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxyXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHJldHVybiBtb2R1bGUubDtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobW9kdWxlLCBcImlkXCIsIHtcclxuXHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcclxuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRyZXR1cm4gbW9kdWxlLmk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0bW9kdWxlLndlYnBhY2tQb2x5ZmlsbCA9IDE7XHJcblx0fVxyXG5cdHJldHVybiBtb2R1bGU7XHJcbn07XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vICh3ZWJwYWNrKS9idWlsZGluL21vZHVsZS5qc1xuLy8gbW9kdWxlIGlkID0gMTBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiKGZ1bmN0aW9uKHNlbGYpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGlmIChzZWxmLmZldGNoKSB7XG4gICAgcmV0dXJuXG4gIH1cblxuICB2YXIgc3VwcG9ydCA9IHtcbiAgICBzZWFyY2hQYXJhbXM6ICdVUkxTZWFyY2hQYXJhbXMnIGluIHNlbGYsXG4gICAgaXRlcmFibGU6ICdTeW1ib2wnIGluIHNlbGYgJiYgJ2l0ZXJhdG9yJyBpbiBTeW1ib2wsXG4gICAgYmxvYjogJ0ZpbGVSZWFkZXInIGluIHNlbGYgJiYgJ0Jsb2InIGluIHNlbGYgJiYgKGZ1bmN0aW9uKCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgbmV3IEJsb2IoKVxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfSBjYXRjaChlKSB7XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgfVxuICAgIH0pKCksXG4gICAgZm9ybURhdGE6ICdGb3JtRGF0YScgaW4gc2VsZixcbiAgICBhcnJheUJ1ZmZlcjogJ0FycmF5QnVmZmVyJyBpbiBzZWxmXG4gIH1cblxuICBpZiAoc3VwcG9ydC5hcnJheUJ1ZmZlcikge1xuICAgIHZhciB2aWV3Q2xhc3NlcyA9IFtcbiAgICAgICdbb2JqZWN0IEludDhBcnJheV0nLFxuICAgICAgJ1tvYmplY3QgVWludDhBcnJheV0nLFxuICAgICAgJ1tvYmplY3QgVWludDhDbGFtcGVkQXJyYXldJyxcbiAgICAgICdbb2JqZWN0IEludDE2QXJyYXldJyxcbiAgICAgICdbb2JqZWN0IFVpbnQxNkFycmF5XScsXG4gICAgICAnW29iamVjdCBJbnQzMkFycmF5XScsXG4gICAgICAnW29iamVjdCBVaW50MzJBcnJheV0nLFxuICAgICAgJ1tvYmplY3QgRmxvYXQzMkFycmF5XScsXG4gICAgICAnW29iamVjdCBGbG9hdDY0QXJyYXldJ1xuICAgIF1cblxuICAgIHZhciBpc0RhdGFWaWV3ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gb2JqICYmIERhdGFWaWV3LnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKG9iailcbiAgICB9XG5cbiAgICB2YXIgaXNBcnJheUJ1ZmZlclZpZXcgPSBBcnJheUJ1ZmZlci5pc1ZpZXcgfHwgZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gb2JqICYmIHZpZXdDbGFzc2VzLmluZGV4T2YoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikpID4gLTFcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBub3JtYWxpemVOYW1lKG5hbWUpIHtcbiAgICBpZiAodHlwZW9mIG5hbWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICBuYW1lID0gU3RyaW5nKG5hbWUpXG4gICAgfVxuICAgIGlmICgvW15hLXowLTlcXC0jJCUmJyorLlxcXl9gfH5dL2kudGVzdChuYW1lKSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBjaGFyYWN0ZXIgaW4gaGVhZGVyIGZpZWxkIG5hbWUnKVxuICAgIH1cbiAgICByZXR1cm4gbmFtZS50b0xvd2VyQ2FzZSgpXG4gIH1cblxuICBmdW5jdGlvbiBub3JtYWxpemVWYWx1ZSh2YWx1ZSkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICB2YWx1ZSA9IFN0cmluZyh2YWx1ZSlcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlXG4gIH1cblxuICAvLyBCdWlsZCBhIGRlc3RydWN0aXZlIGl0ZXJhdG9yIGZvciB0aGUgdmFsdWUgbGlzdFxuICBmdW5jdGlvbiBpdGVyYXRvckZvcihpdGVtcykge1xuICAgIHZhciBpdGVyYXRvciA9IHtcbiAgICAgIG5leHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBpdGVtcy5zaGlmdCgpXG4gICAgICAgIHJldHVybiB7ZG9uZTogdmFsdWUgPT09IHVuZGVmaW5lZCwgdmFsdWU6IHZhbHVlfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChzdXBwb3J0Lml0ZXJhYmxlKSB7XG4gICAgICBpdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBpdGVyYXRvclxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBpdGVyYXRvclxuICB9XG5cbiAgZnVuY3Rpb24gSGVhZGVycyhoZWFkZXJzKSB7XG4gICAgdGhpcy5tYXAgPSB7fVxuXG4gICAgaWYgKGhlYWRlcnMgaW5zdGFuY2VvZiBIZWFkZXJzKSB7XG4gICAgICBoZWFkZXJzLmZvckVhY2goZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcbiAgICAgICAgdGhpcy5hcHBlbmQobmFtZSwgdmFsdWUpXG4gICAgICB9LCB0aGlzKVxuICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShoZWFkZXJzKSkge1xuICAgICAgaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uKGhlYWRlcikge1xuICAgICAgICB0aGlzLmFwcGVuZChoZWFkZXJbMF0sIGhlYWRlclsxXSlcbiAgICAgIH0sIHRoaXMpXG4gICAgfSBlbHNlIGlmIChoZWFkZXJzKSB7XG4gICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhoZWFkZXJzKS5mb3JFYWNoKGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgICAgdGhpcy5hcHBlbmQobmFtZSwgaGVhZGVyc1tuYW1lXSlcbiAgICAgIH0sIHRoaXMpXG4gICAgfVxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuYXBwZW5kID0gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgICBuYW1lID0gbm9ybWFsaXplTmFtZShuYW1lKVxuICAgIHZhbHVlID0gbm9ybWFsaXplVmFsdWUodmFsdWUpXG4gICAgdmFyIG9sZFZhbHVlID0gdGhpcy5tYXBbbmFtZV1cbiAgICB0aGlzLm1hcFtuYW1lXSA9IG9sZFZhbHVlID8gb2xkVmFsdWUrJywnK3ZhbHVlIDogdmFsdWVcbiAgfVxuXG4gIEhlYWRlcnMucHJvdG90eXBlWydkZWxldGUnXSA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICBkZWxldGUgdGhpcy5tYXBbbm9ybWFsaXplTmFtZShuYW1lKV1cbiAgfVxuXG4gIEhlYWRlcnMucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICBuYW1lID0gbm9ybWFsaXplTmFtZShuYW1lKVxuICAgIHJldHVybiB0aGlzLmhhcyhuYW1lKSA/IHRoaXMubWFwW25hbWVdIDogbnVsbFxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuaGFzID0gZnVuY3Rpb24obmFtZSkge1xuICAgIHJldHVybiB0aGlzLm1hcC5oYXNPd25Qcm9wZXJ0eShub3JtYWxpemVOYW1lKG5hbWUpKVxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgICB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXSA9IG5vcm1hbGl6ZVZhbHVlKHZhbHVlKVxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uKGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgZm9yICh2YXIgbmFtZSBpbiB0aGlzLm1hcCkge1xuICAgICAgaWYgKHRoaXMubWFwLmhhc093blByb3BlcnR5KG5hbWUpKSB7XG4gICAgICAgIGNhbGxiYWNrLmNhbGwodGhpc0FyZywgdGhpcy5tYXBbbmFtZV0sIG5hbWUsIHRoaXMpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUua2V5cyA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBpdGVtcyA9IFtdXG4gICAgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7IGl0ZW1zLnB1c2gobmFtZSkgfSlcbiAgICByZXR1cm4gaXRlcmF0b3JGb3IoaXRlbXMpXG4gIH1cblxuICBIZWFkZXJzLnByb3RvdHlwZS52YWx1ZXMgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaXRlbXMgPSBbXVxuICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSkgeyBpdGVtcy5wdXNoKHZhbHVlKSB9KVxuICAgIHJldHVybiBpdGVyYXRvckZvcihpdGVtcylcbiAgfVxuXG4gIEhlYWRlcnMucHJvdG90eXBlLmVudHJpZXMgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaXRlbXMgPSBbXVxuICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSwgbmFtZSkgeyBpdGVtcy5wdXNoKFtuYW1lLCB2YWx1ZV0pIH0pXG4gICAgcmV0dXJuIGl0ZXJhdG9yRm9yKGl0ZW1zKVxuICB9XG5cbiAgaWYgKHN1cHBvcnQuaXRlcmFibGUpIHtcbiAgICBIZWFkZXJzLnByb3RvdHlwZVtTeW1ib2wuaXRlcmF0b3JdID0gSGVhZGVycy5wcm90b3R5cGUuZW50cmllc1xuICB9XG5cbiAgZnVuY3Rpb24gY29uc3VtZWQoYm9keSkge1xuICAgIGlmIChib2R5LmJvZHlVc2VkKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFR5cGVFcnJvcignQWxyZWFkeSByZWFkJykpXG4gICAgfVxuICAgIGJvZHkuYm9keVVzZWQgPSB0cnVlXG4gIH1cblxuICBmdW5jdGlvbiBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXNvbHZlKHJlYWRlci5yZXN1bHQpXG4gICAgICB9XG4gICAgICByZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QocmVhZGVyLmVycm9yKVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICBmdW5jdGlvbiByZWFkQmxvYkFzQXJyYXlCdWZmZXIoYmxvYikge1xuICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpXG4gICAgdmFyIHByb21pc2UgPSBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKVxuICAgIHJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihibG9iKVxuICAgIHJldHVybiBwcm9taXNlXG4gIH1cblxuICBmdW5jdGlvbiByZWFkQmxvYkFzVGV4dChibG9iKSB7XG4gICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKClcbiAgICB2YXIgcHJvbWlzZSA9IGZpbGVSZWFkZXJSZWFkeShyZWFkZXIpXG4gICAgcmVhZGVyLnJlYWRBc1RleHQoYmxvYilcbiAgICByZXR1cm4gcHJvbWlzZVxuICB9XG5cbiAgZnVuY3Rpb24gcmVhZEFycmF5QnVmZmVyQXNUZXh0KGJ1Zikge1xuICAgIHZhciB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoYnVmKVxuICAgIHZhciBjaGFycyA9IG5ldyBBcnJheSh2aWV3Lmxlbmd0aClcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmlldy5sZW5ndGg7IGkrKykge1xuICAgICAgY2hhcnNbaV0gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHZpZXdbaV0pXG4gICAgfVxuICAgIHJldHVybiBjaGFycy5qb2luKCcnKVxuICB9XG5cbiAgZnVuY3Rpb24gYnVmZmVyQ2xvbmUoYnVmKSB7XG4gICAgaWYgKGJ1Zi5zbGljZSkge1xuICAgICAgcmV0dXJuIGJ1Zi5zbGljZSgwKVxuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgdmlldyA9IG5ldyBVaW50OEFycmF5KGJ1Zi5ieXRlTGVuZ3RoKVxuICAgICAgdmlldy5zZXQobmV3IFVpbnQ4QXJyYXkoYnVmKSlcbiAgICAgIHJldHVybiB2aWV3LmJ1ZmZlclxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIEJvZHkoKSB7XG4gICAgdGhpcy5ib2R5VXNlZCA9IGZhbHNlXG5cbiAgICB0aGlzLl9pbml0Qm9keSA9IGZ1bmN0aW9uKGJvZHkpIHtcbiAgICAgIHRoaXMuX2JvZHlJbml0ID0gYm9keVxuICAgICAgaWYgKCFib2R5KSB7XG4gICAgICAgIHRoaXMuX2JvZHlUZXh0ID0gJydcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGJvZHkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRoaXMuX2JvZHlUZXh0ID0gYm9keVxuICAgICAgfSBlbHNlIGlmIChzdXBwb3J0LmJsb2IgJiYgQmxvYi5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICB0aGlzLl9ib2R5QmxvYiA9IGJvZHlcbiAgICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5mb3JtRGF0YSAmJiBGb3JtRGF0YS5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICB0aGlzLl9ib2R5Rm9ybURhdGEgPSBib2R5XG4gICAgICB9IGVsc2UgaWYgKHN1cHBvcnQuc2VhcmNoUGFyYW1zICYmIFVSTFNlYXJjaFBhcmFtcy5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICB0aGlzLl9ib2R5VGV4dCA9IGJvZHkudG9TdHJpbmcoKVxuICAgICAgfSBlbHNlIGlmIChzdXBwb3J0LmFycmF5QnVmZmVyICYmIHN1cHBvcnQuYmxvYiAmJiBpc0RhdGFWaWV3KGJvZHkpKSB7XG4gICAgICAgIHRoaXMuX2JvZHlBcnJheUJ1ZmZlciA9IGJ1ZmZlckNsb25lKGJvZHkuYnVmZmVyKVxuICAgICAgICAvLyBJRSAxMC0xMSBjYW4ndCBoYW5kbGUgYSBEYXRhVmlldyBib2R5LlxuICAgICAgICB0aGlzLl9ib2R5SW5pdCA9IG5ldyBCbG9iKFt0aGlzLl9ib2R5QXJyYXlCdWZmZXJdKVxuICAgICAgfSBlbHNlIGlmIChzdXBwb3J0LmFycmF5QnVmZmVyICYmIChBcnJheUJ1ZmZlci5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSB8fCBpc0FycmF5QnVmZmVyVmlldyhib2R5KSkpIHtcbiAgICAgICAgdGhpcy5fYm9keUFycmF5QnVmZmVyID0gYnVmZmVyQ2xvbmUoYm9keSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcigndW5zdXBwb3J0ZWQgQm9keUluaXQgdHlwZScpXG4gICAgICB9XG5cbiAgICAgIGlmICghdGhpcy5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJykpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBib2R5ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgIHRoaXMuaGVhZGVycy5zZXQoJ2NvbnRlbnQtdHlwZScsICd0ZXh0L3BsYWluO2NoYXJzZXQ9VVRGLTgnKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlCbG9iICYmIHRoaXMuX2JvZHlCbG9iLnR5cGUpIHtcbiAgICAgICAgICB0aGlzLmhlYWRlcnMuc2V0KCdjb250ZW50LXR5cGUnLCB0aGlzLl9ib2R5QmxvYi50eXBlKVxuICAgICAgICB9IGVsc2UgaWYgKHN1cHBvcnQuc2VhcmNoUGFyYW1zICYmIFVSTFNlYXJjaFBhcmFtcy5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICAgIHRoaXMuaGVhZGVycy5zZXQoJ2NvbnRlbnQtdHlwZScsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD1VVEYtOCcpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoc3VwcG9ydC5ibG9iKSB7XG4gICAgICB0aGlzLmJsb2IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHJlamVjdGVkID0gY29uc3VtZWQodGhpcylcbiAgICAgICAgaWYgKHJlamVjdGVkKSB7XG4gICAgICAgICAgcmV0dXJuIHJlamVjdGVkXG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fYm9keUJsb2IpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlCbG9iKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IEJsb2IoW3RoaXMuX2JvZHlBcnJheUJ1ZmZlcl0pKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlGb3JtRGF0YSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignY291bGQgbm90IHJlYWQgRm9ybURhdGEgYm9keSBhcyBibG9iJylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBCbG9iKFt0aGlzLl9ib2R5VGV4dF0pKVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRoaXMuYXJyYXlCdWZmZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikge1xuICAgICAgICAgIHJldHVybiBjb25zdW1lZCh0aGlzKSB8fCBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keUFycmF5QnVmZmVyKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB0aGlzLmJsb2IoKS50aGVuKHJlYWRCbG9iQXNBcnJheUJ1ZmZlcilcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMudGV4dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJlamVjdGVkID0gY29uc3VtZWQodGhpcylcbiAgICAgIGlmIChyZWplY3RlZCkge1xuICAgICAgICByZXR1cm4gcmVqZWN0ZWRcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX2JvZHlCbG9iKSB7XG4gICAgICAgIHJldHVybiByZWFkQmxvYkFzVGV4dCh0aGlzLl9ib2R5QmxvYilcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5fYm9keUFycmF5QnVmZmVyKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVhZEFycmF5QnVmZmVyQXNUZXh0KHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikpXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlGb3JtRGF0YSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvdWxkIG5vdCByZWFkIEZvcm1EYXRhIGJvZHkgYXMgdGV4dCcpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlUZXh0KVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChzdXBwb3J0LmZvcm1EYXRhKSB7XG4gICAgICB0aGlzLmZvcm1EYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRleHQoKS50aGVuKGRlY29kZSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmpzb24gPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLnRleHQoKS50aGVuKEpTT04ucGFyc2UpXG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIC8vIEhUVFAgbWV0aG9kcyB3aG9zZSBjYXBpdGFsaXphdGlvbiBzaG91bGQgYmUgbm9ybWFsaXplZFxuICB2YXIgbWV0aG9kcyA9IFsnREVMRVRFJywgJ0dFVCcsICdIRUFEJywgJ09QVElPTlMnLCAnUE9TVCcsICdQVVQnXVxuXG4gIGZ1bmN0aW9uIG5vcm1hbGl6ZU1ldGhvZChtZXRob2QpIHtcbiAgICB2YXIgdXBjYXNlZCA9IG1ldGhvZC50b1VwcGVyQ2FzZSgpXG4gICAgcmV0dXJuIChtZXRob2RzLmluZGV4T2YodXBjYXNlZCkgPiAtMSkgPyB1cGNhc2VkIDogbWV0aG9kXG4gIH1cblxuICBmdW5jdGlvbiBSZXF1ZXN0KGlucHV0LCBvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge31cbiAgICB2YXIgYm9keSA9IG9wdGlvbnMuYm9keVxuXG4gICAgaWYgKGlucHV0IGluc3RhbmNlb2YgUmVxdWVzdCkge1xuICAgICAgaWYgKGlucHV0LmJvZHlVc2VkKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FscmVhZHkgcmVhZCcpXG4gICAgICB9XG4gICAgICB0aGlzLnVybCA9IGlucHV0LnVybFxuICAgICAgdGhpcy5jcmVkZW50aWFscyA9IGlucHV0LmNyZWRlbnRpYWxzXG4gICAgICBpZiAoIW9wdGlvbnMuaGVhZGVycykge1xuICAgICAgICB0aGlzLmhlYWRlcnMgPSBuZXcgSGVhZGVycyhpbnB1dC5oZWFkZXJzKVxuICAgICAgfVxuICAgICAgdGhpcy5tZXRob2QgPSBpbnB1dC5tZXRob2RcbiAgICAgIHRoaXMubW9kZSA9IGlucHV0Lm1vZGVcbiAgICAgIGlmICghYm9keSAmJiBpbnB1dC5fYm9keUluaXQgIT0gbnVsbCkge1xuICAgICAgICBib2R5ID0gaW5wdXQuX2JvZHlJbml0XG4gICAgICAgIGlucHV0LmJvZHlVc2VkID0gdHJ1ZVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnVybCA9IFN0cmluZyhpbnB1dClcbiAgICB9XG5cbiAgICB0aGlzLmNyZWRlbnRpYWxzID0gb3B0aW9ucy5jcmVkZW50aWFscyB8fCB0aGlzLmNyZWRlbnRpYWxzIHx8ICdvbWl0J1xuICAgIGlmIChvcHRpb25zLmhlYWRlcnMgfHwgIXRoaXMuaGVhZGVycykge1xuICAgICAgdGhpcy5oZWFkZXJzID0gbmV3IEhlYWRlcnMob3B0aW9ucy5oZWFkZXJzKVxuICAgIH1cbiAgICB0aGlzLm1ldGhvZCA9IG5vcm1hbGl6ZU1ldGhvZChvcHRpb25zLm1ldGhvZCB8fCB0aGlzLm1ldGhvZCB8fCAnR0VUJylcbiAgICB0aGlzLm1vZGUgPSBvcHRpb25zLm1vZGUgfHwgdGhpcy5tb2RlIHx8IG51bGxcbiAgICB0aGlzLnJlZmVycmVyID0gbnVsbFxuXG4gICAgaWYgKCh0aGlzLm1ldGhvZCA9PT0gJ0dFVCcgfHwgdGhpcy5tZXRob2QgPT09ICdIRUFEJykgJiYgYm9keSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQm9keSBub3QgYWxsb3dlZCBmb3IgR0VUIG9yIEhFQUQgcmVxdWVzdHMnKVxuICAgIH1cbiAgICB0aGlzLl9pbml0Qm9keShib2R5KVxuICB9XG5cbiAgUmVxdWVzdC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IFJlcXVlc3QodGhpcywgeyBib2R5OiB0aGlzLl9ib2R5SW5pdCB9KVxuICB9XG5cbiAgZnVuY3Rpb24gZGVjb2RlKGJvZHkpIHtcbiAgICB2YXIgZm9ybSA9IG5ldyBGb3JtRGF0YSgpXG4gICAgYm9keS50cmltKCkuc3BsaXQoJyYnKS5mb3JFYWNoKGZ1bmN0aW9uKGJ5dGVzKSB7XG4gICAgICBpZiAoYnl0ZXMpIHtcbiAgICAgICAgdmFyIHNwbGl0ID0gYnl0ZXMuc3BsaXQoJz0nKVxuICAgICAgICB2YXIgbmFtZSA9IHNwbGl0LnNoaWZ0KCkucmVwbGFjZSgvXFwrL2csICcgJylcbiAgICAgICAgdmFyIHZhbHVlID0gc3BsaXQuam9pbignPScpLnJlcGxhY2UoL1xcKy9nLCAnICcpXG4gICAgICAgIGZvcm0uYXBwZW5kKGRlY29kZVVSSUNvbXBvbmVudChuYW1lKSwgZGVjb2RlVVJJQ29tcG9uZW50KHZhbHVlKSlcbiAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiBmb3JtXG4gIH1cblxuICBmdW5jdGlvbiBwYXJzZUhlYWRlcnMocmF3SGVhZGVycykge1xuICAgIHZhciBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKVxuICAgIC8vIFJlcGxhY2UgaW5zdGFuY2VzIG9mIFxcclxcbiBhbmQgXFxuIGZvbGxvd2VkIGJ5IGF0IGxlYXN0IG9uZSBzcGFjZSBvciBob3Jpem9udGFsIHRhYiB3aXRoIGEgc3BhY2VcbiAgICAvLyBodHRwczovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjNzIzMCNzZWN0aW9uLTMuMlxuICAgIHZhciBwcmVQcm9jZXNzZWRIZWFkZXJzID0gcmF3SGVhZGVycy5yZXBsYWNlKC9cXHI/XFxuW1xcdCBdKy9nLCAnICcpXG4gICAgcHJlUHJvY2Vzc2VkSGVhZGVycy5zcGxpdCgvXFxyP1xcbi8pLmZvckVhY2goZnVuY3Rpb24obGluZSkge1xuICAgICAgdmFyIHBhcnRzID0gbGluZS5zcGxpdCgnOicpXG4gICAgICB2YXIga2V5ID0gcGFydHMuc2hpZnQoKS50cmltKClcbiAgICAgIGlmIChrZXkpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gcGFydHMuam9pbignOicpLnRyaW0oKVxuICAgICAgICBoZWFkZXJzLmFwcGVuZChrZXksIHZhbHVlKVxuICAgICAgfVxuICAgIH0pXG4gICAgcmV0dXJuIGhlYWRlcnNcbiAgfVxuXG4gIEJvZHkuY2FsbChSZXF1ZXN0LnByb3RvdHlwZSlcblxuICBmdW5jdGlvbiBSZXNwb25zZShib2R5SW5pdCwgb3B0aW9ucykge1xuICAgIGlmICghb3B0aW9ucykge1xuICAgICAgb3B0aW9ucyA9IHt9XG4gICAgfVxuXG4gICAgdGhpcy50eXBlID0gJ2RlZmF1bHQnXG4gICAgdGhpcy5zdGF0dXMgPSBvcHRpb25zLnN0YXR1cyA9PT0gdW5kZWZpbmVkID8gMjAwIDogb3B0aW9ucy5zdGF0dXNcbiAgICB0aGlzLm9rID0gdGhpcy5zdGF0dXMgPj0gMjAwICYmIHRoaXMuc3RhdHVzIDwgMzAwXG4gICAgdGhpcy5zdGF0dXNUZXh0ID0gJ3N0YXR1c1RleHQnIGluIG9wdGlvbnMgPyBvcHRpb25zLnN0YXR1c1RleHQgOiAnT0snXG4gICAgdGhpcy5oZWFkZXJzID0gbmV3IEhlYWRlcnMob3B0aW9ucy5oZWFkZXJzKVxuICAgIHRoaXMudXJsID0gb3B0aW9ucy51cmwgfHwgJydcbiAgICB0aGlzLl9pbml0Qm9keShib2R5SW5pdClcbiAgfVxuXG4gIEJvZHkuY2FsbChSZXNwb25zZS5wcm90b3R5cGUpXG5cbiAgUmVzcG9uc2UucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBSZXNwb25zZSh0aGlzLl9ib2R5SW5pdCwge1xuICAgICAgc3RhdHVzOiB0aGlzLnN0YXR1cyxcbiAgICAgIHN0YXR1c1RleHQ6IHRoaXMuc3RhdHVzVGV4dCxcbiAgICAgIGhlYWRlcnM6IG5ldyBIZWFkZXJzKHRoaXMuaGVhZGVycyksXG4gICAgICB1cmw6IHRoaXMudXJsXG4gICAgfSlcbiAgfVxuXG4gIFJlc3BvbnNlLmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHJlc3BvbnNlID0gbmV3IFJlc3BvbnNlKG51bGwsIHtzdGF0dXM6IDAsIHN0YXR1c1RleHQ6ICcnfSlcbiAgICByZXNwb25zZS50eXBlID0gJ2Vycm9yJ1xuICAgIHJldHVybiByZXNwb25zZVxuICB9XG5cbiAgdmFyIHJlZGlyZWN0U3RhdHVzZXMgPSBbMzAxLCAzMDIsIDMwMywgMzA3LCAzMDhdXG5cbiAgUmVzcG9uc2UucmVkaXJlY3QgPSBmdW5jdGlvbih1cmwsIHN0YXR1cykge1xuICAgIGlmIChyZWRpcmVjdFN0YXR1c2VzLmluZGV4T2Yoc3RhdHVzKSA9PT0gLTEpIHtcbiAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbnZhbGlkIHN0YXR1cyBjb2RlJylcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKG51bGwsIHtzdGF0dXM6IHN0YXR1cywgaGVhZGVyczoge2xvY2F0aW9uOiB1cmx9fSlcbiAgfVxuXG4gIHNlbGYuSGVhZGVycyA9IEhlYWRlcnNcbiAgc2VsZi5SZXF1ZXN0ID0gUmVxdWVzdFxuICBzZWxmLlJlc3BvbnNlID0gUmVzcG9uc2VcblxuICBzZWxmLmZldGNoID0gZnVuY3Rpb24oaW5wdXQsIGluaXQpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICB2YXIgcmVxdWVzdCA9IG5ldyBSZXF1ZXN0KGlucHV0LCBpbml0KVxuICAgICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpXG5cbiAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgICAgc3RhdHVzOiB4aHIuc3RhdHVzLFxuICAgICAgICAgIHN0YXR1c1RleHQ6IHhoci5zdGF0dXNUZXh0LFxuICAgICAgICAgIGhlYWRlcnM6IHBhcnNlSGVhZGVycyh4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkgfHwgJycpXG4gICAgICAgIH1cbiAgICAgICAgb3B0aW9ucy51cmwgPSAncmVzcG9uc2VVUkwnIGluIHhociA/IHhoci5yZXNwb25zZVVSTCA6IG9wdGlvbnMuaGVhZGVycy5nZXQoJ1gtUmVxdWVzdC1VUkwnKVxuICAgICAgICB2YXIgYm9keSA9ICdyZXNwb25zZScgaW4geGhyID8geGhyLnJlc3BvbnNlIDogeGhyLnJlc3BvbnNlVGV4dFxuICAgICAgICByZXNvbHZlKG5ldyBSZXNwb25zZShib2R5LCBvcHRpb25zKSlcbiAgICAgIH1cblxuICAgICAgeGhyLm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KG5ldyBUeXBlRXJyb3IoJ05ldHdvcmsgcmVxdWVzdCBmYWlsZWQnKSlcbiAgICAgIH1cblxuICAgICAgeGhyLm9udGltZW91dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QobmV3IFR5cGVFcnJvcignTmV0d29yayByZXF1ZXN0IGZhaWxlZCcpKVxuICAgICAgfVxuXG4gICAgICB4aHIub3BlbihyZXF1ZXN0Lm1ldGhvZCwgcmVxdWVzdC51cmwsIHRydWUpXG5cbiAgICAgIGlmIChyZXF1ZXN0LmNyZWRlbnRpYWxzID09PSAnaW5jbHVkZScpIHtcbiAgICAgICAgeGhyLndpdGhDcmVkZW50aWFscyA9IHRydWVcbiAgICAgIH0gZWxzZSBpZiAocmVxdWVzdC5jcmVkZW50aWFscyA9PT0gJ29taXQnKSB7XG4gICAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSBmYWxzZVxuICAgICAgfVxuXG4gICAgICBpZiAoJ3Jlc3BvbnNlVHlwZScgaW4geGhyICYmIHN1cHBvcnQuYmxvYikge1xuICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2Jsb2InXG4gICAgICB9XG5cbiAgICAgIHJlcXVlc3QuaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG4gICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKG5hbWUsIHZhbHVlKVxuICAgICAgfSlcblxuICAgICAgeGhyLnNlbmQodHlwZW9mIHJlcXVlc3QuX2JvZHlJbml0ID09PSAndW5kZWZpbmVkJyA/IG51bGwgOiByZXF1ZXN0Ll9ib2R5SW5pdClcbiAgICB9KVxuICB9XG4gIHNlbGYuZmV0Y2gucG9seWZpbGwgPSB0cnVlXG59KSh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDogdGhpcyk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vd2hhdHdnLWZldGNoL2ZldGNoLmpzXG4vLyBtb2R1bGUgaWQgPSAxMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9