var veMain={};veMain.full_site=!0,veMain.domain="",veMain.domain_IDN="",veMain.domain_PunyCode="",veMain.language="TH",veMain.mode="view",veMain.fb_page_tab=0,veMain.tag_cloud=!1,veMain.debug=!1,veMain.page="content",veMain.contentId=0,veMain.contentIdContactForm=0,veMain.contentTitleContactForm="",veMain.homeContentId=0,veMain.contentType="",veMain.styleSlot=0,veMain.webboardId=0,veMain.webboardTopicId=0,veMain.features=null,veMain.phoneFormat="Thai",veMain.wrapperWidth="none",veMain.smallSizeScreenWidth=610,veMain.middleSizeScreenWidth=1200,veMain.oldWrapperWidth=960,veMain.siteNameFontSize=null,veMain.tagLineFontSize=null,veMain.stickyTopbar=1,veMain.mobileSite=1,veMain.menuBgSimple=1,veMain.EMAIL_REGEXP=/^([\w-\.]+@([\w-]+\.)+[^\W\d]+[\w-]+)?$/,veMain.categoryId="",veMain.rpshopEnable="",veMain.headerLogoOnStickyTopbar="",veMain.showTopbarLogo="",veMain.registerCountry="",veMain.freeBannerUrl="",veMain.isRmp=0,veMain.init=function(encoded_options){$("#ve-loading-overlay").hide();var options=eval("("+$.base64Decode(encoded_options)+")");this.full_site=options.full_site,this.domain=options.domain,this.domain_IDN=options.domain_IDN,this.domain_PunyCode=options.domain_PunyCode,this.language=options.language,this.mode=options.mode,this.fb_page_tab=options.fb_page_tab,this.tag_cloud=options.tag_cloud,this.debug=options.debug,this.page=options.page,this.contentId=parseInt(options.content_id,10),this.homeContentId=parseInt(options.home_content_id,10),this.contentType=options.content_type,this.styleSlot=parseInt(options.style_slot,10),this.webboardId=parseInt(options.webboard_id,10),this.webboardTopicId=parseInt(options.webboard_topic_id,10),this.features=options.features,this.phoneFormat=options.phoneFormat,this.wrapperWidth=options.wrapper_width,this.no_rclick_mode=options.no_rclick_mode,this.no_rclick_alert=options.no_rclick_alert,this.no_rclick_msg=options.no_rclick_msg,this.siteNameFontSize=parseInt(options.sitename_font_size,10),this.tagLineFontSize=parseInt(options.tagline_font_size,10),this.stickyTopbar=options.sticky_topbar,this.mobileSite=options.mobile_site,this.menuBgSimple=options.menu_bg_simple,this.userStock=options.user_stock,this.reCaptchaSiteKey=options.reCaptcha_siteKey,this.reCaptchaEnable=options.reCaptcha_enable,this.member_login=options.member_login,this.desktopMode=options.desktop_mode,this.rpshopEnable=options.rpshop_enable,this.headerLogoOnStickyTopbar=options.header_logo_on_sticky_topbar,this.showTopbarLogo=options.show_topbar_logo,this.registerCountry=options.register_country,this.freeBannerUrl=options.free_banner_url,this.isRmp=options.is_rmp,"none"==this.wrapperWidth?this.wrapperWidth=960:"full"==this.wrapperWidth&&(this.wrapperWidth=1200),veMain.setAjaxCacheScript(),veContactForm.init(),veMain.initHeaderPanel(),veNav.init(),veMain.initContentImages(),veSearchForm.init(),veMain.initSlick(),veMain.initReadyTemplateSlideshowSlick(0),veMain.initBannerSectionSlideshowSlick(0),veSlideMenu.init(),veMain.initAttachmentsGuide(),veMain.initCards(),veMain.initHintReadyTemplateSlideshow(),veMain.initHideBackToTopButton(),veMain.appendMemberBox(),$(window).width()<=610,veMain.wrapperWidth>$(window).width()&&"0"!=veMain.mobileSite&&veMain.setFontSize();var bind_input_text_touch=!1;document.addEventListener?document.addEventListener("touchstart",function(){0==bind_input_text_touch&&(bind_input_text_touch=!0,veMain.bindInputTextTouch())},!0):0==bind_input_text_touch&&$("input[type=text]").attachEvent&&$("input[type=text]").attachEvent("touchstart",function(){bind_input_text_touch=!0,veMain.bindInputTextTouch()}),$("#flexi-preview-bar").length>0&&veMain.bindFlexiPreviewBar(),$(".ve-cart-button").length>0&&($(".ve-cart-button").bind("click",function(){document.location.href="/cart"}),localStorage.getItem("rpcart__products")&&$(".ve-cart-button .ve-cart-count").text(JSON.parse(localStorage.getItem("rpcart__products")).value.length))},veMain.initHideBackToTopButton=function(){var a=null;$(window).scroll(function(){scroll=$(window).scrollTop(),0==scroll?$(".back-to-top").hide():($(".back-to-top").show(),a&&clearTimeout(a),a=setTimeout(function(){$(".back-to-top").hide()},3e3))})},veMain.initLazysizesBackground=function(){document.addEventListener("lazybeforeunveil",function(a){var b=a.target.getAttribute("data-bg");b&&(a.target.style.backgroundImage="url("+b+")")})},veMain.getAccountSSLRedirect=function(){var a="";return $.ajax({url:"/modules/flexi/api/public/Account.php",data:{task:"get_account"},type:"POST",async:!1,dataType:"json",success:function(b){a=b.ssl_proxy_autoredirect}}),a},veMain.chromeViewportWorkAround=function(){var a=window.screen.height,b=$(".ready-template-section-fit-screen");b.length>0&&b.css("height",a+"px")},veMain.bindFlexiPreviewBar=function(){$("#flexi-preview-bar #flexi-preview-change").bind("click",function(){$.ajax({url:"/modules/flexi/controllers/flexi-preview-controller.php",data:{task:"change_to_flexi",slot:veMain.styleSlot},type:"POST",async:!0,success:function(){window.location="/"},error:function(a,b,c){veMain.log("ERROR: "+b+"\n\n"+c)}})}),$("#flexi-preview-bar #flexi-preview-not-change").bind("click",function(){$.ajax({url:"/modules/flexi/controllers/flexi-preview-controller.php",data:{task:"clear_preview_session"},type:"POST",async:!0,success:function(){veMain.updateFlexiPreviewLog("exit-preview"),window.location="/"},error:function(a,b,c){veMain.log("ERROR: "+b+"\n\n"+c)}})})},veMain.updateFlexiPreviewLog=function(a){$.ajax({url:"/modules/flexi/controllers/flexi-preview-controller.php",type:"POST",data:{task:"update_log",action:a},async:!1,success:function(){},error:function(a,b,c){veMain.log("ERROR: "+b+"\n\n"+c)}})},veMain.autoHideMobileTopMenu=function(){$(document).on("scroll",function(){$(".mobile-topbar").show()}),$(document).on("scrollstop",function(){$(".mobile-topbar").hide()}),$(window).scrollTop()<$("#header").offset().top+$("#header").height()&&$(".mobile-topbar").show()},veMain.bindInputTextTouch=function(){$("input[type=text]").on("focus",function(){$("#edit-bar").length>0&&$("#edit-bar").css({position:"absolute"}),$(".slidemenu-wrapper #slidemenu-menu").length>0&&$(".slidemenu-wrapper #slidemenu-menu").css({position:"absolute"}),setTimeout(function(){},0)}),$("input[type=text]").on("blur",function(){$("#edit-bar").length>0&&$("#edit-bar").css({position:"fixed"}),$(".slidemenu-wrapper #slidemenu-menu").length>0&&$(".slidemenu-wrapper #slidemenu-menu").css({position:"fixed"})})},veMain.appendMemberBox=function(){(0==$(".widgets .member-box .widget-item #member-login-wrap").length&&0!=$(".widgets .member-box").length||0!=$("#login-change-password #btn-login-change-password").length)&&veMain.loadMemberBox()},veMain.initHeaderPanel=function(){0!=veMain.mobileSite&&($(window).off("font-resize").on("mobile-font-resize",function(){veMain.setFontSize()}),$(window).resize(function(){$(window).trigger("mobile-font-resize")}));var a=$("#header > .header-inner > .panel"),b=$("#sitename"),c=$("#tagline"),d=a.height();d<b.outerHeight()+c.outerHeight()?c.hide():c.show(),d<b.outerHeight()?b.hide():b.show()},veMain.setFontSize=function(){var a=$(window).width()/veMain.wrapperWidth*veMain.siteNameFontSize;16>a?a=16:a>veMain.siteNameFontSize&&(a=veMain.siteNameFontSize),$("#sitename").css({"font-size":a,"min-height":a});var b=$(window).width()/veMain.wrapperWidth*veMain.tagLineFontSize;14>b?b=14:b>veMain.tagLineFontSize&&(b=veMain.tagLineFontSize),$("#tagline").css({"font-size":b,"min-height":b})},veMain.initContentImages=function(){if($("#content .album-images a img").load(function(){var a=this.height/this.width;a>.585?$(this).width("auto").height("100%"):$(this).height("auto").width("100%"),("edit"!=veMain.mode||1==veMain.fb_page_tab)&&document.documentElement.clientWidth>=veMain.middleSizeScreenWidth&&veMain.hoverZoomEffect($(this),this.height,this.width)}),"edit"!=this.mode||1==this.fb_page_tab){var a=$("#content .images-area  li:not(.no-image) a");if($.browser.msie&&$.browser.version<9)a.swipebox();else{var b=a.tosrus({caption:{add:!0,attributes:["title"]},keys:!0,buttons:!0,pagination:{add:!0},youtube:{imageLink:!1}},{},{});b.bind("opening.tos",function(){$(".tos-uibg").hide()})}var c=$("#content .album-images");c.each(function(b,c){if(a=$(c).find("li a"),$.browser.msie&&$.browser.version<9)a.swipebox();else{var d=a.tosrus({caption:{add:!0,attributes:["title"]},keys:!0,buttons:!0,pagination:{add:!0},youtube:{imageLink:!1}},{},{});d.bind("opening.tos",function(){$(".tos-uibg").hide()})}})}else $("#content .images-area a, #content .album-images .image-wrapper a").attr("href","javascript:void(0);")},veMain.hoverZoomEffect=function(a,b,c){a.hover(function(){var a=$(this);a.parent().parent().parent().css("z-index",4),a.css("box-shadow","5px 5px 7px rgba(0, 0, 0, 0.3)"),a.stop(!0).animate({height:1.5*b,width:1.5*c,"margin-left":"-35","margin-top":"-35"},"fast")},function(){var a=$(this);a.parent().parent().parent().css("z-index",0),a.css("box-shadow","none"),a.stop(!0).animate({height:b,width:c,"margin-left":"0","margin-top":"0"},"fast")})},veMain.embedHeaderFlash=function(a){if(veMain.loadJS("/modules/flexi/js/swfobject/swfobject.js"),"undefined"!=typeof swfobject){var b={},c={quality:"high",align:"right",wmode:"transparent",allowScriptAccess:"sameDomain"},d={};swfobject.embedSWF(a,"header-flash-object","100%","100%","9.0.115","/modules/flexi/swf/expressInstall.swf",b,c,d)}else alert("swfobject is undefined")},veMain.scrollPageTo=function(a){var b=$(a).first(),c=b.offset().left,d=b.offset().top-parseInt($("#edit-bar").outerHeight());$("html,body").stop().animate({scrollLeft:c,scrollTop:d},500)},veMain.initSlick=function(){var a=$("#content .ready-template-slideshow"),b=$("#content .banner-section");(a.length>0||b.length>0)&&(veMain.loadCSS("/modules/flexi/js/slick/slick/slick.css"),veMain.loadCSS("/modules/flexi/js/slick/slick/slick-theme.css"),veMain.loadJS("/modules/flexi/js/slick/slick/slick.min.js"))},veMain.initReadyTemplateSlideshowSlick=function(a){var b=$("#content .ready-template-slideshow");b.each(function(){veMain.getSlickSlideshowSettings($(this),a)})},veMain.initBannerSectionSlideshowSlick=function(a,b){if(""==a)var c=$("#content .banner-section");else var c=a.find(".banner-section");c.each(function(){veBanner.setImageSource($(this)),veMain.getSlickSlideshowSettings($(this),b)})},veMain.getSlickSlideshowSettings=function(a,b){if(a.hasClass("slick-slider")&&a.slick("unslick"),""==b&&(b=0),"edit"==veMain.mode)var c=!1,d=!1,e=!1;else var c=!0,d=!0,e=!0;a.slick({dots:!0,mobileFirst:!0,speed:300,cssEase:"linear",arrows:!1,autoplay:c,autoplaySpeed:3e3,initialSlide:b,slidesToShow:1,slidesToScroll:1,swipe:d,accessibility:e})},veMain.initSlideshow=function(){$("#content .slideshow-container").length>0&&(veMain.loadCSS("/modules/flexi/js/jquery.nivoSlider/nivo-slider.min.css"),veMain.loadCSS("/modules/flexi/js/jquery.nivoSlider/themes/default/default.min.css"),veMain.loadJS("/modules/flexi/js/jquery.nivoSlider/jquery.nivo.slider.pack.js")),$("#content .slideshow-container").each(function(){var a=$(this),b=a.parents(".hidable"),c=b.attr("id").replace("hidable-","");veMain.getSlideshowSettings(c)})},veMain.getSlideshowSettings=function(section_id){$.ajax({url:"/modules/flexi/controllers/slideshow-process-controller.php",type:"POST",data:{task:"get_slideshow_setting",section_id:section_id,content_id:veMain.contentId},async:!0,success:function(data){var json=eval("("+data+")"),$loader=$("#hidable-"+json.result.section_id+" #slideshow-loader"),$wrapper=$loader.find("#slideshow-wrapper"),hide_slideshow_controller=!1;1==$wrapper.find("img").length&&(hide_slideshow_controller=!0),$wrapper.length>0&&($wrapper.show(),$wrapper.nivoSlider({effect:json.result.transition_effect,slices:15,boxCols:8,boxRows:4,animSpeed:1e3*json.result.transition_speed,pauseTime:1e3*json.result.delay,startSlide:0,directionNav:!0,controlNav:!0,controlNavThumbs:!1,pauseOnHover:!0,manualAdvance:!1,prevText:"Prev",nextText:"Next",randomStart:!1,beforeChange:function(){},afterChange:function(){},slideshowEnd:function(){},lastSlide:function(){},afterLoad:function(){$wrapper.find(".nivo-main-image").removeAttr("width").removeAttr("height")}}),0==json.result.autoplay&&$wrapper.data("nivoslider").stop(),1==hide_slideshow_controller&&($wrapper.data("nivoslider").stop(),$wrapper.find(".nivo-directionNav").hide(),$loader.find(".nivo-controlNav").hide()))},error:function(a,b,c){veMain.log("ERROR: "+b+"\n\n"+c)}})},veMain.loadFontsCss=function(){0==$("#allFonts").length&&$.ajax({url:"/modules/flexi/controllers/theme-customize-font-controller.php",type:"GET",data:{task:"load_all_fonts"},success:function(a){$("head").append(a)}})},veMain.initAttachmentsGuide=function(){$(".content-attach-file > ul > li a.download > .attach-download").qtip({position:{my:"top center",at:"bottom center",viewport:$(window)},content:{text:_T("__content_Download File")},style:{classes:"qtip-light"}}),$(".content-attach-file > ul > li a.view").qtip({position:{my:"top center",at:"bottom center",viewport:$(window),target:"mouse",adjust:{y:20}},content:{text:_T("__content_Open file in new tab")},style:{classes:"qtip-light"}})},veMain.initHintReadyTemplateSlideshow=function(){$(".slideshow-left").qtip({position:{my:"top center",at:"bottom center",viewport:$(window)},content:{text:_T("__readytemplate__slideshow left")},style:{classes:"qtip-cream"}}),$(".slideshow-right").qtip({position:{my:"top center",at:"bottom center",viewport:$(window)},content:{text:_T("__readytemplate__slideshow right")},style:{classes:"qtip-cream"}}),$(".slideshow-del").qtip({position:{my:"top center",at:"bottom center",viewport:$(window)},content:{text:_T("__readytemplate__slideshow delete")},style:{classes:"qtip-cream"}}),$(".slideshow-add").qtip({position:{my:"top center",at:"bottom center",viewport:$(window)},content:{text:_T("__readytemplate__slideshow add")},style:{classes:"qtip-cream"}})},veMain.setAjaxCacheScript=function(){$.ajaxPrefilter(function(a,b){("script"==a.dataType||"script"==b.dataType)&&(a.cache=!0)})},veMain.initRuntimeUploader=function(){var a="html5,flash,silverlight,html4";return veMain.domain.indexOf("xn--")>=0&&navigator.userAgent.toLowerCase().indexOf("msie")>=0&&(a="html5,html4"),a},veMain.loadMemberBox=function(){var a=window.location.pathname.substr(1);$.ajax({url:"/modules/flexi/views/widget-member-box.php",type:"POST",data:{redirect_uri:a},dataType:"html",async:!1,success:function(a){$(".member-box .widget-item").html(a),veMain.loadJS(veMain.debug?"/modules/flexi/js/velaeasy/ungrouped/member.js":"/modules/flexi/js/velaeasy/member.min.js"),veMember.LoginForm()}})},veMain.loadJS=function(a){return 0==$("head").find('script[src="'+a+'"]').length?($("head").append('<script type="text/javascript" src="'+a+'"></script>'),!0):!1},veMain.loadCSS=function(a){0==$("head").find('link[href="'+a+'"]').length&&(document.createStyleSheet?document.createStyleSheet(a):$("head").append('<link rel="stylesheet" type="text/css" href="'+a+'" />'))},veMain.showAlert=function(a){setTimeout(function(){alert(a)},100)},veMain.bgLoad=function(){$("#body-bg").addClass("onload")},veMain.initCards=function(){$el_cards_hidable=$(".cards-container");for(var a=0;a<$el_cards_hidable.length;a++)veMain.initCustomScrollbar($el_cards_hidable.eq(a).find(".cards-item .cards-text")),veMain.updateFirstAndLastClass($el_cards_hidable.eq(a).parent().attr("id").replace("hidable-",""))},veMain.updateFirstAndLastClass=function(a){var b=$("#hidable-"+a+" .cards-loader > ul > li");b.removeClass("cards-first-child cards-last-child"),b.first().addClass("cards-first-child"),b.last().addClass("cards-last-child")},veMain.initCustomScrollbar=function(a){a.mCustomScrollbar({theme:"dark",axis:"y",updateOnContentResize:!0})},veMain.initCustomScrollbarTheme=function(a,b){a.mCustomScrollbar({theme:b,axis:"y",updateOnContentResize:!0})},veMain.validateEmail=function(a){var b=punycode.toASCII(a);return veMain.EMAIL_REGEXP.test(b)?!0:!1},veMain.log=function(a){"undefined"!=typeof console&&console.log(a)};var veLang={};veLang.translate=function(a){return void 0==a||null==a||""==a?"":msg=_i18n[a]?_i18n[a]:""};var _T=veLang.translate,veCaptcha={},veReCaptcha={},reCaptchaOnloadCallback=function(){veReCaptcha.init()};veCaptcha.init=function(){$(".captcha .reload").unbind("click").click(veCaptcha.reloadImage)},veCaptcha.reloadImage=function(){$(".captcha .image").attr("src","/modules/helper/Captcha/captcha.php?"+Math.random())},veCaptcha.reload=function(){$.ajax({url:"/modules/flexi/views/captcha.php",type:"GET",async:!0,success:function(a){$(".captcha").parent().html(a),veCaptcha.init()}})},veCaptcha.clearError=function(){$(".captcha .error").text("")},veReCaptcha.init=function(){"undefined"!=typeof grecaptcha&&$(".reCaptcha-container").each(function(index){var elementId=$(this).attr("id");eval("veReCaptcha."+elementId+" = "+grecaptcha.render(elementId,{sitekey:veMain.reCaptchaSiteKey}))})},veReCaptcha.initSpecificElement=function(elementId){"undefined"!=typeof grecaptcha&&eval("veReCaptcha."+elementId+" = "+grecaptcha.render(elementId,{sitekey:veMain.reCaptchaSiteKey}))};var veNav={};veNav.menuStructure=[],veNav.sortableAffectedLists=[],veNav.draggedParentId="",veNav.startDraggedItem="",veNav.checkSaveState=!0,veNav.checkError=1,veNav.deletedSubMenuStatus=0,veNav.deletedSubMenuLimited=10,veNav.nav_title_tag_menu="",veNav.show_logo_status="";var veWebboard={};veWebboard.webboardId=0,veWebboard.topicId=0,veNav.init=function(){veNav.bindEventsMenus(),"edit"==veMain.mode&&1!=veMain.fb_page_tab?veNav.initEditMode():"1"==veMain.stickyTopbar&&(veNav.setScrollTopbar(),veNav.initStickyTopBar()),veNav.initFreeBanner(),"edit"==veMain.mode&&$("ul.topnav > li > ul.subnav").css("overflow","initial")},veNav.bindEventsMenus=function(){veNav.removeSubNavTriggers(),veNav.bindEventsTopNav(),veNav.bindEventsSideNav(),veNav.setHomeMenu(),"edit"==veMain.mode&&1!=veMain.fb_page_tab&&(veNav.bindEventsHiddenNav(),veNav.bindEventsHiddenNavContainer())},veNav.initFreeBanner=function(){$("#wrapper #ads .banner").unbind("click").click(function(){$.ajax({url:"/modules/flexi/controllers/free-banner-controller.php",type:"POST",data:{task:"log_free_banner"},dataType:"json"}),window.open(veMain.freeBannerUrl,"_blank")})},veNav.topBarOffsetTop=0,veNav.initStickyTopBar=function(){var a=$("#topbar");0!=a.length&&(veNav.topBarOffsetTop=a.offset().top+1,veNav.updateStickyTopBar(),$(window).scroll(function(){veNav.updateStickyTopBar(),veNav.setScrollTopbar()}))},veNav.updateStickyTopBar=function(){var a=$("#topbar"),b=$("ul.topnav"),c=$(window).scrollTop(),d=0,e=$("#edit-bar");e.is(":visible")&&(d=53),a.hasClass("sticky")?c-d<veNav.topBarOffsetTop&&(veNav.getSettingTopbarLogo(),a.stop().removeClass("sticky").css("top",0)):c-d>=veNav.topBarOffsetTop&&(b.hide(),veNav.getSettingStickyLogo(),a.addClass("sticky").css("top",-2*a.height()+"px").animate({top:d+"px"},{duration:1e3,easing:"easeInOutCubic",start:function(){b.show()}}))},veNav.getSettingStickyLogo=function(){var a=$("#topbar .topbar-sub-container .image.nav-topbar-logo");""==veNav.show_logo_status?"edit"==veMain.mode?$.ajax({url:"/modules/flexi/controllers/siteinfo-save-controller.php",type:"POST",data:{task:"get_info",el_field:"1",el_val:"1"},dataType:"json",async:!1,success:function(b){var c=b.header_logo_on_sticky_topbar;veNav.show_logo_status=parseInt(c),1==c?a.show():a.hide()}}):1==veMain.headerLogoOnStickyTopbar?a.show():a.hide():1==veNav.show_logo_status?a.show():a.hide()},veNav.getSettingTopbarLogo=function(){var a=$("#topbar .topbar-sub-container .image.nav-topbar-logo");""==veNav.show_logo_status?"edit"==veMain.mode?$.ajax({url:"/modules/flexi/controllers/sitestyle-save-controller.php",type:"POST",data:{task:"get_show_topbar_logo",el_field:"1",el_val:"1"},dataType:"json",async:!1,success:function(b){veNav.show_logo_status=parseInt(b),"1"==b?a.show():a.hide()}}):1==veMain.showTopbarLogo?a.show():a.hide():1==veNav.show_logo_status?a.show():a.hide()},veNav.getMenuStructure=function(){$.ajax({url:"/modules/flexi/controllers/nav-get-menu-structure-controller.php?"+(new Date).getTime(),type:"POST",data:{method:"structure"},async:!1,success:function(data){var json=eval("("+data+")");veNav.createMenuStructure(json)}})},veNav.createMenuStructure=function(a){veNav.menuStructure=[],veNav.menuStructure=a},veNav.initEditMode=function(){veTemplate.getSiteStyleReadyTemplate(),veNav.initEditModeMainNavMenus(".nav"),veEditMode.putContextMenuOver(".midnav > li.nav-content",[{cssClass:"edit",title:_T("__nav__แก้ไขเมนู"),eventHandler:veNav.bindContextMenuEdit},{cssClass:"addSubMenu",title:_T("__nav__เพิ่มเมนูภายใต้เมนูนี้"),eventHandler:veNav.bindContextMenuAdd},{cssClass:"seoSetting",title:_T("__nav__ตั้งค่าสำหรับ SEO"),eventHandler:veNav.bindSeoSetting},{cssClass:"delete",title:_T("__nav__ลบเมนู"),eventHandler:veNav.bindContextMenuDelete}]),veEditMode.putContextMenuOver(".midnav > li.nav-link",[{cssClass:"edit",title:_T("__nav__แก้ไขเมนู"),eventHandler:veNav.bindContextMenuEdit},{cssClass:"addSubMenu",title:_T("__nav__เพิ่มเมนูภายใต้เมนูนี้"),eventHandler:veNav.bindContextMenuAdd},{cssClass:"delete",title:_T("__nav__ลบเมนู"),eventHandler:veNav.bindContextMenuDelete}]),veEditMode.putContextMenuOver(".midnav > li.nav-text",[{cssClass:"edit",title:_T("__nav__แก้ไขเมนู"),eventHandler:veNav.bindContextMenuEdit},{cssClass:"addSubMenu",title:_T("__nav__เพิ่มเมนูภายใต้เมนูนี้"),eventHandler:veNav.bindContextMenuAdd},{cssClass:"delete",title:_T("__nav__ลบเมนู"),eventHandler:veNav.bindContextMenuDelete}]),veEditMode.putContextMenuOver(".midnav > li.nav-webboard",[{cssClass:"edit",title:_T("__nav__แก้ไขเมนู"),eventHandler:veNav.bindContextMenuEdit},{cssClass:"addSubMenu",title:_T("__nav__เพิ่มเมนูภายใต้เมนูนี้"),eventHandler:veNav.bindContextMenuAdd},{cssClass:"seoSetting",title:_T("__nav__ตั้งค่าสำหรับ SEO"),eventHandler:veNav.bindSeoSetting},{cssClass:"delete",title:_T("__nav__ลบเว็บบอร์ด"),eventHandler:veNav.bindContextMenuDelete}]),$(".hiddennav .context-menu > ul > li.decorate").remove(),screen.width<=940&&1==veMain.mobileSite&&$(".hiddennav-container").css({left:"auto",right:"0px"}),$(window).width()<830&&1==veMain.mobileSite&&($(".nav-add-button > a > span").css("margin-right","0").after("<br/>"),$("#widget-add-button > a > span").css("margin-right","0").after("<br/>")),veNav.getMenuStructure(),veNav.makeSortable(),veNav.addButton_init(),veNav.midNavAddButton_init()},veNav.initEditModeMainNavMenus=function(a){return".nav"!=a&&$(a).find(".context-menu").length>0&&$(a+" > li").length>0?!1:(veEditMode.putContextMenuOver(a+" > li.nav-content",[{cssClass:"edit",title:_T("__nav__แก้ไขเมนู"),eventHandler:veNav.bindContextMenuEdit},{cssClass:"decorate",title:_T("__nav__ตกแต่ง"),eventHandler:veEditMode.bindContextMenuDecorate},{cssClass:"addSubMenu",title:_T("__nav__เพิ่มเมนูภายใต้เมนูนี้"),eventHandler:veNav.bindContextMenuAdd},{cssClass:"seoSetting",title:_T("__nav__ตั้งค่าสำหรับ SEO"),eventHandler:veNav.bindSeoSetting},{cssClass:"delete",title:_T("__nav__ลบเมนู"),eventHandler:veNav.bindContextMenuDelete}]),veEditMode.putContextMenuOver(a+" > li.nav-link",[{cssClass:"edit",title:_T("__nav__แก้ไขเมนู"),eventHandler:veNav.bindContextMenuEdit},{cssClass:"decorate",title:_T("__nav__ตกแต่ง"),eventHandler:veEditMode.bindContextMenuDecorate},{cssClass:"addSubMenu",title:_T("__nav__เพิ่มเมนูภายใต้เมนูนี้"),eventHandler:veNav.bindContextMenuAdd},{cssClass:"delete",title:_T("__nav__ลบเมนู"),eventHandler:veNav.bindContextMenuDelete}]),veEditMode.putContextMenuOver(a+" > li.nav-tag-menu",[{cssClass:"edit",title:_T("__nav__แก้ไขเมนู"),eventHandler:veNav.bindContextMenuEdit},{cssClass:"decorate",title:_T("__nav__ตกแต่ง"),eventHandler:veEditMode.bindContextMenuDecorate},{cssClass:"addSubMenu",title:_T("__nav__เพิ่มเมนูภายใต้เมนูนี้"),eventHandler:veNav.bindContextMenuAdd},{cssClass:"delete",title:_T("__nav__ลบเมนู"),eventHandler:veNav.bindContextMenuDelete}]),veEditMode.putContextMenuOver(a+" > li.nav-text",[{cssClass:"edit",title:_T("__nav__แก้ไขเมนู"),eventHandler:veNav.bindContextMenuEdit},{cssClass:"decorate",title:_T("__nav__ตกแต่ง"),eventHandler:veEditMode.bindContextMenuDecorate},{cssClass:"addSubMenu",title:_T("__nav__เพิ่มเมนูภายใต้เมนูนี้"),eventHandler:veNav.bindContextMenuAdd},{cssClass:"delete",title:_T("__nav__ลบเมนู"),eventHandler:veNav.bindContextMenuDelete}]),"1"==veMain.rpshopEnable?veEditMode.putContextMenuOver(a+" > li.nav-category",[{cssClass:"edit",title:_T("__nav__แก้ไขเมนู"),eventHandler:veNav.bindContextMenuEdit},{cssClass:"changeCategory",title:_T("__nav__เปลี่ยนหมวดหมู่สินค้า"),eventHandler:veNav.bindContextMenuChangeCategory},{cssClass:"decorate",title:_T("__nav__ตกแต่ง"),eventHandler:veEditMode.bindContextMenuDecorate},{cssClass:"addSubMenu",title:_T("__nav__เพิ่มเมนูภายใต้เมนูนี้"),eventHandler:veNav.bindContextMenuAdd},{cssClass:"delete",title:_T("__nav__ลบเมนู"),eventHandler:veNav.bindContextMenuDelete}]):veEditMode.putContextMenuOver(a+" > li.nav-category",[{cssClass:"delete",title:_T("__nav__ลบเมนู"),eventHandler:veNav.bindContextMenuDelete}]),void 0)},veNav.bindEventsTopNav=function(){var a='<i class = "fa fa-caret-down fa-2x" ></i>';if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var b=new Number(RegExp.$1);7>=b&&(a="▼")}"edit"!=veMain.mode||1==veMain.fb_page_tab?$("ul.topnav ul.subnav").has("li:not(.sub-back)").after('<span class="arrow">'+a+"</span>"):$("ul.topnav ul.subnav").after('<span class="arrow" title="'+_T("__nav__คลิกเพื่อแสดงเมนูระดับ 2")+'">'+a+"</span>"),"edit"==veMain.mode&&1!=veMain.fb_page_tab?($("ul.topnav > li > span.arrow").unbind("click").click(function(a){return veNav.showOnlyOneSubnav($(this).parent()),veNav.initEditModeMainNavMenus("#"+$(this).parent().attr("id")+" > .subnav"),a.stopPropagation(),!1}).hover(function(){$(this).addClass("subhover")},function(){$(this).removeClass("subhover")}),veNav.bindClickOnBackground("ul.topnav")):veNav.bindHoverOnTopLevelNav("ul.topnav > li")},veNav.bindEventsHiddenNavContainer=function(){var a=400;$("div.hiddennav-container > .header").unbind("click").click(function(b){return $(this).toggleClass("hidden-nav-open"),$(this).hasClass("hidden-nav-open")?$(this).parent().animate({width:"222px"},a,function(){$(this).find(".hiddennav-header-title").toggle()}):($(this).find(".hiddennav-header-title").toggle(),$(this).parent().animate({width:"42px"},a)),$("ul.hiddennav").slideToggle("medium"),b.stopPropagation(),!1}),$("div.hiddennav-container").draggable(),$("div.hiddennav-container").droppable({accept:"ul.nav > li, ul.subnav > li",greedy:!1,over:function(b){return $(this).find("> .header").removeClass("hidden-nav-open").addClass("hidden-nav-open"),$("ul.hiddennav:hidden").slideDown("fast"),$(this).animate({width:"222px"},a,function(){$(this).find(".hiddennav-header-title").show(),$("ul.hiddennav").sortable("refresh")}),b.stopPropagation(),!1}})},veNav.bindEventsSideNav=function(){var a='<i class="fa fa-caret-right fa-2x"></i>';if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var b=new Number(RegExp.$1);7>=b&&(a="►")}"edit"!=veMain.mode||1==veMain.fb_page_tab?$("ul.sidenav ul.subnav").has("li:not(.sub-back)").before('<span class="arrow" >'+a+"</span>"):$("ul.sidenav ul.subnav").before('<span class="arrow" >'+a+"</span>"),"edit"==veMain.mode&&1!=veMain.fb_page_tab?($("ul.sidenav > li > span.arrow").unbind("click").click(function(a){return veNav.showOnlyOneSubnav($(this).parent()),veNav.initEditModeMainNavMenus("#"+$(this).parent().attr("id")+" > .subnav"),a.stopPropagation(),!1}).hover(function(){$(this).addClass("subhover")},function(){$(this).removeClass("subhover")}),veNav.bindClickOnBackground("ul.sidenav")):veNav.bindHoverOnTopLevelNav("ul.sidenav > li")},veNav.bindEventsHiddenNav=function(){"edit"!=veMain.mode||1==veMain.fb_page_tab?$("ul.hiddennav ul.subnav").has("li").before('<span class="arrow" ><i class="fa fa-caret-down fa-2x"></i></span>'):$("ul.hiddennav ul.subnav").before('<span class="arrow" title="'+_T("__nav__คลิกเพื่อแสดงเมนูระดับ 2")+'"><i class="fa fa-caret-right fa-2x"></i></span>'),"edit"==veMain.mode&&1!=veMain.fb_page_tab?($("ul.hiddennav > li > span.arrow").unbind("click").click(function(a){return veNav.showOnlyOneSubnav($(this).parent()),veNav.initEditModeMainNavMenus("#"+$(this).parent().attr("id")+" > .subnav"),a.stopPropagation(),!1}).hover(function(){$(this).addClass("subhover")},function(){$(this).removeClass("subhover")}),veNav.bindClickOnBackground("ul.hiddennav")):veNav.bindHoverOnTopLevelNav("ul.hiddennav > li")},veNav.bindClickOnBackground=function(a){var b=$(a),c="ul.subnav";("edit"!=veMain.mode||1==veMain.fb_page_tab)&&(c="ul.subnav > li"),b.find("> li").has(c).unbind("click").click(function(a){return veNav.showOnlyOneSubnav(this),a.stopPropagation(),!1}),b.find("li > a").click(function(a){return a.stopPropagation(),!0}),b.find("ul.subnav > li").click(function(a){return a.stopPropagation(),!1})},veNav.bindHoverOnTopLevelNav=function(a){$(a).has("ul.subnav > li:not(.sub-back)").hover(function(a){var b=$(this),c=b.find("ul.subnav");b.is("ul.topnav > li")&&c.css("top",b.height()+"px"),b.css("z-index",1),c.show(),a.stopPropagation()},function(a){var b=$(this),c=b.find("ul.subnav");b.css("z-index",""),c.hide(),a.stopPropagation()})},veNav.showOnlyOneSubnav=function(a){var b=$(a).find("ul.subnav:hidden");$("ul.subnav").hide().parent().css("z-index","auto");var c=b.parent();c.is("ul.topnav > li")&&(c.css("z-index",1),b.css("top",c.height()+"px")),b.show("fast")},veNav.removeSubNavTriggers=function(){$("ul.nav li > span").unbind(),$("ul.nav li > span").remove()},veNav.setZIndex_onStart=function(a){a.is(".topnav li")?$("#header").css("z-index",10):a.is(".sidenav li")?$("#sidebar").css("z-index",10):a.is(".midnav li")?$("#midbar").css("z-index",10):a.is(".hiddennav li")&&$(".hiddennav-container").css("z-index",10)},veNav.setZIndex_onOver=function(){},veNav.setZIndex_onOut=function(){},veNav.setZIndex_onStop=function(a){a.css("z-index",""),$("#header").css("z-index",""),$("#sidebar").css("z-index",""),$("#midbar").css("z-index",""),$(".hiddennav-container").css("z-index","")},veNav.check_LinkMenu_Is_Home=function(){var a=$("ul.topnav li").length,b=$("ul.topnav li:first"),c=$("ul.sidenav li:first");return 0==a&&c.hasClass("nav-link")||a>0&&b.hasClass("nav-link")?!0:!1},veNav.check_TextMenu_Is_Home=function(){var a=$("ul.topnav li").length,b=$("ul.topnav li:first"),c=$("ul.sidenav li:first");return 0==a&&c.hasClass("nav-text")||a>0&&b.hasClass("nav-text")?!0:!1},veNav.check_ProductCategoryMenu_Is_Home=function(){var a=$("ul.topnav li").length,b=$("ul.topnav li:first"),c=$("ul.sidenav li:first");return 0==a&&c.hasClass("nav-category")||a>0&&b.hasClass("nav-category")?!0:!1},veNav.check_Landing_Is_Home=function(){var a=$("ul.topnav li:not(.nav-add-button)").length,b=$("ul.topnav li:first:not(.nav-add-button)"),c=$("ul.sidenav li:first");return 0==a&&c.hasClass("landing")||a>0&&b.hasClass("landing")?!0:!1},veNav.check_Adding_Special_Menu_As_Home=function(){var a=$("ul.topnav li:not(.nav-add-button)").length,b=$("ul.sidenav li").length;return veEditMode.showSidebar&&0==a&&0==b||!veEditMode.showSidebar&&0==a?!0:!1},veNav.updateHomeHref=function(a){var b=(a.attr("id"),$("ul.nav > li:not(.nav-add-button)").length,$("ul.nav > li:first:not(.nav-add-button)").attr("id"));$("ul.nav > li:not(.nav-add-button)").each(function(){var a=$(this),c=a.attr("data-seo-friendly");a.attr("id")==b&&(c="/"),a.find("> a").attr("href",c)})},veNav.makeSortable=function(){$("ul.nav > li, ul.subnav > li[class^='nav-']").css({cursor:"move"}).attr("title",_T("__nav__ลากเพื่อย้ายตำแหน่ง")),$("#list").hasClass("ui-sortable")||$("ul.nav, ul.subnav").sortable({placeholder:"placeholder",helper:"original",forcePlaceholderSize:!1,connectWith:".nav:visible",forceHelperSize:!0,items:"> [class^='nav-']",revert:200,delay:300,distance:10,start:function(a,b){b.helper.addClass("dragged");var c=b.item;veNav.sortableAffectedLists=[],-1==$.inArray(a.target,veNav.sortableAffectedLists)&&(veNav.sortableAffectedLists.push(a.target),c.find("> ul.subnav").each(function(){veNav.sortableAffectedLists.push(this)
})),c.unbind("click"),c.find("> a").bind("click",!1),veNav.startDraggedItem="",c.is("ul.sidenav > li")?veNav.startDraggedItem="from_side":c.is("ul.topnav > li")?veNav.startDraggedItem="from_top":c.is("ul.midnav > li")?veNav.startDraggedItem="from_mid":c.is("ul.subnav > li")?veNav.startDraggedItem="from_sub":c.is("ul.hiddennav > li")&&(veNav.startDraggedItem="from_hidden"),veNav.draggedParentId="",c.is("ul.midnav > li")?veNav.draggedParentId=c.find("> a").parent().parent().attr("id").replace("midnav-",""):c.is("ul.subnav > li")&&(veNav.draggedParentId=c.find("> a").parent().parent().parent().attr("id").replace("nav-","")),veNav.setZIndex_onStart(c)},stop:function(a,b){var c=b.item;c.removeClass("dragged"),c.find("> a").unbind("click",!1),veNav.setZIndex_onStop(c)},over:function(a,b){var c=b.item,d=$(a.target);2==$(this).children().length&&$(this).prepend(b.placeholder),veNav.setZIndex_onOver(c,d)},out:function(a,b){var c=b.item,d=$(a.target);veNav.setZIndex_onOut(c,d)},change:function(a){-1==$.inArray(a.target,veNav.sortableAffectedLists)&&veNav.sortableAffectedLists.push(a.target)},update:function(a,b){var c=b.item,d="",e="";c.is("ul.midnav > li")?(d=c.find("> a").parent().attr("id").replace("nav-",""),e=c.find("> a").parent().parent().attr("id").replace("midnav-","")):c.is("ul.subnav > li")?(d=c.find("> a").parent().attr("id").replace("nav-",""),e=c.find("> a").parent().parent().parent().attr("id").replace("nav-",""),d==e&&(veNav.checkSaveState=!1,$(this).sortable("cancel"))):(c.is("ul.sidenav > li")||c.is("ul.topnav > li")||c.is("ul.hiddennav > li"))&&(d=c.find("> a").parent().attr("id").replace("nav-",""));var f=veNav.checkBackupContentLimit(d);veNav.check_LinkMenu_Is_Home()?(veNav.checkSaveState=!1,$(this).sortable("cancel"),alert(_T("__nav__เมนูลิงก์ ไม่สามารถกำหนดเป็นเมนูแรกได้"))):veNav.check_Landing_Is_Home()?(veNav.checkSaveState=!1,$(this).sortable("cancel"),alert(_T("__nav__Landing page ไม่สามารถกำหนดเป็นเมนูแรกได้"))):veNav.check_TextMenu_Is_Home()?(veNav.checkSaveState=!1,$(this).sortable("cancel"),alert(_T("__nav__เมนูข้อความ ไม่สามารถกำหนดเป็นเมนูแรกได้"))):veNav.check_ProductCategoryMenu_Is_Home()?(veNav.checkSaveState=!1,$(this).sortable("cancel"),alert(_T("__nav__เมนูหมวดหมู่สินค้า ไม่สามารถกำหนดเป็นเมนูแรกได้"))):!c.is("ul.midnav > li")||e!=d&&veNav.menuStructure[e].parent_id!=d&&veNav.menuStructure[veNav.menuStructure[e].parent_id].parent_id!=d&&veNav.menuStructure[veNav.menuStructure[veNav.menuStructure[e].parent_id].parent_id].parent_id!=d?c.is("ul.midnav > li")&&veNav.menuStructure[e].num_ancestors+veNav.menuStructure[d].num_children>3?(veNav.checkSaveState=!1,$(this).sortable("cancel"),alert(_T("__nav__ERROR : ระบบรองรับเมนูได้ไม่เกิน 5 ระดับ"))):c.is("ul.subnav > li")&&veNav.menuStructure[e].num_ancestors+veNav.menuStructure[d].num_children>3?(veNav.checkSaveState=!1,$(this).sortable("cancel"),alert(_T("__nav__ERROR : ระบบรองรับเมนูได้ไม่เกิน 5 ระดับ"))):(c.is("ul.subnav > li")||c.is("ul.midnav > li"))&&veNav.checkTypeNoChildMenu(c)&&veNav.menuStructure[d].num_children>0?(veNav.checkSaveState=!1,$(this).sortable("cancel"),alert(_T("__nav__เมนูที่กำลังย้าย มีเมนูอื่นอยู่ภายใต้ การย้ายเมนูนี้ไปเป็นเมนูระดับ 2 จะทำให้ไม่สามารถเข้าถึงเมนูที่อยู่ภายใต้ได้"))):"from_side"==veNav.startDraggedItem&&(c.is("ul.sidenav > li > ul.subnav > li")||c.is("ul.sidenav > li"))||"from_top"==veNav.startDraggedItem&&(c.is("ul.topnav > li > ul.subnav > li")||c.is("ul.topnav > li"))||"from_hidden"==veNav.startDraggedItem&&(c.is("ul.hiddennav > li > ul.subnav > li")||c.is("ul.hiddennav > li"))||"from_mid"==veNav.startDraggedItem&&c.is("ul.midnav > li")||"from_sub"==veNav.startDraggedItem&&c.is("ul.subnav > li")?(1==veNav.checkSaveState&&veNav.manageSaveMenu(c,d,veNav.draggedParentId,e),veNav.checkSaveState=!0):1!=f.status&&($(this).sortable("cancel"),veNav.checkSaveState=!1,alert(_T("__nav__ไม่สามารถเพิ่มเมนูได้")+" "+f.max+" "+_T("__nav__หน้า"))):(veNav.checkSaveState=!1,$(this).sortable("cancel"),alert(_T("__nav__ERROR : ไม่สามารถย้ายเมนูมาอยู่ภายใต้ตัวเอง")))},receive:function(a,b){var c=b.item,d="",e="";c.is("ul.midnav > li")?(d=c.find("> a").parent().attr("id").replace("nav-",""),e=c.find("> a").parent().parent().attr("id").replace("midnav-","")):c.is("ul.subnav > li")?(d=c.find("> a").parent().attr("id").replace("nav-",""),e=c.find("> a").parent().parent().parent().attr("id").replace("nav-","")):(c.is("ul.sidenav > li")||c.is("ul.topnav > li")||c.is("ul.hiddennav > li"))&&(d=c.find("> a").parent().attr("id").replace("nav-","")),1==veNav.checkSaveState&&veNav.manageSaveMenu(c,d,veNav.draggedParentId,e)}}),$("ul.nav, ul.subnav").sortable("option","connectWith",".nav:visible, .subnav:visible"),$("ul.topnav, ul.sidenav, ul.hiddennav").sortable("option","cancel",".subnav > li")},veNav.checkTypeNoChildMenu=function(a){return a.hasClass("nav-link")?!0:a.hasClass("landing")?!0:a.hasClass("nav-text")?!0:a.hasClass("nav-tag-menu")?!0:!1},veNav.manageSaveMenu=function(a,b,c,d){veNav.updateHomeHref(a),a.is("ul.subnav > li")?a.find("ul.subnav").attr("class","preload-subnav"):a.is("ul.midnav > li")?a.find("ul.subnav").attr("class","preload-subnav"):(a.is("ul.topnav > li")||a.is("ul.sidenav > li")||a.is("ul.hiddennav > li"))&&a.find("ul.preload-subnav").attr("class","subnav"),a.find("ul.preload-subnav").hide(),$("ul.subnav > li > ul.subnav").remove(),veNav.saveChanges(a,b,c,d),$("ul.nav:not(.midnav) > li:not(.nav-add-button)").not(":has(ul.subnav)").append('<ul class="subnav"></ul>'),a.is("ul.subnav li")&&a.parent().show(),veNav.bindEventsMenus()},veNav.addHiddenPreloadSubMenu=function(draggedItem){if((draggedItem.is("ul.topnav > li")||draggedItem.is("ul.sidenav > li"))&&draggedItem.find("ul.subnav > li").length>0){var preload_content_id=[],count=0;draggedItem.find("ul.subnav > li").each(function(){$(this).attr("id")&&(preload_content_id[count]=$(this).attr("id").replace("nav-",""),$(this).find("> a").after('<ul class="preload-subnav"></ul>'),count++)}),$.ajax({url:"/modules/flexi/controllers/nav-get-menu-structure-controller.php",type:"POST",data:{content_id:preload_content_id,method:"preload_menu"},async:!0,success:function(data){var json=eval("("+data+")");null!=json&&veNav.createHiddenPreloadMenu(json,draggedItem)}})}},veNav.getSubMenus=function(a){$.ajax({url:"/modules/flexi/controllers/nav-get-menu-structure-controller.php",type:"POST",dataType:"json",data:{content_id:[a],method:"preload_menu"},async:!0,success:function(b){return null==b?!1:(veNav.createSubMenus(b,a),void 0)}})},veNav.createSubMenus=function(a,b){if("undefined"!=typeof a[b])for(var c=a[b].length,d=0;c>d;d++)$("#nav-"+b+" > .subnav").append(a[b][d])},veNav.createHiddenPreloadMenu=function(a,b){b.find("ul.subnav > li").each(function(){if($(this).attr("id")){var b=$(this).attr("id").replace("nav-","");if("undefined"!=typeof a[b])for(var c=a[b].length,d=0;c>d;d++)$(this).find("ul.preload-subnav").append(a[b][d])}})},veNav.saveCheckError=function(a){veNav.checkError=a},veNav.saveAllLevels=function(a){veNav.saveSingleLevel(a),$(a).find("> li > ul.subnav").each(function(){veNav.saveSingleLevel(this)})},veNav.saveSingleLevel=function(ul){var $ul=$(ul),parentId=0;$ul.is(".hiddennav")?parentId=-1:$ul.is(".topnav")?parentId=-2:$ul.is(".sidenav")?parentId=-3:$ul.is(".subnav")||$ul.is(".preload-subnav")?parentId=$ul.parent().attr("id").replace("nav-",""):$ul.is(".midnav")&&(parentId=$ul.attr("id").replace("midnav-",""));var position=void 0;if($ul.is(".topnav")||$ul.is(".topnav > li > .subnav")?position="top":$ul.is(".sidenav")||$ul.is(".sidenav > li > .subnav")?position="side":$ul.is(".hiddennav")||$ul.is(".hiddennav > li > .subnav")?position="hidden":($ul.is(".midnav")||$ul.is(".midnav > li > .preload-subnav"))&&(position="middle"),void 0!=position){var s=veNav.serialize($ul,"nav[]");"nav[]="!=s&&(s+="&parent="+parentId+"&method=position",$.ajax({url:"/modules/flexi/controllers/nav-save-controller.php",type:"POST",data:s,async:!1,success:function(data){var json=eval("("+data+")");veNav.saveCheckError(json),0==json&&alert(_T("__nav__บันทึกเมนูไม่สำเร็จ!"))},error:function(a,b,c){veNav.saveCheckError(0),alert(_T("__nav__บันทึกเมนูไม่สำเร็จ!")+" "+b+" "+c),veMain.log("ERROR: "+b+"\n\n"+c)}}))}},veNav.saveChanges=function(a,b,c,d){if(null!=veNav.sortableAffectedLists&&veNav.sortableAffectedLists.length>0&&1==veNav.checkSaveState){var e=veNav.sortableAffectedLists.length,f=1;$.each(veNav.sortableAffectedLists,function(a,g){if(veNav.saveSingleLevel(g),f==e){var h="dragged_id="+b+"&from_id="+c+"&to_id="+d+"&method=lineage";1==veNav.checkError&&$.ajax({url:"/modules/flexi/controllers/nav-save-controller.php",type:"POST",data:h,async:!1})}f++}),veNav.checkError=1,0==a.find(".subnav > .nav-content").length&&0==a.find(".preload-subnav").length&&veNav.getSubMenus(b),veNav.sortableAffectedLists=[],veTemplate.updateArchive(b),veEditMode.showSavedSplash()}},veNav.serialize=function(a,b){return $(a).sortable("serialize",{key:b})},veNav.setHomeMenu=function(){$(".nav li.home").find("> a > i").remove(),$(".nav li").removeClass("home"),$(".nav.topnav > li:not(.nav-add-button)").length>0?$(".nav.topnav").find(" li:first:not(.nav-add-button)").addClass("home"):$(".nav.sidenav").find(" li:first:not(.nav-add-button)").addClass("home");var a=$(".nav > li.home:not(.nav-add-button)");if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var b=new Number(RegExp.$1);7>=b?a.find("> a > div").css("display","inline").before('<img src="/modules/flexi/images/home.png" style="margin-right: 5px;"/>'):a.find("> a > div").css("display","inline").before('<i class="fa fa-home"></i> ')}else a.find("> a > div").css("display","inline").before('<i class="fa fa-home"></i> ');a.length>0&&(veMain.homeContentId=a.attr("id").replace("nav-",""))},veNav.editMenuTitle=function(a){var b=$("> a",a);b.data("old_text",b.text()),b.attr("contentEditable",!0).addClass("content-editable").focus(),veEditMode.preventMultipleLines(b),b.focusout(function(){$(this).removeClass("content-editable").attr("contentEditable",!1);var b=$(this).text(),c=$(this).data("old_text");if(b!=c)if(""==b)alert(_T("__nav__ไม่อนุญาตให้ใช้ค่าว่าง")),$(this).text(c);else{var d=a.attr("id").replace("nav-","");$.ajax({type:"POST",url:"/modules/flexi/controllers/content-save-controller.php",data:"task=edit_content&content[el_field]=title&content[el_val]="+encodeURIComponent(b)+"&content[c_id]="+d,success:function(){veEditMode.showSavedSplash()}})}})},veNav.bindContextMenuEdit_linkMenu=function(a){var b=a.attr("id").replace("nav-",""),c="/modules/flexi/views/link-menu-form.php?nav_id="+b,d=$(a).find("> .context-menu > ul > li.edit > a");d.click(function(a){a.preventDefault(),$.colorbox({href:c,onComplete:function(){veNav.linkMenuForm_init(),$(this).colorbox.resize()}})})},veNav.bindContextMenuEdit_tagMenu=function(a){var b=a.attr("id").replace("nav-",""),c="/modules/flexi/controllers/tag-menu-form-controller.php?nav_id="+b,d=$(a).find("> .context-menu > ul > li.edit > a");d.click(function(a){a.preventDefault(),$.colorbox({href:c,width:"370px",onComplete:function(){veNav.tagMenuForm_init(),$(this).colorbox.resize()}})})},veNav.bindContextMenuEdit_textMenu=function(a){var b=a.attr("id").replace("nav-",""),c="/modules/flexi/controllers/text-menu-form-controller.php?nav_id="+b,d=$(a).find("> .context-menu > ul > li.edit > a");d.click(function(a){a.preventDefault(),$.colorbox({href:c,onComplete:function(){veNav.textMenuForm_init(),$(this).colorbox.resize()}})})},veNav.bindContextMenuEdit_contentMenu=function(a){var b=a.attr("id").replace("nav-",""),c="/modules/flexi/views/content-add-form.php?type=page&nav_id="+b,d=$(a).find("> .context-menu > ul > li.edit > a");d.click(function(a){a.preventDefault(),$.colorbox({href:c,onComplete:function(){veNav.contentAddForm_init(),$(this).colorbox.resize()}})})},veNav.bindContextMenuEdit_webboard=function(a){var b=a.attr("id").replace("nav-",""),c=a.data("webboard-id"),d="/modules/flexi/views/content-add-form.php?type=webboard&nav_id="+b+"&webboard_id="+c,e=$(a).find("> .context-menu > ul > li.edit > a");e.click(function(a){a.preventDefault(),$.colorbox({href:d,onComplete:function(){veNav.contentWebboardEditForm_init(),$(this).colorbox.resize()}})})},veNav.bindContextMenuEdit=function(a){$(a).find("> .context-menu > ul > li.edit > a").each(function(){var a=$(this).parent().parent().parent().parent();a.hasClass("nav-link")?veNav.bindContextMenuEdit_linkMenu(a):a.hasClass("nav-text")?veNav.bindContextMenuEdit_textMenu(a):a.hasClass("nav-tag-menu")?veNav.bindContextMenuEdit_tagMenu(a):a.hasClass("nav-content")?veNav.bindContextMenuEdit_contentMenu(a):a.hasClass("nav-webboard")?veNav.bindContextMenuEdit_webboard(a):a.hasClass("nav-category")&&(veNav.bindContextMenuEdit_category(a),veNav.bindContextMenuChange_category(a))}).click(function(){var a=$(this).parent().parent().parent().parent();return a.find("> .context-menu").hide(),!1})},veNav.bindSeoSetting=function(a){$(a).find("> .context-menu > ul > li.seoSetting > a").each(function(){var a=$(this).parent().parent().parent().parent();(a.hasClass("nav-content")||a.hasClass("nav-webboard"))&&veNav.bindSeoSettingPage(a)}).click(function(){var a=$(this).parent().parent().parent().parent();return a.find("> .context-menu").hide(),!1})},veNav.bindSeoSettingPage=function(a){var b=a.attr("id").replace("nav-",""),c="/modules/flexi/controllers/seo-setting-form-controller.php?nav_id="+b,d=$(a).find("> .context-menu > ul > li.seoSetting > a");d.click(function(a){a.preventDefault(),$.colorbox({href:c,onComplete:function(){veNav.seoSettingForm_init(),$(this).colorbox.resize()}})})},veNav.seoSettingForm_init=function(){$("#frm-seo-setting-menu .submit").click(function(){return veNav.seoSettingForm_save(),!1}),$("#frm-seo-setting-menu .cancel").click(function(){$.colorbox.close()})},veNav.seoSettingForm_save=function(){var a=$("#frm-seo-setting-menu input[name=nav_id]").val(),b=$("#frm-seo-setting-menu textarea[name=meta_description]").val(),c=$("#frm-seo-setting-menu input[name=meta_keyword]").val(),d=$.trim($("#frm-seo-setting-menu input[name=page_title]").val()),e=b.length;if(e>200){var f=_T("__nav__Meta Description มีความยาวเกิน 200 ตัวอักษรที่กำหนด ระบบจะตัดตัวอักษรที่เกินออกโดยอัตโนมัติ")+"\n\n"+_T("__nav__ดำเนินการต่อ?");if(!confirm(f))return!1;b=b.substring(0,200)}$.ajax({url:"/modules/flexi/controllers/seo-setting-save-controller.php",type:"POST",data:"content_id="+a+"&meta_description="+b+"&meta_keyword="+c+"&page_title="+d,dataType:"html",async:!1,success:function(){$.colorbox.close(),veEditMode.showSavedSplash()},error:function(a,b,c){alert(_T("__nav__Error! ไม่สามารถบันทึกข้อมูลได้")),veMain.log("ERROR: "+b+"\n\n"+c)}})},veNav.bindContextMenuDelete=function(a){$(a).find("> .context-menu > ul > li.delete > a").unbind("click").click(function(){var a=$(this).parent().parent().parent().parent(),b=$.trim($("> a",a).text()),c=_T("__nav__ต้องการลบเมนูนี้?");return""!=b&&(c=a.hasClass("nav-webboard")?_T("__nav__ต้องการลบเว็บบอร์ด ")+'"'+b+'" ?':_T("__nav__ต้องการลบเมนู ")+'"'+b+'" ?'),confirm(c)&&veNav.validateBeforeDelete(a)&&veNav.deleteContent(a),!1})},veNav.validateBeforeDelete=function(a){var b=a.find("> a").parent().attr("id").replace("nav-",""),c=veNav.menuStructure[b].num_children;if(c>1)return alert(_T("__nav__ไม่สามารถลบเมนูนี้ได้ เนื่องจากมีเมนูอื่นอยู่ภายใต้มากกว่า 1 ระดับ")),!1;if(a.hasClass("home")){var d="",e="",f=a.next();f.hasClass("nav-link")?(d=$("> a",f).text(),e=_T("__nav__เมนูลิงก์")):f.hasClass("landing")?(d=$("> a",f).text(),e=_T("__nav__Landing page")):f.hasClass("nav-text")?(d=$("> a",f).text(),e=_T("__nav__เมนูข้อความ")):f.hasClass("nav-category")&&(d=$("> a",f).text(),e=_T("__nav__เมนูหมวดหมู่สินค้า"));var g=$("ul.topnav > li").length,h=$("ul.sidenav > li:first");if(0==g&&(h.hasClass("nav-link")?(d=$("> a",h).text(),e=_T("__nav__เมนูลิงก์")):h.hasClass("landing")?(d=$("> a",h).text(),e=_T("__nav__Landing page")):h.hasClass("nav-text")?(d=$("> a",h).text(),e=_T("__nav__เมนูข้อความ")):h.hasClass("nav-category")&&(d=$("> a",h).text(),e=_T("__nav__เมนูหมวดหมู่สินค้า"))),""!=d){var i=_T("__nav__ไม่สามารถลบเมนูนี้ได้ เนื่องจากจะทำให้ ")+e+" ("+d+") "+_T("__nav__เลื่อนมาเป็นหน้าแรก")+"\n\n"+_T("__nav__แนะนำให้ย้ายเมนูนี้ไปไว้ตำแหน่งอื่นก่อน แล้วทำการลบอีกครั้ง");return alert(i),!1}}var j=$(".topnav > li").size()+$(".sidenav > li").size(),k=$(".subnav > li",a).size();return 0==k&&0==c?1==j?(alert(_T("__nav__ไม่สามารถลบเมนูนี้ได้ เนื่องจากจะทำให้เว็บไซต์ของคุณไม่เหลือเนื้อหาใดๆ เลย")),!1):!0:confirm(_T("__nav__เมนูนี้มีเมนูอื่นอยู่ภายใต้")+"\n\n"+_T("__nav__ต้องการลบเมนูนี้และเมนูทั้งหมดที่อยู่ภายใต้เมนูนี้?"))?(veNav.validateSubMenuDeleted(b),0==veNav.deletedSubMenuStatus?(alert(_T("__nav__ไม่สามารถลบเมนูนี้ได้ เนื่องจากเมนูนี้มีเมนูย่อยอยู่มากกว่า")+" "+veNav.deletedSubMenuLimited+" "+_T("__nav__เมนู")),!1):1==j?(alert(_T("__nav__ไม่สามารถลบเมนูนี้ได้ เนื่องจากจะทำให้เว็บไซต์ของคุณไม่เหลือเนื้อหาใดๆ เลย")),!1):!0):!1},veNav.validateSubMenuDeleted=function(content_id){veNav.deletedSubMenuStatus=0,$.ajax({url:"/modules/flexi/controllers/content-delete-validate-sub-menu-limit-controller.php",type:"POST",data:"id="+content_id,async:!1,success:function(data){var result=eval("("+data+")");veNav.changeDeletedSubMenuValidateStatus(result.status,result.limited)}})},veNav.changeDeletedSubMenuValidateStatus=function(a,b){veNav.deletedSubMenuStatus=a,veNav.deletedSubMenuLimited=b},veNav.deleteContent=function(a){var b=a.attr("id").replace("nav-","");return""==b||"0"==b?(alert(_T("__nav__ไม่สามารถลบเมนูนี้ได้ มีความผิดพลาดบางอย่างเกิดขึ้น")+"\n\n(id="+a.attr("id")+")"),!1):($.ajax({type:"POST",url:"/modules/flexi/controllers/content-delete-controller.php",data:"id="+b+"&type="+veMain.page,success:function(c){"category"==veMain.page&&(veMain.contentId=c),b==veMain.contentId?document.location="/":a.hasClass("nav-webboard")?document.location="/webboard":(a.remove(),veNav.setHomeMenu()),veEditMode.showSavedSplash()}}),!0)},veNav.check_disk_usage=function(a,b){var c=!1;return a>b&&(alert(_T("__nav__คุณไม่สามารถเพิ่มเมนูใหม่ได้ เนื่องจากเว็บไซต์มีจำนวนเนื้อที่เกินกำหนด ")),c=!0),c},veNav.addButton_init=function(){$("#topbar .nav-add-button > a, #sidebar .nav-add-button > a").click(function(a){a.preventDefault();var b=$(this),c=b.attr("data-disk_usage"),d=b.attr("data-limit");return veNav.check_disk_usage(c,d)?!1:($.colorbox({href:"/modules/flexi/views/nav-add-form.php",innerWidth:650,data:{position:b.data("position")},onComplete:function(){veNav.addForm_init(),veNav.bindEventsCategoryMenu()}}),void 0)})},veNav.midNavAddButton_init=function(){$(".midnav .nav-add-button > a").click(function(a){a.preventDefault();var b=$(this),c=b.data("content_id"),d=b.attr("data-disk_usage"),e=b.attr("data-limit");return veNav.check_disk_usage(d,e)?!1:veNav.menuStructure[c].depth>=5?(alert(_T("__nav__ไม่สามารถสร้างเมนูภายใต้เมนูนี้ได้ ระบบรองรับเมนูแค่ 5 ระดับ")),!1):($.colorbox({href:"/modules/flexi/views/nav-add-form.php?parent_id="+c,onComplete:function(){veNav.addForm_init(),$(this).colorbox.resize(),veNav.bindEventsCategoryMenu()}}),void 0)})},veNav.addButton_onComplete=function(){veNav.addForm_init()},veNav.check_Adding_Album=function(){var a=!1;return $("#nav-add-form ul > li > a.album").each(function(){var b=$(this),c=b.attr("data-album_count"),d=b.attr("data-limit");c>d&&(alert(_T("__nav__คุณไม่สามารถสร้างอัลบั้มรูปได้มากกว่า")+" "+d+" "+_T("__nav__อัลบั้ม")),a=!0)}),a},veNav.check_Adding_Webboard=function(){var a=!1;return $("#nav-add-form ul > li > a.webboard").each(function(){var b=$(this),c=b.attr("data-webboard_count"),d=b.attr("data-limit");c>d&&(alert(_T("__nav__คุณไม่สามารถสร้างเว็บบอร์ดได้มากกว่า")+" "+d+" "+_T("__nav__เว็บบอร์ด")),a=!0)}),a},veNav.bindContextMenuAdd=function(a){$(a).find("> .context-menu > ul > li.addSubMenu > a").click(function(a){a.preventDefault();var b=$(this).parent().parent().parent().parent().find("> a").parent(),c=b.attr("id").replace("nav-",""),d=b.attr("class").replace("nav-",""),e=d.split(" ");return b.attr("id").replace("nav-","")&&veNav.menuStructure[c].depth<5?"category"==e[0]&&veNav.menuStructure[c].depth>1?alert(_T("__nav__การเพิ่มเมนูภายใต้เมนูนี้ จะทำให้ไม่สามารถเข้าถึงเมนูที่อยู่ภายใต้ได้")):!veNav.checkTypeNoChildMenu(b)||veNav.menuStructure[c].depth<2?$.colorbox({href:"/modules/flexi/views/nav-add-form.php?parent_id="+c,onComplete:function(){veNav.addForm_init(),veNav.bindEventsCategoryMenu(),$(this).colorbox.resize()}}):alert(_T("__nav__การเพิ่มเมนูภายใต้เมนูนี้ จะทำให้ไม่สามารถเข้าถึงเมนูที่อยู่ภายใต้ได้")):alert(_T("__nav__ไม่สามารถสร้างเมนูภายใต้เมนูนี้ได้ ระบบรองรับเมนูแค่ 5 ระดับ")),!1})},veNav.checkContentLimit=function(){var a="";return $.ajax({url:"/modules/flexi/api/public/Account.php",type:"POST",data:{task:"check_content_limit"},async:!1,dataType:"json",success:function(b){a=b}}),a},veNav.checkBackupContentLimit=function(a){var b="";return $.ajax({url:"/modules/flexi/api/public/Account.php",type:"POST",data:{task:"check_backup_content_limit",content_id:a},async:!1,dataType:"json",success:function(a){b=a}}),b},veNav.addForm_init=function(){$("#nav-add-form ul > li > a").each(function(){var a=$(this),b=a.data("type"),c=!1;"webboard-list"==b?a.click(function(){var a=veNav.checkContentLimit();return veNav.check_Adding_Special_Menu_As_Home()?(alert(_T("__nav__เมนูลิงก์ ไม่สามารถกำหนดเป็นเมนูแรกได้")),!1):(1==a.status?$.ajax({url:$(this).attr("href"),type:"GET",async:!0,success:function(){$.colorbox.close(),veEditMode.showSavedSplash("",function(){window.location="/webboard/"})},error:function(a,b,c){alert(_T("__nav__Error! ไม่สามารถบันทึกข้อมูลได้")),veMain.log("ERROR: "+b+"\n\n"+c),$.colorbox.close()}}):alert(_T("__nav__ไม่สามารถเพิ่มเมนูได้")+" "+a.max+" "+_T("__nav__หน้า")),!1)}):"member-menu"==b?a.click(function(a){var b=veNav.checkContentLimit();return a.preventDefault(),veNav.check_Adding_Special_Menu_As_Home()?(alert(_T("__nav__เมนูลิงก์ ไม่สามารถกำหนดเป็นเมนูแรกได้")),$.colorbox.close(),!1):(1==b.status?$.ajax({url:$(this).attr("href"),type:"GET",async:!0,success:function(){$.colorbox.close(),veEditMode.showSavedSplash("",function(){window.location="/member/"})},error:function(a,b,c){alert(_T("__nav__Error! ไม่สามารถบันทึกข้อมูลได้")),veMain.log("ERROR: "+b+"\n\n"+c)}}):alert(_T("__nav__ไม่สามารถเพิ่มเมนูได้")+" "+b.max+" "+_T("__nav__หน้า")),!1)}):("album"==b?a.click(function(a){a.preventDefault(),veNav.check_Adding_Album()&&$.colorbox.close();var b=veNav.checkContentLimit();return 0==b.status?(alert(_T("__nav__ไม่สามารถเพิ่มเมนูได้")+" "+b.max+" "+_T("__nav__หน้า")),!1):void 0}):"webboard"==b?a.click(function(a){a.preventDefault(),veNav.check_Adding_Webboard()&&$.colorbox.close();var b=veNav.checkContentLimit();return 0==b.status?(alert(_T("__nav__ไม่สามารถเพิ่มเมนูได้")+" "+b.max+" "+_T("__nav__หน้า")),!1):void 0}):"tag-menu"==b?(a.click(function(a){if(a.preventDefault(),veNav.check_Adding_Special_Menu_As_Home())return alert(_T("__nav__เมนูลิงก์ ไม่สามารถกำหนดเป็นเมนูแรกได้")),$.colorbox.close(),!1;var b=veNav.checkContentLimit();return 1!=b.status?(alert(_T("__nav__ไม่สามารถเพิ่มเมนูได้")+" "+b.max+" "+_T("__nav__หน้า")),!1):($.ajax({url:$(this).attr("href"),type:"GET",async:!1,success:function(a){"0"==a&&(alert(_T('__nav__ยังไม่มีรายการ tag! ท่านสามารถทำการใส่ tag ให้กับเมนูได้ผ่านทางเมนู "แก้ไขเมนู"')),$.colorbox.close())},error:function(a,b,c){alert(_T("__nav__Error! ไม่สามารถบันทึกข้อมูลได้")),veMain.log("ERROR: "+b+"\n\n"+c)}}),void 0)}),c="370px"):"page"==b?a.click(function(a){var b=veNav.checkContentLimit();return 0==b.status?(a.preventDefault(),alert(_T("__nav__ไม่สามารถเพิ่มเมนูได้")+" "+b.max+" "+_T("__nav__หน้า")),!1):void 0}):"landing"==b&&a.click(function(a){var b=veNav.checkContentLimit();return 0==b.status?(a.preventDefault(),alert(_T("__nav__ไม่สามารถเพิ่มเมนูได้")+" "+b.max+" "+_T("__nav__หน้า")),!1):void 0}),"category"!=b&&a.colorbox({width:c,onLoad:function(){veNav.addForm_onStart(b)},onComplete:function(){veNav.addForm_onComplete(b),$(this).colorbox.resize()}}))})},veNav.addForm_onStart=function(a){switch(a){case"page":case"album":case"webboard":case"category":break;case"link":if(veNav.check_Adding_Special_Menu_As_Home())return alert(_T("__nav__เมนูลิงก์ ไม่สามารถกำหนดเป็นเมนูแรกได้")),$.colorbox.close(),!1;break;case"tag-menu":break;case"text":if(veNav.check_Adding_Special_Menu_As_Home())return alert(_T("__nav__เมนูข้อความ ไม่สามารถกำหนดเป็นเมนูแรกได้")),$.colorbox.close(),!1;break;case"landing":if(veNav.check_Adding_Special_Menu_As_Home())return alert(_T("__nav__Landing page ไม่สามารถกำหนดเป็นเมนูแรกได้")),$.colorbox.close(),!1;break;case"member-menu":if(veNav.check_Adding_Special_Menu_As_Home())return alert(_T("__nav__เมนูลิงก์ ไม่สามารถกำหนดเป็นเมนูแรกได้")),$.colorbox.close(),!1;break;default:return alert(_T("__nav__Not implemented yet.")),$.colorbox.close(),!1}},veNav.addForm_onComplete=function(a){switch(a){case"page":case"landing":case"album":veNav.contentAddForm_init();break;case"link":veNav.linkMenuForm_init();break;case"tag-menu":veNav.tagMenuForm_init();break;case"text":veNav.textMenuForm_init();break;case"webboard":veMain.loadJS(veMain.debug?"/modules/flexi/js/velaeasy/ungrouped/webboard.js":"/modules/flexi/js/velaeasy/webboard.min.js"),veWebboard.initCreateWebboardForm()}},veNav.contentWebboardEditForm_init=function(){var a=$("#frm-add-content input[name=nav_title]"),b=$("#frm-add-content input[name=title]"),c=$("#frm-add-content input[name=content_title_sync]");veNav.contentTitleSync(a,b,c),$("#frm-add-content").bind("submit",function(){var a=$.trim($("#frm-add-content input[name=nav_title]").val()),b=$.trim($("#frm-add-content input[name=title]").val()),c=($("#frm-add-content input[name=type]").val(),"");return""==a&&(c+=_T("__nav__กรุณากรอก ชื่อเมนู")+"\n"),""==b&&(c+=_T("__nav__กรุณากรอก ชื่อเว็บบอร์ด")),""==c?veNav.contentWebboardEditForm_save():alert(c),!1}),$("#frm-add-content .cancel").click(function(){$.colorbox.close()})},veNav.contentWebboardEditForm_save=function(){{var a=$("#frm-add-content input[name=task]").val(),b=$("#frm-add-content input[name=nav_title]").val(),c=$("#frm-add-content input[name=title]").val(),d=$("#frm-add-content input[name=content_id]").val();$("#frm-add-content input[name=parent_id]").val()}veNav.validateSymbol(b)&&veNav.validateSymbol(c)&&$.ajax({url:"/modules/flexi/controllers/webboard-process-controller.php",type:"POST",data:$("#frm-add-content").serialize(),dataType:"html",async:!1,success:function(e){$.colorbox.close(),veEditMode.showSavedSplash(),"edit-webboard"==a?($("#nav-"+d+"> a").html(b),$(".webboard > .title > span.webboard-title").html(c),veEditMode.syncContentTitle("#nav-"+veMain.contentId+"> a")):window.location.href=$.trim(e)},error:function(a,b,c){alert(_T("__nav__Error! ไม่สามารถบันทึกข้อมูลได้")),veMain.log("ERROR: "+b+"\n\n"+c)}})},veNav.contentAddForm_init=function(){if(veMain.loadCSS("/modules/flexi/js/jquery.tag-it/jquery.tag-it.css"),veMain.loadJS("/modules/flexi/js/jquery.tag-it/jquery.tag-it.js"),veMain.loadJS("/modules/flexi/js/xregexp/xregexp-all-min.js"),$("#frm-add-content").find("#tag_title").length>0){var a=$("#frm-add-content input[name=tag_availble]").val().split(","),b="^[\\p{Letter}\\p{Number}\\p{Thai}\\#\\+\\-\\'\\ ]+$";$("#frm-add-content #tag_title").tagit({fieldName:"content_tag[]",availableTags:a,allowSpaces:!0,removeConfirmation:!0,showAutocompleteOnFocus:!1,beforeTagAdded:function(a,c){return XRegExp(b).test(c.tagLabel)?void 0:!1},afterTagAdded:function(){$.colorbox.resize()}})}var c=$("#frm-add-content input[name=nav_title]"),d=$("#frm-add-content input[name=title]"),e=$("#frm-add-content input[name=content_title_sync]");veNav.contentTitleSync(c,d,e),$("#frm-add-content").bind("submit",function(){{var a=$.trim($("#frm-add-content input[name=nav_title]").val());$("#frm-add-content input[name=type]").val()}return""==a?alert(_T("__nav__กรุณากรอก ชื่อเมนู")):veNav.contentAddForm_save(),!1}),$("#frm-add-content .cancel").click(function(){$.colorbox.close()})},veNav.contentAddForm_save=function(){{var a=$("#frm-add-content input[name=task]").val(),b=$("#frm-add-content input[name=nav_title]").val(),c=$("#frm-add-content input[name=title]").val(),d=$("#frm-add-content input[name=content_id]").val();$("#frm-add-content input[name=parent_id]").val()}veNav.validateSymbol(b)&&veNav.validateSymbol(c)&&($("#frm-add-content input[name=tag_availble]").attr("disabled","disabled"),$.ajax({url:"/modules/flexi/controllers/content-add-controller.php",type:"POST",data:$("#frm-add-content").serialize(),dataType:"html",async:!1,success:function(c){$.colorbox.close(),veEditMode.showSavedSplash("",function(){"edit"==a?($("#nav-"+d+"> a").html(b),veEditMode.syncContentTitle("#nav-"+veMain.contentId+"> a")):window.location.href=$.trim(c)})},error:function(a,b,c){alert(_T("__nav__Error! ไม่สามารถบันทึกข้อมูลได้")),veMain.log("ERROR: "+b+"\n\n"+c)}}))},veNav.linkMenuForm_init=function(){$("#frm-add-link-menu .submit").click(function(){return veNav.linkMenuForm_validate()&&veNav.validateSymbol($.trim($("#frm-add-link-menu input[name=nav_title]").val()))&&veNav.linkMenuForm_save(),!1}),$("#frm-add-link-menu .cancel").click(function(){$.colorbox.close()})},veNav.linkMenuForm_validate=function(){var a=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/,b="",c=!1,d=$.trim($("#frm-add-link-menu input[name=nav_title]").val()),e=$("#frm-add-link-menu input[name=link_href]").val();return""==d&&(b+=_T("__nav__กรุณากรอก ชื่อเมนู")+"\n",c=!0),""==e?(b+=_T("__nav__กรุณากรอก URL")+"\n",c=!0):a.test(e)||"#"==e||"/webboard/"==e||"/member/"==e||(b+=_T("__nav__กรุณากรอก URL ให้ถูกต้อง")+"\n	"+_T("__nav__ตัวอย่าง URL ที่ถูกต้อง เช่น http://www.google.com")+"\n",c=!0),1==c?(alert(b),!1):!0},veNav.linkMenuForm_save=function(){$.ajax({url:"/modules/flexi/controllers/link-menu-save-controller.php",type:"POST",data:$("#frm-add-link-menu").serialize(),dataType:"html",async:!1,success:function(a){veNav.linkMenuForm_updateTargetElement(a),veNav.init(),$.colorbox.close(),veEditMode.showSavedSplash()},error:function(a,b,c){alert(_T("__nav__Error! ไม่สามารถบันทึกข้อมูลได้")),veMain.log("ERROR: "+b+"\n\n"+c)}})},veNav.linkMenuForm_updateTargetElement=function(a){var b=$("#frm-add-link-menu input[name=task]").val(),c=$("#frm-add-link-menu input[name=nav_title]").val(),d=$("#frm-add-link-menu input[name=link_href]").val(),e=$("#frm-add-link-menu input[name=link_target]:checked").val(),f=$("#frm-add-link-menu input[name=nav_id]").val(),g=$("#frm-add-link-menu input[name=parent_id]").val(),h=$("#frm-add-link-menu input[name=position]").val();if("add_link"==b){var i=$.trim(a);liHTML='<li id="nav-'+i+'" class="nav-link"><a href="'+d+'" target="'+e+'">'+c+'</a><ul class="subnav"></ul></li>',veEditMode.showSidebar&&"side"==h?veNav.menuStructure[g].id<0?$("ul.sidenav").append(liHTML):1==veNav.menuStructure[g].depth?(liHTML='<li id="nav-'+i+'" class="nav-link"><a href="'+d+'" target="'+e+'">'+c+'</a><ul class="preload-subnav"></ul></li>',$('ul.sidenav > li[id="nav-'+g+'"]').find("ul.subnav").append(liHTML)):veNav.menuStructure[g].depth>=2&&veNav.linkMenuAppendToMidnav(i,g,d,e,c):veNav.menuStructure[g].id<0?$(liHTML).insertBefore("ul.topnav .nav-add-button"):1==veNav.menuStructure[g].depth?(liHTML='<li id="nav-'+i+'" class="nav-link"><a href="'+d+'" target="'+e+'">'+c+'</a><ul class="preload-subnav"></ul></li>',$('ul.topnav > li[id="nav-'+g+'"]').find("ul.subnav").append(liHTML)):veNav.menuStructure[g].depth>=2&&veNav.linkMenuAppendToMidnav(i,g,d,e,c)}else $("ul.nav > li#nav-"+f+" > a").each(function(){$(this).attr("href",d),$(this).attr("target",e),$(this).html(c)}),$("ul.subnav > li#nav-"+f+" > a").each(function(){$(this).attr("href",d),$(this).attr("target",e),$(this).html(c)})},veNav.linkMenuAppendToMidnav=function(a,b,c,d,e){liHTML='<li id="nav-'+a+'" class="nav-link"><a href="'+c+'" target="'+d+'">'+e+'</a><ul class="preload-subnav"></ul></li>',$('div[id="midbar"] > ul[id="midnav-'+b+'"]').find()&&$(liHTML).insertBefore('div[id="midbar"] > ul[id="midnav-'+b+'"] .nav-add-button')},veNav.tagMenuForm_init=function(){var a="",b="",c="",d="",e="";
$("#frm-add-tag-menu input[name=tag_title], #frm-add-tag-menu input[name=tag_title_selector]").colorbox({width:"600px",href:"/modules/flexi/controllers/tag-menu-selector-controller.php",onLoad:function(){a=$("#frm-add-tag-menu input[name=nav_title]").val(),veNav.nav_title_tag_menu=$("#frm-add-tag-menu input[name=nav_title]").val(),b=$("#frm-add-tag-menu input[name=position]").val(),c=$("#frm-add-tag-menu input[name=nav_id]").val(),d=$("#frm-add-tag-menu input[name=parent_id]").val(),e="",$("#frm-add-tag-menu input[name=member_only]").is(":checked")&&(e=1)},onComplete:function(){veMain.loadJS("/modules/flexi/js/jquery.tinysort/jquery.tinysort.min.js"),1==veMain.tag_cloud?$("#tag_cloud_selector").tagcloud({type:"list",sizemin:14,colormin:"494949",colormax:"494949"}).find("li").tsort():$("#tag_cloud_selector").addClass("no-tagcloud").find("li").tsort(),$(this).colorbox.resize(),$("#tag_cloud_selector > li > a").click(function(f){f.preventDefault(),$.colorbox({href:"/modules/flexi/controllers/tag-menu-form-controller.php?position="+b+"&parent_id="+d+"&nav_id="+c+"&nav_title="+encodeURIComponent(a)+"&tag_title="+encodeURIComponent($(this).text())+"&member_only="+e,width:"370px",onComplete:function(){veNav.tagMenuForm_init(),$("#frm-add-tag-menu input[name=nav_title]").val(""+veNav.nav_title_tag_menu)}})})}}),$("#frm-add-tag-menu .submit").click(function(){return veNav.tagMenuForm_validate()&&veNav.tagMenuForm_save(),!1}),$("#frm-add-tag-menu .cancel").click(function(){$.colorbox.close()})},veNav.tagMenuForm_validate=function(){var a="",b=!1,c=$.trim($("#frm-add-tag-menu input[name=nav_title]").val()),d=$("#frm-add-tag-menu input[name=tag_title]").val();return""==c&&(a+=_T("__nav__กรุณากรอก ชื่อเมนู")+"\n",b=!0),""==d&&(a+=_T("__nav__กรุณาเลือก Tag")+"\n",b=!0),1==b?(alert(a),!1):!0},veNav.tagMenuForm_save=function(){{var a=$("#frm-add-tag-menu input[name=task]").val(),b=$("#frm-add-tag-menu input[name=nav_title]").val(),c=($("#frm-add-tag-menu input[name=title]").val(),$("#frm-add-tag-menu input[name=nav_id]").val());$("#frm-add-tag-menu input[name=parent_id]").val()}veNav.validateSymbol(b)&&$.ajax({url:"/modules/flexi/controllers/tag-menu-save-controller.php",type:"POST",data:$("#frm-add-tag-menu").serialize(),dataType:"html",async:!1,success:function(d){$.colorbox.close(),""!=d?veEditMode.showSavedSplash("",function(){"edit_tag_menu"==a?($("#nav-"+c+"> a").html(b),$("#nav-"+c+"> a").attr("href",d),veEditMode.syncContentTitle("#nav-"+veMain.contentId+"> a")):window.location.href=$.trim(d)}):alert(_T("__nav__Error! ไม่สามารถบันทึกข้อมูลได้"))},error:function(a,b,c){alert(_T("__nav__Error! ไม่สามารถบันทึกข้อมูลได้")),veMain.log("ERROR: "+b+"\n\n"+c)}})},veNav.textMenuForm_init=function(){$("#frm-add-text-menu .submit").click(function(){return veNav.validateSymbol($("input[name=nav_title]").val())&&veNav.textMenuForm_save(),!1}),$("#frm-add-text-menu .cancel").click(function(){$.colorbox.close()})},veNav.textMenuForm_validate=function(){var a="",b=!1,c=$.trim($("#frm-add-text-menu input[name=nav_title]").val());return""==c&&(a+=_T("__nav__กรุณากรอก ชื่อเมนู")+"\n",b=!0),1==b?(alert(a),!1):!0},veNav.textMenuForm_save=function(){$.ajax({url:"/modules/flexi/controllers/text-menu-save-controller.php",type:"POST",data:$("#frm-add-text-menu").serialize(),dataType:"html",async:!1,success:function(a){veNav.textMenuForm_updateTargetElement(a),veNav.init(),$.colorbox.close(),veEditMode.showSavedSplash()},error:function(a,b,c){alert(_T("__nav__Error! ไม่สามารถบันทึกข้อมูลได้")),veMain.log("ERROR: "+b+"\n\n"+c)}})},veNav.textMenuForm_updateTargetElement=function(a){var b=$("#frm-add-text-menu input[name=task]").val(),c=$("#frm-add-text-menu input[name=nav_title]").val(),d=$("#frm-add-text-menu input[name=nav_id]").val(),e=$("#frm-add-text-menu input[name=parent_id]").val(),f=$("#frm-add-text-menu input[name=position]").val();if("add_text"==b){var g=$.trim(a);liHTML='<li id="nav-'+g+'" class="nav-text"><a>'+c+'</a><ul class="subnav"></ul></li>',veEditMode.showSidebar&&"side"==f?veNav.menuStructure[e].id<0?$("ul.sidenav").append(liHTML):1==veNav.menuStructure[e].depth?(liHTML='<li id="nav-'+g+'" class="nav-text"><a>'+c+'</a><ul class="preload-subnav"></ul></li>',$('ul.sidenav > li[id="nav-'+e+'"]').find("ul.subnav").append(liHTML)):veNav.menuStructure[e].depth>=2&&veNav.textMenuAppendToMidnav(g,e,c):veNav.menuStructure[e].id<0?$(liHTML).insertBefore("ul.topnav .nav-add-button"):1==veNav.menuStructure[e].depth?(liHTML='<li id="nav-'+g+'" class="nav-text"><a>'+c+'</a><ul class="preload-subnav"></ul></li>',$('ul.topnav > li[id="nav-'+e+'"]').find("ul.subnav").append(liHTML)):veNav.menuStructure[e].depth>=2&&veNav.textMenuAppendToMidnav(g,e,c)}else $("ul.nav > li#nav-"+d+" > a").each(function(){$(this).html(c)}),$("ul.subnav > li#nav-"+d+" > a").each(function(){$(this).html(c)})},veNav.textMenuAppendToMidnav=function(a,b,c){liHTML='<li id="nav-'+a+'" class="nav-text"><a>'+c+'</a><ul class="preload-subnav"></ul></li>',$('div[id="midbar"] > ul[id="midnav-'+b+'"]').find()&&$(liHTML).insertBefore('div[id="midbar"] > ul[id="midnav-'+b+'"] .nav-add-button')},veNav.contentTitleSync=function(a,b,c){c.is(":checked")&&(a.unbind("keyup"),a.unbind("blur"),b.unbind("keyup"),b.unbind("blur"),a.bind({keyup:function(){b.val($(this).val())},blur:function(){b.val($(this).val())}}),b.bind("keyup",function(){c.attr("checked",!1),a.unbind("keyup"),a.unbind("blur"),b.unbind("keyup"),b.unbind("blur")})),c.bind("change",function(){$(this).is(":checked")?(a.unbind("keyup"),a.unbind("blur"),b.unbind("keyup"),b.unbind("blur"),b.val(a.val()),a.bind({keyup:function(){b.val($(this).val())},blur:function(){b.val($(this).val())}}),b.bind({keyup:function(){a.val($(this).val())},blur:function(){a.val($(this).val())}})):(a.unbind("keyup"),a.unbind("blur"),b.unbind("keyup"),b.unbind("blur"))})},veNav.validateSymbol=function(a){var b='"',c=a.match(b);return c?(alert(_T('__nav__Error! ไม่สามารถบันทึกข้อมูลที่มีสัญลักษณ์ " (Double Quote) ได้')),!1):!0},veNav.initTreeview=function(){$(".category-contents-selector #category-contents-tree-menu").treeview({animated:"fast",collapsed:!1})},veNav.bindEventsCategoryMenu=function(){$("#categoryMenu > a").click(function(){var a=$(this).attr("attr-parent"),b=$(this).attr("attr-position");$.colorbox({width:"520px",height:"460px",href:"/modules/flexi/controllers/category-new-selector-controller.php?parent_id="+a+"&position="+b,onComplete:function(){veMain.loadCSS("/modules/flexi/js/jquery.treeview/jquery.treeview.css"),veMain.loadJS("/modules/flexi/js/jquery.tinysort/jquery.tinysort.min.js"),veMain.loadJS("/modules/flexi/js/jquery.treeview/jquery.treeview.min.js"),veNav.initTreeview(),veNav.bindEventsCategoryMenuSaveCancel()}})})},veNav.categoryAddForm_save=function(){var a=$("input[name=category_item]:checked").attr("attr-id"),b=$("input[name=category_item]:checked").attr("attr-name"),c=$("input[name=category_item]:checked").attr("attr-name"),d=$("input[name=category_item]:checked").attr("attr-static"),e=$("#frm-add-category-menu input[name=position]").val(),f=$("#frm-add-category-menu input[name=parent_id]").val(),g=$("#frm-add-category-menu input[name=task]").val(),h=$("#frm-add-category-menu input[name=content_id]").val(),i=$("#frm-add-category-menu input[name=action]").val();$.ajax({url:"/modules/flexi/controllers/content-add-controller.php",type:"POST",data:{type:"category",task:g,nav_title:b,title:c,"static":d,position:e,parent_id:f,content_id:h,link_href:"/category/"+a,link_target:"_self",action:i},dataType:"html",async:!1,success:function(a){$.colorbox.close(),veEditMode.showSavedSplash("",function(){"editTitle"==e?($("#nav-"+h+"> a").html(b),veEditMode.syncContentTitle("#nav-"+veMain.contentId+"> a")):window.location.href=$.trim(a)})},error:function(a,b,c){alert(_T("__nav__Error! ไม่สามารถบันทึกข้อมูลได้")),veMain.log("ERROR: "+b+"\n\n"+c)}})},veNav.bindContextMenuEdit_category=function(a){var b=a.attr("id").replace("nav-",""),c=$(a).find("> .context-menu > ul > li.edit > a");c.click(function(a){a.preventDefault(),$.colorbox({width:"425px",height:"220px",href:"/modules/flexi/views/category-edit-form.php?nav_id="+b,onComplete:function(){veNav.bindEventsCategoryMenuSaveCancel()}})})},veNav.bindContextMenuChange_category=function(a){var b=a.attr("id").replace("nav-",""),c=$(a).find("> .context-menu > ul > li.changeCategory > a");c.click(function(a){a.preventDefault();$(this).attr("attr-parent"),$(this).attr("attr-position");$.colorbox({width:"520px",height:"460px",href:"/modules/flexi/controllers/category-new-selector-controller.php?content_id="+b,onComplete:function(){veMain.loadCSS("/modules/flexi/js/jquery.treeview/jquery.treeview.css"),veMain.loadJS("/modules/flexi/js/jquery.tinysort/jquery.tinysort.min.js"),veMain.loadJS("/modules/flexi/js/jquery.treeview/jquery.treeview.min.js"),veNav.initTreeview(),veNav.bindEventsCategoryMenuSaveCancel()}})})},veNav.bindEventsCategoryMenuSaveCancel=function(){var a=document.getElementsByClassName("close")[0];a.onclick=function(){veNav.bindShowHideModal("none")},window.onclick=function(a){a.target.id==$("#myModal").children("form").attr("id")&&veNav.bindShowHideModal("none")},$("#frm-add-category-menu .category-contents-selector-cancel").click(function(a){a.preventDefault(),$.colorbox.close()}),$("#frm-add-category-menu .category-contents-selector-submit").click(function(a){a.preventDefault();var b=$("input[name=category_item]:checked").val();return void 0==b?alert(_T("__nav__กรุณาเลือกหมวดหมู่สินค้า")):veNav.categoryAddForm_save(),!1}),$("#frm-edit-category-menu .cancel").click(function(a){a.preventDefault(),$.colorbox.close()}),$("#frm-edit-category-menu .submit").click(function(a){a.preventDefault();var b=$("input[name=nav_title]").val();return void 0!=b&&""!=b?veNav.categoryEditForm_save():alert(_T("__nav__กรุณากรอก ชื่อเมนู")),!1})},veNav.categoryEditForm_save=function(){var a=$("#frm-edit-category-menu input[name=task]").val(),b=$("#frm-edit-category-menu input[name=nav_title]").val(),c=$("#frm-edit-category-menu input[name=content_id]").val();veNav.validateSymbol(b)&&$.ajax({url:"/modules/flexi/controllers/content-add-controller.php",type:"POST",data:$("#frm-edit-category-menu").serialize(),dataType:"html",async:!1,success:function(){veEditMode.showSavedSplash("",function(){$.colorbox.close(),"edit"==a&&($("#nav-"+c+"> a").html(b),veEditMode.syncContentTitle("#nav-"+veMain.contentId+"> a"))})},error:function(a,b,c){alert(_T("__nav__Error! ไม่สามารถบันทึกข้อมูลได้")),veMain.log("ERROR: "+b+"\n\n"+c)}})},veNav.initModal=function(a,b){document.getElementById("myModal")&&document.getElementById("myModal").remove();var c=document.createElement("div");c.setAttribute("id","myModal"),c.setAttribute("class","modal"),c.innerHTML=a,document.body.prepend(c),veNav.bindShowHideModal(b)},veNav.bindShowHideModal=function(a){var b=document.getElementById("myModal");b.style.display=a},veNav.setScrollTopbar=function(){if("edit"==veMain.mode)$("ul.topnav > li > ul.subnav").css("overflow","initial");else{{var a=0,b=0,c=0,d=0;$("ul.topnav")}$("#edit-bar").is(":visible")&&(d=36),$("#banner-festival").is(":visible")&&(a=$("#banner-festival").height()),$("#header-v2").is(":visible")&&(b=$("#header-v2").height()),c=$("ul.topnav").height(),c>89&&(c=89);var e=$(window).height(),f=d+a+b+c,g=e-f;100>g?g=100:g>500&&(g=500);var h=e-c-d;100>h?h=100:h>550&&(h=550),$("ul.topnav > li > ul.subnav").css("max-height",g),$("#header #topbar.sticky ul.subnav").css("max-height",h),veMain.initCustomScrollbarTheme($("ul.topnav > li > ul.subnav"),"minimal-dark")}};var veBanner={};veBanner.setImageSource=function(a){var b=$(window).width(),c=a.data("type");$(a).find(".banner-section-item").each(function(){var a=$(this),d=a.find(".banner-section-image").data("banner_image_normal_1"),e=a.find(".banner-section-image").data("banner_image_multi_1"),f=a.find(".banner-section-image").data("banner_image_multi_2"),g=a.find(".banner-section-image").data("banner_image_multi_3"),h=(new Date).getTime();"edit"==veMain.mode?"normal"==c?a.find(".banner-section-image").attr("src","/images/banner/crop-"+d+"?"+h):"multi"==c&&(b>=1200?a.find(".banner-section-image").attr("src","/images/banner/crop-"+e+"?"+h):b>=611?a.find(".banner-section-image").attr("src","/images/banner/crop-"+f+"?"+h):a.find(".banner-section-image").attr("src","/images/banner/crop-"+g+"?"+h),veBanner.checkWindowResize(a,c,e,f,g)):"normal"==c?a.find(".banner-section-image").attr("src","/images/banner/crop-"+d):"multi"==c&&(b>=1200?a.find(".banner-section-image").attr("src","/images/banner/crop-"+e):b>=611?a.find(".banner-section-image").attr("src","/images/banner/crop-"+f):a.find(".banner-section-image").attr("src","/images/banner/crop-"+g),veBanner.checkWindowResize(a,c,e,f,g))})},veBanner.checkWindowResize=function(a,b,c,d,e){$(window).resize(function(){var f=(new Date).getTime(),g=$(window).width();"edit"==veMain.mode&&"multi"==b?g>=1200?a.find(".banner-section-image").attr("src","/images/banner/crop-"+c+"?"+f):g>=611?a.find(".banner-section-image").attr("src","/images/banner/crop-"+d+"?"+f):a.find(".banner-section-image").attr("src","/images/banner/crop-"+e+"?"+f):"multi"==b&&(g>=1200?a.find(".banner-section-image").attr("src","/images/banner/crop-"+c):g>=611?a.find(".banner-section-image").attr("src","/images/banner/crop-"+d):a.find(".banner-section-image").attr("src","/images/banner/crop-"+e))})};var veComment={};veComment.init=function(){veComment.makeTabs(),veComment.bindShowAll(),veComment.bindDeleteButton(),veComment.initForm()},veComment.makeTabs=function(){$("#comment-tabs").tabs()},veComment.loadComments=function(a){$.ajax({url:"/modules/flexi/views/comment-loader.php",type:"GET",data:{show:a?"all":""},success:function(a){$("#comment-tabs > #comment").html(a),veComment.bindShowAll(),veComment.bindDeleteButton(),veComment.initForm(),"1"==veMain.reCaptchaEnable?veReCaptcha.initSpecificElement($(".comment_form .reCaptcha-container").attr("id")):(veCaptcha.init(),veCaptcha.reloadImage())}})},veComment.bindShowAll=function(){$(".comment_container > .show-all > a").click(function(){return veComment.loadComments(!0),!1})},veComment.initForm=function(){veComment.bindTextarea(),veComment.bindSubmitButton()},veComment.bindTextarea=function(){$(".comment_form textarea[name=detail]").bind("focus",function(){$(this).removeClass("narrow"),$(".comment_form .hidden-on-load").show()})},veComment.bindSubmitButton=function(){$(".comment_form input[type=button].button_save").unbind("click").click(function(){$(".comment_form #validate_detail").text(""),$(".comment_form #validate_username").text(""),"1"==veMain.reCaptchaEnable?$(".comment-captcha-error").text(""):$(".captcha .error").text("");var a=$.trim($(".comment_form input[name=username]").val()),b=$.trim($(".comment_form textarea[name=detail]").val()),c=($(".comment_form input[name=parent_id]").val(),$(".comment_form input[name=parent_type]").val(),$(".comment_form input[name=submitted_captcha]").val()),d=$(".comment_form input.captcha-cache").val();return b=$.trim(b),""==b?($("#validate_detail").text(_T("__comment__เนื้อหาความคิดเห็นต้องไม่เป็นค่าว่าง")),$("textarea[name=detail]").focus(),!1):""==a?($("#validate_username").text(_T("__comment__ชื่อผู้ตอบต้องไม่เป็นค่าว่าง")),$("input[name=reply_username]").focus(),!1):"1"!=veMain.reCaptchaEnable&&""==c&&""!=d&&"0"==veMain.member_login?($(".captcha .error").text(_T("__comment__กรอกตัวอักษรในภาพ")),$("input[name=submitted_captcha]").focus(),!1):(veComment.submit(),!1)})},veComment.submit=function(){var username=$(".comment_form input[name=username]").val(),comment=$(".comment_form textarea[name=detail]").val(),parent_id=$(".comment_form input[name=parent_id]").val(),parent_type=$(".comment_form input[name=parent_type]").val(),member_id=$(".comment_form input[name=member_id]").val(),captcha_cache=$(".comment_form input.captcha-cache").val(),member_id=$(".comment_form input[name=member_id]").val();if("edit"!=veMain.mode)if("1"==veMain.reCaptchaEnable&&"1"==captcha_cache&&"0"==member_id)var submitted_captcha=grecaptcha.getResponse(eval("veReCaptcha."+$(".comment_form .reCaptcha-container").attr("id")));else var submitted_captcha=$(".comment_form input[name=submitted_captcha]").val();else var submitted_captcha="";comment=$.trim(comment),$.ajax({url:"/modules/flexi/controllers/comment-process-controller.php",type:"POST",data:{task:"insert_comment",username:username,comment:comment,parent_id:parent_id,parent_type:parent_type,member_id:member_id,g_recaptcha_response:submitted_captcha,submitted_captcha:submitted_captcha},async:!0,success:function(data,textStatus){if(data=eval("("+data+")"),"1"==veMain.reCaptchaEnable)var $captchaErrorElement=$(".comment-captcha-error");else var $captchaErrorElement=$(".captcha .error");switch(data.status){case 1:veComment.loadComments();break;case 2:$captchaErrorElement.text(_T("__comment__พบปัญหาขณะบันทึกความคิดเห็น"));break;case 3:$captchaErrorElement.text(_T("__comment__พบปัญหาขณะอัพเดทจำนวนความคิดเห็น"));break;default:$captchaErrorElement.text(_T("__comment__รหัสป้องกันสแปมไม่ถูกต้อง กรุณาลองใหม่อีกครั้ง")),"1"!=veMain.reCaptchaEnable&&veCaptcha.reloadImage()}}})},veComment.bindDeleteButton=function(){$(".comment_container .comment_delete > a").unbind("click").click(function(){if(confirm(_T("__comment__ต้องการลบความคิดเห็นนี้"))){var a=$(this),b=a.attr("data-comment-id"),c=a.attr("data-parent-id"),d=a.attr("data-parent-type");veComment.deleteComment(b,c,d)}})},veComment.deleteComment=function(comment_id,parent_id,parent_type){$.ajax({type:"POST",cache:!1,url:"/modules/flexi/controllers/comment-process-controller.php",data:{task:"delete-comment",comment_id:comment_id,parent_id:parent_id,parent_type:parent_type},async:!0,success:function(data,textStatus){data=eval("("+data+")"),"1"==data.status?document.location.reload():alert(_T("__comment__ลบความคิดเห็นไม่สำเร็จ"))}})};var veContactForm={};veContactForm.init=function(){"edit"==veMain.mode&&1!=veMain.fb_page_tab&&(veContactForm.bindAddButton(),veContactForm.bindEditButton(),veContactForm.bindWidgetForm());var a=$("input.use_salesdesk").val();if(0==a||null==a)$(".prepended").remove();else if(1==a){var b=_T("__contact__เปิดใช้งาน Salesdesk");1==veMain.isRmp&&(b=_T("__contact__เปิดใช้งาน r-crm")),$(".salesdesk-form").prepend('<span class="prepended">'+b+"</span>")}veCaptcha.init(),veContactForm.contentStandardFormSubmitInit(),veContactForm.widgetStandardFormSubmitInit(),veContactForm.customizeFormSubmitInit(),veContactForm.addData()},veContactForm.bindContextMenu=function(){veEditMode.putContextMenuOver("#form-loader",[{cssClass:"add",title:_T("__contact__สร้างแบบฟอร์มใหม่"),eventHandler:veContactForm.bindContextMenuAddForm},{cssClass:"list",title:_T("__contact__เลือกแบบฟอร์มจากที่สร้างไว้"),eventHandler:veContactForm.bindContextMenuEditForm},{cssClass:"delete",title:_T("__contact__ลบแบบฟอร์มออกจากหน้านี้"),eventHandler:veContactForm.bindContextMenuDeleteForm}])},veContactForm.bindContextMenuAddForm=function(a){$(a).find("> .context-menu > ul > li.add > a").attr("href","javascript:void(0)").click(function(a){a.preventDefault(),$.colorbox({href:"/modules/flexi/views/form-design.php?task=add&content_id="+veMain.contentId,onComplete:function(){$("#form-design .buttons-panel #create_form_by").val("hidable-content"),veFormDesign.init(),veContactForm.selectForm()}})})},veContactForm.bindContextMenuEditForm=function(a){$(a).find("> .context-menu > ul > li.list > a").click(function(a){a.preventDefault(),$.colorbox({href:"/modules/flexi/views/contact-form-selector.php?section=content&content_id="+veMain.contentId,onComplete:function(){veContactForm.selectForm()}})})},veContactForm.bindContextMenuNavigate=function(a){$(a).find("> .context-menu > ul > li.edit > a").click(function(a){a.preventDefault(),veEditBar.navigateToFormList()})},veContactForm.bindContextMenuEdit=function(a){$(a).find("> .context-menu > ul > li.edit > a").click(function(a){a.preventDefault();var b=$(this).parent().parent().parent().parent().parent().find("#form-loader .standard-form, #form-loader .customize-form").data("contact_form_id");return b>0?($.colorbox({href:"/modules/flexi/views/form-design.php?task=edit&id="+b,onComplete:veFormDesign.init,onClosed:function(){veContactForm.selectFormProcess(b)}}),void 0):(alert(_T("__contact__ไม่สามารถแก้ไขแบบฟอร์มมาตรฐานได้")),!1)})},veContactForm.bindContextMenuEnableSalesdeskForm=function(a){$(a).find("> .context-menu > ul > li.salesdesk > a").unbind("click").click(function(){var a=veMain.contentId,b=$("input.use_salesdesk").val();0==b||null==b||""==b?b=1:1==b&&(b=0),$.ajax({url:"/modules/flexi/controllers/contact-form-selector-process-controller.php",type:"POST",data:{task:"enable_salesdesk",content_id:a,salesdesk_enable:b,type:"content"},async:!1,success:function(){document.getElementById("use_salesdesk").setAttribute("value",b),veContactForm.init(),veEditMode.showSavedSplash()}})})},veContactForm.bindContextMenuDeleteForm=function(a){$(a).find("> .context-menu > ul > li.delete > a").attr("href","javascript:void(0)").click(function(a){var b=confirm(_T("__contact__กรุณายืนยันการไม่ใช้แบบฟอร์ม"));if(!b)return!1;var c=veMain.contentId;$.ajax({url:"/modules/flexi/controllers/contact-form-selector-process-controller.php",type:"POST",data:{task:"remove_contact_form",content_id:c,form_id:"-1"},dataType:"html",async:!0,success:function(){return $(".contact-form .form-add").show(),$(".contact-form #form-loader").hide(),veContactForm.init(),veContactForm.bindContextMenu(),veFormDesign.ajaxReloadFormList(),a.preventDefault(),a.stopPropagation(),!1}})})},veContactForm.bindAddButton=function(){$("#content .contact-form #btn-add-form > a").click(function(a){a.preventDefault(),$.colorbox({href:"/modules/flexi/views/form-design.php?task=add&content_id="+veMain.contentId,onComplete:function(){$("#form-design .buttons-panel #create_form_by").val("hidable-content"),veFormDesign.init(),veContactForm.selectForm()}})})},veContactForm.bindEditButton=function(){$("#content .contact-form #btn-edit-form > a").click(function(a){a.preventDefault(),$.colorbox({onComplete:function(){$(".contact-form .form-add").show(),veContactForm.selectForm()}})})},veContactForm.bindWidgetForm=function(){$("#sidebar").data("edit_widget",!1).data("widget_id","").data("widget_obj_old",""),$("#sidebar #widget-add-button").click(function(){$("#sidebar").data("edit_widget",!1).data("widget_id","").data("widget_obj_old","")})},veContactForm.addNewForm=function(){$.ajax({url:"/modules/flexi/controllers/form-design-process-controller.php",type:"POST",data:"task=get_latest_form",dataType:"html",async:!0,success:function(a){var b=$.trim(a),c="/modules/flexi/views/contact-form-customize-loader.php";veContactForm.submitSelectForm("add_contact_form_customize",veMain.contentId,b,c)}})},veContactForm.selectForm=function(){$(".contact-form-selector .form-list a").click(function(){var a=$(this).attr("id").replace("fid-","");veContactForm.selectFormProcess(a)})},veContactForm.selectFormProcess=function(a){var b=veMain.contentId;if("0"==a)var c="add_contact_form_standard",d="/modules/flexi/views/contact-form-standard-loader.php";else if("-2"==a)var c="add_contact_form_standard",d="/modules/flexi/views/widget-form-standard-loader.php";else var c="add_contact_form_customize",d="/modules/flexi/views/contact-form-customize-loader.php";veContactForm.submitSelectForm(c,b,a,d)},veContactForm.submitSelectForm=function(a,b,c,d){$.ajax({url:"/modules/flexi/controllers/contact-form-selector-process-controller.php",type:"POST",data:{task:a,content_id:b,form_id:c,widget_id:0},dataType:"html",async:!0,success:function(){var b=d+"?contact_form_id="+c+"&"+(new Date).getTime(),e=$(".contact-form #form-loader form.contact input[name=receiver_id]").val();$(".contact-form #form-loader").load(b,function(){$(".contact-form #form-loader").show(),$(".contact-form .form-add").hide(),$(".prepended").remove(),veContactForm.init(),veContactForm.initContextMenu(c),"add_contact_form_standard"==a?($(".contact-form").parent().find(".contact-form-name").text($(".contact-form #form-loader .standard-form").data("contact_form_name")),-2==c||c>0?$(".salesdesk").hide():$(".salesdesk").show()):"add_contact_form_customize"==a&&$(".contact-form").parent().find(".contact-form-name").text($(".contact-form #form-loader .customize-form").data("contact_form_name")),$(".contact-form #form-loader form.contact input[name=receiver_id]").val(e)}),veFormDesign.ajaxReloadFormList(),$.colorbox.close()}})},veContactForm.bindWidgetFormEdit=function(a){$(a).each(function(){var a=$(this).attr("id").replace("widget-",""),b=$(this);$("> .context-menu > ul > li.list > a",this).click(function(c){c.preventDefault(),$.colorbox({href:"/modules/flexi/views/contact-form-selector.php?section=widget&widget_id="+a,onComplete:function(){$("#sidebar").data("edit_widget",!0).data("widget_id",a).data("widget_obj_old",b),veContactForm.selectWidgetForm()}})})})},veContactForm.selectWidgetForm=function(){$(".contact-form-selector .form-list a").click(function(){var a=$(this).attr("id").replace("fid-","");if("0"==a)var b="add_widget_form_standard",c="/modules/flexi/views/contact-form-standard-loader.php";else if("-2"==a)var b="add_widget_form_standard",c="/modules/flexi/views/widget-form-standard-loader.php";else var b="add_widget_form_customize",c="/modules/flexi/views/contact-form-customize-loader.php";veContactForm.submitSelectWidgetForm(b,a,c)})},veContactForm.submitSelectWidgetForm=function(a,b,c){$.ajax({url:"/modules/flexi/controllers/contact-form-selector-process-controller.php",type:"POST",data:{task:a,content_id:0,form_id:b,widget_id:$("#sidebar").data("widget_id")},dataType:"html",async:!0,success:function(a){var d=c+"?contact_form_id="+b+"&"+(new Date).getTime();$.get(d,function(b){if(liHTML='<li id="widget-'+parseInt(a)+'" class="form"><div class="widget-item">'+b+"</div></li>",1==$("#sidebar").data("edit_widget")){var c=$("#sidebar").data("widget_id"),d=$("#sidebar").data("widget_obj_old");veContactForm.widgetFormEdit(a,c,d),$(liHTML).insertBefore(d),d.remove()}else $("ul.widgets").append(liHTML);veWidget.initContextMenus()}),$.colorbox.close(),veFormDesign.ajaxReloadFormList(),veEditMode.showSavedSplash()}})},veContactForm.widgetFormEdit=function(a,b){$.ajax({type:"POST",url:"/modules/flexi/controllers/widget-save-controller.php",data:"task=update-form-widget&new_widget_id="+a+"&old_widget_id="+b,success:function(){veEditMode.showSavedSplash()}})},veContactForm.widgetStandardFormSubmitInit=function(){veContactForm.widgetStandardFormSubmit("#sidebar"),veContactForm.widgetStandardFormSubmit(".contact-form");var a=$("input.widget-captcha-cache").val(),b=$("input.widget-member-login").val();""==a&&""==b&&$("li.widget-captcha-container").hide()},veContactForm.widgetStandardFormSubmit=function(parent_el){$(".standard-form .widget",parent_el).each(function(){$(this).submit(function(){var params=$(this).serialize();if(""==$("input[name=email]",this).val())return veContactForm.qTipValidation($("input[name=email]",this),_T("__contact__กรุณากรอกอีเมล")),!1;if(!veMain.validateEmail($("input[name=email]",this).val()))return veContactForm.qTipValidation($("input[name=email]",this),_T("__contact__รูปแบบอีเมลไม่ถูกต้อง")),$("input[name=email]",this).val(""),!1;$("input[name=email]",this).qtip("destroy");var content_id=$("input[name=content_id]",this).val(),content_title=$("input[name=content_title]",this).val(),widget_id=$("input[name=widget_id]",this).val(),contact_form_id=$("input[name=contact_form_id]",this).val(),contact_form_name=$("input[name=contact_form_name]",this).val(),captcha_cache=$("input.captcha-cache",this).val();if("edit"!=veMain.mode&&""!=captcha_cache&&""==veMain.member_login)if("1"==veMain.reCaptchaEnable)var submitted_captcha=grecaptcha.getResponse(eval("veReCaptcha."+$(".reCaptcha-container",this).attr("id")));else var submitted_captcha="";else var submitted_captcha="";if("#sidebar"==parent_el)var thank_url="/widget/"+widget_id+"/"+contact_form_name+"/thankyou/";else var thank_url="/"+content_id+"/"+content_title+"/"+contact_form_id+"/"+contact_form_name+"/thankyou/";return $.ajax({url:"/modules/flexi/controllers/widget-form-standard-save-controller.php",type:"POST",data:params+"&g_recaptcha_response="+submitted_captcha,dataType:"html",async:!1,success:function(a){1==a?($("input[name=email]").val(""),location.href=thank_url):2==a?(alert(_T('__contact__กรุณากรอก "รหัสป้องกันสแปม" ให้ถูกต้อง')),veCaptcha.clearError(),veCaptcha.reloadImage()):alert(_T("__contact__เกิดข้อผิดพลาด ไม่สามารถบันทึกข้อมูลได้ กรุณารอสักครู่แล้วลองใหม่อีกครั้ง"))}}),!1})})},veContactForm.customizeFormSubmitInit=function(){veContactForm.customizeFormSubmit(".customize-form"),veContactForm.customizeFormSubmit(".widget-form")},veContactForm.customizeFormSubmit=function(parent_el){$(".contact",parent_el).each(function(){$(this).find(".field-file").length>0?veContactForm.customizeFormFileSubmit($(this)):$(this).submit(function(){var blank_field=!0,valid_email_field=!0,btn_submit=$("input[type=submit]",this);if($(this).find(".field-input").each(function(){""!=veContactForm.stringTrim($(this).val())&&(blank_field=!1)}),$(this).find(".field-email").each(function(){""!=$(this).val()&&(blank_field=!1,veMain.validateEmail($(this).val())||(valid_email_field=!1))}),$(this).find(".field-textarea").each(function(){""!=veContactForm.stringTrim($(this).val())&&(blank_field=!1)}),0==blank_field){if(btn_submit.qtip("destroy"),1==valid_email_field){btn_submit.qtip("destroy");var params=$(this).serialize(),content_id=$("input[name=content_id]",this).val(),content_title=$("input[name=content_title]",this).val(),widget_id=$("input[name=widget_id]",this).val(),contact_form_id=$("input[name=contact_form_id]",this).val(),contact_form_name=$("input[name=contact_form_name]",this).val(),captcha_cache=$("input.captcha-cache",this).val(),ua_id=$("input[name=ua_id]",this).val(),use_salesdesk=$("input[name=use_salesdesk]",this).val();if("edit"!=veMain.mode&&""!=captcha_cache&&""==veMain.member_login)if("1"==veMain.reCaptchaEnable)var submitted_captcha=grecaptcha.getResponse(eval("veReCaptcha."+$(".reCaptcha-container",this).attr("id")));else var submitted_captcha="";else var submitted_captcha="";var open_new_window=!1;if("0"==content_id)var thank_url="/widget/"+widget_id+"/"+contact_form_name+"/thankyou/";else var thank_url="/"+content_id+"/"+content_title+"/"+contact_form_id+"/"+contact_form_name+"/thankyou/?ua_id="+ua_id+"&use_salesdesk="+use_salesdesk;return $.ajax({url:"/modules/flexi/controllers/contact-form-customize-save-controller.php",type:"POST",data:params+"&g_recaptcha_response="+submitted_captcha,dataType:"html",async:!1,success:function(a){"captcha"==a?(alert(_T('__contact__กรุณากรอก "รหัสป้องกันสแปม" ให้ถูกต้อง')),veCaptcha.clearError(),veCaptcha.reloadImage()):0!=a?($(".field-input").val(""),$(".field-email").val(""),$(".field-textarea").val(""),1!=veMain.fb_page_tab?location.href=thank_url:open_new_window=!0):alert(_T("__contact__เกิดข้อผิดพลาด ไม่สามารถบันทึกข้อมูลได้ กรุณารอสักครู่แล้วลองใหม่อีกครั้ง"))}}),1==veMain.fb_page_tab&&1==open_new_window&&window.open(thank_url),!1}return veContactForm.qTipValidation(btn_submit,_T("__contact__กรุณากรอกอีเมลให้ถูกต้อง")),!1}return veContactForm.qTipValidation(btn_submit,_T("__contact__กรุณากรอกข้อมูลให้ครบถ้วน")),!1})})},veContactForm.customizeFormFileSubmit=function(form){var file_size_limit="2mb",file_size_limit_byte=2097152,file_upload_limit=1,parent_name=form.parent().parent().parent().find(".widget-item").length>0?"widget":"content",browse_button=parent_name+"-contact-file-selecter",file_container=parent_name+"-file-container";"widget"==parent_name&&(browse_button=parent_name+"-"+form.parent().data("parent_id")+"-contact-file-selecter",file_container=parent_name+"-"+form.parent().data("parent_id")+"-file-container");var params=null,new_params={},thank_url="",runtime=veMain.initRuntimeUploader();veMain.loadJS("/modules/flexi/js/jquery.plupload2/plupload.full.min.js"),veMain.loadJS("/modules/flexi/js/jquery.plupload2/i18n/"+veMain.language+".js");
var uploader=new plupload.Uploader({runtimes:runtime,multi_selection:!1,browse_button:browse_button,container:file_container,url:"/modules/flexi/controllers/contact-form-attachment-controller.php",silverlight_xap_url:"/modules/flexi/js/jquery.plupload2/Moxie.xap",flash_swf_url:"/modules/flexi/js/jquery.plupload2/Moxie.swf",filters:{mime_types:[{title:"Image files",extensions:"jpeg,jpg,gif,png"},{title:"Document files",extensions:"txt,pdf,doc,docx,xls,xlsx,ppt,pptx"}],max_file_size:file_size_limit_byte}});uploader.init(),uploader.bind("FilesAdded",function(a,b){return a.files.length>file_upload_limit?(veMain.showAlert(_T("__content__upload ได้ครั้งละไม่เกิน")+" "+file_upload_limit+" "+_T("__content__ไฟล์")+"\n"+_T("__content__กรุณาเลือกไฟล์ใหม่อีกครั้ง")),$.each(b,function(b,c){a.removeFile(c)}),!1):($.each(b,function(b,c){$("#"+browse_button).hide(),$(".file-list").html(""),form.find(".file-list").append('<div id="'+c.id+'"><span>'+c.name+" ("+plupload.formatSize(c.size)+') </span><a href="#" class="remove-file">'+_T("__content__ลบไฟล์นี้")+"<b></b></a></div>"),$("#"+c.id+" .remove-file").bind("click",function(b){b.preventDefault(),uploader.removeFile(c),$(".file-list #"+c.id).remove(),$("#"+browse_button).show(),a.refresh()})}),a.refresh(),void 0)}),uploader.bind("UploadProgress",function(a,b){$("#"+b.id+" a").remove(),$("#"+b.id+" b").html(b.percent+"%")}),uploader.bind("Error",function(a,b){return-600==b.code?veMain.showAlert(_T("__content__ไฟล์ที่ upload ต้องมีขนาดไม่เกิน")+" "+file_size_limit+" "+_T("__content__เท่านั้น")+"\n"+_T("__content__กรุณาเลือกไฟล์ใหม่อีกครั้ง")):-601==b.code?(veMain.showAlert(_T("__content__ระบบไม่รองรับไฟล์ประเภทนี้")),form.find(".file-list").append("<div>"+_T("__content__ระบบรองรับไฟล์ประเภท jpg, jpeg, gif, png, txt, pdf, doc, docx, xls, xlsx, ppt และpptx เท่านั้น")+"</div><br/>")):(form.find(".file-list").append("<div>"+b.message+(b.file?", File: "+b.file.name:"")+"</div><br/>"),a.refresh()),!1}),uploader.bind("FileUploaded",function(a,b,c){$("#"+b.id+" b").html("100%"),0!=c.response?($(".file-list #"+b.id+" .remove-file").remove(),$(".field-input").val(""),$(".field-email").val(""),$(".field-textarea").val(""),1!=veMain.fb_page_tab?location.href=thank_url:open_new_window=!0):veMain.showAlert(_T("__contact__เกิดข้อผิดพลาด ไม่สามารถบันทึกข้อมูลได้ กรุณารอสักครู่แล้วลองใหม่อีกครั้ง"))}),form.submit(function(){var blank_field=!0,valid_email_field=!0,btn_submit=$("input[type=submit]",this);if(form.find(".field-input").each(function(){""!=veContactForm.stringTrim($(this).val())&&(blank_field=!1)}),form.find(".field-email").each(function(){""!=$(this).val()&&(blank_field=!1,veMain.validateEmail($(this).val())||(valid_email_field=!1))}),form.find(".field-textarea").each(function(){""!=veContactForm.stringTrim($(this).val())&&(blank_field=!1)}),0==blank_field){if(btn_submit.qtip("destroy"),1==valid_email_field){if(uploader.files.length>0){btn_submit.qtip("destroy"),params=form.serializeArray(),$.each(params,function(a,b){new_params[b.name]=b.value}),new_params.task="upload",new_params.file_filed_id=$("#"+browse_button).data("field_id");var content_id=$("input[name=content_id]",this).val(),content_title=$("input[name=content_title]",this).val(),widget_id=$("input[name=widget_id]",this).val(),contact_form_id=$("input[name=contact_form_id]",this).val(),contact_form_name=$("input[name=contact_form_name]",this).val(),captcha_cache=$("input.captcha-cache",this).val();if("edit"!=veMain.mode&&""!=captcha_cache&&""==veMain.member_login)if("1"==veMain.reCaptchaEnable)var submitted_captcha=grecaptcha.getResponse(eval("veReCaptcha."+$(".reCaptcha-container",this).attr("id")));else var submitted_captcha=$("input[name=submitted_captcha]",this).val();else var submitted_captcha="";var open_new_window=!1;return thank_url="0"==content_id?"/widget/"+widget_id+"/"+contact_form_name+"/thankyou/":"/"+content_id+"/"+content_title+"/"+contact_form_id+"/"+contact_form_name+"/thankyou/",$.ajax({url:"/modules/flexi/controllers/contact-form-attachment-controller.php",type:"POST",dataType:"html",data:{task:"validate_captcha",submitted_captcha:submitted_captcha,g_recaptcha_response:submitted_captcha},async:!0,success:function(a){"1"==a?(uploader.settings.multipart_params=new_params,uploader.start()):(alert(_T('__contact__กรุณากรอก "รหัสป้องกันสแปม" ให้ถูกต้อง')),veCaptcha.clearError(),veCaptcha.reloadImage())}}),1==veMain.fb_page_tab&&1==open_new_window&&window.open(thank_url),!1}return veContactForm.qTipValidation(btn_submit,_T("__contact__please select file")),!1}return veContactForm.qTipValidation(btn_submit,_T("__contact__กรุณากรอกอีเมลให้ถูกต้อง")),!1}return veContactForm.qTipValidation(btn_submit,_T("__contact__กรุณากรอกข้อมูลให้ครบถ้วน")),!1})},veContactForm.contentStandardFormSubmitInit=function(){var parent_el=".contact-form .standard-form .contact";$(parent_el).submit(function(){if(veContactForm.validate()){var name=veContactForm.stringTrim($("input[name=name]",parent_el).val()),lastname=veContactForm.stringTrim($("input[name=lastname]",parent_el).val()),email=veContactForm.stringTrim($("input[name=email]",parent_el).val()),phone=veContactForm.stringTrim($("input[name=phone]",parent_el).val()),comment=veContactForm.stringTrim($("textarea[name=comment]",parent_el).val()),captcha_cache=$("input.captcha-cache",this).val();if("edit"!=veMain.mode&&""!=captcha_cache&&""==veMain.member_login)if("1"==veMain.reCaptchaEnable)var submitted_captcha=grecaptcha.getResponse(eval("veReCaptcha."+veContactForm.stringTrim($(".reCaptcha-container",parent_el).attr("id"))));else var submitted_captcha=veContactForm.stringTrim($("input[name=submitted_captcha]",parent_el).val());else var submitted_captcha="";var url=$("input[name=url]",parent_el).val(),session_form_key=$(".session_form_key",parent_el).val(),content_id=$("input[name=content_id]",parent_el).val(),content_title=$("input[name=content_title]",parent_el).val(),widget_id=$("input[name=widget_id]",parent_el).val(),contact_form_id=$("input[name=contact_form_id]",parent_el).val(),contact_form_name=$("input[name=contact_form_name]",parent_el).val(),ua_id=$("input[name=ua_id]",parent_el).val(),use_salesdesk=$("input[name=use_salesdesk]",parent_el).val(),ga_client_id=$("input[name=ga_client_id]",parent_el).val(),salesdesk_id=$("input[name=salesdesk_id]",parent_el).val(),receiver_id=$("input[name=receiver_id]",parent_el).val(),gclid=$("input[name=gclid]",parent_el).val();return veContactForm.standardFormSubmit(name,lastname,email,phone,comment,submitted_captcha,url,session_form_key,content_id,content_title,widget_id,contact_form_id,contact_form_name,"content",ua_id,use_salesdesk,ga_client_id,salesdesk_id,gclid,receiver_id),!1}return!1}),veContactForm.contentStandardFormToWidgetSubmit()},veContactForm.contentStandardFormToWidgetSubmit=function(){var parent_el="#sidebar .standard-form .contact";$(parent_el).each(function(){$(this).submit(function(){var name=$("input[name=name]",this),lastname=$("input[name=lastname]",this),email=$("input[name=email]",this),phone=$("input[name=phone]",this),comment=$("textarea[name=comment]",this),captcha_cache=$("input.captcha-cache",this).val();if("edit"!=veMain.mode&&""!=captcha_cache&&""==veMain.member_login)if("1"==veMain.reCaptchaEnable)var submitted_captcha=grecaptcha.getResponse(eval("veReCaptcha."+$(".reCaptcha-container",this).attr("id")));else var submitted_captcha=$("input[name=submitted_captcha]",this).val();else var submitted_captcha="";var url=$("input[name=url]",this).val(),session_form_key=$(".session_form_key",this).val(),content_id=$("input[name=content_id]",this).val(),content_title=$("input[name=content_title]",this).val(),widget_id=$("input[name=widget_id]",this).val(),contact_form_id=$("input[name=contact_form_id]",this).val(),contact_form_name=$("input[name=contact_form_name]",this).val(),error=!1,msg="";return""==veContactForm.stringTrim(name.val())?(error=!0,veContactForm.qTipValidation(name,_T("__contact__กรุณากรอกชื่อ"))):name.qtip("destroy"),""==veContactForm.stringTrim(lastname.val())?(error=!0,veContactForm.qTipValidation(lastname,_T("__contact__กรุณากรอกนามสกุล"))):lastname.qtip("destroy"),""==veContactForm.stringTrim(email.val())?(error=!0,veContactForm.qTipValidation(email,_T("__contact__กรุณากรอกอีเมล"))):0==veMain.validateEmail(email.val())?(error=!0,veContactForm.qTipValidation(email,_T("__contact__รูปแบบอีเมลไม่ถูกต้อง"))):email.qtip("destroy"),""==veContactForm.stringTrim(comment.val())?(error=!0,veContactForm.qTipValidation(comment,_T("__contact__กรุณากรอกข้อความ"))):comment.qtip("destroy"),1==error?!1:(veContactForm.standardFormSubmit(veContactForm.stringTrim(name.val()),veContactForm.stringTrim(lastname.val()),veContactForm.stringTrim(email.val()),veContactForm.stringTrim(phone.val()),veContactForm.stringTrim(comment.val()),veContactForm.stringTrim(submitted_captcha),url,session_form_key,content_id,content_title,widget_id,contact_form_id,contact_form_name,"widget"),!1)})})},veContactForm.standardFormSubmit=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=!1;if("widget"==n)var v="/widget/"+k+"/"+m+"/thankyou/";else var v="/"+i+"/"+j+"/"+l+"/"+m+"/thankyou/?ua_id="+o+"&use_salesdesk="+p;$.ajax({url:"/modules/flexi/controllers/contact-save-controller.php",type:"POST",data:{p_name:a,p_lastname:b,p_email:c,p_phone:d,p_comment:e,url:g,session_form_key:h,p_content_id:i,g_recaptcha_response:f,submitted_captcha:f,ua_id:o,use_salesdesk:p,ga_client_id:q,salesdesk_id:r,receiver_id:t,gclid:s},dataType:"html",async:!1,success:function(a){return 1==a?($('form input[type="text"]').val(""),$("form textarea").val(""),1!=veMain.fb_page_tab?location.href=v:u=!0):2==a?(alert(_T('__contact__กรุณากรอก "รหัสป้องกันสแปม" ให้ถูกต้อง')),veCaptcha.clearError(),veCaptcha.reloadImage()):alert(_T("__contact__เกิดข้อผิดพลาด ไม่สามารถบันทึกข้อมูลได้ กรุณารอสักครู่แล้วลองใหม่อีกครั้ง")),!1}}),1==veMain.fb_page_tab&&1==u&&window.open(v)},veContactForm.addData=function(){var a={},b=0,c=document.getElementById("sidebar");null!==c&&"block"==getComputedStyle(c).display&&$("#sidebar .widgets li.form").each(function(){a[$(this).attr("id").replace("widget-","")]=$(this).children().data("value"),b++}),b>0&&$.ajax({url:"/modules/flexi/controllers/contact-form-fill-data-controller.php",type:"post",data:{task:"get_data",list:a},success:function(a){for(var b=jQuery.parseJSON(a),c=b.key,d=0;d<c.length;d++){var e=$("#sidebar .widgets li#widget-"+c[d].widget_id+" .widget-item .contact");e.find(".session_form_key").attr("name",c[d].key),e.find(".session_form_key").attr("value",c[d].value),e.find("input[name=content_id]").attr("value",b.content_id),e.find("input[name=content_title]").attr("value",b.content_title),e.find("input[name=ip_client]").attr("value",b.client_ip),e.find("input[name=ip_address_fwd]").attr("value",b.client_ip_remote),e.find("input[name=ip_remote]").attr("value",b.client_ip_forward),e.find("input[name=user_agent]").attr("value",b.client_user_agent)}}});var d=$(".widgets .widget-item input[name=url]");d.length>0&&($contact_form_url=d,""==$contact_form_url.eq(0).val()&&$contact_form_url.val(decodeURIComponent(document.URL)))},veContactForm.validate=function(){var a=$(".contact-form .contact input[name=name]"),b=$(".contact-form .contact input[name=lastname]"),c=$(".contact-form .contact input[name=email]"),d=$(".contact-form .contact textarea[name=comment]"),e=!1;return""==veContactForm.stringTrim(a.val())?(e=!0,veContactForm.qTipValidation(a,_T("__contact__กรุณากรอกชื่อ"))):a.qtip("destroy"),""==veContactForm.stringTrim(b.val())?(e=!0,veContactForm.qTipValidation(b,_T("__contact__กรุณากรอกนามสกุล"))):b.qtip("destroy"),""==veContactForm.stringTrim(c.val())?(e=!0,veContactForm.qTipValidation(c,_T("__contact__กรุณากรอกอีเมล"))):0==veMain.validateEmail(c.val())?(e=!0,veContactForm.qTipValidation(c,_T("__contact__รูปแบบอีเมลไม่ถูกต้อง"))):c.qtip("destroy"),""==veContactForm.stringTrim(d.val())?(e=!0,veContactForm.qTipValidation(d,_T("__contact__กรุณากรอกข้อความ"))):d.qtip("destroy"),1==e?!1:!0},veContactForm.qTipValidation=function(a,b){a.qtip({content:b,position:{my:"left center",at:"right center"},show:{event:!1,ready:!0},hide:!1,style:{classes:"ui-tooltip-red"}})},veContactForm.stringTrim=function(a){return $.trim(a)},veContactForm.initContextMenu=function(){$("#show_contact_form > context-menu").remove();var a=[{cssClass:"add",title:_T("__content__สร้างแบบฟอร์มใหม่"),eventHandler:veContactForm.bindContextMenuAddForm},{cssClass:"list",title:_T("__content__เลือกแบบฟอร์มจากที่สร้างไว้"),eventHandler:veContactForm.bindContextMenuEditForm}];if(1==veMain.features.salesdesk&&"-2"!=veEditMode.contactFormID&&""!=veEditMode.salesdeskBusinessID&&null!=veEditMode.salesdeskBusinessID){var b="";b=1==veMain.isRmp?_T("__content__ตั้งค่า r-crm"):_T("__content__ตั้งค่า SalesDesk"),a.push({cssClass:"salesdesk",title:b,eventHandler:veContactForm.bindContextMenuSalesdeskSettings})}a.push({cssClass:"edit",title:_T("__content__แก้ไขแบบฟอร์ม"),eventHandler:veContactForm.bindContextMenuEdit},{cssClass:"delete",title:_T("__content__ลบ Section นี้"),eventHandler:veContentSection.deleteSection}),veEditMode.putContextMenuOver("#show_contact_form",a,!0)},veContactForm.bindContextMenuSalesdeskSettings=function(a){$(a).find("> .context-menu > ul > li.salesdesk > a").unbind("click").click(function(){var a=$(this).parent().parent().parent().parent().parent().attr("id"),a=a.replace("hidable-","");$.colorbox({href:"/modules/flexi/views/contact-form-salesdesk-settings.php?content_id="+veMain.contentId+"&content_section_id="+a+"&type="+veMain.page,onComplete:function(){veContactForm.initSalesdeskSettings()}})})},veContactForm.initSalesdeskSettings=function(){$(".salesdesk-settings-form input.submit").unbind("click").click(function(){veContactForm.validateSalesdeskSettings()?veContactForm.saveSalesdeskSettings():alert(_T("__contact__กรุณากรอก gate_id เป็นตัวเลขและความยาวไม่เกิน 12 ตัวอักษร"))}),$(".salesdesk-settings-form input.cancel").unbind("click").click(function(){$.colorbox.close()}),veContactForm.initQtip(".salesdesk-settings-container a.hint")},veContactForm.validateSalesdeskSettings=function(){var a=/^[0-9]{0,12}$/,b=$(".salesdesk-settings-form input[name=receiver_id]").val();return a.test(b)},veContactForm.saveSalesdeskSettings=function(){$.ajax({url:"/modules/flexi/controllers/salesdesk-process-controller.php",type:"POST",data:"task=save_form_settings&type="+veMain.page+"&"+$(".salesdesk-settings-form").serialize(),dataType:"json",async:!1,success:function(a){"success"==a.status?($(".contact-form #form-loader form.contact input[name=use_salesdesk]").val(a.data.salesdesk_status),$(".contact-form #form-loader form.contact input[name=receiver_id]").val(a.data.receiver_id),$(".salesdesk-form").html(""),veContactForm.init(),veEditMode.showSavedSplash(),$.colorbox.close()):alert(_T("__contact__เกิดข้อผิดพลาด! โปรดลองใหม่ภายหลัง"))},error:function(a,b,c){veMain.log("ERROR: "+b+"\n\n"+c)}})},veContactForm.initQtip=function(a){$(a).not("[disabled]").qtip({content:{text:$(a).next(".hint-popup")},position:{at:"bottom center",my:"top left",viewport:$(window)},show:{solo:!0},hide:{fixed:!0,delay:300},style:{classes:"qtip-youtube"}})};var veSearchForm={};veSearchForm.init=function(){veSearchForm.SearchFormInit(),veSearchForm.SearchMobileInit(),veSearchForm.SearchFormTopBarInit(),veSearchForm.SearchFormHeaderV2Init(),veSearchForm.SearchResultInit()},veSearchForm.SearchResultInit=function(){$("#search-content-link").hasClass("active")&&($("#search-product-link").removeClass("active"),$("#content-search-result").removeClass("hide"),$("#product-search-result").addClass("hide")),$("#search-product-link").bind("click",function(){$(this).addClass("active"),$("#search-content-link").removeClass("active"),$("#product-search-result").removeClass("hide"),$("#content-search-result").addClass("hide")}),$("#search-content-link").bind("click",function(){$(this).addClass("active"),$("#search-product-link").removeClass("active"),$("#content-search-result").removeClass("hide"),$("#product-search-result").addClass("hide")}),$("#content").delegate(".search-result > .highlight-toggle > input[type=checkbox]","click",function(){this.checked?$(".search-result .keyword-normal").toggleClass("keyword keyword-normal"):$(".search-result .keyword").toggleClass("keyword keyword-normal")}),$("#content").delegate("#product-search-result .product-highlight-toggle > input[type=checkbox]","click",function(){this.checked?$("#product-search-result .keyword-normal").toggleClass("keyword keyword-normal"):$("#product-search-result .keyword").toggleClass("keyword keyword-normal")})},veSearchForm.SearchFormInit=function(){var a=$("#sidebar .widgets .search-form > form"),b=a.find(".keyword"),c=a.find(":button");veSearchForm.SearchFormState(a,b,c,"desktop")},veSearchForm.searchFormSettingInit=function(){$search_setting=$("#search-setting"),$search_setting.find("#search-setting-submit").bind("click",function(){var a=$("input:radio[name=search_type]:checked").val(),b=$("#widget-id").val(),c="";c=$("#search-form-hidden-search:checked").val()?$("#search-form-hidden-search:checked").val():0,$.ajax({url:"/modules/flexi/controllers/search-setting-controller.php",type:"POST",data:{task:"update_widget_search",id:b,type:a},async:!0,success:function(d){1==d?($.ajax({url:"/modules/flexi/controllers/search-setting-controller.php",type:"POST",data:{task:"search_hiddennav_setting",search_hiddennav:c}}),"product"==a?$.ajax({url:"/modules/flexi/views/search-form-product-loader.php",context:document.body,success:function(a){$("#widget-"+b).find("div.widget-item").html(a)}}):$.ajax({url:"/modules/flexi/views/search-form-standard-loader.php",context:document.body,success:function(a){$("#widget-"+b).find("div.widget-item").html(a)}}),$.ajax({url:"/modules/flexi/controllers/search-setting-controller.php",type:"POST",data:{task:"save_cache"}}),veEditMode.showSavedSplash(),$.colorbox.close()):(alert(_T("__search__เกิดข้อผิดพลาด! กรุณาลองใหม่อีกครั้ง")),$.colorbox.close())},error:function(a,b,c){return alert(_T("__search__เกิดข้อผิดพลาด! กรุณาลองใหม่อีกครั้ง")),veMain.log("ERROR: "+b+"\n\n"+c),!1}})})},veSearchForm.searchFormChangeType=function(){$search_setting=$("#search-setting"),$search_setting.find("input:radio[name=search_type]").bind("change",function(){var a=$("input:radio[name=search_type]:checked").val();"product"==a?$("#search-form-hidden-search").prop("disabled",!0):$("#search-form-hidden-search").prop("disabled",!1)})},veSearchForm.SearchFormState=function(a,b,c,d){b.bind("focus",function(){b.attr("value",""),b.css("background","#FFFFFF")}).bind("blur",function(){""==b.val()&&"mobile-search-input"!=b.attr("id")&&"topnav-searchbox-input"!=b.attr("id")&&b.attr(!0)?b.css("background","url(/modules/flexi/images/readyplanet_search_engine.gif) no-repeat scroll left center #FFFFFF"):b.css("background","#FFFFFF")}),b.bind("keypress",function(a){if(13==a.keyCode){if("desktop"==d)var b=$("input[name=keyword]").val();else if("mobile"==d)var b=$("input[name=keyword-mobile]").val();else if("topbar"==d)var b=$("input[name=keyword-topnav]").val();else if("headerv2"==d)var b=$("input[name=keyword-header-v2]").val();return window.open("/search/"+b,"_self"),$("input[name=keyword]").val(""),!1}}),c&&c.bind("click",function(){var a=$("input[name=keyword]").val();return window.open("/search/"+a,"_self"),$("input[name=keyword]").val(""),!1})},veSearchForm.SearchFormSubmit=function(a){var b=a.val(),c=veMain.domain;return""==b?(veSearchForm.qtipValidation(a,_T("__search__กรุณากรอกคำค้น")),!1):1==b.length?(veSearchForm.qtipValidation(a,_T("__search__กรุณากรอกคำค้นที่ยาวกว่านี้")),!1):(a.qtip("destroy"),$("#content > *").not("#sidebar").remove(),$("#content").append('<h1 class="title">'+_T("__search__ผลการค้นหา")+'</h1><div class="inner"></div><div class="clear"></div>'),inner=$("#content > .inner"),inner.append('<div class="search-loading-image"><img src = "/modules/flexi/images/ajax-loading.gif"><br/><br/>'+_T("__search__กำลังค้นหา")+"</div>"),veMain.scrollPageTo("#content > .title"),$.ajax({url:"/modules/flexi/controllers/search-controller.php",type:"POST",data:{domain:c,keyword:b},dataType:"html",async:!0,success:function(a){$("#content .search-loading-image").fadeOut("slow"),inner.html(a)},error:function(a,b,c){return alert(_T("__search__กรุณาค้นหาใหม่อีกครั้ง")),veMain.log("ERROR: "+b+"\n\n"+c),!1}}),void 0)},veSearchForm.qtipValidation=function(a,b){var c="left center",d="right center";"mobile-search-input"==a.attr("id")&&(c="top center",d="bottom center"),a.qtip({content:b,position:{my:c,at:d},show:{event:!1,ready:!0},hide:!1,style:{classes:"ui-tooltip-red"}})},veSearchForm.bindContextMenuSetting=function(a){$(a).each(function(){var a="/modules/flexi/views/search-setting-form.php",b=$("> .context-menu > ul > li.edit > a",this),c=$(b).parent().parent().parent().parent().attr("id").replace("widget-","");b.click(function(b){b.preventDefault(),$.colorbox({href:a+"?"+(new Date).getTime()+"&widgetId="+c,onComplete:function(){veSearchForm.searchFormSettingInit(),veSearchForm.searchFormChangeType()}})})})},veSearchForm.SearchMobileInit=function(){var a=$(".mobile-topbar .searchbox-wrapper .search-form > form"),b=a.find(".keyword");veSearchForm.SearchFormState(a,b,null,"mobile"),$("#mobile-searchbox-icon").on("click",function(){42==$(".searchbox-wrapper").width()?($(".search-form").fadeIn(200),$(".nav-topbar-logo").fadeOut(200),$(".searchbox-wrapper").animate({width:"70%"},400,function(){$("#mobile-clear-icon").show(),$("#mobile-search-input").focus()})):($("#mobile-clear-icon").hide(),$(".nav-topbar-logo").fadeIn(200),$(".searchbox-wrapper").animate({width:"42px"},400,function(){b.val(null),b.qtip("destroy"),$(".search-form").fadeOut(100)}))}),$("#mobile-clear-icon").on("click",function(){b.val(null),$("#mobile-search-input").focus()})},veSearchForm.SearchFormTopBarInit=function(){$("#topbar .topnav-component .topnav-searchbox-icon").on("click",function(){var a=$(".topnav-searchbox");a.css("display","flex"),a.hasClass("hide")?a.animate({height:"40px"},"slow",function(){a.removeClass("hide"),$("#topnav-searchbox-input").focus()}):a.animate({height:"0px"},"slow",function(){a.css("display","none"),a.addClass("hide")})});var a=$("#topnav-searchbox-input");veSearchForm.SearchFormState("",a,null,"topbar")},veSearchForm.SearchFormHeaderV2Init=function(){$(".header-v2-container .header-v2-icons #header-v2-searchbox-icon").on("click",function(){var a=$(".header-v2-container .header-v2-icons .header-v2-searchbox-container");a.css("display","flex"),a.hasClass("hide")?a.animate({width:"270px"},"slow",function(){a.removeClass("hide"),$("#topnav-searchbox-input").focus()}):a.animate({width:"0px"},"slow",function(){a.css("display","none"),a.addClass("hide")})});var a=$("#header-v2-searchbox-input");veSearchForm.SearchFormState("",a,null,"headerv2")};var veSlideMenu={};veSlideMenu.container="",veSlideMenu.slide_menu_container="",veSlideMenu.slide_menu="",veSlideMenu.slide_menu_cover="",veSlideMenu.slide_menu_sub_menu="",veSlideMenu.content_wrapper="",veSlideMenu.init=function(){veSlideMenu.container=$("#body-bg"),veSlideMenu.slide_menu_container=$("#slidemenu-container"),veSlideMenu.slide_menu=$("#slidemenu-menu"),veSlideMenu.slide_menu_cover=$("#slidemenu-cover"),veSlideMenu.slide_menu_sub_menu=$("#slidemenu-menu ul.subnav"),veSlideMenu.content_wrapper=$("#wrapper"),veSlideMenu.pepareMenu(),veSlideMenu.bindTrigger(),veSlideMenu.bindCloseMenu(),veSlideMenu.bindSubMenu(),veSlideMenu.slide_menu.find("> nav").scroll(function(){veSlideMenu.slide_menu_container.jqDropdown("hide")})},veSlideMenu.pepareMenu=function(){veSlideMenu.slide_menu_sub_menu.has("li[class^='nav-']").before('<i class="fa fa-angle-right fa-2x slidemenu-next"></i>'),veSlideMenu.slide_menu_sub_menu.has("li[class^='nav-']").parent().find("a").css("width","80%"),veSlideMenu.slide_menu_sub_menu.has("li[class^='nav-']").find("li:first-child").before('<li class="slidemenu-back sub"><i class="fa fa-reply fa-2x"></i><a id="suv-back">'+_T("__nav__ย้อนกลับ")+"</a></li>"),"edit"==veMain.mode?(veSlideMenu.slide_menu.find("nav").height($(window).height()-36),veSlideMenu.slide_menu.height($(window).height()-36)):(veSlideMenu.slide_menu.find("nav").height($(window).height()),veSlideMenu.slide_menu.height($(window).height()))},veSlideMenu.bindTrigger=function(){$("#slidemenu-trigger").click(function(a){a.preventDefault(),veSlideMenu.slide_menu_cover.on("touchmove",function(a){a.preventDefault()},!1),"edit"==veMain.mode?(veSlideMenu.slide_menu.find("nav").height($(window).height()-36),veSlideMenu.slide_menu.height($(window).height()-36)):(veSlideMenu.slide_menu.find("nav").height($(window).height()),veSlideMenu.slide_menu.height($(window).height())),veSlideMenu.slide_menu_sub_menu.css("left","-100%"),veSlideMenu.slide_menu.animate({left:0},300),veSlideMenu.container.animate({left:"80%"},300,function(){veSlideMenu.slide_menu_cover.show(0,function(){$(this).css("opacity",.6),$("body").css("overflow","hidden"),$("html").css("overflow","hidden")})})})},veSlideMenu.bindCloseMenu=function(){veSlideMenu.slide_menu_cover.click(function(a){a.preventDefault(),veSlideMenu.slide_menu_cover.hide(),veSlideMenu.slide_menu.animate({left:"-80%"},300),veSlideMenu.container.animate({left:0},300,function(){$("body").css("overflow","auto"),$("html").css("overflow","auto")})}),$(".slidemenu-back.main").click(function(a){a.preventDefault(),veSlideMenu.slide_menu_cover.hide(),veSlideMenu.slide_menu.animate({left:"-80%"},300),veSlideMenu.container.animate({left:0},300,function(){$("body").css("overflow","auto"),$("html").css("overflow","auto")})})},veSlideMenu.bindSubMenu=function(){$(".slidemenu-next").click(function(a){a.preventDefault();var b=$(this).parent().find(".subnav");veSlideMenu.slide_menu.animate({scrollTop:0},{duration:0,queue:!1},function(){veSlideMenu.slide_menu.css("overflow","hidden"),b.css("overflow","auto")}),b.animate({left:0},{duration:300,queue:!1})}),$(".slidemenu-back.sub").click(function(a){a.preventDefault(),veSlideMenu.slide_menu_sub_menu.animate({left:"-100%"},500,function(){veSlideMenu.slide_menu.css("overflow","auto")})}),$(".nav-text > a").click(function(a){a.preventDefault();var b=$(this).parent().find(".subnav");if(b.length>0){var c=b[0].children.length;c>0&&(veSlideMenu.slide_menu.animate({scrollTop:0},{duration:0,queue:!1},function(){veSlideMenu.slide_menu.css("overflow","hidden"),b.css("overflow","auto")}),b.animate({left:0},{duration:300,queue:!1}))}})};